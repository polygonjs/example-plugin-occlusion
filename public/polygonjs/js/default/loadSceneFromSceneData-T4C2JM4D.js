import{a as xg,b as x1}from"./chunk-RWEHPLL2.js";import{A as ey,B as ty,C as ry,D as ny,E as oy,F as U1,J as iy,K as V1,a as jv,b as Ad,c as gn,d as I0,e as nl,f as wr,g as Yo,h as Zv,i as qn,j as Pd,k as Tr,l as ol,m as D0,n as Xo,o as il,p as Oi,q as Wn,r as Od,s as $n,t as wd,u as sl,v as Do,x as Rd,y as Qv,z as t0}from"./chunk-HPC26XLO.js";import{$ as Ni,$a as dv,A as Og,Aa as Qg,Ac as _t,B as wg,Ba as qo,Bc as Jv,C as Rg,Ca as nn,Cc as G1,D as Lg,Da as ev,Dc as On,E as Ig,Ea as tv,Ec as Kv,F as Dg,Fa as rv,Fc as L0,G as Bg,Ga as Zc,Gc as Sd,H as kg,Ha as Qc,Hc as Gt,I as Fg,Ia as nv,J as Gg,Ja as ov,Jc as Ld,K as Ug,Ka as iv,Kb as Pn,Kc as al,L as Vg,La as sv,Lb as Wo,Lc as ws,M as A1,Ma as av,Mb as Ps,N as zg,Na as lv,Nb as Os,O as Hg,Oa as M1,Ob as Cd,P as jg,Pa as N1,Pb as Ka,Q as qg,Qa as S1,Qb as Za,R as w0,Ra as P1,Rb as Qa,S as fd,Sa as O1,Sb as Gv,T as md,Ta as w1,Tb as Uv,U as Lo,Ua as R1,Ub as $o,V as hd,Va as L1,Vb as Td,W as _d,Wa as cv,X as gd,Xa as I1,Y as vd,Ya as D1,Z as Wg,Za as uv,Zb as B1,_ as As,_a as pv,_b as Ed,a as Cs,aa as e0,ab as fv,ac as el,b as Ts,ba as Ms,bb as mv,bc as _o,c as Cg,ca as Ns,cb as hv,cc as Pi,d as C1,da as Si,db as _v,dc as k1,e as Tg,ea as Ss,eb as gv,ec as F1,f as Eg,fa as yd,fb as vv,g as $a,ga as rn,gb as yv,gc as Vv,h as dd,ha as bd,hb as bv,hc as ao,i as Qi,ia as Ur,ib as xv,ic as F,j as eo,ja as Xc,jb as Cv,jc as zv,k as Nr,ka as Jc,kb as Tv,kc as Hv,l as Ho,la as Sn,lb as Ev,lc as Io,ma as xd,mb as Av,mc as vr,n as To,na as R0,nb as Mv,nc as kt,o as Es,oa as oi,ob as Nv,oc as re,p as Wc,pa as $g,pb as Sv,pc as tl,q as $c,qa as Yg,qb as Pv,qc as Ke,r as Yc,ra as Kc,rb as Ov,rc as lo,s as Ag,sa as Xg,sb as wv,sc as qv,t as Ya,ta as Xa,tb as Rv,tc as Wv,u as Mg,ua as ho,ub as Lv,uc as $v,v as Ng,va as jo,vb as Iv,vc as Yv,w as T1,wa as Jg,wb as Dv,wc as Md,x as E1,xa as Kg,xb as Bv,xc as rl,y as Sg,ya as Zg,yb as kv,yc as Nd,z as Pg,za as Ja,zb as Fv,zc as Xv}from"./chunk-5BKIQBMM.js";import{a as K,b as b1,c as Zi}from"./chunk-KBNISIIW.js";var HC=K((pse,zC)=>{function Rk(){this.__data__=[],this.size=0}zC.exports=Rk});var b_=K((dse,jC)=>{function Lk(n,e){return n===e||n!==n&&e!==e}jC.exports=Lk});var su=K((fse,qC)=>{var Ik=b_();function Dk(n,e){for(var t=n.length;t--;)if(Ik(n[t][0],e))return t;return-1}qC.exports=Dk});var $C=K((mse,WC)=>{var Bk=su(),kk=Array.prototype,Fk=kk.splice;function Gk(n){var e=this.__data__,t=Bk(e,n);if(t<0)return!1;var r=e.length-1;return t==r?e.pop():Fk.call(e,t,1),--this.size,!0}WC.exports=Gk});var XC=K((hse,YC)=>{var Uk=su();function Vk(n){var e=this.__data__,t=Uk(e,n);return t<0?void 0:e[t][1]}YC.exports=Vk});var KC=K((_se,JC)=>{var zk=su();function Hk(n){return zk(this.__data__,n)>-1}JC.exports=Hk});var QC=K((gse,ZC)=>{var jk=su();function qk(n,e){var t=this.__data__,r=jk(t,n);return r<0?(++this.size,t.push([n,e])):t[r][1]=e,this}ZC.exports=qk});var au=K((vse,eT)=>{var Wk=HC(),$k=$C(),Yk=XC(),Xk=KC(),Jk=QC();function bl(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}bl.prototype.clear=Wk;bl.prototype.delete=$k;bl.prototype.get=Yk;bl.prototype.has=Xk;bl.prototype.set=Jk;eT.exports=bl});var rT=K((yse,tT)=>{var Kk=au();function Zk(){this.__data__=new Kk,this.size=0}tT.exports=Zk});var oT=K((bse,nT)=>{function Qk(n){var e=this.__data__,t=e.delete(n);return this.size=e.size,t}nT.exports=Qk});var sT=K((xse,iT)=>{function eF(n){return this.__data__.get(n)}iT.exports=eF});var lT=K((Cse,aT)=>{function tF(n){return this.__data__.has(n)}aT.exports=tF});var x_=K((Tse,cT)=>{var rF=typeof global=="object"&&global&&global.Object===Object&&global;cT.exports=rF});var ai=K((Ese,uT)=>{var nF=x_(),oF=typeof self=="object"&&self&&self.Object===Object&&self,iF=nF||oF||Function("return this")();uT.exports=iF});var jd=K((Ase,pT)=>{var sF=ai(),aF=sF.Symbol;pT.exports=aF});var hT=K((Mse,mT)=>{var dT=jd(),fT=Object.prototype,lF=fT.hasOwnProperty,cF=fT.toString,lu=dT?dT.toStringTag:void 0;function uF(n){var e=lF.call(n,lu),t=n[lu];try{n[lu]=void 0;var r=!0}catch{}var o=cF.call(n);return r&&(e?n[lu]=t:delete n[lu]),o}mT.exports=uF});var gT=K((Nse,_T)=>{var pF=Object.prototype,dF=pF.toString;function fF(n){return dF.call(n)}_T.exports=fF});var cu=K((Sse,bT)=>{var vT=jd(),mF=hT(),hF=gT(),_F="[object Null]",gF="[object Undefined]",yT=vT?vT.toStringTag:void 0;function vF(n){return n==null?n===void 0?gF:_F:yT&&yT in Object(n)?mF(n):hF(n)}bT.exports=vF});var xl=K((Pse,xT)=>{function yF(n){var e=typeof n;return n!=null&&(e=="object"||e=="function")}xT.exports=yF});var C_=K((Ose,CT)=>{var bF=cu(),xF=xl(),CF="[object AsyncFunction]",TF="[object Function]",EF="[object GeneratorFunction]",AF="[object Proxy]";function MF(n){if(!xF(n))return!1;var e=bF(n);return e==TF||e==EF||e==CF||e==AF}CT.exports=MF});var ET=K((wse,TT)=>{var NF=ai(),SF=NF["__core-js_shared__"];TT.exports=SF});var NT=K((Rse,MT)=>{var T_=ET(),AT=function(){var n=/[^.]+$/.exec(T_&&T_.keys&&T_.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function PF(n){return!!AT&&AT in n}MT.exports=PF});var E_=K((Lse,ST)=>{var OF=Function.prototype,wF=OF.toString;function RF(n){if(n!=null){try{return wF.call(n)}catch{}try{return n+""}catch{}}return""}ST.exports=RF});var OT=K((Ise,PT)=>{var LF=C_(),IF=NT(),DF=xl(),BF=E_(),kF=/[\\^$.*+?()[\]{}|]/g,FF=/^\[object .+?Constructor\]$/,GF=Function.prototype,UF=Object.prototype,VF=GF.toString,zF=UF.hasOwnProperty,HF=RegExp("^"+VF.call(zF).replace(kF,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function jF(n){if(!DF(n)||IF(n))return!1;var e=LF(n)?HF:FF;return e.test(BF(n))}PT.exports=jF});var RT=K((Dse,wT)=>{function qF(n,e){return n==null?void 0:n[e]}wT.exports=qF});var j0=K((Bse,LT)=>{var WF=OT(),$F=RT();function YF(n,e){var t=$F(n,e);return WF(t)?t:void 0}LT.exports=YF});var qd=K((kse,IT)=>{var XF=j0(),JF=ai(),KF=XF(JF,"Map");IT.exports=KF});var uu=K((Fse,DT)=>{var ZF=j0(),QF=ZF(Object,"create");DT.exports=QF});var FT=K((Gse,kT)=>{var BT=uu();function eG(){this.__data__=BT?BT(null):{},this.size=0}kT.exports=eG});var UT=K((Use,GT)=>{function tG(n){var e=this.has(n)&&delete this.__data__[n];return this.size-=e?1:0,e}GT.exports=tG});var zT=K((Vse,VT)=>{var rG=uu(),nG="__lodash_hash_undefined__",oG=Object.prototype,iG=oG.hasOwnProperty;function sG(n){var e=this.__data__;if(rG){var t=e[n];return t===nG?void 0:t}return iG.call(e,n)?e[n]:void 0}VT.exports=sG});var jT=K((zse,HT)=>{var aG=uu(),lG=Object.prototype,cG=lG.hasOwnProperty;function uG(n){var e=this.__data__;return aG?e[n]!==void 0:cG.call(e,n)}HT.exports=uG});var WT=K((Hse,qT)=>{var pG=uu(),dG="__lodash_hash_undefined__";function fG(n,e){var t=this.__data__;return this.size+=this.has(n)?0:1,t[n]=pG&&e===void 0?dG:e,this}qT.exports=fG});var YT=K((jse,$T)=>{var mG=FT(),hG=UT(),_G=zT(),gG=jT(),vG=WT();function Cl(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}Cl.prototype.clear=mG;Cl.prototype.delete=hG;Cl.prototype.get=_G;Cl.prototype.has=gG;Cl.prototype.set=vG;$T.exports=Cl});var KT=K((qse,JT)=>{var XT=YT(),yG=au(),bG=qd();function xG(){this.size=0,this.__data__={hash:new XT,map:new(bG||yG),string:new XT}}JT.exports=xG});var QT=K((Wse,ZT)=>{function CG(n){var e=typeof n;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?n!=="__proto__":n===null}ZT.exports=CG});var pu=K(($se,eE)=>{var TG=QT();function EG(n,e){var t=n.__data__;return TG(e)?t[typeof e=="string"?"string":"hash"]:t.map}eE.exports=EG});var rE=K((Yse,tE)=>{var AG=pu();function MG(n){var e=AG(this,n).delete(n);return this.size-=e?1:0,e}tE.exports=MG});var oE=K((Xse,nE)=>{var NG=pu();function SG(n){return NG(this,n).get(n)}nE.exports=SG});var sE=K((Jse,iE)=>{var PG=pu();function OG(n){return PG(this,n).has(n)}iE.exports=OG});var lE=K((Kse,aE)=>{var wG=pu();function RG(n,e){var t=wG(this,n),r=t.size;return t.set(n,e),this.size+=t.size==r?0:1,this}aE.exports=RG});var uE=K((Zse,cE)=>{var LG=KT(),IG=rE(),DG=oE(),BG=sE(),kG=lE();function Tl(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}Tl.prototype.clear=LG;Tl.prototype.delete=IG;Tl.prototype.get=DG;Tl.prototype.has=BG;Tl.prototype.set=kG;cE.exports=Tl});var dE=K((Qse,pE)=>{var FG=au(),GG=qd(),UG=uE(),VG=200;function zG(n,e){var t=this.__data__;if(t instanceof FG){var r=t.__data__;if(!GG||r.length<VG-1)return r.push([n,e]),this.size=++t.size,this;t=this.__data__=new UG(r)}return t.set(n,e),this.size=t.size,this}pE.exports=zG});var mE=K((eae,fE)=>{var HG=au(),jG=rT(),qG=oT(),WG=sT(),$G=lT(),YG=dE();function El(n){var e=this.__data__=new HG(n);this.size=e.size}El.prototype.clear=jG;El.prototype.delete=qG;El.prototype.get=WG;El.prototype.has=$G;El.prototype.set=YG;fE.exports=El});var _E=K((tae,hE)=>{function XG(n,e){for(var t=-1,r=n==null?0:n.length;++t<r&&e(n[t],t,n)!==!1;);return n}hE.exports=XG});var vE=K((rae,gE)=>{var JG=j0(),KG=function(){try{var n=JG(Object,"defineProperty");return n({},"",{}),n}catch{}}();gE.exports=KG});var A_=K((nae,bE)=>{var yE=vE();function ZG(n,e,t){e=="__proto__"&&yE?yE(n,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):n[e]=t}bE.exports=ZG});var M_=K((oae,xE)=>{var QG=A_(),eU=b_(),tU=Object.prototype,rU=tU.hasOwnProperty;function nU(n,e,t){var r=n[e];(!(rU.call(n,e)&&eU(r,t))||t===void 0&&!(e in n))&&QG(n,e,t)}xE.exports=nU});var du=K((iae,CE)=>{var oU=M_(),iU=A_();function sU(n,e,t,r){var o=!t;t||(t={});for(var s=-1,i=e.length;++s<i;){var l=e[s],a=r?r(t[l],n[l],l,t,n):void 0;a===void 0&&(a=n[l]),o?iU(t,l,a):oU(t,l,a)}return t}CE.exports=sU});var EE=K((sae,TE)=>{function aU(n,e){for(var t=-1,r=Array(n);++t<n;)r[t]=e(t);return r}TE.exports=aU});var Al=K((aae,AE)=>{function lU(n){return n!=null&&typeof n=="object"}AE.exports=lU});var NE=K((lae,ME)=>{var cU=cu(),uU=Al(),pU="[object Arguments]";function dU(n){return uU(n)&&cU(n)==pU}ME.exports=dU});var wE=K((cae,OE)=>{var SE=NE(),fU=Al(),PE=Object.prototype,mU=PE.hasOwnProperty,hU=PE.propertyIsEnumerable,_U=SE(function(){return arguments}())?SE:function(n){return fU(n)&&mU.call(n,"callee")&&!hU.call(n,"callee")};OE.exports=_U});var Wd=K((uae,RE)=>{var gU=Array.isArray;RE.exports=gU});var IE=K((pae,LE)=>{function vU(){return!1}LE.exports=vU});var N_=K((fu,Ml)=>{var yU=ai(),bU=IE(),DE=typeof fu=="object"&&fu&&!fu.nodeType&&fu,BE=DE&&typeof Ml=="object"&&Ml&&!Ml.nodeType&&Ml,xU=BE&&BE.exports===DE,kE=xU?yU.Buffer:void 0,CU=kE?kE.isBuffer:void 0,TU=CU||bU;Ml.exports=TU});var GE=K((dae,FE)=>{var EU=9007199254740991,AU=/^(?:0|[1-9]\d*)$/;function MU(n,e){var t=typeof n;return e=e??EU,!!e&&(t=="number"||t!="symbol"&&AU.test(n))&&n>-1&&n%1==0&&n<e}FE.exports=MU});var S_=K((fae,UE)=>{var NU=9007199254740991;function SU(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=NU}UE.exports=SU});var zE=K((mae,VE)=>{var PU=cu(),OU=S_(),wU=Al(),RU="[object Arguments]",LU="[object Array]",IU="[object Boolean]",DU="[object Date]",BU="[object Error]",kU="[object Function]",FU="[object Map]",GU="[object Number]",UU="[object Object]",VU="[object RegExp]",zU="[object Set]",HU="[object String]",jU="[object WeakMap]",qU="[object ArrayBuffer]",WU="[object DataView]",$U="[object Float32Array]",YU="[object Float64Array]",XU="[object Int8Array]",JU="[object Int16Array]",KU="[object Int32Array]",ZU="[object Uint8Array]",QU="[object Uint8ClampedArray]",eV="[object Uint16Array]",tV="[object Uint32Array]",jr={};jr[$U]=jr[YU]=jr[XU]=jr[JU]=jr[KU]=jr[ZU]=jr[QU]=jr[eV]=jr[tV]=!0;jr[RU]=jr[LU]=jr[qU]=jr[IU]=jr[WU]=jr[DU]=jr[BU]=jr[kU]=jr[FU]=jr[GU]=jr[UU]=jr[VU]=jr[zU]=jr[HU]=jr[jU]=!1;function rV(n){return wU(n)&&OU(n.length)&&!!jr[PU(n)]}VE.exports=rV});var $d=K((hae,HE)=>{function nV(n){return function(e){return n(e)}}HE.exports=nV});var Yd=K((hu,Nl)=>{var oV=x_(),jE=typeof hu=="object"&&hu&&!hu.nodeType&&hu,mu=jE&&typeof Nl=="object"&&Nl&&!Nl.nodeType&&Nl,iV=mu&&mu.exports===jE,P_=iV&&oV.process,sV=function(){try{var n=mu&&mu.require&&mu.require("util").types;return n||P_&&P_.binding&&P_.binding("util")}catch{}}();Nl.exports=sV});var YE=K((_ae,$E)=>{var aV=zE(),lV=$d(),qE=Yd(),WE=qE&&qE.isTypedArray,cV=WE?lV(WE):aV;$E.exports=cV});var O_=K((gae,XE)=>{var uV=EE(),pV=wE(),dV=Wd(),fV=N_(),mV=GE(),hV=YE(),_V=Object.prototype,gV=_V.hasOwnProperty;function vV(n,e){var t=dV(n),r=!t&&pV(n),o=!t&&!r&&fV(n),s=!t&&!r&&!o&&hV(n),i=t||r||o||s,l=i?uV(n.length,String):[],a=l.length;for(var c in n)(e||gV.call(n,c))&&!(i&&(c=="length"||o&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||mV(c,a)))&&l.push(c);return l}XE.exports=vV});var Xd=K((vae,JE)=>{var yV=Object.prototype;function bV(n){var e=n&&n.constructor,t=typeof e=="function"&&e.prototype||yV;return n===t}JE.exports=bV});var w_=K((yae,KE)=>{function xV(n,e){return function(t){return n(e(t))}}KE.exports=xV});var QE=K((bae,ZE)=>{var CV=w_(),TV=CV(Object.keys,Object);ZE.exports=TV});var tA=K((xae,eA)=>{var EV=Xd(),AV=QE(),MV=Object.prototype,NV=MV.hasOwnProperty;function SV(n){if(!EV(n))return AV(n);var e=[];for(var t in Object(n))NV.call(n,t)&&t!="constructor"&&e.push(t);return e}eA.exports=SV});var R_=K((Cae,rA)=>{var PV=C_(),OV=S_();function wV(n){return n!=null&&OV(n.length)&&!PV(n)}rA.exports=wV});var Jd=K((Tae,nA)=>{var RV=O_(),LV=tA(),IV=R_();function DV(n){return IV(n)?RV(n):LV(n)}nA.exports=DV});var iA=K((Eae,oA)=>{var BV=du(),kV=Jd();function FV(n,e){return n&&BV(e,kV(e),n)}oA.exports=FV});var aA=K((Aae,sA)=>{function GV(n){var e=[];if(n!=null)for(var t in Object(n))e.push(t);return e}sA.exports=GV});var cA=K((Mae,lA)=>{var UV=xl(),VV=Xd(),zV=aA(),HV=Object.prototype,jV=HV.hasOwnProperty;function qV(n){if(!UV(n))return zV(n);var e=VV(n),t=[];for(var r in n)r=="constructor"&&(e||!jV.call(n,r))||t.push(r);return t}lA.exports=qV});var Kd=K((Nae,uA)=>{var WV=O_(),$V=cA(),YV=R_();function XV(n){return YV(n)?WV(n,!0):$V(n)}uA.exports=XV});var dA=K((Sae,pA)=>{var JV=du(),KV=Kd();function ZV(n,e){return n&&JV(e,KV(e),n)}pA.exports=ZV});var gA=K((_u,Sl)=>{var QV=ai(),fA=typeof _u=="object"&&_u&&!_u.nodeType&&_u,mA=fA&&typeof Sl=="object"&&Sl&&!Sl.nodeType&&Sl,ez=mA&&mA.exports===fA,hA=ez?QV.Buffer:void 0,_A=hA?hA.allocUnsafe:void 0;function tz(n,e){if(e)return n.slice();var t=n.length,r=_A?_A(t):new n.constructor(t);return n.copy(r),r}Sl.exports=tz});var yA=K((Pae,vA)=>{function rz(n,e){var t=-1,r=n.length;for(e||(e=Array(r));++t<r;)e[t]=n[t];return e}vA.exports=rz});var xA=K((Oae,bA)=>{function nz(n,e){for(var t=-1,r=n==null?0:n.length,o=0,s=[];++t<r;){var i=n[t];e(i,t,n)&&(s[o++]=i)}return s}bA.exports=nz});var L_=K((wae,CA)=>{function oz(){return[]}CA.exports=oz});var Zd=K((Rae,EA)=>{var iz=xA(),sz=L_(),az=Object.prototype,lz=az.propertyIsEnumerable,TA=Object.getOwnPropertySymbols,cz=TA?function(n){return n==null?[]:(n=Object(n),iz(TA(n),function(e){return lz.call(n,e)}))}:sz;EA.exports=cz});var MA=K((Lae,AA)=>{var uz=du(),pz=Zd();function dz(n,e){return uz(n,pz(n),e)}AA.exports=dz});var I_=K((Iae,NA)=>{function fz(n,e){for(var t=-1,r=e.length,o=n.length;++t<r;)n[o+t]=e[t];return n}NA.exports=fz});var D_=K((Dae,SA)=>{var mz=w_(),hz=mz(Object.getPrototypeOf,Object);SA.exports=hz});var B_=K((Bae,PA)=>{var _z=I_(),gz=D_(),vz=Zd(),yz=L_(),bz=Object.getOwnPropertySymbols,xz=bz?function(n){for(var e=[];n;)_z(e,vz(n)),n=gz(n);return e}:yz;PA.exports=xz});var wA=K((kae,OA)=>{var Cz=du(),Tz=B_();function Ez(n,e){return Cz(n,Tz(n),e)}OA.exports=Ez});var k_=K((Fae,RA)=>{var Az=I_(),Mz=Wd();function Nz(n,e,t){var r=e(n);return Mz(n)?r:Az(r,t(n))}RA.exports=Nz});var IA=K((Gae,LA)=>{var Sz=k_(),Pz=Zd(),Oz=Jd();function wz(n){return Sz(n,Oz,Pz)}LA.exports=wz});var BA=K((Uae,DA)=>{var Rz=k_(),Lz=B_(),Iz=Kd();function Dz(n){return Rz(n,Iz,Lz)}DA.exports=Dz});var FA=K((Vae,kA)=>{var Bz=j0(),kz=ai(),Fz=Bz(kz,"DataView");kA.exports=Fz});var UA=K((zae,GA)=>{var Gz=j0(),Uz=ai(),Vz=Gz(Uz,"Promise");GA.exports=Vz});var zA=K((Hae,VA)=>{var zz=j0(),Hz=ai(),jz=zz(Hz,"Set");VA.exports=jz});var jA=K((jae,HA)=>{var qz=j0(),Wz=ai(),$z=qz(Wz,"WeakMap");HA.exports=$z});var Qd=K((qae,KA)=>{var F_=FA(),G_=qd(),U_=UA(),V_=zA(),z_=jA(),qA=cu(),Pl=E_(),WA="[object Map]",Yz="[object Object]",$A="[object Promise]",YA="[object Set]",XA="[object WeakMap]",JA="[object DataView]",Xz=Pl(F_),Jz=Pl(G_),Kz=Pl(U_),Zz=Pl(V_),Qz=Pl(z_),Ls=qA;(F_&&Ls(new F_(new ArrayBuffer(1)))!=JA||G_&&Ls(new G_)!=WA||U_&&Ls(U_.resolve())!=$A||V_&&Ls(new V_)!=YA||z_&&Ls(new z_)!=XA)&&(Ls=function(n){var e=qA(n),t=e==Yz?n.constructor:void 0,r=t?Pl(t):"";if(r)switch(r){case Xz:return JA;case Jz:return WA;case Kz:return $A;case Zz:return YA;case Qz:return XA}return e});KA.exports=Ls});var QA=K((Wae,ZA)=>{var eH=Object.prototype,tH=eH.hasOwnProperty;function rH(n){var e=n.length,t=new n.constructor(e);return e&&typeof n[0]=="string"&&tH.call(n,"index")&&(t.index=n.index,t.input=n.input),t}ZA.exports=rH});var tM=K(($ae,eM)=>{var nH=ai(),oH=nH.Uint8Array;eM.exports=oH});var ef=K((Yae,nM)=>{var rM=tM();function iH(n){var e=new n.constructor(n.byteLength);return new rM(e).set(new rM(n)),e}nM.exports=iH});var iM=K((Xae,oM)=>{var sH=ef();function aH(n,e){var t=e?sH(n.buffer):n.buffer;return new n.constructor(t,n.byteOffset,n.byteLength)}oM.exports=aH});var aM=K((Jae,sM)=>{var lH=/\w*$/;function cH(n){var e=new n.constructor(n.source,lH.exec(n));return e.lastIndex=n.lastIndex,e}sM.exports=cH});var dM=K((Kae,pM)=>{var lM=jd(),cM=lM?lM.prototype:void 0,uM=cM?cM.valueOf:void 0;function uH(n){return uM?Object(uM.call(n)):{}}pM.exports=uH});var mM=K((Zae,fM)=>{var pH=ef();function dH(n,e){var t=e?pH(n.buffer):n.buffer;return new n.constructor(t,n.byteOffset,n.length)}fM.exports=dH});var _M=K((Qae,hM)=>{var fH=ef(),mH=iM(),hH=aM(),_H=dM(),gH=mM(),vH="[object Boolean]",yH="[object Date]",bH="[object Map]",xH="[object Number]",CH="[object RegExp]",TH="[object Set]",EH="[object String]",AH="[object Symbol]",MH="[object ArrayBuffer]",NH="[object DataView]",SH="[object Float32Array]",PH="[object Float64Array]",OH="[object Int8Array]",wH="[object Int16Array]",RH="[object Int32Array]",LH="[object Uint8Array]",IH="[object Uint8ClampedArray]",DH="[object Uint16Array]",BH="[object Uint32Array]";function kH(n,e,t){var r=n.constructor;switch(e){case MH:return fH(n);case vH:case yH:return new r(+n);case NH:return mH(n,t);case SH:case PH:case OH:case wH:case RH:case LH:case IH:case DH:case BH:return gH(n,t);case bH:return new r;case xH:case EH:return new r(n);case CH:return hH(n);case TH:return new r;case AH:return _H(n)}}hM.exports=kH});var yM=K((ele,vM)=>{var FH=xl(),gM=Object.create,GH=function(){function n(){}return function(e){if(!FH(e))return{};if(gM)return gM(e);n.prototype=e;var t=new n;return n.prototype=void 0,t}}();vM.exports=GH});var xM=K((tle,bM)=>{var UH=yM(),VH=D_(),zH=Xd();function HH(n){return typeof n.constructor=="function"&&!zH(n)?UH(VH(n)):{}}bM.exports=HH});var TM=K((rle,CM)=>{var jH=Qd(),qH=Al(),WH="[object Map]";function $H(n){return qH(n)&&jH(n)==WH}CM.exports=$H});var NM=K((nle,MM)=>{var YH=TM(),XH=$d(),EM=Yd(),AM=EM&&EM.isMap,JH=AM?XH(AM):YH;MM.exports=JH});var PM=K((ole,SM)=>{var KH=Qd(),ZH=Al(),QH="[object Set]";function ej(n){return ZH(n)&&KH(n)==QH}SM.exports=ej});var LM=K((ile,RM)=>{var tj=PM(),rj=$d(),OM=Yd(),wM=OM&&OM.isSet,nj=wM?rj(wM):tj;RM.exports=nj});var H_=K((sle,kM)=>{var oj=mE(),ij=_E(),sj=M_(),aj=iA(),lj=dA(),cj=gA(),uj=yA(),pj=MA(),dj=wA(),fj=IA(),mj=BA(),hj=Qd(),_j=QA(),gj=_M(),vj=xM(),yj=Wd(),bj=N_(),xj=NM(),Cj=xl(),Tj=LM(),Ej=Jd(),Aj=Kd(),Mj=1,Nj=2,Sj=4,IM="[object Arguments]",Pj="[object Array]",Oj="[object Boolean]",wj="[object Date]",Rj="[object Error]",DM="[object Function]",Lj="[object GeneratorFunction]",Ij="[object Map]",Dj="[object Number]",BM="[object Object]",Bj="[object RegExp]",kj="[object Set]",Fj="[object String]",Gj="[object Symbol]",Uj="[object WeakMap]",Vj="[object ArrayBuffer]",zj="[object DataView]",Hj="[object Float32Array]",jj="[object Float64Array]",qj="[object Int8Array]",Wj="[object Int16Array]",$j="[object Int32Array]",Yj="[object Uint8Array]",Xj="[object Uint8ClampedArray]",Jj="[object Uint16Array]",Kj="[object Uint32Array]",Hr={};Hr[IM]=Hr[Pj]=Hr[Vj]=Hr[zj]=Hr[Oj]=Hr[wj]=Hr[Hj]=Hr[jj]=Hr[qj]=Hr[Wj]=Hr[$j]=Hr[Ij]=Hr[Dj]=Hr[BM]=Hr[Bj]=Hr[kj]=Hr[Fj]=Hr[Gj]=Hr[Yj]=Hr[Xj]=Hr[Jj]=Hr[Kj]=!0;Hr[Rj]=Hr[DM]=Hr[Uj]=!1;function tf(n,e,t,r,o,s){var i,l=e&Mj,a=e&Nj,c=e&Sj;if(t&&(i=o?t(n,r,o,s):t(n)),i!==void 0)return i;if(!Cj(n))return n;var h=yj(n);if(h){if(i=_j(n),!l)return uj(n,i)}else{var g=hj(n),p=g==DM||g==Lj;if(bj(n))return cj(n,l);if(g==BM||g==IM||p&&!o){if(i=a||p?{}:vj(n),!l)return a?dj(n,lj(i,n)):pj(n,aj(i,n))}else{if(!Hr[g])return o?n:{};i=gj(n,g,l)}}s||(s=new oj);var u=s.get(n);if(u)return u;s.set(n,i),Tj(n)?n.forEach(function(_){i.add(tf(_,e,t,_,n,s))}):xj(n)&&n.forEach(function(_,m){i.set(m,tf(_,e,t,m,n,s))});var d=c?a?mj:fj:a?Aj:Ej,f=h?void 0:d(n);return ij(f||n,function(_,m){f&&(m=_,_=n[m]),sj(i,m,tf(_,e,t,m,n,s))}),i}kM.exports=tf});var j_=K((ale,FM)=>{var Zj=H_(),Qj=1,eq=4;function tq(n){return Zj(n,Qj|eq)}FM.exports=tq});var q_=K((lle,GM)=>{var rq=H_(),nq=4;function oq(n){return rq(n,nq)}GM.exports=oq});var $9=K((Tu,_f)=>{(function(n){"use strict";var e="Compound",t="Identifier",r="MemberExpression",o="Literal",s="ThisExpression",i="CallExpression",l="UnaryExpression",a="BinaryExpression",c="LogicalExpression",h="ConditionalExpression",g="ArrayExpression",p=46,u=44,d=39,f=34,_=40,m=41,v=91,y=93,b=63,x=59,E=58,T=function(ce,oe){var yt=new Error(ce+" at character "+oe);throw yt.index=oe,yt.description=ce,yt},M=!0,D={"-":M,"!":M,"~":M,"+":M},U={"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},L=function(ce){var oe=0,yt;for(var X in ce)(yt=X.length)>oe&&ce.hasOwnProperty(X)&&(oe=yt);return oe},se=L(D),$=L(U),H={true:!0,false:!1,null:null},ae="this",ue=function(ce){return U[ce]||0},me=function(ce,oe,yt){var X=ce==="||"||ce==="&&"?c:a;return{type:X,operator:ce,left:oe,right:yt}},Ue=function(ce){return ce>=48&&ce<=57},st=function(ce){return ce===36||ce===95||ce>=65&&ce<=90||ce>=97&&ce<=122||ce>=128&&!U[String.fromCharCode(ce)]},ft=function(ce){return ce===36||ce===95||ce>=65&&ce<=90||ce>=97&&ce<=122||ce>=48&&ce<=57||ce>=128&&!U[String.fromCharCode(ce)]},Ze=function(ce){for(var oe=0,yt=ce.charAt,X=ce.charCodeAt,Tt=function(De){return yt.call(ce,De)},At=function(De){return X.call(ce,De)},Nt=ce.length,Mt=function(){for(var De=At(oe);De===32||De===9||De===10||De===13;)De=At(++oe)},Vt=function(){var De=tt(),Le,Y;if(Mt(),At(oe)===b){if(oe++,Le=Vt(),Le||T("Expected expression",oe),Mt(),At(oe)===E)return oe++,Y=Vt(),Y||T("Expected expression",oe),{type:h,test:De,consequent:Le,alternate:Y};T("Expected :",oe)}else return De},Re=function(){Mt();for(var De,Le=ce.substr(oe,$),Y=Le.length;Y>0;){if(U.hasOwnProperty(Le)&&(!st(At(oe))||oe+Le.length<ce.length&&!ft(At(oe+Le.length))))return oe+=Y,Le;Le=Le.substr(0,--Y)}return!1},tt=function(){var De,Le,Y,ot,Oe,bt,Pt,Zt,ne,Et;if(Pt=ut(),Y=Re(),!Y)return Pt;for(bt={value:Y,prec:ue(Y)},Zt=ut(),Zt||T("Expected expression after "+Y,oe),Oe=[Pt,bt,Zt];(Y=Re())&&(ot=ue(Y),ot!==0);){for(bt={value:Y,prec:ot},Et=Y;Oe.length>2&&ot<=Oe[Oe.length-2].prec;)Zt=Oe.pop(),Y=Oe.pop().value,Pt=Oe.pop(),Le=me(Y,Pt,Zt),Oe.push(Le);Le=ut(),Le||T("Expected expression after "+Et,oe),Oe.push(bt,Le)}for(ne=Oe.length-1,Le=Oe[ne];ne>1;)Le=me(Oe[ne-1].value,Oe[ne-2],Le),ne-=2;return Le},ut=function(){var De,Le,Y;if(Mt(),De=At(oe),Ue(De)||De===p)return It();if(De===d||De===f)return pt();if(De===v)return A();for(Le=ce.substr(oe,se),Y=Le.length;Y>0;){if(D.hasOwnProperty(Le)&&(!st(At(oe))||oe+Le.length<ce.length&&!ft(At(oe+Le.length))))return oe+=Y,{type:l,operator:Le,argument:ut(),prefix:!0};Le=Le.substr(0,--Y)}return st(De)||De===_?Pe():!1},It=function(){for(var De="",Le,Y;Ue(At(oe));)De+=Tt(oe++);if(At(oe)===p)for(De+=Tt(oe++);Ue(At(oe));)De+=Tt(oe++);if(Le=Tt(oe),Le==="e"||Le==="E"){for(De+=Tt(oe++),Le=Tt(oe),(Le==="+"||Le==="-")&&(De+=Tt(oe++));Ue(At(oe));)De+=Tt(oe++);Ue(At(oe-1))||T("Expected exponent ("+De+Tt(oe)+")",oe)}return Y=At(oe),st(Y)?T("Variable names cannot start with a number ("+De+Tt(oe)+")",oe):Y===p&&T("Unexpected period",oe),{type:o,value:parseFloat(De),raw:De}},pt=function(){for(var De="",Le=Tt(oe++),Y=!1,ot;oe<Nt;)if(ot=Tt(oe++),ot===Le){Y=!0;break}else if(ot==="\\")switch(ot=Tt(oe++),ot){case"n":De+=`
`;break;case"r":De+="\r";break;case"t":De+="	";break;case"b":De+="\b";break;case"f":De+="\f";break;case"v":De+="\v";break;default:De+=ot}else De+=ot;return Y||T('Unclosed quote after "'+De+'"',oe),{type:o,value:De,raw:Le+De+Le}},V=function(){var De=At(oe),Le=oe,Y;for(st(De)?oe++:T("Unexpected "+Tt(oe),oe);oe<Nt&&(De=At(oe),ft(De));)oe++;return Y=ce.slice(Le,oe),H.hasOwnProperty(Y)?{type:o,value:H[Y],raw:Y}:Y===ae?{type:s}:{type:t,name:Y}},B=function(De){for(var Le,Y=[],ot,Oe=!1,bt=0;oe<Nt;)if(Mt(),Le=At(oe),Le===De){Oe=!0,oe++,De===m&&bt&&bt>=Y.length&&T("Unexpected token "+String.fromCharCode(De),oe);break}else if(Le===u){if(oe++,bt++,bt!==Y.length){if(De===m)T("Unexpected token ,",oe);else if(De===y)for(var Pt=Y.length;Pt<bt;Pt++)Y.push(null)}}else ot=Vt(),(!ot||ot.type===e)&&T("Expected comma",oe),Y.push(ot);return Oe||T("Expected "+String.fromCharCode(De),oe),Y},Pe=function(){var De,Le;for(De=At(oe),De===_?Le=lt():Le=V(),Mt(),De=At(oe);De===p||De===v||De===_;)oe++,De===p?(Mt(),Le={type:r,computed:!1,object:Le,property:V()}):De===v?(Le={type:r,computed:!0,object:Le,property:Vt()},Mt(),De=At(oe),De!==y&&T("Unclosed [",oe),oe++):De===_&&(Le={type:i,arguments:B(m),callee:Le}),Mt(),De=At(oe);return Le},lt=function(){oe++;var De=Vt();if(Mt(),At(oe)===m)return oe++,De;T("Unclosed (",oe)},A=function(){return oe++,{type:g,elements:B(y)}},St=[],Ut,Dt;oe<Nt;)Ut=At(oe),Ut===x||Ut===u?oe++:(Dt=Vt())?St.push(Dt):oe<Nt&&T('Unexpected "'+Tt(oe)+'"',oe);return St.length===1?St[0]:{type:e,body:St}};if(Ze.version="0.3.5",Ze.toString=function(){return"JavaScript Expression Parser (JSEP) v"+Ze.version},Ze.addUnaryOp=function(ce){return se=Math.max(ce.length,se),D[ce]=M,this},Ze.addBinaryOp=function(ce,oe){return $=Math.max(ce.length,$),U[ce]=oe,this},Ze.addLiteral=function(ce,oe){return H[ce]=oe,this},Ze.removeUnaryOp=function(ce){return delete D[ce],ce.length===se&&(se=L(D)),this},Ze.removeAllUnaryOps=function(){return D={},se=0,this},Ze.removeBinaryOp=function(ce){return delete U[ce],ce.length===$&&($=L(U)),this},Ze.removeAllBinaryOps=function(){return U={},$=0,this},Ze.removeLiteral=function(ce){return delete H[ce],this},Ze.removeAllLiterals=function(){return H={},this},typeof Tu=="undefined"){var gt=n.jsep;n.jsep=Ze,Ze.noConflict=function(){return n.jsep===Ze&&(n.jsep=gt),Ze}}else typeof _f!="undefined"&&_f.exports?Tu=_f.exports=Ze:Tu.parse=Ze})(Tu)});var wN=K((Q2,e3)=>{(function(n,e){typeof Q2=="object"&&typeof e3!="undefined"?e3.exports=e():typeof define=="function"&&define.amd?define(e):n.createREGL=e()})(Q2,function(){"use strict";var n=function(C){return C instanceof Uint8Array||C instanceof Uint16Array||C instanceof Uint32Array||C instanceof Int8Array||C instanceof Int16Array||C instanceof Int32Array||C instanceof Float32Array||C instanceof Float64Array||C instanceof Uint8ClampedArray},e=function(C,P){for(var G=Object.keys(P),de=0;de<G.length;++de)C[G[de]]=P[G[de]];return C},t=`
`;function r(C){return typeof atob!="undefined"?atob(C):"base64:"+C}function o(C){var P=new Error("(regl) "+C);throw console.error(P),P}function s(C,P){C||o(P)}function i(C){return C?": "+C:""}function l(C,P,G){C in P||o("unknown parameter ("+C+")"+i(G)+". possible values: "+Object.keys(P).join())}function a(C,P){n(C)||o("invalid parameter type"+i(P)+". must be a typed array")}function c(C,P){switch(P){case"number":return typeof C=="number";case"object":return typeof C=="object";case"string":return typeof C=="string";case"boolean":return typeof C=="boolean";case"function":return typeof C=="function";case"undefined":return typeof C=="undefined";case"symbol":return typeof C=="symbol"}}function h(C,P,G){c(C,P)||o("invalid parameter type"+i(G)+". expected "+P+", got "+typeof C)}function g(C,P){C>=0&&(C|0)===C||o("invalid parameter type, ("+C+")"+i(P)+". must be a nonnegative integer")}function p(C,P,G){P.indexOf(C)<0&&o("invalid value"+i(G)+". must be one of: "+P)}var u=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function d(C){Object.keys(C).forEach(function(P){u.indexOf(P)<0&&o('invalid regl constructor argument "'+P+'". must be one of '+u)})}function f(C,P){for(C=C+"";C.length<P;)C=" "+C;return C}function _(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function m(C,P){this.number=C,this.line=P,this.errors=[]}function v(C,P,G){this.file=C,this.line=P,this.message=G}function y(){var C=new Error,P=(C.stack||C).toString(),G=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(P);if(G)return G[1];var de=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(P);return de?de[1]:"unknown"}function b(){var C=new Error,P=(C.stack||C).toString(),G=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(P);if(G)return G[1];var de=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(P);return de?de[1]:"unknown"}function x(C,P){var G=C.split(`
`),de=1,Ee=0,pe={unknown:new _,0:new _};pe.unknown.name=pe[0].name=P||y(),pe.unknown.lines.push(new m(0,""));for(var _e=0;_e<G.length;++_e){var Be=G[_e],Ve=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(Be);if(Ve)switch(Ve[1]){case"line":var We=/(\d+)(\s+\d+)?/.exec(Ve[2]);We&&(de=We[1]|0,We[2]&&(Ee=We[2]|0,Ee in pe||(pe[Ee]=new _)));break;case"define":var ze=/SHADER_NAME(_B64)?\s+(.*)$/.exec(Ve[2]);ze&&(pe[Ee].name=ze[1]?r(ze[2]):ze[2]);break}pe[Ee].lines.push(new m(de++,Be))}return Object.keys(pe).forEach(function(Xe){var rt=pe[Xe];rt.lines.forEach(function(ke){rt.index[ke.number]=ke})}),pe}function E(C){var P=[];return C.split(`
`).forEach(function(G){if(!(G.length<5)){var de=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(G);de?P.push(new v(de[1]|0,de[2]|0,de[3].trim())):G.length>0&&P.push(new v("unknown",0,G))}}),P}function T(C,P){P.forEach(function(G){var de=C[G.file];if(de){var Ee=de.index[G.line];if(Ee){Ee.errors.push(G),de.hasErrors=!0;return}}C.unknown.hasErrors=!0,C.unknown.lines[0].errors.push(G)})}function M(C,P,G,de,Ee){if(!C.getShaderParameter(P,C.COMPILE_STATUS)){var pe=C.getShaderInfoLog(P),_e=de===C.FRAGMENT_SHADER?"fragment":"vertex";ae(G,"string",_e+" shader source must be a string",Ee);var Be=x(G,Ee),Ve=E(pe);T(Be,Ve),Object.keys(Be).forEach(function(We){var ze=Be[We];if(!ze.hasErrors)return;var Xe=[""],rt=[""];function ke(Je,ee){Xe.push(Je),rt.push(ee||"")}ke("file number "+We+": "+ze.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),ze.lines.forEach(function(Je){if(Je.errors.length>0){ke(f(Je.number,4)+"|  ","background-color:yellow; font-weight:bold"),ke(Je.line+t,"color:red; background-color:yellow; font-weight:bold");var ee=0;Je.errors.forEach(function(ge){var qe=ge.message,at=/^\s*'(.*)'\s*:\s*(.*)$/.exec(qe);if(at){var Ne=at[1];switch(qe=at[2],Ne){case"assign":Ne="=";break}ee=Math.max(Je.line.indexOf(Ne,ee),0)}else ee=0;ke(f("| ",6)),ke(f("^^^",ee+3)+t,"font-weight:bold"),ke(f("| ",6)),ke(qe+t,"font-weight:bold")}),ke(f("| ",6)+t)}else ke(f(Je.number,4)+"|  "),ke(Je.line+t,"color:red")}),typeof document!="undefined"&&!window.chrome?(rt[0]=Xe.join("%c"),console.log.apply(console,rt)):console.log(Xe.join(""))}),s.raise("Error compiling "+_e+" shader, "+Be[0].name)}}function D(C,P,G,de,Ee){if(!C.getProgramParameter(P,C.LINK_STATUS)){var pe=C.getProgramInfoLog(P),_e=x(G,Ee),Be=x(de,Ee),Ve='Error linking program with vertex shader, "'+Be[0].name+'", and fragment shader "'+_e[0].name+'"';typeof document!="undefined"?console.log("%c"+Ve+t+"%c"+pe,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(Ve+t+pe),s.raise(Ve)}}function U(C){C._commandRef=y()}function L(C,P,G,de){U(C);function Ee(Ve){return Ve?de.id(Ve):0}C._fragId=Ee(C.static.frag),C._vertId=Ee(C.static.vert);function pe(Ve,We){Object.keys(We).forEach(function(ze){Ve[de.id(ze)]=!0})}var _e=C._uniformSet={};pe(_e,P.static),pe(_e,P.dynamic);var Be=C._attributeSet={};pe(Be,G.static),pe(Be,G.dynamic),C._hasCount="count"in C.static||"count"in C.dynamic||"elements"in C.static||"elements"in C.dynamic}function se(C,P){var G=b();o(C+" in command "+(P||y())+(G==="unknown"?"":" called from "+G))}function $(C,P,G){C||se(P,G||y())}function H(C,P,G,de){C in P||se("unknown parameter ("+C+")"+i(G)+". possible values: "+Object.keys(P).join(),de||y())}function ae(C,P,G,de){c(C,P)||se("invalid parameter type"+i(G)+". expected "+P+", got "+typeof C,de||y())}function ue(C){C()}function me(C,P,G){C.texture?p(C.texture._texture.internalformat,P,"unsupported texture format for attachment"):p(C.renderbuffer._renderbuffer.format,G,"unsupported renderbuffer format for attachment")}var Ue=33071,st=9728,ft=9984,Ze=9985,gt=9986,ce=9987,oe=5120,yt=5121,X=5122,Tt=5123,At=5124,Nt=5125,Mt=5126,Vt=32819,Re=32820,tt=33635,ut=34042,It=36193,pt={};pt[oe]=pt[yt]=1,pt[X]=pt[Tt]=pt[It]=pt[tt]=pt[Vt]=pt[Re]=2,pt[At]=pt[Nt]=pt[Mt]=pt[ut]=4;function V(C,P){return C===Re||C===Vt||C===tt?2:C===ut?4:pt[C]*P}function B(C){return!(C&C-1)&&!!C}function Pe(C,P,G){var de,Ee=P.width,pe=P.height,_e=P.channels;s(Ee>0&&Ee<=G.maxTextureSize&&pe>0&&pe<=G.maxTextureSize,"invalid texture shape"),(C.wrapS!==Ue||C.wrapT!==Ue)&&s(B(Ee)&&B(pe),"incompatible wrap mode for texture, both width and height must be power of 2"),P.mipmask===1?Ee!==1&&pe!==1&&s(C.minFilter!==ft&&C.minFilter!==gt&&C.minFilter!==Ze&&C.minFilter!==ce,"min filter requires mipmap"):(s(B(Ee)&&B(pe),"texture must be a square power of 2 to support mipmapping"),s(P.mipmask===(Ee<<1)-1,"missing or incomplete mipmap data")),P.type===Mt&&(G.extensions.indexOf("oes_texture_float_linear")<0&&s(C.minFilter===st&&C.magFilter===st,"filter not supported, must enable oes_texture_float_linear"),s(!C.genMipmaps,"mipmap generation not supported with float textures"));var Be=P.images;for(de=0;de<16;++de)if(Be[de]){var Ve=Ee>>de,We=pe>>de;s(P.mipmask&1<<de,"missing mipmap data");var ze=Be[de];if(s(ze.width===Ve&&ze.height===We,"invalid shape for mip images"),s(ze.format===P.format&&ze.internalformat===P.internalformat&&ze.type===P.type,"incompatible type for mip image"),!ze.compressed)if(ze.data){var Xe=Math.ceil(V(ze.type,_e)*Ve/ze.unpackAlignment)*ze.unpackAlignment;s(ze.data.byteLength===Xe*We,"invalid data for image, buffer size is inconsistent with image format")}else ze.element||ze.copy}else C.genMipmaps||s((P.mipmask&1<<de)==0,"extra mipmap data");P.compressed&&s(!C.genMipmaps,"mipmap generation for compressed images not supported")}function lt(C,P,G,de){var Ee=C.width,pe=C.height,_e=C.channels;s(Ee>0&&Ee<=de.maxTextureSize&&pe>0&&pe<=de.maxTextureSize,"invalid texture shape"),s(Ee===pe,"cube map must be square"),s(P.wrapS===Ue&&P.wrapT===Ue,"wrap mode not supported by cube map");for(var Be=0;Be<G.length;++Be){var Ve=G[Be];s(Ve.width===Ee&&Ve.height===pe,"inconsistent cube map face shape"),P.genMipmaps&&(s(!Ve.compressed,"can not generate mipmap for compressed textures"),s(Ve.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var We=Ve.images,ze=0;ze<16;++ze){var Xe=We[ze];if(Xe){var rt=Ee>>ze,ke=pe>>ze;s(Ve.mipmask&1<<ze,"missing mipmap data"),s(Xe.width===rt&&Xe.height===ke,"invalid shape for mip images"),s(Xe.format===C.format&&Xe.internalformat===C.internalformat&&Xe.type===C.type,"incompatible type for mip image"),Xe.compressed||(Xe.data?s(Xe.data.byteLength===rt*ke*Math.max(V(Xe.type,_e),Xe.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):Xe.element||Xe.copy)}}}}var A=e(s,{optional:ue,raise:o,commandRaise:se,command:$,parameter:l,commandParameter:H,constructor:d,type:h,commandType:ae,isTypedArray:a,nni:g,oneOf:p,shaderError:M,linkError:D,callSite:b,saveCommandRef:U,saveDrawInfo:L,framebufferFormat:me,guessCommand:y,texture2D:Pe,textureCube:lt}),St=0,Ut=0,Dt=5,De=6;function Le(C,P){this.id=St++,this.type=C,this.data=P}function Y(C){return C.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function ot(C){if(C.length===0)return[];var P=C.charAt(0),G=C.charAt(C.length-1);if(C.length>1&&P===G&&(P==='"'||P==="'"))return['"'+Y(C.substr(1,C.length-2))+'"'];var de=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(C);if(de)return ot(C.substr(0,de.index)).concat(ot(de[1])).concat(ot(C.substr(de.index+de[0].length)));var Ee=C.split(".");if(Ee.length===1)return['"'+Y(C)+'"'];for(var pe=[],_e=0;_e<Ee.length;++_e)pe=pe.concat(ot(Ee[_e]));return pe}function Oe(C){return"["+ot(C).join("][")+"]"}function bt(C,P){return new Le(C,Oe(P+""))}function Pt(C){return typeof C=="function"&&!C._reglType||C instanceof Le}function Zt(C,P){if(typeof C=="function")return new Le(Ut,C);if(typeof C=="number"||typeof C=="boolean")return new Le(Dt,C);if(Array.isArray(C))return new Le(De,C.map((G,de)=>Zt(G,P+"["+de+"]")));if(C instanceof Le)return C;A(!1,"invalid option type in uniform "+P)}var ne={DynamicVariable:Le,define:bt,isDynamic:Pt,unbox:Zt,accessor:Oe},Et={next:typeof requestAnimationFrame=="function"?function(C){return requestAnimationFrame(C)}:function(C){return setTimeout(C,16)},cancel:typeof cancelAnimationFrame=="function"?function(C){return cancelAnimationFrame(C)}:clearTimeout},Or=typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function cr(){var C={"":0},P=[""];return{id:function(G){var de=C[G];return de||(de=C[G]=P.length,P.push(G),de)},str:function(G){return P[G]}}}function an(C,P,G){var de=document.createElement("canvas");e(de.style,{border:0,margin:0,padding:0,top:0,left:0}),C.appendChild(de),C===document.body&&(de.style.position="absolute",e(C.style,{margin:0,padding:0}));function Ee(){var Be=window.innerWidth,Ve=window.innerHeight;if(C!==document.body){var We=C.getBoundingClientRect();Be=We.right-We.left,Ve=We.bottom-We.top}de.width=G*Be,de.height=G*Ve,e(de.style,{width:Be+"px",height:Ve+"px"})}var pe;C!==document.body&&typeof ResizeObserver=="function"?(pe=new ResizeObserver(function(){setTimeout(Ee)}),pe.observe(C)):window.addEventListener("resize",Ee,!1);function _e(){pe?pe.disconnect():window.removeEventListener("resize",Ee),C.removeChild(de)}return Ee(),{canvas:de,onDestroy:_e}}function Vn(C,P){function G(de){try{return C.getContext(de,P)}catch{return null}}return G("webgl")||G("experimental-webgl")||G("webgl-experimental")}function Oo(C){return typeof C.nodeName=="string"&&typeof C.appendChild=="function"&&typeof C.getBoundingClientRect=="function"}function Ip(C){return typeof C.drawArrays=="function"||typeof C.drawElements=="function"}function A0(C){return typeof C=="string"?C.split():(A(Array.isArray(C),"invalid extension array"),C)}function po(C){return typeof C=="string"?(A(typeof document!="undefined","not supported outside of DOM"),document.querySelector(C)):C}function Ln(C){var P=C||{},G,de,Ee,pe,_e={},Be=[],Ve=[],We=typeof window=="undefined"?1:window.devicePixelRatio,ze=!1,Xe=function(Je){Je&&A.raise(Je)},rt=function(){};if(typeof P=="string"?(A(typeof document!="undefined","selector queries only supported in DOM enviroments"),G=document.querySelector(P),A(G,"invalid query string for element")):typeof P=="object"?Oo(P)?G=P:Ip(P)?(pe=P,Ee=pe.canvas):(A.constructor(P),"gl"in P?pe=P.gl:"canvas"in P?Ee=po(P.canvas):"container"in P&&(de=po(P.container)),"attributes"in P&&(_e=P.attributes,A.type(_e,"object","invalid context attributes")),"extensions"in P&&(Be=A0(P.extensions)),"optionalExtensions"in P&&(Ve=A0(P.optionalExtensions)),"onDone"in P&&(A.type(P.onDone,"function","invalid or missing onDone callback"),Xe=P.onDone),"profile"in P&&(ze=!!P.profile),"pixelRatio"in P&&(We=+P.pixelRatio,A(We>0,"invalid pixel ratio"))):A.raise("invalid arguments to regl"),G&&(G.nodeName.toLowerCase()==="canvas"?Ee=G:de=G),!pe){if(!Ee){A(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var ke=an(de||document.body,Xe,We);if(!ke)return null;Ee=ke.canvas,rt=ke.onDestroy}_e.premultipliedAlpha===void 0&&(_e.premultipliedAlpha=!0),pe=Vn(Ee,_e)}return pe?{gl:pe,canvas:Ee,container:de,extensions:Be,optionalExtensions:Ve,pixelRatio:We,profile:ze,onDone:Xe,onDestroy:rt}:(rt(),Xe("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function ls(C,P){var G={};function de(_e){A.type(_e,"string","extension name must be string");var Be=_e.toLowerCase(),Ve;try{Ve=G[Be]=C.getExtension(Be)}catch{}return!!Ve}for(var Ee=0;Ee<P.extensions.length;++Ee){var pe=P.extensions[Ee];if(!de(pe))return P.onDestroy(),P.onDone('"'+pe+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return P.optionalExtensions.forEach(de),{extensions:G,restore:function(){Object.keys(G).forEach(function(_e){if(G[_e]&&!de(_e))throw new Error("(regl): error restoring extension "+_e)})}}}function Mn(C,P){for(var G=Array(C),de=0;de<C;++de)G[de]=P(de);return G}var xh=5120,Oa=5121,Ch=5122,Sc=5123,Dp=5124,Bp=5125,Th=5126;function Eh(C){for(var P=16;P<=1<<28;P*=16)if(C<=P)return P;return 0}function k(C){var P,G;return P=(C>65535)<<4,C>>>=P,G=(C>255)<<3,C>>>=G,P|=G,G=(C>15)<<2,C>>>=G,P|=G,G=(C>3)<<1,C>>>=G,P|=G,P|C>>1}function ye(){var C=Mn(8,function(){return[]});function P(pe){var _e=Eh(pe),Be=C[k(_e)>>2];return Be.length>0?Be.pop():new ArrayBuffer(_e)}function G(pe){C[k(pe.byteLength)>>2].push(pe)}function de(pe,_e){var Be=null;switch(pe){case xh:Be=new Int8Array(P(_e),0,_e);break;case Oa:Be=new Uint8Array(P(_e),0,_e);break;case Ch:Be=new Int16Array(P(2*_e),0,_e);break;case Sc:Be=new Uint16Array(P(2*_e),0,_e);break;case Dp:Be=new Int32Array(P(4*_e),0,_e);break;case Bp:Be=new Uint32Array(P(4*_e),0,_e);break;case Th:Be=new Float32Array(P(4*_e),0,_e);break;default:return null}return Be.length!==_e?Be.subarray(0,_e):Be}function Ee(pe){G(pe.buffer)}return{alloc:P,free:G,allocType:de,freeType:Ee}}var he=ye();he.zero=ye();var be=3408,Ye=3410,tr=3411,qt=3412,Wt=3413,pr=3414,Mr=3415,_r=33901,br=33902,Qr=3379,Wi=3386,Cr=34921,cs=36347,Gr=36348,$i=35661,Yi=35660,Xi=34930,Ti=36349,en=34076,us=34024,wo=7936,ML=7937,NL=7938,SL=35724,PL=34047,OL=36063,wL=34852,kp=3553,w6=34067,RL=34069,LL=33984,Pc=6408,Ah=5126,R6=5121,Mh=36160,IL=36053,DL=36064,BL=16384,kL=function(C,P){var G=1;P.ext_texture_filter_anisotropic&&(G=C.getParameter(PL));var de=1,Ee=1;P.webgl_draw_buffers&&(de=C.getParameter(wL),Ee=C.getParameter(OL));var pe=!!P.oes_texture_float;if(pe){var _e=C.createTexture();C.bindTexture(kp,_e),C.texImage2D(kp,0,Pc,1,1,0,Pc,Ah,null);var Be=C.createFramebuffer();if(C.bindFramebuffer(Mh,Be),C.framebufferTexture2D(Mh,DL,kp,_e,0),C.bindTexture(kp,null),C.checkFramebufferStatus(Mh)!==IL)pe=!1;else{C.viewport(0,0,1,1),C.clearColor(1,0,0,1),C.clear(BL);var Ve=he.allocType(Ah,4);C.readPixels(0,0,1,1,Pc,Ah,Ve),C.getError()?pe=!1:(C.deleteFramebuffer(Be),C.deleteTexture(_e),pe=Ve[0]===1),he.freeType(Ve)}}var We=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),ze=!0;if(!We){var Xe=C.createTexture(),rt=he.allocType(R6,36);C.activeTexture(LL),C.bindTexture(w6,Xe),C.texImage2D(RL,0,Pc,3,3,0,Pc,R6,rt),he.freeType(rt),C.bindTexture(w6,null),C.deleteTexture(Xe),ze=!C.getError()}return{colorBits:[C.getParameter(Ye),C.getParameter(tr),C.getParameter(qt),C.getParameter(Wt)],depthBits:C.getParameter(pr),stencilBits:C.getParameter(Mr),subpixelBits:C.getParameter(be),extensions:Object.keys(P).filter(function(ke){return!!P[ke]}),maxAnisotropic:G,maxDrawbuffers:de,maxColorAttachments:Ee,pointSizeDims:C.getParameter(_r),lineWidthDims:C.getParameter(br),maxViewportDims:C.getParameter(Wi),maxCombinedTextureUnits:C.getParameter($i),maxCubeMapSize:C.getParameter(en),maxRenderbufferSize:C.getParameter(us),maxTextureUnits:C.getParameter(Xi),maxTextureSize:C.getParameter(Qr),maxAttributes:C.getParameter(Cr),maxVertexUniforms:C.getParameter(cs),maxVertexTextureUnits:C.getParameter(Yi),maxVaryingVectors:C.getParameter(Gr),maxFragmentUniforms:C.getParameter(Ti),glsl:C.getParameter(SL),renderer:C.getParameter(ML),vendor:C.getParameter(wo),version:C.getParameter(NL),readFloat:pe,npotTextureCube:ze}};function ti(C){return!!C&&typeof C=="object"&&Array.isArray(C.shape)&&Array.isArray(C.stride)&&typeof C.offset=="number"&&C.shape.length===C.stride.length&&(Array.isArray(C.data)||n(C.data))}var Ro=function(C){return Object.keys(C).map(function(P){return C[P]})},Fp={shape:VL,flatten:UL};function FL(C,P,G){for(var de=0;de<P;++de)G[de]=C[de]}function GL(C,P,G,de){for(var Ee=0,pe=0;pe<P;++pe)for(var _e=C[pe],Be=0;Be<G;++Be)de[Ee++]=_e[Be]}function L6(C,P,G,de,Ee,pe){for(var _e=pe,Be=0;Be<P;++Be)for(var Ve=C[Be],We=0;We<G;++We)for(var ze=Ve[We],Xe=0;Xe<de;++Xe)Ee[_e++]=ze[Xe]}function I6(C,P,G,de,Ee){for(var pe=1,_e=G+1;_e<P.length;++_e)pe*=P[_e];var Be=P[G];if(P.length-G==4){var Ve=P[G+1],We=P[G+2],ze=P[G+3];for(_e=0;_e<Be;++_e)L6(C[_e],Ve,We,ze,de,Ee),Ee+=pe}else for(_e=0;_e<Be;++_e)I6(C[_e],P,G+1,de,Ee),Ee+=pe}function UL(C,P,G,de){var Ee=1;if(P.length)for(var pe=0;pe<P.length;++pe)Ee*=P[pe];else Ee=0;var _e=de||he.allocType(G,Ee);switch(P.length){case 0:break;case 1:FL(C,P[0],_e);break;case 2:GL(C,P[0],P[1],_e);break;case 3:L6(C,P[0],P[1],P[2],_e,0);break;default:I6(C,P,0,_e,0)}return _e}function VL(C){for(var P=[],G=C;G.length;G=G[0])P.push(G.length);return P}var Nh={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},zL=5120,HL=5122,jL=5124,qL=5121,WL=5123,$L=5125,YL=5126,XL=5126,ps={int8:zL,int16:HL,int32:jL,uint8:qL,uint16:WL,uint32:$L,float:YL,float32:XL},JL=35048,KL=35040,Gp={dynamic:JL,stream:KL,static:35044},Sh=Fp.flatten,D6=Fp.shape,B6=35044,ZL=35040,Ph=5121,Oh=5126,M0=[];M0[5120]=1,M0[5122]=2,M0[5124]=4,M0[5121]=1,M0[5123]=2,M0[5125]=4,M0[5126]=4;function Up(C){return Nh[Object.prototype.toString.call(C)]|0}function k6(C,P){for(var G=0;G<P.length;++G)C[G]=P[G]}function F6(C,P,G,de,Ee,pe,_e){for(var Be=0,Ve=0;Ve<G;++Ve)for(var We=0;We<de;++We)C[Be++]=P[Ee*Ve+pe*We+_e]}function QL(C,P,G,de){var Ee=0,pe={};function _e(ee){this.id=Ee++,this.buffer=C.createBuffer(),this.type=ee,this.usage=B6,this.byteLength=0,this.dimension=1,this.dtype=Ph,this.persistentData=null,G.profile&&(this.stats={size:0})}_e.prototype.bind=function(){C.bindBuffer(this.type,this.buffer)},_e.prototype.destroy=function(){rt(this)};var Be=[];function Ve(ee,ge){var qe=Be.pop();return qe||(qe=new _e(ee)),qe.bind(),Xe(qe,ge,ZL,0,1,!1),qe}function We(ee){Be.push(ee)}function ze(ee,ge,qe){ee.byteLength=ge.byteLength,C.bufferData(ee.type,ge,qe)}function Xe(ee,ge,qe,at,Ne,mt){var we;if(ee.usage=qe,Array.isArray(ge)){if(ee.dtype=at||Oh,ge.length>0){var Qe;if(Array.isArray(ge[0])){we=D6(ge);for(var Se=1,et=1;et<we.length;++et)Se*=we[et];ee.dimension=Se,Qe=Sh(ge,we,ee.dtype),ze(ee,Qe,qe),mt?ee.persistentData=Qe:he.freeType(Qe)}else if(typeof ge[0]=="number"){ee.dimension=Ne;var wt=he.allocType(ee.dtype,ge.length);k6(wt,ge),ze(ee,wt,qe),mt?ee.persistentData=wt:he.freeType(wt)}else n(ge[0])?(ee.dimension=ge[0].length,ee.dtype=at||Up(ge[0])||Oh,Qe=Sh(ge,[ge.length,ge[0].length],ee.dtype),ze(ee,Qe,qe),mt?ee.persistentData=Qe:he.freeType(Qe)):A.raise("invalid buffer data")}}else if(n(ge))ee.dtype=at||Up(ge),ee.dimension=Ne,ze(ee,ge,qe),mt&&(ee.persistentData=new Uint8Array(new Uint8Array(ge.buffer)));else if(ti(ge)){we=ge.shape;var zt=ge.stride,nt=ge.offset,$e=0,Me=0,Ft=0,$t=0;we.length===1?($e=we[0],Me=1,Ft=zt[0],$t=0):we.length===2?($e=we[0],Me=we[1],Ft=zt[0],$t=zt[1]):A.raise("invalid shape"),ee.dtype=at||Up(ge.data)||Oh,ee.dimension=Me;var xt=he.allocType(ee.dtype,$e*Me);F6(xt,ge.data,$e,Me,Ft,$t,nt),ze(ee,xt,qe),mt?ee.persistentData=xt:he.freeType(xt)}else ge instanceof ArrayBuffer?(ee.dtype=Ph,ee.dimension=Ne,ze(ee,ge,qe),mt&&(ee.persistentData=new Uint8Array(new Uint8Array(ge)))):A.raise("invalid buffer data")}function rt(ee){P.bufferCount--,de(ee);var ge=ee.buffer;A(ge,"buffer must not be deleted already"),C.deleteBuffer(ge),ee.buffer=null,delete pe[ee.id]}function ke(ee,ge,qe,at){P.bufferCount++;var Ne=new _e(ge);pe[Ne.id]=Ne;function mt(Se){var et=B6,wt=null,zt=0,nt=0,$e=1;return Array.isArray(Se)||n(Se)||ti(Se)||Se instanceof ArrayBuffer?wt=Se:typeof Se=="number"?zt=Se|0:Se&&(A.type(Se,"object","buffer arguments must be an object, a number or an array"),"data"in Se&&(A(wt===null||Array.isArray(wt)||n(wt)||ti(wt),"invalid data for buffer"),wt=Se.data),"usage"in Se&&(A.parameter(Se.usage,Gp,"invalid buffer usage"),et=Gp[Se.usage]),"type"in Se&&(A.parameter(Se.type,ps,"invalid buffer type"),nt=ps[Se.type]),"dimension"in Se&&(A.type(Se.dimension,"number","invalid dimension"),$e=Se.dimension|0),"length"in Se&&(A.nni(zt,"buffer length must be a nonnegative integer"),zt=Se.length|0)),Ne.bind(),wt?Xe(Ne,wt,et,nt,$e,at):(zt&&C.bufferData(Ne.type,zt,et),Ne.dtype=nt||Ph,Ne.usage=et,Ne.dimension=$e,Ne.byteLength=zt),G.profile&&(Ne.stats.size=Ne.byteLength*M0[Ne.dtype]),mt}function we(Se,et){A(et+Se.byteLength<=Ne.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+Se.byteLength+" starting from offset "+et+" to a buffer of size "+Ne.byteLength),C.bufferSubData(Ne.type,et,Se)}function Qe(Se,et){var wt=(et||0)|0,zt;if(Ne.bind(),n(Se)||Se instanceof ArrayBuffer)we(Se,wt);else if(Array.isArray(Se)){if(Se.length>0)if(typeof Se[0]=="number"){var nt=he.allocType(Ne.dtype,Se.length);k6(nt,Se),we(nt,wt),he.freeType(nt)}else if(Array.isArray(Se[0])||n(Se[0])){zt=D6(Se);var $e=Sh(Se,zt,Ne.dtype);we($e,wt),he.freeType($e)}else A.raise("invalid buffer data")}else if(ti(Se)){zt=Se.shape;var Me=Se.stride,Ft=0,$t=0,xt=0,rr=0;zt.length===1?(Ft=zt[0],$t=1,xt=Me[0],rr=0):zt.length===2?(Ft=zt[0],$t=zt[1],xt=Me[0],rr=Me[1]):A.raise("invalid shape");var Ht=Array.isArray(Se.data)?Ne.dtype:Up(Se.data),Qt=he.allocType(Ht,Ft*$t);F6(Qt,Se.data,Ft,$t,xt,rr,Se.offset),we(Qt,wt),he.freeType(Qt)}else A.raise("invalid data for buffer subdata");return mt}return qe||mt(ee),mt._reglType="buffer",mt._buffer=Ne,mt.subdata=Qe,G.profile&&(mt.stats=Ne.stats),mt.destroy=function(){rt(Ne)},mt}function Je(){Ro(pe).forEach(function(ee){ee.buffer=C.createBuffer(),C.bindBuffer(ee.type,ee.buffer),C.bufferData(ee.type,ee.persistentData||ee.byteLength,ee.usage)})}return G.profile&&(P.getTotalBufferSize=function(){var ee=0;return Object.keys(pe).forEach(function(ge){ee+=pe[ge].stats.size}),ee}),{create:ke,createStream:Ve,destroyStream:We,clear:function(){Ro(pe).forEach(rt),Be.forEach(rt)},getBuffer:function(ee){return ee&&ee._buffer instanceof _e?ee._buffer:null},restore:Je,_initBuffer:Xe}}var eI=0,tI=0,rI=1,nI=1,oI=4,iI=4,wa={points:eI,point:tI,lines:rI,line:nI,triangles:oI,triangle:iI,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},sI=0,aI=1,Oc=4,lI=5120,Ra=5121,G6=5122,La=5123,U6=5124,ds=5125,wh=34963,cI=35040,uI=35044;function pI(C,P,G,de){var Ee={},pe=0,_e={uint8:Ra,uint16:La};P.oes_element_index_uint&&(_e.uint32=ds);function Be(Je){this.id=pe++,Ee[this.id]=this,this.buffer=Je,this.primType=Oc,this.vertCount=0,this.type=0}Be.prototype.bind=function(){this.buffer.bind()};var Ve=[];function We(Je){var ee=Ve.pop();return ee||(ee=new Be(G.create(null,wh,!0,!1)._buffer)),Xe(ee,Je,cI,-1,-1,0,0),ee}function ze(Je){Ve.push(Je)}function Xe(Je,ee,ge,qe,at,Ne,mt){Je.buffer.bind();var we;if(ee){var Qe=mt;!mt&&(!n(ee)||ti(ee)&&!n(ee.data))&&(Qe=P.oes_element_index_uint?ds:La),G._initBuffer(Je.buffer,ee,ge,Qe,3)}else C.bufferData(wh,Ne,ge),Je.buffer.dtype=we||Ra,Je.buffer.usage=ge,Je.buffer.dimension=3,Je.buffer.byteLength=Ne;if(we=mt,!mt){switch(Je.buffer.dtype){case Ra:case lI:we=Ra;break;case La:case G6:we=La;break;case ds:case U6:we=ds;break;default:A.raise("unsupported type for element array")}Je.buffer.dtype=we}Je.type=we,A(we!==ds||!!P.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var Se=at;Se<0&&(Se=Je.buffer.byteLength,we===La?Se>>=1:we===ds&&(Se>>=2)),Je.vertCount=Se;var et=qe;if(qe<0){et=Oc;var wt=Je.buffer.dimension;wt===1&&(et=sI),wt===2&&(et=aI),wt===3&&(et=Oc)}Je.primType=et}function rt(Je){de.elementsCount--,A(Je.buffer!==null,"must not double destroy elements"),delete Ee[Je.id],Je.buffer.destroy(),Je.buffer=null}function ke(Je,ee){var ge=G.create(null,wh,!0),qe=new Be(ge._buffer);de.elementsCount++;function at(Ne){if(!Ne)ge(),qe.primType=Oc,qe.vertCount=0,qe.type=Ra;else if(typeof Ne=="number")ge(Ne),qe.primType=Oc,qe.vertCount=Ne|0,qe.type=Ra;else{var mt=null,we=uI,Qe=-1,Se=-1,et=0,wt=0;Array.isArray(Ne)||n(Ne)||ti(Ne)?mt=Ne:(A.type(Ne,"object","invalid arguments for elements"),"data"in Ne&&(mt=Ne.data,A(Array.isArray(mt)||n(mt)||ti(mt),"invalid data for element buffer")),"usage"in Ne&&(A.parameter(Ne.usage,Gp,"invalid element buffer usage"),we=Gp[Ne.usage]),"primitive"in Ne&&(A.parameter(Ne.primitive,wa,"invalid element buffer primitive"),Qe=wa[Ne.primitive]),"count"in Ne&&(A(typeof Ne.count=="number"&&Ne.count>=0,"invalid vertex count for elements"),Se=Ne.count|0),"type"in Ne&&(A.parameter(Ne.type,_e,"invalid buffer type"),wt=_e[Ne.type]),"length"in Ne?et=Ne.length|0:(et=Se,wt===La||wt===G6?et*=2:(wt===ds||wt===U6)&&(et*=4))),Xe(qe,mt,we,Qe,Se,et,wt)}return at}return at(Je),at._reglType="elements",at._elements=qe,at.subdata=function(Ne,mt){return ge.subdata(Ne,mt),at},at.destroy=function(){rt(qe)},at}return{create:ke,createStream:We,destroyStream:ze,getElements:function(Je){return typeof Je=="function"&&Je._elements instanceof Be?Je._elements:null},clear:function(){Ro(Ee).forEach(rt)}}}var V6=new Float32Array(1),dI=new Uint32Array(V6.buffer),fI=5123;function z6(C){for(var P=he.allocType(fI,C.length),G=0;G<C.length;++G)if(isNaN(C[G]))P[G]=65535;else if(C[G]===1/0)P[G]=31744;else if(C[G]===-1/0)P[G]=64512;else{V6[0]=C[G];var de=dI[0],Ee=de>>>31<<15,pe=(de<<1>>>24)-127,_e=de>>13&(1<<10)-1;if(pe<-24)P[G]=Ee;else if(pe<-14){var Be=-14-pe;P[G]=Ee+(_e+(1<<10)>>Be)}else pe>15?P[G]=Ee+31744:P[G]=Ee+(pe+15<<10)+_e}return P}function ln(C){return Array.isArray(C)||n(C)}var H6=function(C){return!(C&C-1)&&!!C},mI=34467,Ei=3553,Rh=34067,Vp=34069,fs=6408,Lh=6406,zp=6407,wc=6409,Hp=6410,j6=32854,Ih=32855,q6=36194,hI=32819,_I=32820,gI=33635,vI=34042,Dh=6402,jp=34041,Bh=35904,kh=35906,Ia=36193,Fh=33776,Gh=33777,Uh=33778,Vh=33779,W6=35986,$6=35987,Y6=34798,X6=35840,J6=35841,K6=35842,Z6=35843,Q6=36196,Da=5121,zh=5123,Hh=5125,Rc=5126,yI=10242,bI=10243,xI=10497,jh=33071,CI=33648,TI=10240,EI=10241,qh=9728,AI=9729,Wh=9984,e7=9985,t7=9986,$h=9987,MI=33170,qp=4352,NI=4353,SI=4354,PI=34046,OI=3317,wI=37440,RI=37441,LI=37443,r7=37444,Lc=33984,II=[Wh,t7,e7,$h],Wp=[0,wc,Hp,zp,fs],Vo={};Vo[wc]=Vo[Lh]=Vo[Dh]=1,Vo[jp]=Vo[Hp]=2,Vo[zp]=Vo[Bh]=3,Vo[fs]=Vo[kh]=4;function Ba(C){return"[object "+C+"]"}var n7=Ba("HTMLCanvasElement"),o7=Ba("OffscreenCanvas"),i7=Ba("CanvasRenderingContext2D"),s7=Ba("ImageBitmap"),a7=Ba("HTMLImageElement"),l7=Ba("HTMLVideoElement"),DI=Object.keys(Nh).concat([n7,o7,i7,s7,a7,l7]),ka=[];ka[Da]=1,ka[Rc]=4,ka[Ia]=2,ka[zh]=2,ka[Hh]=4;var zn=[];zn[j6]=2,zn[Ih]=2,zn[q6]=2,zn[jp]=4,zn[Fh]=.5,zn[Gh]=.5,zn[Uh]=1,zn[Vh]=1,zn[W6]=.5,zn[$6]=1,zn[Y6]=1,zn[X6]=.5,zn[J6]=.25,zn[K6]=.5,zn[Z6]=.25,zn[Q6]=.5;function c7(C){return Array.isArray(C)&&(C.length===0||typeof C[0]=="number")}function u7(C){if(!Array.isArray(C))return!1;var P=C.length;return!(P===0||!ln(C[0]))}function ms(C){return Object.prototype.toString.call(C)}function p7(C){return ms(C)===n7}function d7(C){return ms(C)===o7}function BI(C){return ms(C)===i7}function kI(C){return ms(C)===s7}function FI(C){return ms(C)===a7}function GI(C){return ms(C)===l7}function Yh(C){if(!C)return!1;var P=ms(C);return DI.indexOf(P)>=0?!0:c7(C)||u7(C)||ti(C)}function f7(C){return Nh[Object.prototype.toString.call(C)]|0}function UI(C,P){var G=P.length;switch(C.type){case Da:case zh:case Hh:case Rc:var de=he.allocType(C.type,G);de.set(P),C.data=de;break;case Ia:C.data=z6(P);break;default:A.raise("unsupported texture type, must specify a typed array")}}function m7(C,P){return he.allocType(C.type===Ia?Rc:C.type,P)}function h7(C,P){C.type===Ia?(C.data=z6(P),he.freeType(P)):C.data=P}function VI(C,P,G,de,Ee,pe){for(var _e=C.width,Be=C.height,Ve=C.channels,We=_e*Be*Ve,ze=m7(C,We),Xe=0,rt=0;rt<Be;++rt)for(var ke=0;ke<_e;++ke)for(var Je=0;Je<Ve;++Je)ze[Xe++]=P[G*ke+de*rt+Ee*Je+pe];h7(C,ze)}function $p(C,P,G,de,Ee,pe){var _e;if(typeof zn[C]!="undefined"?_e=zn[C]:_e=Vo[C]*ka[P],pe&&(_e*=6),Ee){for(var Be=0,Ve=G;Ve>=1;)Be+=_e*Ve*Ve,Ve/=2;return Be}else return _e*G*de}function zI(C,P,G,de,Ee,pe,_e){var Be={"don't care":qp,"dont care":qp,nice:SI,fast:NI},Ve={repeat:xI,clamp:jh,mirror:CI},We={nearest:qh,linear:AI},ze=e({mipmap:$h,"nearest mipmap nearest":Wh,"linear mipmap nearest":e7,"nearest mipmap linear":t7,"linear mipmap linear":$h},We),Xe={none:0,browser:r7},rt={uint8:Da,rgba4:hI,rgb565:gI,"rgb5 a1":_I},ke={alpha:Lh,luminance:wc,"luminance alpha":Hp,rgb:zp,rgba:fs,rgba4:j6,"rgb5 a1":Ih,rgb565:q6},Je={};P.ext_srgb&&(ke.srgb=Bh,ke.srgba=kh),P.oes_texture_float&&(rt.float32=rt.float=Rc),P.oes_texture_half_float&&(rt.float16=rt["half float"]=Ia),P.webgl_depth_texture&&(e(ke,{depth:Dh,"depth stencil":jp}),e(rt,{uint16:zh,uint32:Hh,"depth stencil":vI})),P.webgl_compressed_texture_s3tc&&e(Je,{"rgb s3tc dxt1":Fh,"rgba s3tc dxt1":Gh,"rgba s3tc dxt3":Uh,"rgba s3tc dxt5":Vh}),P.webgl_compressed_texture_atc&&e(Je,{"rgb atc":W6,"rgba atc explicit alpha":$6,"rgba atc interpolated alpha":Y6}),P.webgl_compressed_texture_pvrtc&&e(Je,{"rgb pvrtc 4bppv1":X6,"rgb pvrtc 2bppv1":J6,"rgba pvrtc 4bppv1":K6,"rgba pvrtc 2bppv1":Z6}),P.webgl_compressed_texture_etc1&&(Je["rgb etc1"]=Q6);var ee=Array.prototype.slice.call(C.getParameter(mI));Object.keys(Je).forEach(function(I){var fe=Je[I];ee.indexOf(fe)>=0&&(ke[I]=fe)});var ge=Object.keys(ke);G.textureFormats=ge;var qe=[];Object.keys(ke).forEach(function(I){var fe=ke[I];qe[fe]=I});var at=[];Object.keys(rt).forEach(function(I){var fe=rt[I];at[fe]=I});var Ne=[];Object.keys(We).forEach(function(I){var fe=We[I];Ne[fe]=I});var mt=[];Object.keys(ze).forEach(function(I){var fe=ze[I];mt[fe]=I});var we=[];Object.keys(Ve).forEach(function(I){var fe=Ve[I];we[fe]=I});var Qe=ge.reduce(function(I,fe){var le=ke[fe];return le===wc||le===Lh||le===wc||le===Hp||le===Dh||le===jp||P.ext_srgb&&(le===Bh||le===kh)?I[le]=le:le===Ih||fe.indexOf("rgba")>=0?I[le]=fs:I[le]=zp,I},{});function Se(){this.internalformat=fs,this.format=fs,this.type=Da,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=r7,this.width=0,this.height=0,this.channels=0}function et(I,fe){I.internalformat=fe.internalformat,I.format=fe.format,I.type=fe.type,I.compressed=fe.compressed,I.premultiplyAlpha=fe.premultiplyAlpha,I.flipY=fe.flipY,I.unpackAlignment=fe.unpackAlignment,I.colorSpace=fe.colorSpace,I.width=fe.width,I.height=fe.height,I.channels=fe.channels}function wt(I,fe){if(!(typeof fe!="object"||!fe)){if("premultiplyAlpha"in fe&&(A.type(fe.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),I.premultiplyAlpha=fe.premultiplyAlpha),"flipY"in fe&&(A.type(fe.flipY,"boolean","invalid texture flip"),I.flipY=fe.flipY),"alignment"in fe&&(A.oneOf(fe.alignment,[1,2,4,8],"invalid texture unpack alignment"),I.unpackAlignment=fe.alignment),"colorSpace"in fe&&(A.parameter(fe.colorSpace,Xe,"invalid colorSpace"),I.colorSpace=Xe[fe.colorSpace]),"type"in fe){var le=fe.type;A(P.oes_texture_float||!(le==="float"||le==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),A(P.oes_texture_half_float||!(le==="half float"||le==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),A(P.webgl_depth_texture||!(le==="uint16"||le==="uint32"||le==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),A.parameter(le,rt,"invalid texture type"),I.type=rt[le]}var ht=I.width,nr=I.height,w=I.channels,S=!1;"shape"in fe?(A(Array.isArray(fe.shape)&&fe.shape.length>=2,"shape must be an array"),ht=fe.shape[0],nr=fe.shape[1],fe.shape.length===3&&(w=fe.shape[2],A(w>0&&w<=4,"invalid number of channels"),S=!0),A(ht>=0&&ht<=G.maxTextureSize,"invalid width"),A(nr>=0&&nr<=G.maxTextureSize,"invalid height")):("radius"in fe&&(ht=nr=fe.radius,A(ht>=0&&ht<=G.maxTextureSize,"invalid radius")),"width"in fe&&(ht=fe.width,A(ht>=0&&ht<=G.maxTextureSize,"invalid width")),"height"in fe&&(nr=fe.height,A(nr>=0&&nr<=G.maxTextureSize,"invalid height")),"channels"in fe&&(w=fe.channels,A(w>0&&w<=4,"invalid number of channels"),S=!0)),I.width=ht|0,I.height=nr|0,I.channels=w|0;var j=!1;if("format"in fe){var Q=fe.format;A(P.webgl_depth_texture||!(Q==="depth"||Q==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),A.parameter(Q,ke,"invalid texture format");var te=I.internalformat=ke[Q];I.format=Qe[te],Q in rt&&("type"in fe||(I.type=rt[Q])),Q in Je&&(I.compressed=!0),j=!0}!S&&j?I.channels=Vo[I.format]:S&&!j?I.channels!==Wp[I.format]&&(I.format=I.internalformat=Wp[I.channels]):j&&S&&A(I.channels===Vo[I.format],"number of channels inconsistent with specified format")}}function zt(I){C.pixelStorei(wI,I.flipY),C.pixelStorei(RI,I.premultiplyAlpha),C.pixelStorei(LI,I.colorSpace),C.pixelStorei(OI,I.unpackAlignment)}function nt(){Se.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function $e(I,fe){var le=null;if(Yh(fe)?le=fe:fe&&(A.type(fe,"object","invalid pixel data type"),wt(I,fe),"x"in fe&&(I.xOffset=fe.x|0),"y"in fe&&(I.yOffset=fe.y|0),Yh(fe.data)&&(le=fe.data)),A(!I.compressed||le instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),fe.copy){A(!le,"can not specify copy and data field for the same texture");var ht=Ee.viewportWidth,nr=Ee.viewportHeight;I.width=I.width||ht-I.xOffset,I.height=I.height||nr-I.yOffset,I.needsCopy=!0,A(I.xOffset>=0&&I.xOffset<ht&&I.yOffset>=0&&I.yOffset<nr&&I.width>0&&I.width<=ht&&I.height>0&&I.height<=nr,"copy texture read out of bounds")}else if(!le)I.width=I.width||1,I.height=I.height||1,I.channels=I.channels||4;else if(n(le))I.channels=I.channels||4,I.data=le,!("type"in fe)&&I.type===Da&&(I.type=f7(le));else if(c7(le))I.channels=I.channels||4,UI(I,le),I.alignment=1,I.needsFree=!0;else if(ti(le)){var w=le.data;!Array.isArray(w)&&I.type===Da&&(I.type=f7(w));var S=le.shape,j=le.stride,Q,te,W,q,J,R;S.length===3?(W=S[2],R=j[2]):(A(S.length===2,"invalid ndarray pixel data, must be 2 or 3D"),W=1,R=1),Q=S[0],te=S[1],q=j[0],J=j[1],I.alignment=1,I.width=Q,I.height=te,I.channels=W,I.format=I.internalformat=Wp[W],I.needsFree=!0,VI(I,w,q,J,R,le.offset)}else if(p7(le)||d7(le)||BI(le))p7(le)||d7(le)?I.element=le:I.element=le.canvas,I.width=I.element.width,I.height=I.element.height,I.channels=4;else if(kI(le))I.element=le,I.width=le.width,I.height=le.height,I.channels=4;else if(FI(le))I.element=le,I.width=le.naturalWidth,I.height=le.naturalHeight,I.channels=4;else if(GI(le))I.element=le,I.width=le.videoWidth,I.height=le.videoHeight,I.channels=4;else if(u7(le)){var z=I.width||le[0].length,O=I.height||le.length,Z=I.channels;ln(le[0][0])?Z=Z||le[0][0].length:Z=Z||1;for(var ie=Fp.shape(le),Ce=1,Ae=0;Ae<ie.length;++Ae)Ce*=ie[Ae];var ve=m7(I,Ce);Fp.flatten(le,ie,"",ve),h7(I,ve),I.alignment=1,I.width=z,I.height=O,I.channels=Z,I.format=I.internalformat=Wp[Z],I.needsFree=!0}I.type===Rc?A(G.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):I.type===Ia&&A(G.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function Me(I,fe,le){var ht=I.element,nr=I.data,w=I.internalformat,S=I.format,j=I.type,Q=I.width,te=I.height;zt(I),ht?C.texImage2D(fe,le,S,S,j,ht):I.compressed?C.compressedTexImage2D(fe,le,w,Q,te,0,nr):I.needsCopy?(de(),C.copyTexImage2D(fe,le,S,I.xOffset,I.yOffset,Q,te,0)):C.texImage2D(fe,le,S,Q,te,0,S,j,nr||null)}function Ft(I,fe,le,ht,nr){var w=I.element,S=I.data,j=I.internalformat,Q=I.format,te=I.type,W=I.width,q=I.height;zt(I),w?C.texSubImage2D(fe,nr,le,ht,Q,te,w):I.compressed?C.compressedTexSubImage2D(fe,nr,le,ht,j,W,q,S):I.needsCopy?(de(),C.copyTexSubImage2D(fe,nr,le,ht,I.xOffset,I.yOffset,W,q)):C.texSubImage2D(fe,nr,le,ht,W,q,Q,te,S)}var $t=[];function xt(){return $t.pop()||new nt}function rr(I){I.needsFree&&he.freeType(I.data),nt.call(I),$t.push(I)}function Ht(){Se.call(this),this.genMipmaps=!1,this.mipmapHint=qp,this.mipmask=0,this.images=Array(16)}function Qt(I,fe,le){var ht=I.images[0]=xt();I.mipmask=1,ht.width=I.width=fe,ht.height=I.height=le,ht.channels=I.channels=4}function fr(I,fe){var le=null;if(Yh(fe))le=I.images[0]=xt(),et(le,I),$e(le,fe),I.mipmask=1;else if(wt(I,fe),Array.isArray(fe.mipmap))for(var ht=fe.mipmap,nr=0;nr<ht.length;++nr)le=I.images[nr]=xt(),et(le,I),le.width>>=nr,le.height>>=nr,$e(le,ht[nr]),I.mipmask|=1<<nr;else le=I.images[0]=xt(),et(le,I),$e(le,fe),I.mipmask=1;et(I,I.images[0]),I.compressed&&(I.internalformat===Fh||I.internalformat===Gh||I.internalformat===Uh||I.internalformat===Vh)&&A(I.width%4==0&&I.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function hn(I,fe){for(var le=I.images,ht=0;ht<le.length;++ht){if(!le[ht])return;Me(le[ht],fe,ht)}}var Nn=[];function ar(){var I=Nn.pop()||new Ht;Se.call(I),I.mipmask=0;for(var fe=0;fe<16;++fe)I.images[fe]=null;return I}function bn(I){for(var fe=I.images,le=0;le<fe.length;++le)fe[le]&&rr(fe[le]),fe[le]=null;Nn.push(I)}function kr(){this.minFilter=qh,this.magFilter=qh,this.wrapS=jh,this.wrapT=jh,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=qp}function _n(I,fe){if("min"in fe){var le=fe.min;A.parameter(le,ze),I.minFilter=ze[le],II.indexOf(I.minFilter)>=0&&!("faces"in fe)&&(I.genMipmaps=!0)}if("mag"in fe){var ht=fe.mag;A.parameter(ht,We),I.magFilter=We[ht]}var nr=I.wrapS,w=I.wrapT;if("wrap"in fe){var S=fe.wrap;typeof S=="string"?(A.parameter(S,Ve),nr=w=Ve[S]):Array.isArray(S)&&(A.parameter(S[0],Ve),A.parameter(S[1],Ve),nr=Ve[S[0]],w=Ve[S[1]])}else{if("wrapS"in fe){var j=fe.wrapS;A.parameter(j,Ve),nr=Ve[j]}if("wrapT"in fe){var Q=fe.wrapT;A.parameter(Q,Ve),w=Ve[Q]}}if(I.wrapS=nr,I.wrapT=w,"anisotropic"in fe){var te=fe.anisotropic;A(typeof te=="number"&&te>=1&&te<=G.maxAnisotropic,"aniso samples must be between 1 and "),I.anisotropic=fe.anisotropic}if("mipmap"in fe){var W=!1;switch(typeof fe.mipmap){case"string":A.parameter(fe.mipmap,Be,"invalid mipmap hint"),I.mipmapHint=Be[fe.mipmap],I.genMipmaps=!0,W=!0;break;case"boolean":W=I.genMipmaps=fe.mipmap;break;case"object":A(Array.isArray(fe.mipmap),"invalid mipmap type"),I.genMipmaps=!1,W=!0;break;default:A.raise("invalid mipmap type")}W&&!("min"in fe)&&(I.minFilter=Wh)}}function xn(I,fe){C.texParameteri(fe,EI,I.minFilter),C.texParameteri(fe,TI,I.magFilter),C.texParameteri(fe,yI,I.wrapS),C.texParameteri(fe,bI,I.wrapT),P.ext_texture_filter_anisotropic&&C.texParameteri(fe,PI,I.anisotropic),I.genMipmaps&&(C.hint(MI,I.mipmapHint),C.generateMipmap(fe))}var Cn=0,In={},Hn=G.maxTextureUnits,cn=Array(Hn).map(function(){return null});function Yt(I){Se.call(this),this.mipmask=0,this.internalformat=fs,this.id=Cn++,this.refCount=1,this.target=I,this.texture=C.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new kr,_e.profile&&(this.stats={size:0})}function jn(I){C.activeTexture(Lc),C.bindTexture(I.target,I.texture)}function gr(){var I=cn[0];I?C.bindTexture(I.target,I.texture):C.bindTexture(Ei,null)}function Lt(I){var fe=I.texture;A(fe,"must not double destroy texture");var le=I.unit,ht=I.target;le>=0&&(C.activeTexture(Lc+le),C.bindTexture(ht,null),cn[le]=null),C.deleteTexture(fe),I.texture=null,I.params=null,I.pixels=null,I.refCount=0,delete In[I.id],pe.textureCount--}e(Yt.prototype,{bind:function(){var I=this;I.bindCount+=1;var fe=I.unit;if(fe<0){for(var le=0;le<Hn;++le){var ht=cn[le];if(ht){if(ht.bindCount>0)continue;ht.unit=-1}cn[le]=I,fe=le;break}fe>=Hn&&A.raise("insufficient number of texture units"),_e.profile&&pe.maxTextureUnits<fe+1&&(pe.maxTextureUnits=fe+1),I.unit=fe,C.activeTexture(Lc+fe),C.bindTexture(I.target,I.texture)}return fe},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Lt(this)}});function ir(I,fe){var le=new Yt(Ei);In[le.id]=le,pe.textureCount++;function ht(S,j){var Q=le.texInfo;kr.call(Q);var te=ar();return typeof S=="number"?typeof j=="number"?Qt(te,S|0,j|0):Qt(te,S|0,S|0):S?(A.type(S,"object","invalid arguments to regl.texture"),_n(Q,S),fr(te,S)):Qt(te,1,1),Q.genMipmaps&&(te.mipmask=(te.width<<1)-1),le.mipmask=te.mipmask,et(le,te),A.texture2D(Q,te,G),le.internalformat=te.internalformat,ht.width=te.width,ht.height=te.height,jn(le),hn(te,Ei),xn(Q,Ei),gr(),bn(te),_e.profile&&(le.stats.size=$p(le.internalformat,le.type,te.width,te.height,Q.genMipmaps,!1)),ht.format=qe[le.internalformat],ht.type=at[le.type],ht.mag=Ne[Q.magFilter],ht.min=mt[Q.minFilter],ht.wrapS=we[Q.wrapS],ht.wrapT=we[Q.wrapT],ht}function nr(S,j,Q,te){A(!!S,"must specify image data");var W=j|0,q=Q|0,J=te|0,R=xt();return et(R,le),R.width=0,R.height=0,$e(R,S),R.width=R.width||(le.width>>J)-W,R.height=R.height||(le.height>>J)-q,A(le.type===R.type&&le.format===R.format&&le.internalformat===R.internalformat,"incompatible format for texture.subimage"),A(W>=0&&q>=0&&W+R.width<=le.width&&q+R.height<=le.height,"texture.subimage write out of bounds"),A(le.mipmask&1<<J,"missing mipmap data"),A(R.data||R.element||R.needsCopy,"missing image data"),jn(le),Ft(R,Ei,W,q,J),gr(),rr(R),ht}function w(S,j){var Q=S|0,te=j|0||Q;if(Q===le.width&&te===le.height)return ht;ht.width=le.width=Q,ht.height=le.height=te,jn(le);for(var W=0;le.mipmask>>W;++W){var q=Q>>W,J=te>>W;if(!q||!J)break;C.texImage2D(Ei,W,le.format,q,J,0,le.format,le.type,null)}return gr(),_e.profile&&(le.stats.size=$p(le.internalformat,le.type,Q,te,!1,!1)),ht}return ht(I,fe),ht.subimage=nr,ht.resize=w,ht._reglType="texture2d",ht._texture=le,_e.profile&&(ht.stats=le.stats),ht.destroy=function(){le.decRef()},ht}function ur(I,fe,le,ht,nr,w){var S=new Yt(Rh);In[S.id]=S,pe.cubeCount++;var j=new Array(6);function Q(q,J,R,z,O,Z){var ie,Ce=S.texInfo;for(kr.call(Ce),ie=0;ie<6;++ie)j[ie]=ar();if(typeof q=="number"||!q){var Ae=q|0||1;for(ie=0;ie<6;++ie)Qt(j[ie],Ae,Ae)}else if(typeof q=="object")if(J)fr(j[0],q),fr(j[1],J),fr(j[2],R),fr(j[3],z),fr(j[4],O),fr(j[5],Z);else if(_n(Ce,q),wt(S,q),"faces"in q){var ve=q.faces;for(A(Array.isArray(ve)&&ve.length===6,"cube faces must be a length 6 array"),ie=0;ie<6;++ie)A(typeof ve[ie]=="object"&&!!ve[ie],"invalid input for cube map face"),et(j[ie],S),fr(j[ie],ve[ie])}else for(ie=0;ie<6;++ie)fr(j[ie],q);else A.raise("invalid arguments to cube map");for(et(S,j[0]),G.npotTextureCube||A(H6(S.width)&&H6(S.height),"your browser does not support non power or two texture dimensions"),Ce.genMipmaps?S.mipmask=(j[0].width<<1)-1:S.mipmask=j[0].mipmask,A.textureCube(S,Ce,j,G),S.internalformat=j[0].internalformat,Q.width=j[0].width,Q.height=j[0].height,jn(S),ie=0;ie<6;++ie)hn(j[ie],Vp+ie);for(xn(Ce,Rh),gr(),_e.profile&&(S.stats.size=$p(S.internalformat,S.type,Q.width,Q.height,Ce.genMipmaps,!0)),Q.format=qe[S.internalformat],Q.type=at[S.type],Q.mag=Ne[Ce.magFilter],Q.min=mt[Ce.minFilter],Q.wrapS=we[Ce.wrapS],Q.wrapT=we[Ce.wrapT],ie=0;ie<6;++ie)bn(j[ie]);return Q}function te(q,J,R,z,O){A(!!J,"must specify image data"),A(typeof q=="number"&&q===(q|0)&&q>=0&&q<6,"invalid face");var Z=R|0,ie=z|0,Ce=O|0,Ae=xt();return et(Ae,S),Ae.width=0,Ae.height=0,$e(Ae,J),Ae.width=Ae.width||(S.width>>Ce)-Z,Ae.height=Ae.height||(S.height>>Ce)-ie,A(S.type===Ae.type&&S.format===Ae.format&&S.internalformat===Ae.internalformat,"incompatible format for texture.subimage"),A(Z>=0&&ie>=0&&Z+Ae.width<=S.width&&ie+Ae.height<=S.height,"texture.subimage write out of bounds"),A(S.mipmask&1<<Ce,"missing mipmap data"),A(Ae.data||Ae.element||Ae.needsCopy,"missing image data"),jn(S),Ft(Ae,Vp+q,Z,ie,Ce),gr(),rr(Ae),Q}function W(q){var J=q|0;if(J!==S.width){Q.width=S.width=J,Q.height=S.height=J,jn(S);for(var R=0;R<6;++R)for(var z=0;S.mipmask>>z;++z)C.texImage2D(Vp+R,z,S.format,J>>z,J>>z,0,S.format,S.type,null);return gr(),_e.profile&&(S.stats.size=$p(S.internalformat,S.type,Q.width,Q.height,!1,!0)),Q}}return Q(I,fe,le,ht,nr,w),Q.subimage=te,Q.resize=W,Q._reglType="textureCube",Q._texture=S,_e.profile&&(Q.stats=S.stats),Q.destroy=function(){S.decRef()},Q}function un(){for(var I=0;I<Hn;++I)C.activeTexture(Lc+I),C.bindTexture(Ei,null),cn[I]=null;Ro(In).forEach(Lt),pe.cubeCount=0,pe.textureCount=0}_e.profile&&(pe.getTotalTextureSize=function(){var I=0;return Object.keys(In).forEach(function(fe){I+=In[fe].stats.size}),I});function Mi(){for(var I=0;I<Hn;++I){var fe=cn[I];fe&&(fe.bindCount=0,fe.unit=-1,cn[I]=null)}Ro(In).forEach(function(le){le.texture=C.createTexture(),C.bindTexture(le.target,le.texture);for(var ht=0;ht<32;++ht)if((le.mipmask&1<<ht)!=0)if(le.target===Ei)C.texImage2D(Ei,ht,le.internalformat,le.width>>ht,le.height>>ht,0,le.internalformat,le.type,null);else for(var nr=0;nr<6;++nr)C.texImage2D(Vp+nr,ht,le.internalformat,le.width>>ht,le.height>>ht,0,le.internalformat,le.type,null);xn(le.texInfo,le.target)})}function xs(){for(var I=0;I<Hn;++I){var fe=cn[I];fe&&(fe.bindCount=0,fe.unit=-1,cn[I]=null),C.activeTexture(Lc+I),C.bindTexture(Ei,null),C.bindTexture(Rh,null)}}return{create2D:ir,createCube:ur,clear:un,getTexture:function(I){return null},restore:Mi,refresh:xs}}var N0=36161,Yp=32854,_7=32855,g7=36194,v7=33189,y7=36168,b7=34041,x7=35907,C7=34836,T7=34842,E7=34843,ri=[];ri[Yp]=2,ri[_7]=2,ri[g7]=2,ri[v7]=2,ri[y7]=1,ri[b7]=4,ri[x7]=4,ri[C7]=16,ri[T7]=8,ri[E7]=6;function A7(C,P,G){return ri[C]*P*G}var HI=function(C,P,G,de,Ee){var pe={rgba4:Yp,rgb565:g7,"rgb5 a1":_7,depth:v7,stencil:y7,"depth stencil":b7};P.ext_srgb&&(pe.srgba=x7),P.ext_color_buffer_half_float&&(pe.rgba16f=T7,pe.rgb16f=E7),P.webgl_color_buffer_float&&(pe.rgba32f=C7);var _e=[];Object.keys(pe).forEach(function(ke){var Je=pe[ke];_e[Je]=ke});var Be=0,Ve={};function We(ke){this.id=Be++,this.refCount=1,this.renderbuffer=ke,this.format=Yp,this.width=0,this.height=0,Ee.profile&&(this.stats={size:0})}We.prototype.decRef=function(){--this.refCount<=0&&ze(this)};function ze(ke){var Je=ke.renderbuffer;A(Je,"must not double destroy renderbuffer"),C.bindRenderbuffer(N0,null),C.deleteRenderbuffer(Je),ke.renderbuffer=null,ke.refCount=0,delete Ve[ke.id],de.renderbufferCount--}function Xe(ke,Je){var ee=new We(C.createRenderbuffer());Ve[ee.id]=ee,de.renderbufferCount++;function ge(at,Ne){var mt=0,we=0,Qe=Yp;if(typeof at=="object"&&at){var Se=at;if("shape"in Se){var et=Se.shape;A(Array.isArray(et)&&et.length>=2,"invalid renderbuffer shape"),mt=et[0]|0,we=et[1]|0}else"radius"in Se&&(mt=we=Se.radius|0),"width"in Se&&(mt=Se.width|0),"height"in Se&&(we=Se.height|0);"format"in Se&&(A.parameter(Se.format,pe,"invalid renderbuffer format"),Qe=pe[Se.format])}else typeof at=="number"?(mt=at|0,typeof Ne=="number"?we=Ne|0:we=mt):at?A.raise("invalid arguments to renderbuffer constructor"):mt=we=1;if(A(mt>0&&we>0&&mt<=G.maxRenderbufferSize&&we<=G.maxRenderbufferSize,"invalid renderbuffer size"),!(mt===ee.width&&we===ee.height&&Qe===ee.format))return ge.width=ee.width=mt,ge.height=ee.height=we,ee.format=Qe,C.bindRenderbuffer(N0,ee.renderbuffer),C.renderbufferStorage(N0,Qe,mt,we),A(C.getError()===0,"invalid render buffer format"),Ee.profile&&(ee.stats.size=A7(ee.format,ee.width,ee.height)),ge.format=_e[ee.format],ge}function qe(at,Ne){var mt=at|0,we=Ne|0||mt;return mt===ee.width&&we===ee.height||(A(mt>0&&we>0&&mt<=G.maxRenderbufferSize&&we<=G.maxRenderbufferSize,"invalid renderbuffer size"),ge.width=ee.width=mt,ge.height=ee.height=we,C.bindRenderbuffer(N0,ee.renderbuffer),C.renderbufferStorage(N0,ee.format,mt,we),A(C.getError()===0,"invalid render buffer format"),Ee.profile&&(ee.stats.size=A7(ee.format,ee.width,ee.height))),ge}return ge(ke,Je),ge.resize=qe,ge._reglType="renderbuffer",ge._renderbuffer=ee,Ee.profile&&(ge.stats=ee.stats),ge.destroy=function(){ee.decRef()},ge}Ee.profile&&(de.getTotalRenderbufferSize=function(){var ke=0;return Object.keys(Ve).forEach(function(Je){ke+=Ve[Je].stats.size}),ke});function rt(){Ro(Ve).forEach(function(ke){ke.renderbuffer=C.createRenderbuffer(),C.bindRenderbuffer(N0,ke.renderbuffer),C.renderbufferStorage(N0,ke.format,ke.width,ke.height)}),C.bindRenderbuffer(N0,null)}return{create:Xe,clear:function(){Ro(Ve).forEach(ze)},restore:rt}},Ji=36160,Xh=36161,hs=3553,Xp=34069,M7=36064,N7=36096,S7=36128,P7=33306,O7=36053,jI=36054,qI=36055,WI=36057,$I=36061,YI=36193,XI=5121,JI=5126,w7=6407,R7=6408,KI=6402,ZI=[w7,R7],Jh=[];Jh[R7]=4,Jh[w7]=3;var Jp=[];Jp[XI]=1,Jp[JI]=4,Jp[YI]=2;var QI=32854,eD=32855,tD=36194,rD=33189,nD=36168,L7=34041,oD=35907,iD=34836,sD=34842,aD=34843,lD=[QI,eD,tD,oD,sD,aD,iD],Fa={};Fa[O7]="complete",Fa[jI]="incomplete attachment",Fa[WI]="incomplete dimensions",Fa[qI]="incomplete, missing attachment",Fa[$I]="unsupported";function cD(C,P,G,de,Ee,pe){var _e={cur:null,next:null,dirty:!1,setFBO:null},Be=["rgba"],Ve=["rgba4","rgb565","rgb5 a1"];P.ext_srgb&&Ve.push("srgba"),P.ext_color_buffer_half_float&&Ve.push("rgba16f","rgb16f"),P.webgl_color_buffer_float&&Ve.push("rgba32f");var We=["uint8"];P.oes_texture_half_float&&We.push("half float","float16"),P.oes_texture_float&&We.push("float","float32");function ze(nt,$e,Me){this.target=nt,this.texture=$e,this.renderbuffer=Me;var Ft=0,$t=0;$e?(Ft=$e.width,$t=$e.height):Me&&(Ft=Me.width,$t=Me.height),this.width=Ft,this.height=$t}function Xe(nt){nt&&(nt.texture&&nt.texture._texture.decRef(),nt.renderbuffer&&nt.renderbuffer._renderbuffer.decRef())}function rt(nt,$e,Me){if(!!nt)if(nt.texture){var Ft=nt.texture._texture,$t=Math.max(1,Ft.width),xt=Math.max(1,Ft.height);A($t===$e&&xt===Me,"inconsistent width/height for supplied texture"),Ft.refCount+=1}else{var rr=nt.renderbuffer._renderbuffer;A(rr.width===$e&&rr.height===Me,"inconsistent width/height for renderbuffer"),rr.refCount+=1}}function ke(nt,$e){$e&&($e.texture?C.framebufferTexture2D(Ji,nt,$e.target,$e.texture._texture.texture,0):C.framebufferRenderbuffer(Ji,nt,Xh,$e.renderbuffer._renderbuffer.renderbuffer))}function Je(nt){var $e=hs,Me=null,Ft=null,$t=nt;typeof nt=="object"&&($t=nt.data,"target"in nt&&($e=nt.target|0)),A.type($t,"function","invalid attachment data");var xt=$t._reglType;return xt==="texture2d"?(Me=$t,A($e===hs)):xt==="textureCube"?(Me=$t,A($e>=Xp&&$e<Xp+6,"invalid cube map target")):xt==="renderbuffer"?(Ft=$t,$e=Xh):A.raise("invalid regl object for attachment"),new ze($e,Me,Ft)}function ee(nt,$e,Me,Ft,$t){if(Me){var xt=de.create2D({width:nt,height:$e,format:Ft,type:$t});return xt._texture.refCount=0,new ze(hs,xt,null)}else{var rr=Ee.create({width:nt,height:$e,format:Ft});return rr._renderbuffer.refCount=0,new ze(Xh,null,rr)}}function ge(nt){return nt&&(nt.texture||nt.renderbuffer)}function qe(nt,$e,Me){nt&&(nt.texture?nt.texture.resize($e,Me):nt.renderbuffer&&nt.renderbuffer.resize($e,Me),nt.width=$e,nt.height=Me)}var at=0,Ne={};function mt(){this.id=at++,Ne[this.id]=this,this.framebuffer=C.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function we(nt){nt.colorAttachments.forEach(Xe),Xe(nt.depthAttachment),Xe(nt.stencilAttachment),Xe(nt.depthStencilAttachment)}function Qe(nt){var $e=nt.framebuffer;A($e,"must not double destroy framebuffer"),C.deleteFramebuffer($e),nt.framebuffer=null,pe.framebufferCount--,delete Ne[nt.id]}function Se(nt){var $e;C.bindFramebuffer(Ji,nt.framebuffer);var Me=nt.colorAttachments;for($e=0;$e<Me.length;++$e)ke(M7+$e,Me[$e]);for($e=Me.length;$e<G.maxColorAttachments;++$e)C.framebufferTexture2D(Ji,M7+$e,hs,null,0);C.framebufferTexture2D(Ji,P7,hs,null,0),C.framebufferTexture2D(Ji,N7,hs,null,0),C.framebufferTexture2D(Ji,S7,hs,null,0),ke(N7,nt.depthAttachment),ke(S7,nt.stencilAttachment),ke(P7,nt.depthStencilAttachment);var Ft=C.checkFramebufferStatus(Ji);!C.isContextLost()&&Ft!==O7&&A.raise("framebuffer configuration not supported, status = "+Fa[Ft]),C.bindFramebuffer(Ji,_e.next?_e.next.framebuffer:null),_e.cur=_e.next,C.getError()}function et(nt,$e){var Me=new mt;pe.framebufferCount++;function Ft(xt,rr){var Ht;A(_e.next!==Me,"can not update framebuffer which is currently in use");var Qt=0,fr=0,hn=!0,Nn=!0,ar=null,bn=!0,kr="rgba",_n="uint8",xn=1,Cn=null,In=null,Hn=null,cn=!1;if(typeof xt=="number")Qt=xt|0,fr=rr|0||Qt;else if(!xt)Qt=fr=1;else{A.type(xt,"object","invalid arguments for framebuffer");var Yt=xt;if("shape"in Yt){var jn=Yt.shape;A(Array.isArray(jn)&&jn.length>=2,"invalid shape for framebuffer"),Qt=jn[0],fr=jn[1]}else"radius"in Yt&&(Qt=fr=Yt.radius),"width"in Yt&&(Qt=Yt.width),"height"in Yt&&(fr=Yt.height);("color"in Yt||"colors"in Yt)&&(ar=Yt.color||Yt.colors,Array.isArray(ar)&&A(ar.length===1||P.webgl_draw_buffers,"multiple render targets not supported")),ar||("colorCount"in Yt&&(xn=Yt.colorCount|0,A(xn>0,"invalid color buffer count")),"colorTexture"in Yt&&(bn=!!Yt.colorTexture,kr="rgba4"),"colorType"in Yt&&(_n=Yt.colorType,bn?(A(P.oes_texture_float||!(_n==="float"||_n==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),A(P.oes_texture_half_float||!(_n==="half float"||_n==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):_n==="half float"||_n==="float16"?(A(P.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),kr="rgba16f"):(_n==="float"||_n==="float32")&&(A(P.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),kr="rgba32f"),A.oneOf(_n,We,"invalid color type")),"colorFormat"in Yt&&(kr=Yt.colorFormat,Be.indexOf(kr)>=0?bn=!0:Ve.indexOf(kr)>=0?bn=!1:bn?A.oneOf(Yt.colorFormat,Be,"invalid color format for texture"):A.oneOf(Yt.colorFormat,Ve,"invalid color format for renderbuffer"))),("depthTexture"in Yt||"depthStencilTexture"in Yt)&&(cn=!!(Yt.depthTexture||Yt.depthStencilTexture),A(!cn||P.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in Yt&&(typeof Yt.depth=="boolean"?hn=Yt.depth:(Cn=Yt.depth,Nn=!1)),"stencil"in Yt&&(typeof Yt.stencil=="boolean"?Nn=Yt.stencil:(In=Yt.stencil,hn=!1)),"depthStencil"in Yt&&(typeof Yt.depthStencil=="boolean"?hn=Nn=Yt.depthStencil:(Hn=Yt.depthStencil,hn=!1,Nn=!1))}var gr=null,Lt=null,ir=null,ur=null;if(Array.isArray(ar))gr=ar.map(Je);else if(ar)gr=[Je(ar)];else for(gr=new Array(xn),Ht=0;Ht<xn;++Ht)gr[Ht]=ee(Qt,fr,bn,kr,_n);A(P.webgl_draw_buffers||gr.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),A(gr.length<=G.maxColorAttachments,"too many color attachments, not supported"),Qt=Qt||gr[0].width,fr=fr||gr[0].height,Cn?Lt=Je(Cn):hn&&!Nn&&(Lt=ee(Qt,fr,cn,"depth","uint32")),In?ir=Je(In):Nn&&!hn&&(ir=ee(Qt,fr,!1,"stencil","uint8")),Hn?ur=Je(Hn):!Cn&&!In&&Nn&&hn&&(ur=ee(Qt,fr,cn,"depth stencil","depth stencil")),A(!!Cn+!!In+!!Hn<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var un=null;for(Ht=0;Ht<gr.length;++Ht)if(rt(gr[Ht],Qt,fr),A(!gr[Ht]||gr[Ht].texture&&ZI.indexOf(gr[Ht].texture._texture.format)>=0||gr[Ht].renderbuffer&&lD.indexOf(gr[Ht].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+Ht+" is invalid"),gr[Ht]&&gr[Ht].texture){var Mi=Jh[gr[Ht].texture._texture.format]*Jp[gr[Ht].texture._texture.type];un===null?un=Mi:A(un===Mi,"all color attachments much have the same number of bits per pixel.")}return rt(Lt,Qt,fr),A(!Lt||Lt.texture&&Lt.texture._texture.format===KI||Lt.renderbuffer&&Lt.renderbuffer._renderbuffer.format===rD,"invalid depth attachment for framebuffer object"),rt(ir,Qt,fr),A(!ir||ir.renderbuffer&&ir.renderbuffer._renderbuffer.format===nD,"invalid stencil attachment for framebuffer object"),rt(ur,Qt,fr),A(!ur||ur.texture&&ur.texture._texture.format===L7||ur.renderbuffer&&ur.renderbuffer._renderbuffer.format===L7,"invalid depth-stencil attachment for framebuffer object"),we(Me),Me.width=Qt,Me.height=fr,Me.colorAttachments=gr,Me.depthAttachment=Lt,Me.stencilAttachment=ir,Me.depthStencilAttachment=ur,Ft.color=gr.map(ge),Ft.depth=ge(Lt),Ft.stencil=ge(ir),Ft.depthStencil=ge(ur),Ft.width=Me.width,Ft.height=Me.height,Se(Me),Ft}function $t(xt,rr){A(_e.next!==Me,"can not resize a framebuffer which is currently in use");var Ht=Math.max(xt|0,1),Qt=Math.max(rr|0||Ht,1);if(Ht===Me.width&&Qt===Me.height)return Ft;for(var fr=Me.colorAttachments,hn=0;hn<fr.length;++hn)qe(fr[hn],Ht,Qt);return qe(Me.depthAttachment,Ht,Qt),qe(Me.stencilAttachment,Ht,Qt),qe(Me.depthStencilAttachment,Ht,Qt),Me.width=Ft.width=Ht,Me.height=Ft.height=Qt,Se(Me),Ft}return Ft(nt,$e),e(Ft,{resize:$t,_reglType:"framebuffer",_framebuffer:Me,destroy:function(){Qe(Me),we(Me)},use:function(xt){_e.setFBO({framebuffer:Ft},xt)}})}function wt(nt){var $e=Array(6);function Me($t){var xt;A($e.indexOf(_e.next)<0,"can not update framebuffer which is currently in use");var rr={color:null},Ht=0,Qt=null,fr="rgba",hn="uint8",Nn=1;if(typeof $t=="number")Ht=$t|0;else if(!$t)Ht=1;else{A.type($t,"object","invalid arguments for framebuffer");var ar=$t;if("shape"in ar){var bn=ar.shape;A(Array.isArray(bn)&&bn.length>=2,"invalid shape for framebuffer"),A(bn[0]===bn[1],"cube framebuffer must be square"),Ht=bn[0]}else"radius"in ar&&(Ht=ar.radius|0),"width"in ar?(Ht=ar.width|0,"height"in ar&&A(ar.height===Ht,"must be square")):"height"in ar&&(Ht=ar.height|0);("color"in ar||"colors"in ar)&&(Qt=ar.color||ar.colors,Array.isArray(Qt)&&A(Qt.length===1||P.webgl_draw_buffers,"multiple render targets not supported")),Qt||("colorCount"in ar&&(Nn=ar.colorCount|0,A(Nn>0,"invalid color buffer count")),"colorType"in ar&&(A.oneOf(ar.colorType,We,"invalid color type"),hn=ar.colorType),"colorFormat"in ar&&(fr=ar.colorFormat,A.oneOf(ar.colorFormat,Be,"invalid color format for texture"))),"depth"in ar&&(rr.depth=ar.depth),"stencil"in ar&&(rr.stencil=ar.stencil),"depthStencil"in ar&&(rr.depthStencil=ar.depthStencil)}var kr;if(Qt)if(Array.isArray(Qt))for(kr=[],xt=0;xt<Qt.length;++xt)kr[xt]=Qt[xt];else kr=[Qt];else{kr=Array(Nn);var _n={radius:Ht,format:fr,type:hn};for(xt=0;xt<Nn;++xt)kr[xt]=de.createCube(_n)}for(rr.color=Array(kr.length),xt=0;xt<kr.length;++xt){var xn=kr[xt];A(typeof xn=="function"&&xn._reglType==="textureCube","invalid cube map"),Ht=Ht||xn.width,A(xn.width===Ht&&xn.height===Ht,"invalid cube map shape"),rr.color[xt]={target:Xp,data:kr[xt]}}for(xt=0;xt<6;++xt){for(var Cn=0;Cn<kr.length;++Cn)rr.color[Cn].target=Xp+xt;xt>0&&(rr.depth=$e[0].depth,rr.stencil=$e[0].stencil,rr.depthStencil=$e[0].depthStencil),$e[xt]?$e[xt](rr):$e[xt]=et(rr)}return e(Me,{width:Ht,height:Ht,color:kr})}function Ft($t){var xt,rr=$t|0;if(A(rr>0&&rr<=G.maxCubeMapSize,"invalid radius for cube fbo"),rr===Me.width)return Me;var Ht=Me.color;for(xt=0;xt<Ht.length;++xt)Ht[xt].resize(rr);for(xt=0;xt<6;++xt)$e[xt].resize(rr);return Me.width=Me.height=rr,Me}return Me(nt),e(Me,{faces:$e,resize:Ft,_reglType:"framebufferCube",destroy:function(){$e.forEach(function($t){$t.destroy()})}})}function zt(){_e.cur=null,_e.next=null,_e.dirty=!0,Ro(Ne).forEach(function(nt){nt.framebuffer=C.createFramebuffer(),Se(nt)})}return e(_e,{getFramebuffer:function(nt){if(typeof nt=="function"&&nt._reglType==="framebuffer"){var $e=nt._framebuffer;if($e instanceof mt)return $e}return null},create:et,createCube:wt,clear:function(){Ro(Ne).forEach(Qe)},restore:zt})}var uD=5126,I7=34962;function Kh(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=uD,this.offset=0,this.stride=0,this.divisor=0}function pD(C,P,G,de,Ee){for(var pe=G.maxAttributes,_e=new Array(pe),Be=0;Be<pe;++Be)_e[Be]=new Kh;var Ve=0,We={},ze={Record:Kh,scope:{},state:_e,currentVAO:null,targetVAO:null,restore:rt()?Ne:function(){},createVAO:mt,getVAO:Je,destroyBuffer:Xe,setVAO:rt()?ee:ge,clear:rt()?qe:function(){}};function Xe(we){for(var Qe=0;Qe<_e.length;++Qe){var Se=_e[Qe];Se.buffer===we&&(C.disableVertexAttribArray(Qe),Se.buffer=null)}}function rt(){return P.oes_vertex_array_object}function ke(){return P.angle_instanced_arrays}function Je(we){return typeof we=="function"&&we._vao?we._vao:null}function ee(we){if(we!==ze.currentVAO){var Qe=rt();we?Qe.bindVertexArrayOES(we.vao):Qe.bindVertexArrayOES(null),ze.currentVAO=we}}function ge(we){if(we!==ze.currentVAO){if(we)we.bindAttrs();else for(var Qe=ke(),Se=0;Se<_e.length;++Se){var et=_e[Se];et.buffer?(C.enableVertexAttribArray(Se),C.vertexAttribPointer(Se,et.size,et.type,et.normalized,et.stride,et.offfset),Qe&&et.divisor&&Qe.vertexAttribDivisorANGLE(Se,et.divisor)):(C.disableVertexAttribArray(Se),C.vertexAttrib4f(Se,et.x,et.y,et.z,et.w))}ze.currentVAO=we}}function qe(){Ro(We).forEach(function(we){we.destroy()})}function at(){this.id=++Ve,this.attributes=[];var we=rt();we?this.vao=we.createVertexArrayOES():this.vao=null,We[this.id]=this,this.buffers=[]}at.prototype.bindAttrs=function(){for(var we=ke(),Qe=this.attributes,Se=0;Se<Qe.length;++Se){var et=Qe[Se];et.buffer?(C.enableVertexAttribArray(Se),C.bindBuffer(I7,et.buffer.buffer),C.vertexAttribPointer(Se,et.size,et.type,et.normalized,et.stride,et.offset),we&&et.divisor&&we.vertexAttribDivisorANGLE(Se,et.divisor)):(C.disableVertexAttribArray(Se),C.vertexAttrib4f(Se,et.x,et.y,et.z,et.w))}for(var wt=Qe.length;wt<pe;++wt)C.disableVertexAttribArray(wt)},at.prototype.refresh=function(){var we=rt();we&&(we.bindVertexArrayOES(this.vao),this.bindAttrs(),ze.currentVAO=this)},at.prototype.destroy=function(){if(this.vao){var we=rt();this===ze.currentVAO&&(ze.currentVAO=null,we.bindVertexArrayOES(null)),we.deleteVertexArrayOES(this.vao),this.vao=null}We[this.id]&&(delete We[this.id],de.vaoCount-=1)};function Ne(){var we=rt();we&&Ro(We).forEach(function(Qe){Qe.refresh()})}function mt(we){var Qe=new at;de.vaoCount+=1;function Se(et){A(Array.isArray(et),"arguments to vertex array constructor must be an array"),A(et.length<pe,"too many attributes"),A(et.length>0,"must specify at least one attribute");var wt={},zt=Qe.attributes;zt.length=et.length;for(var nt=0;nt<et.length;++nt){var $e=et[nt],Me=zt[nt]=new Kh,Ft=$e.data||$e;if(Array.isArray(Ft)||n(Ft)||ti(Ft)){var $t;Qe.buffers[nt]&&($t=Qe.buffers[nt],n(Ft)&&$t._buffer.byteLength>=Ft.byteLength?$t.subdata(Ft):($t.destroy(),Qe.buffers[nt]=null)),Qe.buffers[nt]||($t=Qe.buffers[nt]=Ee.create($e,I7,!1,!0)),Me.buffer=Ee.getBuffer($t),Me.size=Me.buffer.dimension|0,Me.normalized=!1,Me.type=Me.buffer.dtype,Me.offset=0,Me.stride=0,Me.divisor=0,Me.state=1,wt[nt]=1}else Ee.getBuffer($e)?(Me.buffer=Ee.getBuffer($e),Me.size=Me.buffer.dimension|0,Me.normalized=!1,Me.type=Me.buffer.dtype,Me.offset=0,Me.stride=0,Me.divisor=0,Me.state=1):Ee.getBuffer($e.buffer)?(Me.buffer=Ee.getBuffer($e.buffer),Me.size=(+$e.size||Me.buffer.dimension)|0,Me.normalized=!!$e.normalized||!1,"type"in $e?(A.parameter($e.type,ps,"invalid buffer type"),Me.type=ps[$e.type]):Me.type=Me.buffer.dtype,Me.offset=($e.offset||0)|0,Me.stride=($e.stride||0)|0,Me.divisor=($e.divisor||0)|0,Me.state=1,A(Me.size>=1&&Me.size<=4,"size must be between 1 and 4"),A(Me.offset>=0,"invalid offset"),A(Me.stride>=0&&Me.stride<=255,"stride must be between 0 and 255"),A(Me.divisor>=0,"divisor must be positive"),A(!Me.divisor||!!P.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in $e?(A(nt>0,"first attribute must not be a constant"),Me.x=+$e.x||0,Me.y=+$e.y||0,Me.z=+$e.z||0,Me.w=+$e.w||0,Me.state=2):A(!1,"invalid attribute spec for location "+nt)}for(var xt=0;xt<Qe.buffers.length;++xt)!wt[xt]&&Qe.buffers[xt]&&(Qe.buffers[xt].destroy(),Qe.buffers[xt]=null);return Qe.refresh(),Se}return Se.destroy=function(){for(var et=0;et<Qe.buffers.length;++et)Qe.buffers[et]&&Qe.buffers[et].destroy();Qe.buffers.length=0,Qe.destroy()},Se._vao=Qe,Se._reglType="vao",Se(we)}return ze}var D7=35632,dD=35633,fD=35718,mD=35721;function hD(C,P,G,de){var Ee={},pe={};function _e(ee,ge,qe,at){this.name=ee,this.id=ge,this.location=qe,this.info=at}function Be(ee,ge){for(var qe=0;qe<ee.length;++qe)if(ee[qe].id===ge.id){ee[qe].location=ge.location;return}ee.push(ge)}function Ve(ee,ge,qe){var at=ee===D7?Ee:pe,Ne=at[ge];if(!Ne){var mt=P.str(ge);Ne=C.createShader(ee),C.shaderSource(Ne,mt),C.compileShader(Ne),A.shaderError(C,Ne,mt,ee,qe),at[ge]=Ne}return Ne}var We={},ze=[],Xe=0;function rt(ee,ge){this.id=Xe++,this.fragId=ee,this.vertId=ge,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,de.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function ke(ee,ge,qe){var at,Ne,mt=Ve(D7,ee.fragId),we=Ve(dD,ee.vertId),Qe=ee.program=C.createProgram();if(C.attachShader(Qe,mt),C.attachShader(Qe,we),qe)for(at=0;at<qe.length;++at){var Se=qe[at];C.bindAttribLocation(Qe,Se[0],Se[1])}C.linkProgram(Qe),A.linkError(C,Qe,P.str(ee.fragId),P.str(ee.vertId),ge);var et=C.getProgramParameter(Qe,fD);de.profile&&(ee.stats.uniformsCount=et);var wt=ee.uniforms;for(at=0;at<et;++at)if(Ne=C.getActiveUniform(Qe,at),Ne)if(Ne.size>1)for(var zt=0;zt<Ne.size;++zt){var nt=Ne.name.replace("[0]","["+zt+"]");Be(wt,new _e(nt,P.id(nt),C.getUniformLocation(Qe,nt),Ne))}else Be(wt,new _e(Ne.name,P.id(Ne.name),C.getUniformLocation(Qe,Ne.name),Ne));var $e=C.getProgramParameter(Qe,mD);de.profile&&(ee.stats.attributesCount=$e);var Me=ee.attributes;for(at=0;at<$e;++at)Ne=C.getActiveAttrib(Qe,at),Ne&&Be(Me,new _e(Ne.name,P.id(Ne.name),C.getAttribLocation(Qe,Ne.name),Ne))}de.profile&&(G.getMaxUniformsCount=function(){var ee=0;return ze.forEach(function(ge){ge.stats.uniformsCount>ee&&(ee=ge.stats.uniformsCount)}),ee},G.getMaxAttributesCount=function(){var ee=0;return ze.forEach(function(ge){ge.stats.attributesCount>ee&&(ee=ge.stats.attributesCount)}),ee});function Je(){Ee={},pe={};for(var ee=0;ee<ze.length;++ee)ke(ze[ee],null,ze[ee].attributes.map(function(ge){return[ge.location,ge.name]}))}return{clear:function(){var ee=C.deleteShader.bind(C);Ro(Ee).forEach(ee),Ee={},Ro(pe).forEach(ee),pe={},ze.forEach(function(ge){C.deleteProgram(ge.program)}),ze.length=0,We={},G.shaderCount=0},program:function(ee,ge,qe,at){A.command(ee>=0,"missing vertex shader",qe),A.command(ge>=0,"missing fragment shader",qe);var Ne=We[ge];Ne||(Ne=We[ge]={});var mt=Ne[ee];if(mt&&(mt.refCount++,!at))return mt;var we=new rt(ge,ee);return G.shaderCount++,ke(we,qe,at),mt||(Ne[ee]=we),ze.push(we),e(we,{destroy:function(){if(we.refCount--,we.refCount<=0){C.deleteProgram(we.program);var Qe=ze.indexOf(we);ze.splice(Qe,1),G.shaderCount--}Ne[we.vertId].refCount<=0&&(C.deleteShader(pe[we.vertId]),delete pe[we.vertId],delete We[we.fragId][we.vertId]),Object.keys(We[we.fragId]).length||(C.deleteShader(Ee[we.fragId]),delete Ee[we.fragId],delete We[we.fragId])}})},restore:Je,shader:Ve,frag:-1,vert:-1}}var _D=6408,Ic=5121,gD=3333,Kp=5126;function vD(C,P,G,de,Ee,pe,_e){function Be(ze){var Xe;P.next===null?(A(Ee.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),Xe=Ic):(A(P.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),Xe=P.next.colorAttachments[0].texture._texture.type,pe.oes_texture_float?(A(Xe===Ic||Xe===Kp,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),Xe===Kp&&A(_e.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):A(Xe===Ic,"Reading from a framebuffer is only allowed for the type 'uint8'"));var rt=0,ke=0,Je=de.framebufferWidth,ee=de.framebufferHeight,ge=null;n(ze)?ge=ze:ze&&(A.type(ze,"object","invalid arguments to regl.read()"),rt=ze.x|0,ke=ze.y|0,A(rt>=0&&rt<de.framebufferWidth,"invalid x offset for regl.read"),A(ke>=0&&ke<de.framebufferHeight,"invalid y offset for regl.read"),Je=(ze.width||de.framebufferWidth-rt)|0,ee=(ze.height||de.framebufferHeight-ke)|0,ge=ze.data||null),ge&&(Xe===Ic?A(ge instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):Xe===Kp&&A(ge instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),A(Je>0&&Je+rt<=de.framebufferWidth,"invalid width for read pixels"),A(ee>0&&ee+ke<=de.framebufferHeight,"invalid height for read pixels"),G();var qe=Je*ee*4;return ge||(Xe===Ic?ge=new Uint8Array(qe):Xe===Kp&&(ge=ge||new Float32Array(qe))),A.isTypedArray(ge,"data buffer for regl.read() must be a typedarray"),A(ge.byteLength>=qe,"data buffer for regl.read() too small"),C.pixelStorei(gD,4),C.readPixels(rt,ke,Je,ee,_D,Xe,ge),ge}function Ve(ze){var Xe;return P.setFBO({framebuffer:ze.framebuffer},function(){Xe=Be(ze)}),Xe}function We(ze){return!ze||!("framebuffer"in ze)?Be(ze):Ve(ze)}return We}function Ga(C){return Array.prototype.slice.call(C)}function Ua(C){return Ga(C).join("")}function yD(){var C=0,P=[],G=[];function de(Xe){for(var rt=0;rt<G.length;++rt)if(G[rt]===Xe)return P[rt];var ke="g"+C++;return P.push(ke),G.push(Xe),ke}function Ee(){var Xe=[];function rt(){Xe.push.apply(Xe,Ga(arguments))}var ke=[];function Je(){var ee="v"+C++;return ke.push(ee),arguments.length>0&&(Xe.push(ee,"="),Xe.push.apply(Xe,Ga(arguments)),Xe.push(";")),ee}return e(rt,{def:Je,toString:function(){return Ua([ke.length>0?"var "+ke.join(",")+";":"",Ua(Xe)])}})}function pe(){var Xe=Ee(),rt=Ee(),ke=Xe.toString,Je=rt.toString;function ee(ge,qe){rt(ge,qe,"=",Xe.def(ge,qe),";")}return e(function(){Xe.apply(Xe,Ga(arguments))},{def:Xe.def,entry:Xe,exit:rt,save:ee,set:function(ge,qe,at){ee(ge,qe),Xe(ge,qe,"=",at,";")},toString:function(){return ke()+Je()}})}function _e(){var Xe=Ua(arguments),rt=pe(),ke=pe(),Je=rt.toString,ee=ke.toString;return e(rt,{then:function(){return rt.apply(rt,Ga(arguments)),this},else:function(){return ke.apply(ke,Ga(arguments)),this},toString:function(){var ge=ee();return ge&&(ge="else{"+ge+"}"),Ua(["if(",Xe,"){",Je(),"}",ge])}})}var Be=Ee(),Ve={};function We(Xe,rt){var ke=[];function Je(){var Ne="a"+ke.length;return ke.push(Ne),Ne}rt=rt||0;for(var ee=0;ee<rt;++ee)Je();var ge=pe(),qe=ge.toString,at=Ve[Xe]=e(ge,{arg:Je,toString:function(){return Ua(["function(",ke.join(),"){",qe(),"}"])}});return at}function ze(){var Xe=['"use strict";',Be,"return {"];Object.keys(Ve).forEach(function(Je){Xe.push('"',Je,'":',Ve[Je].toString(),",")}),Xe.push("}");var rt=Ua(Xe).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),ke=Function.apply(null,P.concat(rt));return ke.apply(null,G)}return{global:Be,link:de,block:Ee,proc:We,scope:pe,cond:_e,compile:ze}}var Va="xyzw".split(""),B7=5121,za=1,Zh=2,Qh=0,e1=1,t1=2,r1=3,Zp=4,k7=5,F7=6,G7="dither",U7="blend.enable",V7="blend.color",n1="blend.equation",o1="blend.func",z7="depth.enable",H7="depth.func",j7="depth.range",q7="depth.mask",i1="colorMask",W7="cull.enable",$7="cull.face",s1="frontFace",a1="lineWidth",Y7="polygonOffset.enable",l1="polygonOffset.offset",X7="sample.alpha",J7="sample.enable",c1="sample.coverage",K7="stencil.enable",Z7="stencil.mask",u1="stencil.func",p1="stencil.opFront",Dc="stencil.opBack",Q7="scissor.enable",Qp="scissor.box",Ki="viewport",Bc="profile",_s="framebuffer",kc="vert",Fc="frag",gs="elements",vs="primitive",ys="count",ed="offset",td="instances",Gc="vao",d1="Width",f1="Height",Ha=_s+d1,ja=_s+f1,bD=Ki+d1,xD=Ki+f1,eg="drawingBuffer",tg=eg+d1,rg=eg+f1,CD=[o1,n1,u1,p1,Dc,c1,Ki,Qp,l1],qa=34962,TD=34963,ED=35632,AD=35633,ng=3553,MD=34067,ND=2884,SD=3042,PD=3024,OD=2960,wD=2929,RD=3089,LD=32823,ID=32926,DD=32928,m1=5126,rd=35664,nd=35665,od=35666,h1=5124,id=35667,sd=35668,ad=35669,_1=35670,ld=35671,cd=35672,ud=35673,Uc=35674,Vc=35675,zc=35676,Hc=35678,jc=35680,og=4,qc=1028,bs=1029,ig=2304,g1=2305,BD=32775,kD=32776,FD=519,S0=7680,sg=0,ag=1,lg=32774,GD=513,cg=36160,UD=36064,Ai={"0":0,"1":1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},ug=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Wa={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},P0={"0":0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},pg={frag:ED,vert:AD},v1={cw:ig,ccw:g1};function pd(C){return Array.isArray(C)||n(C)||ti(C)}function dg(C){return C.sort(function(P,G){return P===Ki?-1:G===Ki?1:P<G?-1:1})}function fo(C,P,G,de){this.thisDep=C,this.contextDep=P,this.propDep=G,this.append=de}function O0(C){return C&&!(C.thisDep||C.contextDep||C.propDep)}function mn(C){return new fo(!1,!1,!1,C)}function Co(C,P){var G=C.type;if(G===Qh){var de=C.data.length;return new fo(!0,de>=1,de>=2,P)}else if(G===Zp){var Ee=C.data;return new fo(Ee.thisDep,Ee.contextDep,Ee.propDep,P)}else{if(G===k7)return new fo(!1,!1,!1,P);if(G===F7){for(var pe=!1,_e=!1,Be=!1,Ve=0;Ve<C.data.length;++Ve){var We=C.data[Ve];if(We.type===e1)Be=!0;else if(We.type===t1)_e=!0;else if(We.type===r1)pe=!0;else if(We.type===Qh){pe=!0;var ze=We.data;ze>=1&&(_e=!0),ze>=2&&(Be=!0)}else We.type===Zp&&(pe=pe||We.data.thisDep,_e=_e||We.data.contextDep,Be=Be||We.data.propDep)}return new fo(pe,_e,Be,P)}else return new fo(G===r1,G===t1,G===e1,P)}}var fg=new fo(!1,!1,!1,function(){});function VD(C,P,G,de,Ee,pe,_e,Be,Ve,We,ze,Xe,rt,ke,Je){var ee=We.Record,ge={add:32774,subtract:32778,"reverse subtract":32779};G.ext_blend_minmax&&(ge.min=BD,ge.max=kD);var qe=G.angle_instanced_arrays,at=G.webgl_draw_buffers,Ne={dirty:!0,profile:Je.profile},mt={},we=[],Qe={},Se={};function et(w){return w.replace(".","_")}function wt(w,S,j){var Q=et(w);we.push(w),mt[Q]=Ne[Q]=!!j,Qe[Q]=S}function zt(w,S,j){var Q=et(w);we.push(w),Array.isArray(j)?(Ne[Q]=j.slice(),mt[Q]=j.slice()):Ne[Q]=mt[Q]=j,Se[Q]=S}wt(G7,PD),wt(U7,SD),zt(V7,"blendColor",[0,0,0,0]),zt(n1,"blendEquationSeparate",[lg,lg]),zt(o1,"blendFuncSeparate",[ag,sg,ag,sg]),wt(z7,wD,!0),zt(H7,"depthFunc",GD),zt(j7,"depthRange",[0,1]),zt(q7,"depthMask",!0),zt(i1,i1,[!0,!0,!0,!0]),wt(W7,ND),zt($7,"cullFace",bs),zt(s1,s1,g1),zt(a1,a1,1),wt(Y7,LD),zt(l1,"polygonOffset",[0,0]),wt(X7,ID),wt(J7,DD),zt(c1,"sampleCoverage",[1,!1]),wt(K7,OD),zt(Z7,"stencilMask",-1),zt(u1,"stencilFunc",[FD,0,-1]),zt(p1,"stencilOpSeparate",[qc,S0,S0,S0]),zt(Dc,"stencilOpSeparate",[bs,S0,S0,S0]),wt(Q7,RD),zt(Qp,"scissor",[0,0,C.drawingBufferWidth,C.drawingBufferHeight]),zt(Ki,Ki,[0,0,C.drawingBufferWidth,C.drawingBufferHeight]);var nt={gl:C,context:rt,strings:P,next:mt,current:Ne,draw:Xe,elements:pe,buffer:Ee,shader:ze,attributes:We.state,vao:We,uniforms:Ve,framebuffer:Be,extensions:G,timer:ke,isBufferArgs:pd},$e={primTypes:wa,compareFuncs:Wa,blendFuncs:Ai,blendEquations:ge,stencilOps:P0,glTypes:ps,orientationType:v1};A.optional(function(){nt.isArrayLike=ln}),at&&($e.backBuffer=[bs],$e.drawBuffer=Mn(de.maxDrawbuffers,function(w){return w===0?[0]:Mn(w,function(S){return UD+S})}));var Me=0;function Ft(){var w=yD(),S=w.link,j=w.global;w.id=Me++,w.batchId="0";var Q=S(nt),te=w.shared={props:"a0"};Object.keys(nt).forEach(function(z){te[z]=j.def(Q,".",z)}),A.optional(function(){w.CHECK=S(A),w.commandStr=A.guessCommand(),w.command=S(w.commandStr),w.assert=function(z,O,Z){z("if(!(",O,"))",this.CHECK,".commandRaise(",S(Z),",",this.command,");")},$e.invalidBlendCombinations=ug});var W=w.next={},q=w.current={};Object.keys(Se).forEach(function(z){Array.isArray(Ne[z])&&(W[z]=j.def(te.next,".",z),q[z]=j.def(te.current,".",z))});var J=w.constants={};Object.keys($e).forEach(function(z){J[z]=j.def(JSON.stringify($e[z]))}),w.invoke=function(z,O){switch(O.type){case Qh:var Z=["this",te.context,te.props,w.batchId];return z.def(S(O.data),".call(",Z.slice(0,Math.max(O.data.length+1,4)),")");case e1:return z.def(te.props,O.data);case t1:return z.def(te.context,O.data);case r1:return z.def("this",O.data);case Zp:return O.data.append(w,z),O.data.ref;case k7:return O.data.toString();case F7:return O.data.map(function(ie){return w.invoke(z,ie)})}},w.attribCache={};var R={};return w.scopeAttrib=function(z){var O=P.id(z);if(O in R)return R[O];var Z=We.scope[O];Z||(Z=We.scope[O]=new ee);var ie=R[O]=S(Z);return ie},w}function $t(w){var S=w.static,j=w.dynamic,Q;if(Bc in S){var te=!!S[Bc];Q=mn(function(q,J){return te}),Q.enable=te}else if(Bc in j){var W=j[Bc];Q=Co(W,function(q,J){return q.invoke(J,W)})}return Q}function xt(w,S){var j=w.static,Q=w.dynamic;if(_s in j){var te=j[_s];return te?(te=Be.getFramebuffer(te),A.command(te,"invalid framebuffer object"),mn(function(q,J){var R=q.link(te),z=q.shared;J.set(z.framebuffer,".next",R);var O=z.context;return J.set(O,"."+Ha,R+".width"),J.set(O,"."+ja,R+".height"),R})):mn(function(q,J){var R=q.shared;J.set(R.framebuffer,".next","null");var z=R.context;return J.set(z,"."+Ha,z+"."+tg),J.set(z,"."+ja,z+"."+rg),"null"})}else if(_s in Q){var W=Q[_s];return Co(W,function(q,J){var R=q.invoke(J,W),z=q.shared,O=z.framebuffer,Z=J.def(O,".getFramebuffer(",R,")");A.optional(function(){q.assert(J,"!"+R+"||"+Z,"invalid framebuffer object")}),J.set(O,".next",Z);var ie=z.context;return J.set(ie,"."+Ha,Z+"?"+Z+".width:"+ie+"."+tg),J.set(ie,"."+ja,Z+"?"+Z+".height:"+ie+"."+rg),Z})}else return null}function rr(w,S,j){var Q=w.static,te=w.dynamic;function W(R){if(R in Q){var z=Q[R];A.commandType(z,"object","invalid "+R,j.commandStr);var O=!0,Z=z.x|0,ie=z.y|0,Ce,Ae;return"width"in z?(Ce=z.width|0,A.command(Ce>=0,"invalid "+R,j.commandStr)):O=!1,"height"in z?(Ae=z.height|0,A.command(Ae>=0,"invalid "+R,j.commandStr)):O=!1,new fo(!O&&S&&S.thisDep,!O&&S&&S.contextDep,!O&&S&&S.propDep,function(Ot,Xt){var Ct=Ot.shared.context,Bt=Ce;"width"in z||(Bt=Xt.def(Ct,".",Ha,"-",Z));var jt=Ae;return"height"in z||(jt=Xt.def(Ct,".",ja,"-",ie)),[Z,ie,Bt,jt]})}else if(R in te){var ve=te[R],He=Co(ve,function(Ot,Xt){var Ct=Ot.invoke(Xt,ve);A.optional(function(){Ot.assert(Xt,Ct+"&&typeof "+Ct+'==="object"',"invalid "+R)});var Bt=Ot.shared.context,jt=Xt.def(Ct,".x|0"),mr=Xt.def(Ct,".y|0"),tn=Xt.def('"width" in ',Ct,"?",Ct,".width|0:","(",Bt,".",Ha,"-",jt,")"),mo=Xt.def('"height" in ',Ct,"?",Ct,".height|0:","(",Bt,".",ja,"-",mr,")");return A.optional(function(){Ot.assert(Xt,tn+">=0&&"+mo+">=0","invalid "+R)}),[jt,mr,tn,mo]});return S&&(He.thisDep=He.thisDep||S.thisDep,He.contextDep=He.contextDep||S.contextDep,He.propDep=He.propDep||S.propDep),He}else return S?new fo(S.thisDep,S.contextDep,S.propDep,function(Ot,Xt){var Ct=Ot.shared.context;return[0,0,Xt.def(Ct,".",Ha),Xt.def(Ct,".",ja)]}):null}var q=W(Ki);if(q){var J=q;q=new fo(q.thisDep,q.contextDep,q.propDep,function(R,z){var O=J.append(R,z),Z=R.shared.context;return z.set(Z,"."+bD,O[2]),z.set(Z,"."+xD,O[3]),O})}return{viewport:q,scissor_box:W(Qp)}}function Ht(w,S){var j=w.static,Q=typeof j[Fc]=="string"&&typeof j[kc]=="string";if(Q){if(Object.keys(S.dynamic).length>0)return null;var te=S.static,W=Object.keys(te);if(W.length>0&&typeof te[W[0]]=="number"){for(var q=[],J=0;J<W.length;++J)A(typeof te[W[J]]=="number","must specify all vertex attribute locations when using vaos"),q.push([te[W[J]]|0,W[J]]);return q}}return null}function Qt(w,S,j){var Q=w.static,te=w.dynamic;function W(O){if(O in Q){var Z=P.id(Q[O]);A.optional(function(){ze.shader(pg[O],Z,A.guessCommand())});var ie=mn(function(){return Z});return ie.id=Z,ie}else if(O in te){var Ce=te[O];return Co(Ce,function(Ae,ve){var He=Ae.invoke(ve,Ce),Ot=ve.def(Ae.shared.strings,".id(",He,")");return A.optional(function(){ve(Ae.shared.shader,".shader(",pg[O],",",Ot,",",Ae.command,");")}),Ot})}return null}var q=W(Fc),J=W(kc),R=null,z;return O0(q)&&O0(J)?(R=ze.program(J.id,q.id,null,j),z=mn(function(O,Z){return O.link(R)})):z=new fo(q&&q.thisDep||J&&J.thisDep,q&&q.contextDep||J&&J.contextDep,q&&q.propDep||J&&J.propDep,function(O,Z){var ie=O.shared.shader,Ce;q?Ce=q.append(O,Z):Ce=Z.def(ie,".",Fc);var Ae;J?Ae=J.append(O,Z):Ae=Z.def(ie,".",kc);var ve=ie+".program("+Ae+","+Ce;return A.optional(function(){ve+=","+O.command}),Z.def(ve+")")}),{frag:q,vert:J,progVar:z,program:R}}function fr(w,S){var j=w.static,Q=w.dynamic;function te(){if(gs in j){var O=j[gs];pd(O)?O=pe.getElements(pe.create(O,!0)):O&&(O=pe.getElements(O),A.command(O,"invalid elements",S.commandStr));var Z=mn(function(Ce,Ae){if(O){var ve=Ce.link(O);return Ce.ELEMENTS=ve,ve}return Ce.ELEMENTS=null,null});return Z.value=O,Z}else if(gs in Q){var ie=Q[gs];return Co(ie,function(Ce,Ae){var ve=Ce.shared,He=ve.isBufferArgs,Ot=ve.elements,Xt=Ce.invoke(Ae,ie),Ct=Ae.def("null"),Bt=Ae.def(He,"(",Xt,")"),jt=Ce.cond(Bt).then(Ct,"=",Ot,".createStream(",Xt,");").else(Ct,"=",Ot,".getElements(",Xt,");");return A.optional(function(){Ce.assert(jt.else,"!"+Xt+"||"+Ct,"invalid elements")}),Ae.entry(jt),Ae.exit(Ce.cond(Bt).then(Ot,".destroyStream(",Ct,");")),Ce.ELEMENTS=Ct,Ct})}return null}var W=te();function q(){if(vs in j){var O=j[vs];return A.commandParameter(O,wa,"invalid primitve",S.commandStr),mn(function(ie,Ce){return wa[O]})}else if(vs in Q){var Z=Q[vs];return Co(Z,function(ie,Ce){var Ae=ie.constants.primTypes,ve=ie.invoke(Ce,Z);return A.optional(function(){ie.assert(Ce,ve+" in "+Ae,"invalid primitive, must be one of "+Object.keys(wa))}),Ce.def(Ae,"[",ve,"]")})}else if(W)return O0(W)?W.value?mn(function(ie,Ce){return Ce.def(ie.ELEMENTS,".primType")}):mn(function(){return og}):new fo(W.thisDep,W.contextDep,W.propDep,function(ie,Ce){var Ae=ie.ELEMENTS;return Ce.def(Ae,"?",Ae,".primType:",og)});return null}function J(O,Z){if(O in j){var ie=j[O]|0;return A.command(!Z||ie>=0,"invalid "+O,S.commandStr),mn(function(Ae,ve){return Z&&(Ae.OFFSET=ie),ie})}else if(O in Q){var Ce=Q[O];return Co(Ce,function(Ae,ve){var He=Ae.invoke(ve,Ce);return Z&&(Ae.OFFSET=He,A.optional(function(){Ae.assert(ve,He+">=0","invalid "+O)})),He})}else if(Z&&W)return mn(function(Ae,ve){return Ae.OFFSET="0",0});return null}var R=J(ed,!0);function z(){if(ys in j){var O=j[ys]|0;return A.command(typeof O=="number"&&O>=0,"invalid vertex count",S.commandStr),mn(function(){return O})}else if(ys in Q){var Z=Q[ys];return Co(Z,function(Ae,ve){var He=Ae.invoke(ve,Z);return A.optional(function(){Ae.assert(ve,"typeof "+He+'==="number"&&'+He+">=0&&"+He+"===("+He+"|0)","invalid vertex count")}),He})}else if(W)if(O0(W)){if(W)return R?new fo(R.thisDep,R.contextDep,R.propDep,function(Ae,ve){var He=ve.def(Ae.ELEMENTS,".vertCount-",Ae.OFFSET);return A.optional(function(){Ae.assert(ve,He+">=0","invalid vertex offset/element buffer too small")}),He}):mn(function(Ae,ve){return ve.def(Ae.ELEMENTS,".vertCount")});var ie=mn(function(){return-1});return A.optional(function(){ie.MISSING=!0}),ie}else{var Ce=new fo(W.thisDep||R.thisDep,W.contextDep||R.contextDep,W.propDep||R.propDep,function(Ae,ve){var He=Ae.ELEMENTS;return Ae.OFFSET?ve.def(He,"?",He,".vertCount-",Ae.OFFSET,":-1"):ve.def(He,"?",He,".vertCount:-1")});return A.optional(function(){Ce.DYNAMIC=!0}),Ce}return null}return{elements:W,primitive:q(),count:z(),instances:J(td,!1),offset:R}}function hn(w,S){var j=w.static,Q=w.dynamic,te={};return we.forEach(function(W){var q=et(W);function J(R,z){if(W in j){var O=R(j[W]);te[q]=mn(function(){return O})}else if(W in Q){var Z=Q[W];te[q]=Co(Z,function(ie,Ce){return z(ie,Ce,ie.invoke(Ce,Z))})}}switch(W){case W7:case U7:case G7:case K7:case z7:case Q7:case Y7:case X7:case J7:case q7:return J(function(R){return A.commandType(R,"boolean",W,S.commandStr),R},function(R,z,O){return A.optional(function(){R.assert(z,"typeof "+O+'==="boolean"',"invalid flag "+W,R.commandStr)}),O});case H7:return J(function(R){return A.commandParameter(R,Wa,"invalid "+W,S.commandStr),Wa[R]},function(R,z,O){var Z=R.constants.compareFuncs;return A.optional(function(){R.assert(z,O+" in "+Z,"invalid "+W+", must be one of "+Object.keys(Wa))}),z.def(Z,"[",O,"]")});case j7:return J(function(R){return A.command(ln(R)&&R.length===2&&typeof R[0]=="number"&&typeof R[1]=="number"&&R[0]<=R[1],"depth range is 2d array",S.commandStr),R},function(R,z,O){A.optional(function(){R.assert(z,R.shared.isArrayLike+"("+O+")&&"+O+".length===2&&typeof "+O+'[0]==="number"&&typeof '+O+'[1]==="number"&&'+O+"[0]<="+O+"[1]","depth range must be a 2d array")});var Z=z.def("+",O,"[0]"),ie=z.def("+",O,"[1]");return[Z,ie]});case o1:return J(function(R){A.commandType(R,"object","blend.func",S.commandStr);var z="srcRGB"in R?R.srcRGB:R.src,O="srcAlpha"in R?R.srcAlpha:R.src,Z="dstRGB"in R?R.dstRGB:R.dst,ie="dstAlpha"in R?R.dstAlpha:R.dst;return A.commandParameter(z,Ai,q+".srcRGB",S.commandStr),A.commandParameter(O,Ai,q+".srcAlpha",S.commandStr),A.commandParameter(Z,Ai,q+".dstRGB",S.commandStr),A.commandParameter(ie,Ai,q+".dstAlpha",S.commandStr),A.command(ug.indexOf(z+", "+Z)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+z+", "+Z+")",S.commandStr),[Ai[z],Ai[Z],Ai[O],Ai[ie]]},function(R,z,O){var Z=R.constants.blendFuncs;A.optional(function(){R.assert(z,O+"&&typeof "+O+'==="object"',"invalid blend func, must be an object")});function ie(Ct,Bt){var jt=z.def('"',Ct,Bt,'" in ',O,"?",O,".",Ct,Bt,":",O,".",Ct);return A.optional(function(){R.assert(z,jt+" in "+Z,"invalid "+W+"."+Ct+Bt+", must be one of "+Object.keys(Ai))}),jt}var Ce=ie("src","RGB"),Ae=ie("dst","RGB");A.optional(function(){var Ct=R.constants.invalidBlendCombinations;R.assert(z,Ct+".indexOf("+Ce+'+", "+'+Ae+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var ve=z.def(Z,"[",Ce,"]"),He=z.def(Z,"[",ie("src","Alpha"),"]"),Ot=z.def(Z,"[",Ae,"]"),Xt=z.def(Z,"[",ie("dst","Alpha"),"]");return[ve,Ot,He,Xt]});case n1:return J(function(R){if(typeof R=="string")return A.commandParameter(R,ge,"invalid "+W,S.commandStr),[ge[R],ge[R]];if(typeof R=="object")return A.commandParameter(R.rgb,ge,W+".rgb",S.commandStr),A.commandParameter(R.alpha,ge,W+".alpha",S.commandStr),[ge[R.rgb],ge[R.alpha]];A.commandRaise("invalid blend.equation",S.commandStr)},function(R,z,O){var Z=R.constants.blendEquations,ie=z.def(),Ce=z.def(),Ae=R.cond("typeof ",O,'==="string"');return A.optional(function(){function ve(He,Ot,Xt){R.assert(He,Xt+" in "+Z,"invalid "+Ot+", must be one of "+Object.keys(ge))}ve(Ae.then,W,O),R.assert(Ae.else,O+"&&typeof "+O+'==="object"',"invalid "+W),ve(Ae.else,W+".rgb",O+".rgb"),ve(Ae.else,W+".alpha",O+".alpha")}),Ae.then(ie,"=",Ce,"=",Z,"[",O,"];"),Ae.else(ie,"=",Z,"[",O,".rgb];",Ce,"=",Z,"[",O,".alpha];"),z(Ae),[ie,Ce]});case V7:return J(function(R){return A.command(ln(R)&&R.length===4,"blend.color must be a 4d array",S.commandStr),Mn(4,function(z){return+R[z]})},function(R,z,O){return A.optional(function(){R.assert(z,R.shared.isArrayLike+"("+O+")&&"+O+".length===4","blend.color must be a 4d array")}),Mn(4,function(Z){return z.def("+",O,"[",Z,"]")})});case Z7:return J(function(R){return A.commandType(R,"number",q,S.commandStr),R|0},function(R,z,O){return A.optional(function(){R.assert(z,"typeof "+O+'==="number"',"invalid stencil.mask")}),z.def(O,"|0")});case u1:return J(function(R){A.commandType(R,"object",q,S.commandStr);var z=R.cmp||"keep",O=R.ref||0,Z="mask"in R?R.mask:-1;return A.commandParameter(z,Wa,W+".cmp",S.commandStr),A.commandType(O,"number",W+".ref",S.commandStr),A.commandType(Z,"number",W+".mask",S.commandStr),[Wa[z],O,Z]},function(R,z,O){var Z=R.constants.compareFuncs;A.optional(function(){function ve(){R.assert(z,Array.prototype.join.call(arguments,""),"invalid stencil.func")}ve(O+"&&typeof ",O,'==="object"'),ve('!("cmp" in ',O,")||(",O,".cmp in ",Z,")")});var ie=z.def('"cmp" in ',O,"?",Z,"[",O,".cmp]",":",S0),Ce=z.def(O,".ref|0"),Ae=z.def('"mask" in ',O,"?",O,".mask|0:-1");return[ie,Ce,Ae]});case p1:case Dc:return J(function(R){A.commandType(R,"object",q,S.commandStr);var z=R.fail||"keep",O=R.zfail||"keep",Z=R.zpass||"keep";return A.commandParameter(z,P0,W+".fail",S.commandStr),A.commandParameter(O,P0,W+".zfail",S.commandStr),A.commandParameter(Z,P0,W+".zpass",S.commandStr),[W===Dc?bs:qc,P0[z],P0[O],P0[Z]]},function(R,z,O){var Z=R.constants.stencilOps;A.optional(function(){R.assert(z,O+"&&typeof "+O+'==="object"',"invalid "+W)});function ie(Ce){return A.optional(function(){R.assert(z,'!("'+Ce+'" in '+O+")||("+O+"."+Ce+" in "+Z+")","invalid "+W+"."+Ce+", must be one of "+Object.keys(P0))}),z.def('"',Ce,'" in ',O,"?",Z,"[",O,".",Ce,"]:",S0)}return[W===Dc?bs:qc,ie("fail"),ie("zfail"),ie("zpass")]});case l1:return J(function(R){A.commandType(R,"object",q,S.commandStr);var z=R.factor|0,O=R.units|0;return A.commandType(z,"number",q+".factor",S.commandStr),A.commandType(O,"number",q+".units",S.commandStr),[z,O]},function(R,z,O){A.optional(function(){R.assert(z,O+"&&typeof "+O+'==="object"',"invalid "+W)});var Z=z.def(O,".factor|0"),ie=z.def(O,".units|0");return[Z,ie]});case $7:return J(function(R){var z=0;return R==="front"?z=qc:R==="back"&&(z=bs),A.command(!!z,q,S.commandStr),z},function(R,z,O){return A.optional(function(){R.assert(z,O+'==="front"||'+O+'==="back"',"invalid cull.face")}),z.def(O,'==="front"?',qc,":",bs)});case a1:return J(function(R){return A.command(typeof R=="number"&&R>=de.lineWidthDims[0]&&R<=de.lineWidthDims[1],"invalid line width, must be a positive number between "+de.lineWidthDims[0]+" and "+de.lineWidthDims[1],S.commandStr),R},function(R,z,O){return A.optional(function(){R.assert(z,"typeof "+O+'==="number"&&'+O+">="+de.lineWidthDims[0]+"&&"+O+"<="+de.lineWidthDims[1],"invalid line width")}),O});case s1:return J(function(R){return A.commandParameter(R,v1,q,S.commandStr),v1[R]},function(R,z,O){return A.optional(function(){R.assert(z,O+'==="cw"||'+O+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),z.def(O+'==="cw"?'+ig+":"+g1)});case i1:return J(function(R){return A.command(ln(R)&&R.length===4,"color.mask must be length 4 array",S.commandStr),R.map(function(z){return!!z})},function(R,z,O){return A.optional(function(){R.assert(z,R.shared.isArrayLike+"("+O+")&&"+O+".length===4","invalid color.mask")}),Mn(4,function(Z){return"!!"+O+"["+Z+"]"})});case c1:return J(function(R){A.command(typeof R=="object"&&R,q,S.commandStr);var z="value"in R?R.value:1,O=!!R.invert;return A.command(typeof z=="number"&&z>=0&&z<=1,"sample.coverage.value must be a number between 0 and 1",S.commandStr),[z,O]},function(R,z,O){A.optional(function(){R.assert(z,O+"&&typeof "+O+'==="object"',"invalid sample.coverage")});var Z=z.def('"value" in ',O,"?+",O,".value:1"),ie=z.def("!!",O,".invert");return[Z,ie]})}}),te}function Nn(w,S){var j=w.static,Q=w.dynamic,te={};return Object.keys(j).forEach(function(W){var q=j[W],J;if(typeof q=="number"||typeof q=="boolean")J=mn(function(){return q});else if(typeof q=="function"){var R=q._reglType;R==="texture2d"||R==="textureCube"?J=mn(function(z){return z.link(q)}):R==="framebuffer"||R==="framebufferCube"?(A.command(q.color.length>0,'missing color attachment for framebuffer sent to uniform "'+W+'"',S.commandStr),J=mn(function(z){return z.link(q.color[0])})):A.commandRaise('invalid data for uniform "'+W+'"',S.commandStr)}else ln(q)?J=mn(function(z){var O=z.global.def("[",Mn(q.length,function(Z){return A.command(typeof q[Z]=="number"||typeof q[Z]=="boolean","invalid uniform "+W,z.commandStr),q[Z]}),"]");return O}):A.commandRaise('invalid or missing data for uniform "'+W+'"',S.commandStr);J.value=q,te[W]=J}),Object.keys(Q).forEach(function(W){var q=Q[W];te[W]=Co(q,function(J,R){return J.invoke(R,q)})}),te}function ar(w,S){var j=w.static,Q=w.dynamic,te={};return Object.keys(j).forEach(function(W){var q=j[W],J=P.id(W),R=new ee;if(pd(q))R.state=za,R.buffer=Ee.getBuffer(Ee.create(q,qa,!1,!0)),R.type=0;else{var z=Ee.getBuffer(q);if(z)R.state=za,R.buffer=z,R.type=0;else if(A.command(typeof q=="object"&&q,"invalid data for attribute "+W,S.commandStr),"constant"in q){var O=q.constant;R.buffer="null",R.state=Zh,typeof O=="number"?R.x=O:(A.command(ln(O)&&O.length>0&&O.length<=4,"invalid constant for attribute "+W,S.commandStr),Va.forEach(function(Ot,Xt){Xt<O.length&&(R[Ot]=O[Xt])}))}else{pd(q.buffer)?z=Ee.getBuffer(Ee.create(q.buffer,qa,!1,!0)):z=Ee.getBuffer(q.buffer),A.command(!!z,'missing buffer for attribute "'+W+'"',S.commandStr);var Z=q.offset|0;A.command(Z>=0,'invalid offset for attribute "'+W+'"',S.commandStr);var ie=q.stride|0;A.command(ie>=0&&ie<256,'invalid stride for attribute "'+W+'", must be integer betweeen [0, 255]',S.commandStr);var Ce=q.size|0;A.command(!("size"in q)||Ce>0&&Ce<=4,'invalid size for attribute "'+W+'", must be 1,2,3,4',S.commandStr);var Ae=!!q.normalized,ve=0;"type"in q&&(A.commandParameter(q.type,ps,"invalid type for attribute "+W,S.commandStr),ve=ps[q.type]);var He=q.divisor|0;"divisor"in q&&(A.command(He===0||qe,'cannot specify divisor for attribute "'+W+'", instancing not supported',S.commandStr),A.command(He>=0,'invalid divisor for attribute "'+W+'"',S.commandStr)),A.optional(function(){var Ot=S.commandStr,Xt=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(q).forEach(function(Ct){A.command(Xt.indexOf(Ct)>=0,'unknown parameter "'+Ct+'" for attribute pointer "'+W+'" (valid parameters are '+Xt+")",Ot)})}),R.buffer=z,R.state=za,R.size=Ce,R.normalized=Ae,R.type=ve||z.dtype,R.offset=Z,R.stride=ie,R.divisor=He}}te[W]=mn(function(Ot,Xt){var Ct=Ot.attribCache;if(J in Ct)return Ct[J];var Bt={isStream:!1};return Object.keys(R).forEach(function(jt){Bt[jt]=R[jt]}),R.buffer&&(Bt.buffer=Ot.link(R.buffer),Bt.type=Bt.type||Bt.buffer+".dtype"),Ct[J]=Bt,Bt})}),Object.keys(Q).forEach(function(W){var q=Q[W];function J(R,z){var O=R.invoke(z,q),Z=R.shared,ie=R.constants,Ce=Z.isBufferArgs,Ae=Z.buffer;A.optional(function(){R.assert(z,O+"&&(typeof "+O+'==="object"||typeof '+O+'==="function")&&('+Ce+"("+O+")||"+Ae+".getBuffer("+O+")||"+Ae+".getBuffer("+O+".buffer)||"+Ce+"("+O+'.buffer)||("constant" in '+O+"&&(typeof "+O+'.constant==="number"||'+Z.isArrayLike+"("+O+".constant))))",'invalid dynamic attribute "'+W+'"')});var ve={isStream:z.def(!1)},He=new ee;He.state=za,Object.keys(He).forEach(function(Bt){ve[Bt]=z.def(""+He[Bt])});var Ot=ve.buffer,Xt=ve.type;z("if(",Ce,"(",O,")){",ve.isStream,"=true;",Ot,"=",Ae,".createStream(",qa,",",O,");",Xt,"=",Ot,".dtype;","}else{",Ot,"=",Ae,".getBuffer(",O,");","if(",Ot,"){",Xt,"=",Ot,".dtype;",'}else if("constant" in ',O,"){",ve.state,"=",Zh,";","if(typeof "+O+'.constant === "number"){',ve[Va[0]],"=",O,".constant;",Va.slice(1).map(function(Bt){return ve[Bt]}).join("="),"=0;","}else{",Va.map(function(Bt,jt){return ve[Bt]+"="+O+".constant.length>"+jt+"?"+O+".constant["+jt+"]:0;"}).join(""),"}}else{","if(",Ce,"(",O,".buffer)){",Ot,"=",Ae,".createStream(",qa,",",O,".buffer);","}else{",Ot,"=",Ae,".getBuffer(",O,".buffer);","}",Xt,'="type" in ',O,"?",ie.glTypes,"[",O,".type]:",Ot,".dtype;",ve.normalized,"=!!",O,".normalized;");function Ct(Bt){z(ve[Bt],"=",O,".",Bt,"|0;")}return Ct("size"),Ct("offset"),Ct("stride"),Ct("divisor"),z("}}"),z.exit("if(",ve.isStream,"){",Ae,".destroyStream(",Ot,");","}"),ve}te[W]=Co(q,J)}),te}function bn(w,S){var j=w.static,Q=w.dynamic;if(Gc in j){var te=j[Gc];return te!==null&&We.getVAO(te)===null&&(te=We.createVAO(te)),mn(function(q){return q.link(We.getVAO(te))})}else if(Gc in Q){var W=Q[Gc];return Co(W,function(q,J){var R=q.invoke(J,W);return J.def(q.shared.vao+".getVAO("+R+")")})}return null}function kr(w){var S=w.static,j=w.dynamic,Q={};return Object.keys(S).forEach(function(te){var W=S[te];Q[te]=mn(function(q,J){return typeof W=="number"||typeof W=="boolean"?""+W:q.link(W)})}),Object.keys(j).forEach(function(te){var W=j[te];Q[te]=Co(W,function(q,J){return q.invoke(J,W)})}),Q}function _n(w,S,j,Q,te){var W=w.static,q=w.dynamic;A.optional(function(){var Ct=[_s,kc,Fc,gs,vs,ed,ys,td,Bc,Gc].concat(we);function Bt(jt){Object.keys(jt).forEach(function(mr){A.command(Ct.indexOf(mr)>=0,'unknown parameter "'+mr+'"',te.commandStr)})}Bt(W),Bt(q)});var J=Ht(w,S),R=xt(w,te),z=rr(w,R,te),O=fr(w,te),Z=hn(w,te),ie=Qt(w,te,J);function Ce(Ct){var Bt=z[Ct];Bt&&(Z[Ct]=Bt)}Ce(Ki),Ce(et(Qp));var Ae=Object.keys(Z).length>0,ve={framebuffer:R,draw:O,shader:ie,state:Z,dirty:Ae,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(ve.profile=$t(w,te),ve.uniforms=Nn(j,te),ve.drawVAO=ve.scopeVAO=bn(w,te),!ve.drawVAO&&ie.program&&!J&&G.angle_instanced_arrays){var He=!0,Ot=ie.program.attributes.map(function(Ct){var Bt=S.static[Ct];return He=He&&!!Bt,Bt});if(He&&Ot.length>0){var Xt=We.getVAO(We.createVAO(Ot));ve.drawVAO=new fo(null,null,null,function(Ct,Bt){return Ct.link(Xt)}),ve.useVAO=!0}}return J?ve.useVAO=!0:ve.attributes=ar(S,te),ve.context=kr(Q,te),ve}function xn(w,S,j){var Q=w.shared,te=Q.context,W=w.scope();Object.keys(j).forEach(function(q){S.save(te,"."+q);var J=j[q],R=J.append(w,S);Array.isArray(R)?W(te,".",q,"=[",R.join(),"];"):W(te,".",q,"=",R,";")}),S(W)}function Cn(w,S,j,Q){var te=w.shared,W=te.gl,q=te.framebuffer,J;at&&(J=S.def(te.extensions,".webgl_draw_buffers"));var R=w.constants,z=R.drawBuffer,O=R.backBuffer,Z;j?Z=j.append(w,S):Z=S.def(q,".next"),Q||S("if(",Z,"!==",q,".cur){"),S("if(",Z,"){",W,".bindFramebuffer(",cg,",",Z,".framebuffer);"),at&&S(J,".drawBuffersWEBGL(",z,"[",Z,".colorAttachments.length]);"),S("}else{",W,".bindFramebuffer(",cg,",null);"),at&&S(J,".drawBuffersWEBGL(",O,");"),S("}",q,".cur=",Z,";"),Q||S("}")}function In(w,S,j){var Q=w.shared,te=Q.gl,W=w.current,q=w.next,J=Q.current,R=Q.next,z=w.cond(J,".dirty");we.forEach(function(O){var Z=et(O);if(!(Z in j.state)){var ie,Ce;if(Z in q){ie=q[Z],Ce=W[Z];var Ae=Mn(Ne[Z].length,function(He){return z.def(ie,"[",He,"]")});z(w.cond(Ae.map(function(He,Ot){return He+"!=="+Ce+"["+Ot+"]"}).join("||")).then(te,".",Se[Z],"(",Ae,");",Ae.map(function(He,Ot){return Ce+"["+Ot+"]="+He}).join(";"),";"))}else{ie=z.def(R,".",Z);var ve=w.cond(ie,"!==",J,".",Z);z(ve),Z in Qe?ve(w.cond(ie).then(te,".enable(",Qe[Z],");").else(te,".disable(",Qe[Z],");"),J,".",Z,"=",ie,";"):ve(te,".",Se[Z],"(",ie,");",J,".",Z,"=",ie,";")}}}),Object.keys(j.state).length===0&&z(J,".dirty=false;"),S(z)}function Hn(w,S,j,Q){var te=w.shared,W=w.current,q=te.current,J=te.gl;dg(Object.keys(j)).forEach(function(R){var z=j[R];if(!(Q&&!Q(z))){var O=z.append(w,S);if(Qe[R]){var Z=Qe[R];O0(z)?O?S(J,".enable(",Z,");"):S(J,".disable(",Z,");"):S(w.cond(O).then(J,".enable(",Z,");").else(J,".disable(",Z,");")),S(q,".",R,"=",O,";")}else if(ln(O)){var ie=W[R];S(J,".",Se[R],"(",O,");",O.map(function(Ce,Ae){return ie+"["+Ae+"]="+Ce}).join(";"),";")}else S(J,".",Se[R],"(",O,");",q,".",R,"=",O,";")}})}function cn(w,S){qe&&(w.instancing=S.def(w.shared.extensions,".angle_instanced_arrays"))}function Yt(w,S,j,Q,te){var W=w.shared,q=w.stats,J=W.current,R=W.timer,z=j.profile;function O(){return typeof performance=="undefined"?"Date.now()":"performance.now()"}var Z,ie;function Ce(Ct){Z=S.def(),Ct(Z,"=",O(),";"),typeof te=="string"?Ct(q,".count+=",te,";"):Ct(q,".count++;"),ke&&(Q?(ie=S.def(),Ct(ie,"=",R,".getNumPendingQueries();")):Ct(R,".beginQuery(",q,");"))}function Ae(Ct){Ct(q,".cpuTime+=",O(),"-",Z,";"),ke&&(Q?Ct(R,".pushScopeStats(",ie,",",R,".getNumPendingQueries(),",q,");"):Ct(R,".endQuery();"))}function ve(Ct){var Bt=S.def(J,".profile");S(J,".profile=",Ct,";"),S.exit(J,".profile=",Bt,";")}var He;if(z){if(O0(z)){z.enable?(Ce(S),Ae(S.exit),ve("true")):ve("false");return}He=z.append(w,S),ve(He)}else He=S.def(J,".profile");var Ot=w.block();Ce(Ot),S("if(",He,"){",Ot,"}");var Xt=w.block();Ae(Xt),S.exit("if(",He,"){",Xt,"}")}function jn(w,S,j,Q,te){var W=w.shared;function q(R){switch(R){case rd:case id:case ld:return 2;case nd:case sd:case cd:return 3;case od:case ad:case ud:return 4;default:return 1}}function J(R,z,O){var Z=W.gl,ie=S.def(R,".location"),Ce=S.def(W.attributes,"[",ie,"]"),Ae=O.state,ve=O.buffer,He=[O.x,O.y,O.z,O.w],Ot=["buffer","normalized","offset","stride"];function Xt(){S("if(!",Ce,".buffer){",Z,".enableVertexAttribArray(",ie,");}");var Bt=O.type,jt;if(O.size?jt=S.def(O.size,"||",z):jt=z,S("if(",Ce,".type!==",Bt,"||",Ce,".size!==",jt,"||",Ot.map(function(tn){return Ce+"."+tn+"!=="+O[tn]}).join("||"),"){",Z,".bindBuffer(",qa,",",ve,".buffer);",Z,".vertexAttribPointer(",[ie,jt,Bt,O.normalized,O.stride,O.offset],");",Ce,".type=",Bt,";",Ce,".size=",jt,";",Ot.map(function(tn){return Ce+"."+tn+"="+O[tn]+";"}).join(""),"}"),qe){var mr=O.divisor;S("if(",Ce,".divisor!==",mr,"){",w.instancing,".vertexAttribDivisorANGLE(",[ie,mr],");",Ce,".divisor=",mr,";}")}}function Ct(){S("if(",Ce,".buffer){",Z,".disableVertexAttribArray(",ie,");",Ce,".buffer=null;","}if(",Va.map(function(Bt,jt){return Ce+"."+Bt+"!=="+He[jt]}).join("||"),"){",Z,".vertexAttrib4f(",ie,",",He,");",Va.map(function(Bt,jt){return Ce+"."+Bt+"="+He[jt]+";"}).join(""),"}")}Ae===za?Xt():Ae===Zh?Ct():(S("if(",Ae,"===",za,"){"),Xt(),S("}else{"),Ct(),S("}"))}Q.forEach(function(R){var z=R.name,O=j.attributes[z],Z;if(O){if(!te(O))return;Z=O.append(w,S)}else{if(!te(fg))return;var ie=w.scopeAttrib(z);A.optional(function(){w.assert(S,ie+".state","missing attribute "+z)}),Z={},Object.keys(new ee).forEach(function(Ce){Z[Ce]=S.def(ie,".",Ce)})}J(w.link(R),q(R.info.type),Z)})}function gr(w,S,j,Q,te){for(var W=w.shared,q=W.gl,J,R=0;R<Q.length;++R){var z=Q[R],O=z.name,Z=z.info.type,ie=j.uniforms[O],Ce=w.link(z),Ae=Ce+".location",ve;if(ie){if(!te(ie))continue;if(O0(ie)){var He=ie.value;if(A.command(He!==null&&typeof He!="undefined",'missing uniform "'+O+'"',w.commandStr),Z===Hc||Z===jc){A.command(typeof He=="function"&&(Z===Hc&&(He._reglType==="texture2d"||He._reglType==="framebuffer")||Z===jc&&(He._reglType==="textureCube"||He._reglType==="framebufferCube")),"invalid texture for uniform "+O,w.commandStr);var Ot=w.link(He._texture||He.color[0]._texture);S(q,".uniform1i(",Ae,",",Ot+".bind());"),S.exit(Ot,".unbind();")}else if(Z===Uc||Z===Vc||Z===zc){A.optional(function(){A.command(ln(He),"invalid matrix for uniform "+O,w.commandStr),A.command(Z===Uc&&He.length===4||Z===Vc&&He.length===9||Z===zc&&He.length===16,"invalid length for matrix uniform "+O,w.commandStr)});var Xt=w.global.def("new Float32Array(["+Array.prototype.slice.call(He)+"])"),Ct=2;Z===Vc?Ct=3:Z===zc&&(Ct=4),S(q,".uniformMatrix",Ct,"fv(",Ae,",false,",Xt,");")}else{switch(Z){case m1:A.commandType(He,"number","uniform "+O,w.commandStr),J="1f";break;case rd:A.command(ln(He)&&He.length===2,"uniform "+O,w.commandStr),J="2f";break;case nd:A.command(ln(He)&&He.length===3,"uniform "+O,w.commandStr),J="3f";break;case od:A.command(ln(He)&&He.length===4,"uniform "+O,w.commandStr),J="4f";break;case _1:A.commandType(He,"boolean","uniform "+O,w.commandStr),J="1i";break;case h1:A.commandType(He,"number","uniform "+O,w.commandStr),J="1i";break;case ld:A.command(ln(He)&&He.length===2,"uniform "+O,w.commandStr),J="2i";break;case id:A.command(ln(He)&&He.length===2,"uniform "+O,w.commandStr),J="2i";break;case cd:A.command(ln(He)&&He.length===3,"uniform "+O,w.commandStr),J="3i";break;case sd:A.command(ln(He)&&He.length===3,"uniform "+O,w.commandStr),J="3i";break;case ud:A.command(ln(He)&&He.length===4,"uniform "+O,w.commandStr),J="4i";break;case ad:A.command(ln(He)&&He.length===4,"uniform "+O,w.commandStr),J="4i";break}S(q,".uniform",J,"(",Ae,",",ln(He)?Array.prototype.slice.call(He):He,");")}continue}else ve=ie.append(w,S)}else{if(!te(fg))continue;ve=S.def(W.uniforms,"[",P.id(O),"]")}Z===Hc?(A(!Array.isArray(ve),"must specify a scalar prop for textures"),S("if(",ve,"&&",ve,'._reglType==="framebuffer"){',ve,"=",ve,".color[0];","}")):Z===jc&&(A(!Array.isArray(ve),"must specify a scalar prop for cube maps"),S("if(",ve,"&&",ve,'._reglType==="framebufferCube"){',ve,"=",ve,".color[0];","}")),A.optional(function(){function mo(ni,bg){w.assert(S,ni,'bad data or missing for uniform "'+O+'".  '+bg)}function y1(ni){A(!Array.isArray(ve),"must not specify an array type for uniform"),mo("typeof "+ve+'==="'+ni+'"',"invalid type, expected "+ni)}function zo(ni,bg){Array.isArray(ve)?A(ve.length===ni,"must have length "+ni):mo(W.isArrayLike+"("+ve+")&&"+ve+".length==="+ni,"invalid vector, should have length "+ni,w.commandStr)}function yg(ni){A(!Array.isArray(ve),"must not specify a value type"),mo("typeof "+ve+'==="function"&&'+ve+'._reglType==="texture'+(ni===ng?"2d":"Cube")+'"',"invalid texture type",w.commandStr)}switch(Z){case h1:y1("number");break;case id:zo(2,"number");break;case sd:zo(3,"number");break;case ad:zo(4,"number");break;case m1:y1("number");break;case rd:zo(2,"number");break;case nd:zo(3,"number");break;case od:zo(4,"number");break;case _1:y1("boolean");break;case ld:zo(2,"boolean");break;case cd:zo(3,"boolean");break;case ud:zo(4,"boolean");break;case Uc:zo(4,"number");break;case Vc:zo(9,"number");break;case zc:zo(16,"number");break;case Hc:yg(ng);break;case jc:yg(MD);break}});var Bt=1;switch(Z){case Hc:case jc:var jt=S.def(ve,"._texture");S(q,".uniform1i(",Ae,",",jt,".bind());"),S.exit(jt,".unbind();");continue;case h1:case _1:J="1i";break;case id:case ld:J="2i",Bt=2;break;case sd:case cd:J="3i",Bt=3;break;case ad:case ud:J="4i",Bt=4;break;case m1:J="1f";break;case rd:J="2f",Bt=2;break;case nd:J="3f",Bt=3;break;case od:J="4f",Bt=4;break;case Uc:J="Matrix2fv";break;case Vc:J="Matrix3fv";break;case zc:J="Matrix4fv";break}if(S(q,".uniform",J,"(",Ae,","),J.charAt(0)==="M"){var mr=Math.pow(Z-Uc+2,2),tn=w.global.def("new Float32Array(",mr,")");Array.isArray(ve)?S("false,(",Mn(mr,function(mo){return tn+"["+mo+"]="+ve[mo]}),",",tn,")"):S("false,(Array.isArray(",ve,")||",ve," instanceof Float32Array)?",ve,":(",Mn(mr,function(mo){return tn+"["+mo+"]="+ve+"["+mo+"]"}),",",tn,")")}else Bt>1?S(Mn(Bt,function(mo){return Array.isArray(ve)?ve[mo]:ve+"["+mo+"]"})):(A(!Array.isArray(ve),"uniform value must not be an array"),S(ve));S(");")}}function Lt(w,S,j,Q){var te=w.shared,W=te.gl,q=te.draw,J=Q.draw;function R(){var jt=J.elements,mr,tn=S;return jt?((jt.contextDep&&Q.contextDynamic||jt.propDep)&&(tn=j),mr=jt.append(w,tn)):mr=tn.def(q,".",gs),mr&&tn("if("+mr+")"+W+".bindBuffer("+TD+","+mr+".buffer.buffer);"),mr}function z(){var jt=J.count,mr,tn=S;return jt?((jt.contextDep&&Q.contextDynamic||jt.propDep)&&(tn=j),mr=jt.append(w,tn),A.optional(function(){jt.MISSING&&w.assert(S,"false","missing vertex count"),jt.DYNAMIC&&w.assert(tn,mr+">=0","missing vertex count")})):(mr=tn.def(q,".",ys),A.optional(function(){w.assert(tn,mr+">=0","missing vertex count")})),mr}var O=R();function Z(jt){var mr=J[jt];return mr?mr.contextDep&&Q.contextDynamic||mr.propDep?mr.append(w,j):mr.append(w,S):S.def(q,".",jt)}var ie=Z(vs),Ce=Z(ed),Ae=z();if(typeof Ae=="number"){if(Ae===0)return}else j("if(",Ae,"){"),j.exit("}");var ve,He;qe&&(ve=Z(td),He=w.instancing);var Ot=O+".type",Xt=J.elements&&O0(J.elements);function Ct(){function jt(){j(He,".drawElementsInstancedANGLE(",[ie,Ae,Ot,Ce+"<<(("+Ot+"-"+B7+")>>1)",ve],");")}function mr(){j(He,".drawArraysInstancedANGLE(",[ie,Ce,Ae,ve],");")}O?Xt?jt():(j("if(",O,"){"),jt(),j("}else{"),mr(),j("}")):mr()}function Bt(){function jt(){j(W+".drawElements("+[ie,Ae,Ot,Ce+"<<(("+Ot+"-"+B7+")>>1)"]+");")}function mr(){j(W+".drawArrays("+[ie,Ce,Ae]+");")}O?Xt?jt():(j("if(",O,"){"),jt(),j("}else{"),mr(),j("}")):mr()}qe&&(typeof ve!="number"||ve>=0)?typeof ve=="string"?(j("if(",ve,">0){"),Ct(),j("}else if(",ve,"<0){"),Bt(),j("}")):Ct():Bt()}function ir(w,S,j,Q,te){var W=Ft(),q=W.proc("body",te);return A.optional(function(){W.commandStr=S.commandStr,W.command=W.link(S.commandStr)}),qe&&(W.instancing=q.def(W.shared.extensions,".angle_instanced_arrays")),w(W,q,j,Q),W.compile().body}function ur(w,S,j,Q){cn(w,S),j.useVAO?j.drawVAO?S(w.shared.vao,".setVAO(",j.drawVAO.append(w,S),");"):S(w.shared.vao,".setVAO(",w.shared.vao,".targetVAO);"):(S(w.shared.vao,".setVAO(null);"),jn(w,S,j,Q.attributes,function(){return!0})),gr(w,S,j,Q.uniforms,function(){return!0}),Lt(w,S,S,j)}function un(w,S){var j=w.proc("draw",1);cn(w,j),xn(w,j,S.context),Cn(w,j,S.framebuffer),In(w,j,S),Hn(w,j,S.state),Yt(w,j,S,!1,!0);var Q=S.shader.progVar.append(w,j);if(j(w.shared.gl,".useProgram(",Q,".program);"),S.shader.program)ur(w,j,S,S.shader.program);else{j(w.shared.vao,".setVAO(null);");var te=w.global.def("{}"),W=j.def(Q,".id"),q=j.def(te,"[",W,"]");j(w.cond(q).then(q,".call(this,a0);").else(q,"=",te,"[",W,"]=",w.link(function(J){return ir(ur,w,S,J,1)}),"(",Q,");",q,".call(this,a0);"))}Object.keys(S.state).length>0&&j(w.shared.current,".dirty=true;")}function Mi(w,S,j,Q){w.batchId="a1",cn(w,S);function te(){return!0}jn(w,S,j,Q.attributes,te),gr(w,S,j,Q.uniforms,te),Lt(w,S,S,j)}function xs(w,S,j,Q){cn(w,S);var te=j.contextDep,W=S.def(),q="a0",J="a1",R=S.def();w.shared.props=R,w.batchId=W;var z=w.scope(),O=w.scope();S(z.entry,"for(",W,"=0;",W,"<",J,";++",W,"){",R,"=",q,"[",W,"];",O,"}",z.exit);function Z(Ot){return Ot.contextDep&&te||Ot.propDep}function ie(Ot){return!Z(Ot)}if(j.needsContext&&xn(w,O,j.context),j.needsFramebuffer&&Cn(w,O,j.framebuffer),Hn(w,O,j.state,Z),j.profile&&Z(j.profile)&&Yt(w,O,j,!1,!0),Q)j.useVAO?j.drawVAO?Z(j.drawVAO)?O(w.shared.vao,".setVAO(",j.drawVAO.append(w,O),");"):z(w.shared.vao,".setVAO(",j.drawVAO.append(w,z),");"):z(w.shared.vao,".setVAO(",w.shared.vao,".targetVAO);"):(z(w.shared.vao,".setVAO(null);"),jn(w,z,j,Q.attributes,ie),jn(w,O,j,Q.attributes,Z)),gr(w,z,j,Q.uniforms,ie),gr(w,O,j,Q.uniforms,Z),Lt(w,z,O,j);else{var Ce=w.global.def("{}"),Ae=j.shader.progVar.append(w,O),ve=O.def(Ae,".id"),He=O.def(Ce,"[",ve,"]");O(w.shared.gl,".useProgram(",Ae,".program);","if(!",He,"){",He,"=",Ce,"[",ve,"]=",w.link(function(Ot){return ir(Mi,w,j,Ot,2)}),"(",Ae,");}",He,".call(this,a0[",W,"],",W,");")}}function I(w,S){var j=w.proc("batch",2);w.batchId="0",cn(w,j);var Q=!1,te=!0;Object.keys(S.context).forEach(function(Ce){Q=Q||S.context[Ce].propDep}),Q||(xn(w,j,S.context),te=!1);var W=S.framebuffer,q=!1;W?(W.propDep?Q=q=!0:W.contextDep&&Q&&(q=!0),q||Cn(w,j,W)):Cn(w,j,null),S.state.viewport&&S.state.viewport.propDep&&(Q=!0);function J(Ce){return Ce.contextDep&&Q||Ce.propDep}In(w,j,S),Hn(w,j,S.state,function(Ce){return!J(Ce)}),(!S.profile||!J(S.profile))&&Yt(w,j,S,!1,"a1"),S.contextDep=Q,S.needsContext=te,S.needsFramebuffer=q;var R=S.shader.progVar;if(R.contextDep&&Q||R.propDep)xs(w,j,S,null);else{var z=R.append(w,j);if(j(w.shared.gl,".useProgram(",z,".program);"),S.shader.program)xs(w,j,S,S.shader.program);else{j(w.shared.vao,".setVAO(null);");var O=w.global.def("{}"),Z=j.def(z,".id"),ie=j.def(O,"[",Z,"]");j(w.cond(ie).then(ie,".call(this,a0,a1);").else(ie,"=",O,"[",Z,"]=",w.link(function(Ce){return ir(xs,w,S,Ce,2)}),"(",z,");",ie,".call(this,a0,a1);"))}}Object.keys(S.state).length>0&&j(w.shared.current,".dirty=true;")}function fe(w,S){var j=w.proc("scope",3);w.batchId="a2";var Q=w.shared,te=Q.current;xn(w,j,S.context),S.framebuffer&&S.framebuffer.append(w,j),dg(Object.keys(S.state)).forEach(function(q){var J=S.state[q],R=J.append(w,j);ln(R)?R.forEach(function(z,O){j.set(w.next[q],"["+O+"]",z)}):j.set(Q.next,"."+q,R)}),Yt(w,j,S,!0,!0),[gs,ed,ys,td,vs].forEach(function(q){var J=S.draw[q];!J||j.set(Q.draw,"."+q,""+J.append(w,j))}),Object.keys(S.uniforms).forEach(function(q){var J=S.uniforms[q].append(w,j);Array.isArray(J)&&(J="["+J.join()+"]"),j.set(Q.uniforms,"["+P.id(q)+"]",J)}),Object.keys(S.attributes).forEach(function(q){var J=S.attributes[q].append(w,j),R=w.scopeAttrib(q);Object.keys(new ee).forEach(function(z){j.set(R,"."+z,J[z])})}),S.scopeVAO&&j.set(Q.vao,".targetVAO",S.scopeVAO.append(w,j));function W(q){var J=S.shader[q];J&&j.set(Q.shader,"."+q,J.append(w,j))}W(kc),W(Fc),Object.keys(S.state).length>0&&(j(te,".dirty=true;"),j.exit(te,".dirty=true;")),j("a1(",w.shared.context,",a0,",w.batchId,");")}function le(w){if(!(typeof w!="object"||ln(w))){for(var S=Object.keys(w),j=0;j<S.length;++j)if(ne.isDynamic(w[S[j]]))return!0;return!1}}function ht(w,S,j){var Q=S.static[j];if(!Q||!le(Q))return;var te=w.global,W=Object.keys(Q),q=!1,J=!1,R=!1,z=w.global.def("{}");W.forEach(function(Z){var ie=Q[Z];if(ne.isDynamic(ie)){typeof ie=="function"&&(ie=Q[Z]=ne.unbox(ie));var Ce=Co(ie,null);q=q||Ce.thisDep,R=R||Ce.propDep,J=J||Ce.contextDep}else{switch(te(z,".",Z,"="),typeof ie){case"number":te(ie);break;case"string":te('"',ie,'"');break;case"object":Array.isArray(ie)&&te("[",ie.join(),"]");break;default:te(w.link(ie));break}te(";")}});function O(Z,ie){W.forEach(function(Ce){var Ae=Q[Ce];if(!!ne.isDynamic(Ae)){var ve=Z.invoke(ie,Ae);ie(z,".",Ce,"=",ve,";")}})}S.dynamic[j]=new ne.DynamicVariable(Zp,{thisDep:q,contextDep:J,propDep:R,ref:z,append:O}),delete S.static[j]}function nr(w,S,j,Q,te){var W=Ft();W.stats=W.link(te),Object.keys(S.static).forEach(function(J){ht(W,S,J)}),CD.forEach(function(J){ht(W,w,J)});var q=_n(w,S,j,Q,W);return un(W,q),fe(W,q),I(W,q),e(W.compile(),{destroy:function(){q.shader.program.destroy()}})}return{next:mt,current:Ne,procs:function(){var w=Ft(),S=w.proc("poll"),j=w.proc("refresh"),Q=w.block();S(Q),j(Q);var te=w.shared,W=te.gl,q=te.next,J=te.current;Q(J,".dirty=false;"),Cn(w,S),Cn(w,j,null,!0);var R;qe&&(R=w.link(qe)),G.oes_vertex_array_object&&j(w.link(G.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var z=0;z<de.maxAttributes;++z){var O=j.def(te.attributes,"[",z,"]"),Z=w.cond(O,".buffer");Z.then(W,".enableVertexAttribArray(",z,");",W,".bindBuffer(",qa,",",O,".buffer.buffer);",W,".vertexAttribPointer(",z,",",O,".size,",O,".type,",O,".normalized,",O,".stride,",O,".offset);").else(W,".disableVertexAttribArray(",z,");",W,".vertexAttrib4f(",z,",",O,".x,",O,".y,",O,".z,",O,".w);",O,".buffer=null;"),j(Z),qe&&j(R,".vertexAttribDivisorANGLE(",z,",",O,".divisor);")}return j(w.shared.vao,".currentVAO=null;",w.shared.vao,".setVAO(",w.shared.vao,".targetVAO);"),Object.keys(Qe).forEach(function(ie){var Ce=Qe[ie],Ae=Q.def(q,".",ie),ve=w.block();ve("if(",Ae,"){",W,".enable(",Ce,")}else{",W,".disable(",Ce,")}",J,".",ie,"=",Ae,";"),j(ve),S("if(",Ae,"!==",J,".",ie,"){",ve,"}")}),Object.keys(Se).forEach(function(ie){var Ce=Se[ie],Ae=Ne[ie],ve,He,Ot=w.block();if(Ot(W,".",Ce,"("),ln(Ae)){var Xt=Ae.length;ve=w.global.def(q,".",ie),He=w.global.def(J,".",ie),Ot(Mn(Xt,function(Ct){return ve+"["+Ct+"]"}),");",Mn(Xt,function(Ct){return He+"["+Ct+"]="+ve+"["+Ct+"];"}).join("")),S("if(",Mn(Xt,function(Ct){return ve+"["+Ct+"]!=="+He+"["+Ct+"]"}).join("||"),"){",Ot,"}")}else ve=Q.def(q,".",ie),He=Q.def(J,".",ie),Ot(ve,");",J,".",ie,"=",ve,";"),S("if(",ve,"!==",He,"){",Ot,"}");j(Ot)}),w.compile()}(),compile:nr}}function zD(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var HD=34918,jD=34919,mg=35007,qD=function(C,P){if(!P.ext_disjoint_timer_query)return null;var G=[];function de(){return G.pop()||P.ext_disjoint_timer_query.createQueryEXT()}function Ee(qe){G.push(qe)}var pe=[];function _e(qe){var at=de();P.ext_disjoint_timer_query.beginQueryEXT(mg,at),pe.push(at),ke(pe.length-1,pe.length,qe)}function Be(){P.ext_disjoint_timer_query.endQueryEXT(mg)}function Ve(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var We=[];function ze(){return We.pop()||new Ve}function Xe(qe){We.push(qe)}var rt=[];function ke(qe,at,Ne){var mt=ze();mt.startQueryIndex=qe,mt.endQueryIndex=at,mt.sum=0,mt.stats=Ne,rt.push(mt)}var Je=[],ee=[];function ge(){var qe,at,Ne=pe.length;if(Ne!==0){ee.length=Math.max(ee.length,Ne+1),Je.length=Math.max(Je.length,Ne+1),Je[0]=0,ee[0]=0;var mt=0;for(qe=0,at=0;at<pe.length;++at){var we=pe[at];P.ext_disjoint_timer_query.getQueryObjectEXT(we,jD)?(mt+=P.ext_disjoint_timer_query.getQueryObjectEXT(we,HD),Ee(we)):pe[qe++]=we,Je[at+1]=mt,ee[at+1]=qe}for(pe.length=qe,qe=0,at=0;at<rt.length;++at){var Qe=rt[at],Se=Qe.startQueryIndex,et=Qe.endQueryIndex;Qe.sum+=Je[et]-Je[Se];var wt=ee[Se],zt=ee[et];zt===wt?(Qe.stats.gpuTime+=Qe.sum/1e6,Xe(Qe)):(Qe.startQueryIndex=wt,Qe.endQueryIndex=zt,rt[qe++]=Qe)}rt.length=qe}}return{beginQuery:_e,endQuery:Be,pushScopeStats:ke,update:ge,getNumPendingQueries:function(){return pe.length},clear:function(){G.push.apply(G,pe);for(var qe=0;qe<G.length;qe++)P.ext_disjoint_timer_query.deleteQueryEXT(G[qe]);pe.length=0,G.length=0},restore:function(){pe.length=0,G.length=0}}},WD=16384,$D=256,YD=1024,XD=34962,hg="webglcontextlost",_g="webglcontextrestored",gg=1,JD=2,KD=3;function vg(C,P){for(var G=0;G<C.length;++G)if(C[G]===P)return G;return-1}function ZD(C){var P=Ln(C);if(!P)return null;var G=P.gl,de=G.getContextAttributes(),Ee=G.isContextLost(),pe=ls(G,P);if(!pe)return null;var _e=cr(),Be=zD(),Ve=pe.extensions,We=qD(G,Ve),ze=Or(),Xe=G.drawingBufferWidth,rt=G.drawingBufferHeight,ke={tick:0,time:0,viewportWidth:Xe,viewportHeight:rt,framebufferWidth:Xe,framebufferHeight:rt,drawingBufferWidth:Xe,drawingBufferHeight:rt,pixelRatio:P.pixelRatio},Je={},ee={elements:null,primitive:4,count:-1,offset:0,instances:-1},ge=kL(G,Ve),qe=QL(G,Be,P,Ne),at=pD(G,Ve,ge,Be,qe);function Ne(Lt){return at.destroyBuffer(Lt)}var mt=pI(G,Ve,qe,Be),we=hD(G,_e,Be,P),Qe=zI(G,Ve,ge,function(){wt.procs.poll()},ke,Be,P),Se=HI(G,Ve,ge,Be,P),et=cD(G,Ve,ge,Qe,Se,Be),wt=VD(G,_e,Ve,ge,qe,mt,Qe,et,Je,at,we,ee,ke,We,P),zt=vD(G,et,wt.procs.poll,ke,de,Ve,ge),nt=wt.next,$e=G.canvas,Me=[],Ft=[],$t=[],xt=[P.onDestroy],rr=null;function Ht(){if(Me.length===0){We&&We.update(),rr=null;return}rr=Et.next(Ht),Hn();for(var Lt=Me.length-1;Lt>=0;--Lt){var ir=Me[Lt];ir&&ir(ke,null,0)}G.flush(),We&&We.update()}function Qt(){!rr&&Me.length>0&&(rr=Et.next(Ht))}function fr(){rr&&(Et.cancel(Ht),rr=null)}function hn(Lt){Lt.preventDefault(),Ee=!0,fr(),Ft.forEach(function(ir){ir()})}function Nn(Lt){G.getError(),Ee=!1,pe.restore(),we.restore(),qe.restore(),Qe.restore(),Se.restore(),et.restore(),at.restore(),We&&We.restore(),wt.procs.refresh(),Qt(),$t.forEach(function(ir){ir()})}$e&&($e.addEventListener(hg,hn,!1),$e.addEventListener(_g,Nn,!1));function ar(){Me.length=0,fr(),$e&&($e.removeEventListener(hg,hn),$e.removeEventListener(_g,Nn)),we.clear(),et.clear(),Se.clear(),Qe.clear(),mt.clear(),qe.clear(),at.clear(),We&&We.clear(),xt.forEach(function(Lt){Lt()})}function bn(Lt){A(!!Lt,"invalid args to regl({...})"),A.type(Lt,"object","invalid args to regl({...})");function ir(te){var W=e({},te);delete W.uniforms,delete W.attributes,delete W.context,delete W.vao,"stencil"in W&&W.stencil.op&&(W.stencil.opBack=W.stencil.opFront=W.stencil.op,delete W.stencil.op);function q(J){if(J in W){var R=W[J];delete W[J],Object.keys(R).forEach(function(z){W[J+"."+z]=R[z]})}}return q("blend"),q("depth"),q("cull"),q("stencil"),q("polygonOffset"),q("scissor"),q("sample"),"vao"in te&&(W.vao=te.vao),W}function ur(te,W){var q={},J={};return Object.keys(te).forEach(function(R){var z=te[R];if(ne.isDynamic(z)){J[R]=ne.unbox(z,R);return}else if(W&&Array.isArray(z)){for(var O=0;O<z.length;++O)if(ne.isDynamic(z[O])){J[R]=ne.unbox(z,R);return}}q[R]=z}),{dynamic:J,static:q}}var un=ur(Lt.context||{},!0),Mi=ur(Lt.uniforms||{},!0),xs=ur(Lt.attributes||{},!1),I=ur(ir(Lt),!1),fe={gpuTime:0,cpuTime:0,count:0},le=wt.compile(I,xs,Mi,un,fe),ht=le.draw,nr=le.batch,w=le.scope,S=[];function j(te){for(;S.length<te;)S.push(null);return S}function Q(te,W){var q;if(Ee&&A.raise("context lost"),typeof te=="function")return w.call(this,null,te,0);if(typeof W=="function")if(typeof te=="number")for(q=0;q<te;++q)w.call(this,null,W,q);else if(Array.isArray(te))for(q=0;q<te.length;++q)w.call(this,te[q],W,q);else return w.call(this,te,W,0);else if(typeof te=="number"){if(te>0)return nr.call(this,j(te|0),te|0)}else if(Array.isArray(te)){if(te.length)return nr.call(this,te,te.length)}else return ht.call(this,te)}return e(Q,{stats:fe,destroy:function(){le.destroy()}})}var kr=et.setFBO=bn({framebuffer:ne.define.call(null,gg,"framebuffer")});function _n(Lt,ir){var ur=0;wt.procs.poll();var un=ir.color;un&&(G.clearColor(+un[0]||0,+un[1]||0,+un[2]||0,+un[3]||0),ur|=WD),"depth"in ir&&(G.clearDepth(+ir.depth),ur|=$D),"stencil"in ir&&(G.clearStencil(ir.stencil|0),ur|=YD),A(!!ur,"called regl.clear with no buffer specified"),G.clear(ur)}function xn(Lt){if(A(typeof Lt=="object"&&Lt,"regl.clear() takes an object as input"),"framebuffer"in Lt)if(Lt.framebuffer&&Lt.framebuffer_reglType==="framebufferCube")for(var ir=0;ir<6;++ir)kr(e({framebuffer:Lt.framebuffer.faces[ir]},Lt),_n);else kr(Lt,_n);else _n(null,Lt)}function Cn(Lt){A.type(Lt,"function","regl.frame() callback must be a function"),Me.push(Lt);function ir(){var ur=vg(Me,Lt);A(ur>=0,"cannot cancel a frame twice");function un(){var Mi=vg(Me,un);Me[Mi]=Me[Me.length-1],Me.length-=1,Me.length<=0&&fr()}Me[ur]=un}return Qt(),{cancel:ir}}function In(){var Lt=nt.viewport,ir=nt.scissor_box;Lt[0]=Lt[1]=ir[0]=ir[1]=0,ke.viewportWidth=ke.framebufferWidth=ke.drawingBufferWidth=Lt[2]=ir[2]=G.drawingBufferWidth,ke.viewportHeight=ke.framebufferHeight=ke.drawingBufferHeight=Lt[3]=ir[3]=G.drawingBufferHeight}function Hn(){ke.tick+=1,ke.time=Yt(),In(),wt.procs.poll()}function cn(){Qe.refresh(),In(),wt.procs.refresh(),We&&We.update()}function Yt(){return(Or()-ze)/1e3}cn();function jn(Lt,ir){A.type(ir,"function","listener callback must be a function");var ur;switch(Lt){case"frame":return Cn(ir);case"lost":ur=Ft;break;case"restore":ur=$t;break;case"destroy":ur=xt;break;default:A.raise("invalid event, must be one of frame,lost,restore,destroy")}return ur.push(ir),{cancel:function(){for(var un=0;un<ur.length;++un)if(ur[un]===ir){ur[un]=ur[ur.length-1],ur.pop();return}}}}var gr=e(bn,{clear:xn,prop:ne.define.bind(null,gg),context:ne.define.bind(null,JD),this:ne.define.bind(null,KD),draw:bn({}),buffer:function(Lt){return qe.create(Lt,XD,!1,!1)},elements:function(Lt){return mt.create(Lt,!1)},texture:Qe.create2D,cube:Qe.createCube,renderbuffer:Se.create,framebuffer:et.create,framebufferCube:et.createCube,vao:at.createVAO,attributes:de,frame:Cn,on:jn,limits:ge,hasExtension:function(Lt){return ge.extensions.indexOf(Lt.toLowerCase())>=0},read:zt,destroy:ar,_gl:G,_refresh:cn,poll:function(){Hn(),We&&We.update()},now:Yt,stats:Be});return P.onDone(null,gr),gr}return ZD})});var RN=K((Iu,t3)=>{(function(n,e){if(typeof Iu=="object"&&typeof t3=="object")t3.exports=e();else if(typeof define=="function"&&define.amd)define([],e);else{var t=e();for(var r in t)(typeof Iu=="object"?Iu:n)[r]=t[r]}})(typeof self!="undefined"?self:Iu,function(){return function(n){var e={};function t(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return n[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=n,t.c=e,t.d=function(r,o,s){t.o(r,o)||Object.defineProperty(r,o,{enumerable:!0,get:s})},t.r=function(r){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},t.t=function(r,o){if(1&o&&(r=t(r)),8&o||4&o&&typeof r=="object"&&r&&r.__esModule)return r;var s=Object.create(null);if(t.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:r}),2&o&&typeof r!="string")for(var i in r)t.d(s,i,function(l){return r[l]}.bind(null,i));return s},t.n=function(r){var o=r&&r.__esModule?function(){return r.default}:function(){return r};return t.d(o,"a",o),o},t.o=function(r,o){return Object.prototype.hasOwnProperty.call(r,o)},t.p="",t(t.s=10)}([function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.setMatrixArrayType=function(s){e.ARRAY_TYPE=s},e.toRadian=function(s){return s*o},e.equals=function(s,i){return Math.abs(s-i)<=r*Math.max(1,Math.abs(s),Math.abs(i))};var r=e.EPSILON=1e-6;e.ARRAY_TYPE=typeof Float32Array!="undefined"?Float32Array:Array,e.RANDOM=Math.random;var o=Math.PI/180},function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.forEach=e.sqrLen=e.len=e.sqrDist=e.dist=e.div=e.mul=e.sub=void 0,e.create=o,e.clone=function(p){var u=new r.ARRAY_TYPE(4);return u[0]=p[0],u[1]=p[1],u[2]=p[2],u[3]=p[3],u},e.fromValues=function(p,u,d,f){var _=new r.ARRAY_TYPE(4);return _[0]=p,_[1]=u,_[2]=d,_[3]=f,_},e.copy=function(p,u){return p[0]=u[0],p[1]=u[1],p[2]=u[2],p[3]=u[3],p},e.set=function(p,u,d,f,_){return p[0]=u,p[1]=d,p[2]=f,p[3]=_,p},e.add=function(p,u,d){return p[0]=u[0]+d[0],p[1]=u[1]+d[1],p[2]=u[2]+d[2],p[3]=u[3]+d[3],p},e.subtract=s,e.multiply=i,e.divide=l,e.ceil=function(p,u){return p[0]=Math.ceil(u[0]),p[1]=Math.ceil(u[1]),p[2]=Math.ceil(u[2]),p[3]=Math.ceil(u[3]),p},e.floor=function(p,u){return p[0]=Math.floor(u[0]),p[1]=Math.floor(u[1]),p[2]=Math.floor(u[2]),p[3]=Math.floor(u[3]),p},e.min=function(p,u,d){return p[0]=Math.min(u[0],d[0]),p[1]=Math.min(u[1],d[1]),p[2]=Math.min(u[2],d[2]),p[3]=Math.min(u[3],d[3]),p},e.max=function(p,u,d){return p[0]=Math.max(u[0],d[0]),p[1]=Math.max(u[1],d[1]),p[2]=Math.max(u[2],d[2]),p[3]=Math.max(u[3],d[3]),p},e.round=function(p,u){return p[0]=Math.round(u[0]),p[1]=Math.round(u[1]),p[2]=Math.round(u[2]),p[3]=Math.round(u[3]),p},e.scale=function(p,u,d){return p[0]=u[0]*d,p[1]=u[1]*d,p[2]=u[2]*d,p[3]=u[3]*d,p},e.scaleAndAdd=function(p,u,d,f){return p[0]=u[0]+d[0]*f,p[1]=u[1]+d[1]*f,p[2]=u[2]+d[2]*f,p[3]=u[3]+d[3]*f,p},e.distance=a,e.squaredDistance=c,e.length=h,e.squaredLength=g,e.negate=function(p,u){return p[0]=-u[0],p[1]=-u[1],p[2]=-u[2],p[3]=-u[3],p},e.inverse=function(p,u){return p[0]=1/u[0],p[1]=1/u[1],p[2]=1/u[2],p[3]=1/u[3],p},e.normalize=function(p,u){var d=u[0],f=u[1],_=u[2],m=u[3],v=d*d+f*f+_*_+m*m;return v>0&&(v=1/Math.sqrt(v),p[0]=d*v,p[1]=f*v,p[2]=_*v,p[3]=m*v),p},e.dot=function(p,u){return p[0]*u[0]+p[1]*u[1]+p[2]*u[2]+p[3]*u[3]},e.lerp=function(p,u,d,f){var _=u[0],m=u[1],v=u[2],y=u[3];return p[0]=_+f*(d[0]-_),p[1]=m+f*(d[1]-m),p[2]=v+f*(d[2]-v),p[3]=y+f*(d[3]-y),p},e.random=function(p,u){var d,f,_,m,v,y;u=u||1;do d=2*r.RANDOM()-1,f=2*r.RANDOM()-1,v=d*d+f*f;while(v>=1);do _=2*r.RANDOM()-1,m=2*r.RANDOM()-1,y=_*_+m*m;while(y>=1);var b=Math.sqrt((1-v)/y);return p[0]=u*d,p[1]=u*f,p[2]=u*_*b,p[3]=u*m*b,p},e.transformMat4=function(p,u,d){var f=u[0],_=u[1],m=u[2],v=u[3];return p[0]=d[0]*f+d[4]*_+d[8]*m+d[12]*v,p[1]=d[1]*f+d[5]*_+d[9]*m+d[13]*v,p[2]=d[2]*f+d[6]*_+d[10]*m+d[14]*v,p[3]=d[3]*f+d[7]*_+d[11]*m+d[15]*v,p},e.transformQuat=function(p,u,d){var f=u[0],_=u[1],m=u[2],v=d[0],y=d[1],b=d[2],x=d[3],E=x*f+y*m-b*_,T=x*_+b*f-v*m,M=x*m+v*_-y*f,D=-v*f-y*_-b*m;return p[0]=E*x+D*-v+T*-b-M*-y,p[1]=T*x+D*-y+M*-v-E*-b,p[2]=M*x+D*-b+E*-y-T*-v,p[3]=u[3],p},e.str=function(p){return"vec4("+p[0]+", "+p[1]+", "+p[2]+", "+p[3]+")"},e.exactEquals=function(p,u){return p[0]===u[0]&&p[1]===u[1]&&p[2]===u[2]&&p[3]===u[3]},e.equals=function(p,u){var d=p[0],f=p[1],_=p[2],m=p[3],v=u[0],y=u[1],b=u[2],x=u[3];return Math.abs(d-v)<=r.EPSILON*Math.max(1,Math.abs(d),Math.abs(v))&&Math.abs(f-y)<=r.EPSILON*Math.max(1,Math.abs(f),Math.abs(y))&&Math.abs(_-b)<=r.EPSILON*Math.max(1,Math.abs(_),Math.abs(b))&&Math.abs(m-x)<=r.EPSILON*Math.max(1,Math.abs(m),Math.abs(x))};var r=function(p){if(p&&p.__esModule)return p;var u={};if(p!=null)for(var d in p)Object.prototype.hasOwnProperty.call(p,d)&&(u[d]=p[d]);return u.default=p,u}(t(0));function o(){var p=new r.ARRAY_TYPE(4);return r.ARRAY_TYPE!=Float32Array&&(p[0]=0,p[1]=0,p[2]=0,p[3]=0),p}function s(p,u,d){return p[0]=u[0]-d[0],p[1]=u[1]-d[1],p[2]=u[2]-d[2],p[3]=u[3]-d[3],p}function i(p,u,d){return p[0]=u[0]*d[0],p[1]=u[1]*d[1],p[2]=u[2]*d[2],p[3]=u[3]*d[3],p}function l(p,u,d){return p[0]=u[0]/d[0],p[1]=u[1]/d[1],p[2]=u[2]/d[2],p[3]=u[3]/d[3],p}function a(p,u){var d=u[0]-p[0],f=u[1]-p[1],_=u[2]-p[2],m=u[3]-p[3];return Math.sqrt(d*d+f*f+_*_+m*m)}function c(p,u){var d=u[0]-p[0],f=u[1]-p[1],_=u[2]-p[2],m=u[3]-p[3];return d*d+f*f+_*_+m*m}function h(p){var u=p[0],d=p[1],f=p[2],_=p[3];return Math.sqrt(u*u+d*d+f*f+_*_)}function g(p){var u=p[0],d=p[1],f=p[2],_=p[3];return u*u+d*d+f*f+_*_}e.sub=s,e.mul=i,e.div=l,e.dist=a,e.sqrDist=c,e.len=h,e.sqrLen=g,e.forEach=function(){var p=o();return function(u,d,f,_,m,v){var y=void 0,b=void 0;for(d||(d=4),f||(f=0),b=_?Math.min(_*d+f,u.length):u.length,y=f;y<b;y+=d)p[0]=u[y],p[1]=u[y+1],p[2]=u[y+2],p[3]=u[y+3],m(p,p,v),u[y]=p[0],u[y+1]=p[1],u[y+2]=p[2],u[y+3]=p[3];return u}}()},function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.forEach=e.sqrLen=e.len=e.sqrDist=e.dist=e.div=e.mul=e.sub=void 0,e.create=o,e.clone=function(f){var _=new r.ARRAY_TYPE(3);return _[0]=f[0],_[1]=f[1],_[2]=f[2],_},e.length=s,e.fromValues=i,e.copy=function(f,_){return f[0]=_[0],f[1]=_[1],f[2]=_[2],f},e.set=function(f,_,m,v){return f[0]=_,f[1]=m,f[2]=v,f},e.add=function(f,_,m){return f[0]=_[0]+m[0],f[1]=_[1]+m[1],f[2]=_[2]+m[2],f},e.subtract=l,e.multiply=a,e.divide=c,e.ceil=function(f,_){return f[0]=Math.ceil(_[0]),f[1]=Math.ceil(_[1]),f[2]=Math.ceil(_[2]),f},e.floor=function(f,_){return f[0]=Math.floor(_[0]),f[1]=Math.floor(_[1]),f[2]=Math.floor(_[2]),f},e.min=function(f,_,m){return f[0]=Math.min(_[0],m[0]),f[1]=Math.min(_[1],m[1]),f[2]=Math.min(_[2],m[2]),f},e.max=function(f,_,m){return f[0]=Math.max(_[0],m[0]),f[1]=Math.max(_[1],m[1]),f[2]=Math.max(_[2],m[2]),f},e.round=function(f,_){return f[0]=Math.round(_[0]),f[1]=Math.round(_[1]),f[2]=Math.round(_[2]),f},e.scale=function(f,_,m){return f[0]=_[0]*m,f[1]=_[1]*m,f[2]=_[2]*m,f},e.scaleAndAdd=function(f,_,m,v){return f[0]=_[0]+m[0]*v,f[1]=_[1]+m[1]*v,f[2]=_[2]+m[2]*v,f},e.distance=h,e.squaredDistance=g,e.squaredLength=p,e.negate=function(f,_){return f[0]=-_[0],f[1]=-_[1],f[2]=-_[2],f},e.inverse=function(f,_){return f[0]=1/_[0],f[1]=1/_[1],f[2]=1/_[2],f},e.normalize=u,e.dot=d,e.cross=function(f,_,m){var v=_[0],y=_[1],b=_[2],x=m[0],E=m[1],T=m[2];return f[0]=y*T-b*E,f[1]=b*x-v*T,f[2]=v*E-y*x,f},e.lerp=function(f,_,m,v){var y=_[0],b=_[1],x=_[2];return f[0]=y+v*(m[0]-y),f[1]=b+v*(m[1]-b),f[2]=x+v*(m[2]-x),f},e.hermite=function(f,_,m,v,y,b){var x=b*b,E=x*(2*b-3)+1,T=x*(b-2)+b,M=x*(b-1),D=x*(3-2*b);return f[0]=_[0]*E+m[0]*T+v[0]*M+y[0]*D,f[1]=_[1]*E+m[1]*T+v[1]*M+y[1]*D,f[2]=_[2]*E+m[2]*T+v[2]*M+y[2]*D,f},e.bezier=function(f,_,m,v,y,b){var x=1-b,E=x*x,T=b*b,M=E*x,D=3*b*E,U=3*T*x,L=T*b;return f[0]=_[0]*M+m[0]*D+v[0]*U+y[0]*L,f[1]=_[1]*M+m[1]*D+v[1]*U+y[1]*L,f[2]=_[2]*M+m[2]*D+v[2]*U+y[2]*L,f},e.random=function(f,_){_=_||1;var m=2*r.RANDOM()*Math.PI,v=2*r.RANDOM()-1,y=Math.sqrt(1-v*v)*_;return f[0]=Math.cos(m)*y,f[1]=Math.sin(m)*y,f[2]=v*_,f},e.transformMat4=function(f,_,m){var v=_[0],y=_[1],b=_[2],x=m[3]*v+m[7]*y+m[11]*b+m[15];return x=x||1,f[0]=(m[0]*v+m[4]*y+m[8]*b+m[12])/x,f[1]=(m[1]*v+m[5]*y+m[9]*b+m[13])/x,f[2]=(m[2]*v+m[6]*y+m[10]*b+m[14])/x,f},e.transformMat3=function(f,_,m){var v=_[0],y=_[1],b=_[2];return f[0]=v*m[0]+y*m[3]+b*m[6],f[1]=v*m[1]+y*m[4]+b*m[7],f[2]=v*m[2]+y*m[5]+b*m[8],f},e.transformQuat=function(f,_,m){var v=m[0],y=m[1],b=m[2],x=m[3],E=_[0],T=_[1],M=_[2],D=y*M-b*T,U=b*E-v*M,L=v*T-y*E,se=y*L-b*U,$=b*D-v*L,H=v*U-y*D,ae=2*x;return D*=ae,U*=ae,L*=ae,se*=2,$*=2,H*=2,f[0]=E+D+se,f[1]=T+U+$,f[2]=M+L+H,f},e.rotateX=function(f,_,m,v){var y=[],b=[];return y[0]=_[0]-m[0],y[1]=_[1]-m[1],y[2]=_[2]-m[2],b[0]=y[0],b[1]=y[1]*Math.cos(v)-y[2]*Math.sin(v),b[2]=y[1]*Math.sin(v)+y[2]*Math.cos(v),f[0]=b[0]+m[0],f[1]=b[1]+m[1],f[2]=b[2]+m[2],f},e.rotateY=function(f,_,m,v){var y=[],b=[];return y[0]=_[0]-m[0],y[1]=_[1]-m[1],y[2]=_[2]-m[2],b[0]=y[2]*Math.sin(v)+y[0]*Math.cos(v),b[1]=y[1],b[2]=y[2]*Math.cos(v)-y[0]*Math.sin(v),f[0]=b[0]+m[0],f[1]=b[1]+m[1],f[2]=b[2]+m[2],f},e.rotateZ=function(f,_,m,v){var y=[],b=[];return y[0]=_[0]-m[0],y[1]=_[1]-m[1],y[2]=_[2]-m[2],b[0]=y[0]*Math.cos(v)-y[1]*Math.sin(v),b[1]=y[0]*Math.sin(v)+y[1]*Math.cos(v),b[2]=y[2],f[0]=b[0]+m[0],f[1]=b[1]+m[1],f[2]=b[2]+m[2],f},e.angle=function(f,_){var m=i(f[0],f[1],f[2]),v=i(_[0],_[1],_[2]);u(m,m),u(v,v);var y=d(m,v);return y>1?0:y<-1?Math.PI:Math.acos(y)},e.str=function(f){return"vec3("+f[0]+", "+f[1]+", "+f[2]+")"},e.exactEquals=function(f,_){return f[0]===_[0]&&f[1]===_[1]&&f[2]===_[2]},e.equals=function(f,_){var m=f[0],v=f[1],y=f[2],b=_[0],x=_[1],E=_[2];return Math.abs(m-b)<=r.EPSILON*Math.max(1,Math.abs(m),Math.abs(b))&&Math.abs(v-x)<=r.EPSILON*Math.max(1,Math.abs(v),Math.abs(x))&&Math.abs(y-E)<=r.EPSILON*Math.max(1,Math.abs(y),Math.abs(E))};var r=function(f){if(f&&f.__esModule)return f;var _={};if(f!=null)for(var m in f)Object.prototype.hasOwnProperty.call(f,m)&&(_[m]=f[m]);return _.default=f,_}(t(0));function o(){var f=new r.ARRAY_TYPE(3);return r.ARRAY_TYPE!=Float32Array&&(f[0]=0,f[1]=0,f[2]=0),f}function s(f){var _=f[0],m=f[1],v=f[2];return Math.sqrt(_*_+m*m+v*v)}function i(f,_,m){var v=new r.ARRAY_TYPE(3);return v[0]=f,v[1]=_,v[2]=m,v}function l(f,_,m){return f[0]=_[0]-m[0],f[1]=_[1]-m[1],f[2]=_[2]-m[2],f}function a(f,_,m){return f[0]=_[0]*m[0],f[1]=_[1]*m[1],f[2]=_[2]*m[2],f}function c(f,_,m){return f[0]=_[0]/m[0],f[1]=_[1]/m[1],f[2]=_[2]/m[2],f}function h(f,_){var m=_[0]-f[0],v=_[1]-f[1],y=_[2]-f[2];return Math.sqrt(m*m+v*v+y*y)}function g(f,_){var m=_[0]-f[0],v=_[1]-f[1],y=_[2]-f[2];return m*m+v*v+y*y}function p(f){var _=f[0],m=f[1],v=f[2];return _*_+m*m+v*v}function u(f,_){var m=_[0],v=_[1],y=_[2],b=m*m+v*v+y*y;return b>0&&(b=1/Math.sqrt(b),f[0]=_[0]*b,f[1]=_[1]*b,f[2]=_[2]*b),f}function d(f,_){return f[0]*_[0]+f[1]*_[1]+f[2]*_[2]}e.sub=l,e.mul=a,e.div=c,e.dist=h,e.sqrDist=g,e.len=s,e.sqrLen=p,e.forEach=function(){var f=o();return function(_,m,v,y,b,x){var E=void 0,T=void 0;for(m||(m=3),v||(v=0),T=y?Math.min(y*m+v,_.length):_.length,E=v;E<T;E+=m)f[0]=_[E],f[1]=_[E+1],f[2]=_[E+2],b(f,f,x),_[E]=f[0],_[E+1]=f[1],_[E+2]=f[2];return _}}()},function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.setAxes=e.sqlerp=e.rotationTo=e.equals=e.exactEquals=e.normalize=e.sqrLen=e.squaredLength=e.len=e.length=e.lerp=e.dot=e.scale=e.mul=e.add=e.set=e.copy=e.fromValues=e.clone=void 0,e.create=a,e.identity=function(_){return _[0]=0,_[1]=0,_[2]=0,_[3]=1,_},e.setAxisAngle=c,e.getAxisAngle=function(_,m){var v=2*Math.acos(m[3]),y=Math.sin(v/2);return y>r.EPSILON?(_[0]=m[0]/y,_[1]=m[1]/y,_[2]=m[2]/y):(_[0]=1,_[1]=0,_[2]=0),v},e.multiply=h,e.rotateX=function(_,m,v){v*=.5;var y=m[0],b=m[1],x=m[2],E=m[3],T=Math.sin(v),M=Math.cos(v);return _[0]=y*M+E*T,_[1]=b*M+x*T,_[2]=x*M-b*T,_[3]=E*M-y*T,_},e.rotateY=function(_,m,v){v*=.5;var y=m[0],b=m[1],x=m[2],E=m[3],T=Math.sin(v),M=Math.cos(v);return _[0]=y*M-x*T,_[1]=b*M+E*T,_[2]=x*M+y*T,_[3]=E*M-b*T,_},e.rotateZ=function(_,m,v){v*=.5;var y=m[0],b=m[1],x=m[2],E=m[3],T=Math.sin(v),M=Math.cos(v);return _[0]=y*M+b*T,_[1]=b*M-y*T,_[2]=x*M+E*T,_[3]=E*M-x*T,_},e.calculateW=function(_,m){var v=m[0],y=m[1],b=m[2];return _[0]=v,_[1]=y,_[2]=b,_[3]=Math.sqrt(Math.abs(1-v*v-y*y-b*b)),_},e.slerp=g,e.random=function(_){var m=r.RANDOM(),v=r.RANDOM(),y=r.RANDOM(),b=Math.sqrt(1-m),x=Math.sqrt(m);return _[0]=b*Math.sin(2*Math.PI*v),_[1]=b*Math.cos(2*Math.PI*v),_[2]=x*Math.sin(2*Math.PI*y),_[3]=x*Math.cos(2*Math.PI*y),_},e.invert=function(_,m){var v=m[0],y=m[1],b=m[2],x=m[3],E=v*v+y*y+b*b+x*x,T=E?1/E:0;return _[0]=-v*T,_[1]=-y*T,_[2]=-b*T,_[3]=x*T,_},e.conjugate=function(_,m){return _[0]=-m[0],_[1]=-m[1],_[2]=-m[2],_[3]=m[3],_},e.fromMat3=p,e.fromEuler=function(_,m,v,y){var b=.5*Math.PI/180;m*=b,v*=b,y*=b;var x=Math.sin(m),E=Math.cos(m),T=Math.sin(v),M=Math.cos(v),D=Math.sin(y),U=Math.cos(y);return _[0]=x*M*U-E*T*D,_[1]=E*T*U+x*M*D,_[2]=E*M*D-x*T*U,_[3]=E*M*U+x*T*D,_},e.str=function(_){return"quat("+_[0]+", "+_[1]+", "+_[2]+", "+_[3]+")"};var r=l(t(0)),o=l(t(5)),s=l(t(2)),i=l(t(1));function l(_){if(_&&_.__esModule)return _;var m={};if(_!=null)for(var v in _)Object.prototype.hasOwnProperty.call(_,v)&&(m[v]=_[v]);return m.default=_,m}function a(){var _=new r.ARRAY_TYPE(4);return r.ARRAY_TYPE!=Float32Array&&(_[0]=0,_[1]=0,_[2]=0),_[3]=1,_}function c(_,m,v){v*=.5;var y=Math.sin(v);return _[0]=y*m[0],_[1]=y*m[1],_[2]=y*m[2],_[3]=Math.cos(v),_}function h(_,m,v){var y=m[0],b=m[1],x=m[2],E=m[3],T=v[0],M=v[1],D=v[2],U=v[3];return _[0]=y*U+E*T+b*D-x*M,_[1]=b*U+E*M+x*T-y*D,_[2]=x*U+E*D+y*M-b*T,_[3]=E*U-y*T-b*M-x*D,_}function g(_,m,v,y){var b=m[0],x=m[1],E=m[2],T=m[3],M=v[0],D=v[1],U=v[2],L=v[3],se=void 0,$=void 0,H=void 0,ae=void 0,ue=void 0;return($=b*M+x*D+E*U+T*L)<0&&($=-$,M=-M,D=-D,U=-U,L=-L),1-$>r.EPSILON?(se=Math.acos($),H=Math.sin(se),ae=Math.sin((1-y)*se)/H,ue=Math.sin(y*se)/H):(ae=1-y,ue=y),_[0]=ae*b+ue*M,_[1]=ae*x+ue*D,_[2]=ae*E+ue*U,_[3]=ae*T+ue*L,_}function p(_,m){var v=m[0]+m[4]+m[8],y=void 0;if(v>0)y=Math.sqrt(v+1),_[3]=.5*y,y=.5/y,_[0]=(m[5]-m[7])*y,_[1]=(m[6]-m[2])*y,_[2]=(m[1]-m[3])*y;else{var b=0;m[4]>m[0]&&(b=1),m[8]>m[3*b+b]&&(b=2);var x=(b+1)%3,E=(b+2)%3;y=Math.sqrt(m[3*b+b]-m[3*x+x]-m[3*E+E]+1),_[b]=.5*y,y=.5/y,_[3]=(m[3*x+E]-m[3*E+x])*y,_[x]=(m[3*x+b]+m[3*b+x])*y,_[E]=(m[3*E+b]+m[3*b+E])*y}return _}e.clone=i.clone,e.fromValues=i.fromValues,e.copy=i.copy,e.set=i.set,e.add=i.add,e.mul=h,e.scale=i.scale,e.dot=i.dot,e.lerp=i.lerp;var u=e.length=i.length,d=(e.len=u,e.squaredLength=i.squaredLength),f=(e.sqrLen=d,e.normalize=i.normalize);e.exactEquals=i.exactEquals,e.equals=i.equals,e.rotationTo=function(){var _=s.create(),m=s.fromValues(1,0,0),v=s.fromValues(0,1,0);return function(y,b,x){var E=s.dot(b,x);return E<-.999999?(s.cross(_,m,b),s.len(_)<1e-6&&s.cross(_,v,b),s.normalize(_,_),c(y,_,Math.PI),y):E>.999999?(y[0]=0,y[1]=0,y[2]=0,y[3]=1,y):(s.cross(_,b,x),y[0]=_[0],y[1]=_[1],y[2]=_[2],y[3]=1+E,f(y,y))}}(),e.sqlerp=function(){var _=a(),m=a();return function(v,y,b,x,E,T){return g(_,y,E,T),g(m,b,x,T),g(v,_,m,2*T*(1-T)),v}}(),e.setAxes=function(){var _=o.create();return function(m,v,y,b){return _[0]=y[0],_[3]=y[1],_[6]=y[2],_[1]=b[0],_[4]=b[1],_[7]=b[2],_[2]=-v[0],_[5]=-v[1],_[8]=-v[2],f(m,p(m,_))}}()},function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sub=e.mul=void 0,e.create=function(){var a=new r.ARRAY_TYPE(16);return r.ARRAY_TYPE!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},e.clone=function(a){var c=new r.ARRAY_TYPE(16);return c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[4]=a[4],c[5]=a[5],c[6]=a[6],c[7]=a[7],c[8]=a[8],c[9]=a[9],c[10]=a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15],c},e.copy=function(a,c){return a[0]=c[0],a[1]=c[1],a[2]=c[2],a[3]=c[3],a[4]=c[4],a[5]=c[5],a[6]=c[6],a[7]=c[7],a[8]=c[8],a[9]=c[9],a[10]=c[10],a[11]=c[11],a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15],a},e.fromValues=function(a,c,h,g,p,u,d,f,_,m,v,y,b,x,E,T){var M=new r.ARRAY_TYPE(16);return M[0]=a,M[1]=c,M[2]=h,M[3]=g,M[4]=p,M[5]=u,M[6]=d,M[7]=f,M[8]=_,M[9]=m,M[10]=v,M[11]=y,M[12]=b,M[13]=x,M[14]=E,M[15]=T,M},e.set=function(a,c,h,g,p,u,d,f,_,m,v,y,b,x,E,T,M){return a[0]=c,a[1]=h,a[2]=g,a[3]=p,a[4]=u,a[5]=d,a[6]=f,a[7]=_,a[8]=m,a[9]=v,a[10]=y,a[11]=b,a[12]=x,a[13]=E,a[14]=T,a[15]=M,a},e.identity=o,e.transpose=function(a,c){if(a===c){var h=c[1],g=c[2],p=c[3],u=c[6],d=c[7],f=c[11];a[1]=c[4],a[2]=c[8],a[3]=c[12],a[4]=h,a[6]=c[9],a[7]=c[13],a[8]=g,a[9]=u,a[11]=c[14],a[12]=p,a[13]=d,a[14]=f}else a[0]=c[0],a[1]=c[4],a[2]=c[8],a[3]=c[12],a[4]=c[1],a[5]=c[5],a[6]=c[9],a[7]=c[13],a[8]=c[2],a[9]=c[6],a[10]=c[10],a[11]=c[14],a[12]=c[3],a[13]=c[7],a[14]=c[11],a[15]=c[15];return a},e.invert=function(a,c){var h=c[0],g=c[1],p=c[2],u=c[3],d=c[4],f=c[5],_=c[6],m=c[7],v=c[8],y=c[9],b=c[10],x=c[11],E=c[12],T=c[13],M=c[14],D=c[15],U=h*f-g*d,L=h*_-p*d,se=h*m-u*d,$=g*_-p*f,H=g*m-u*f,ae=p*m-u*_,ue=v*T-y*E,me=v*M-b*E,Ue=v*D-x*E,st=y*M-b*T,ft=y*D-x*T,Ze=b*D-x*M,gt=U*Ze-L*ft+se*st+$*Ue-H*me+ae*ue;return gt?(gt=1/gt,a[0]=(f*Ze-_*ft+m*st)*gt,a[1]=(p*ft-g*Ze-u*st)*gt,a[2]=(T*ae-M*H+D*$)*gt,a[3]=(b*H-y*ae-x*$)*gt,a[4]=(_*Ue-d*Ze-m*me)*gt,a[5]=(h*Ze-p*Ue+u*me)*gt,a[6]=(M*se-E*ae-D*L)*gt,a[7]=(v*ae-b*se+x*L)*gt,a[8]=(d*ft-f*Ue+m*ue)*gt,a[9]=(g*Ue-h*ft-u*ue)*gt,a[10]=(E*H-T*se+D*U)*gt,a[11]=(y*se-v*H-x*U)*gt,a[12]=(f*me-d*st-_*ue)*gt,a[13]=(h*st-g*me+p*ue)*gt,a[14]=(T*L-E*$-M*U)*gt,a[15]=(v*$-y*L+b*U)*gt,a):null},e.adjoint=function(a,c){var h=c[0],g=c[1],p=c[2],u=c[3],d=c[4],f=c[5],_=c[6],m=c[7],v=c[8],y=c[9],b=c[10],x=c[11],E=c[12],T=c[13],M=c[14],D=c[15];return a[0]=f*(b*D-x*M)-y*(_*D-m*M)+T*(_*x-m*b),a[1]=-(g*(b*D-x*M)-y*(p*D-u*M)+T*(p*x-u*b)),a[2]=g*(_*D-m*M)-f*(p*D-u*M)+T*(p*m-u*_),a[3]=-(g*(_*x-m*b)-f*(p*x-u*b)+y*(p*m-u*_)),a[4]=-(d*(b*D-x*M)-v*(_*D-m*M)+E*(_*x-m*b)),a[5]=h*(b*D-x*M)-v*(p*D-u*M)+E*(p*x-u*b),a[6]=-(h*(_*D-m*M)-d*(p*D-u*M)+E*(p*m-u*_)),a[7]=h*(_*x-m*b)-d*(p*x-u*b)+v*(p*m-u*_),a[8]=d*(y*D-x*T)-v*(f*D-m*T)+E*(f*x-m*y),a[9]=-(h*(y*D-x*T)-v*(g*D-u*T)+E*(g*x-u*y)),a[10]=h*(f*D-m*T)-d*(g*D-u*T)+E*(g*m-u*f),a[11]=-(h*(f*x-m*y)-d*(g*x-u*y)+v*(g*m-u*f)),a[12]=-(d*(y*M-b*T)-v*(f*M-_*T)+E*(f*b-_*y)),a[13]=h*(y*M-b*T)-v*(g*M-p*T)+E*(g*b-p*y),a[14]=-(h*(f*M-_*T)-d*(g*M-p*T)+E*(g*_-p*f)),a[15]=h*(f*b-_*y)-d*(g*b-p*y)+v*(g*_-p*f),a},e.determinant=function(a){var c=a[0],h=a[1],g=a[2],p=a[3],u=a[4],d=a[5],f=a[6],_=a[7],m=a[8],v=a[9],y=a[10],b=a[11],x=a[12],E=a[13],T=a[14],M=a[15];return(c*d-h*u)*(y*M-b*T)-(c*f-g*u)*(v*M-b*E)+(c*_-p*u)*(v*T-y*E)+(h*f-g*d)*(m*M-b*x)-(h*_-p*d)*(m*T-y*x)+(g*_-p*f)*(m*E-v*x)},e.multiply=s,e.translate=function(a,c,h){var g=h[0],p=h[1],u=h[2],d=void 0,f=void 0,_=void 0,m=void 0,v=void 0,y=void 0,b=void 0,x=void 0,E=void 0,T=void 0,M=void 0,D=void 0;return c===a?(a[12]=c[0]*g+c[4]*p+c[8]*u+c[12],a[13]=c[1]*g+c[5]*p+c[9]*u+c[13],a[14]=c[2]*g+c[6]*p+c[10]*u+c[14],a[15]=c[3]*g+c[7]*p+c[11]*u+c[15]):(d=c[0],f=c[1],_=c[2],m=c[3],v=c[4],y=c[5],b=c[6],x=c[7],E=c[8],T=c[9],M=c[10],D=c[11],a[0]=d,a[1]=f,a[2]=_,a[3]=m,a[4]=v,a[5]=y,a[6]=b,a[7]=x,a[8]=E,a[9]=T,a[10]=M,a[11]=D,a[12]=d*g+v*p+E*u+c[12],a[13]=f*g+y*p+T*u+c[13],a[14]=_*g+b*p+M*u+c[14],a[15]=m*g+x*p+D*u+c[15]),a},e.scale=function(a,c,h){var g=h[0],p=h[1],u=h[2];return a[0]=c[0]*g,a[1]=c[1]*g,a[2]=c[2]*g,a[3]=c[3]*g,a[4]=c[4]*p,a[5]=c[5]*p,a[6]=c[6]*p,a[7]=c[7]*p,a[8]=c[8]*u,a[9]=c[9]*u,a[10]=c[10]*u,a[11]=c[11]*u,a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15],a},e.rotate=function(a,c,h,g){var p=g[0],u=g[1],d=g[2],f=Math.sqrt(p*p+u*u+d*d),_=void 0,m=void 0,v=void 0,y=void 0,b=void 0,x=void 0,E=void 0,T=void 0,M=void 0,D=void 0,U=void 0,L=void 0,se=void 0,$=void 0,H=void 0,ae=void 0,ue=void 0,me=void 0,Ue=void 0,st=void 0,ft=void 0,Ze=void 0,gt=void 0,ce=void 0;return f<r.EPSILON?null:(p*=f=1/f,u*=f,d*=f,_=Math.sin(h),m=Math.cos(h),v=1-m,y=c[0],b=c[1],x=c[2],E=c[3],T=c[4],M=c[5],D=c[6],U=c[7],L=c[8],se=c[9],$=c[10],H=c[11],ae=p*p*v+m,ue=u*p*v+d*_,me=d*p*v-u*_,Ue=p*u*v-d*_,st=u*u*v+m,ft=d*u*v+p*_,Ze=p*d*v+u*_,gt=u*d*v-p*_,ce=d*d*v+m,a[0]=y*ae+T*ue+L*me,a[1]=b*ae+M*ue+se*me,a[2]=x*ae+D*ue+$*me,a[3]=E*ae+U*ue+H*me,a[4]=y*Ue+T*st+L*ft,a[5]=b*Ue+M*st+se*ft,a[6]=x*Ue+D*st+$*ft,a[7]=E*Ue+U*st+H*ft,a[8]=y*Ze+T*gt+L*ce,a[9]=b*Ze+M*gt+se*ce,a[10]=x*Ze+D*gt+$*ce,a[11]=E*Ze+U*gt+H*ce,c!==a&&(a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15]),a)},e.rotateX=function(a,c,h){var g=Math.sin(h),p=Math.cos(h),u=c[4],d=c[5],f=c[6],_=c[7],m=c[8],v=c[9],y=c[10],b=c[11];return c!==a&&(a[0]=c[0],a[1]=c[1],a[2]=c[2],a[3]=c[3],a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15]),a[4]=u*p+m*g,a[5]=d*p+v*g,a[6]=f*p+y*g,a[7]=_*p+b*g,a[8]=m*p-u*g,a[9]=v*p-d*g,a[10]=y*p-f*g,a[11]=b*p-_*g,a},e.rotateY=function(a,c,h){var g=Math.sin(h),p=Math.cos(h),u=c[0],d=c[1],f=c[2],_=c[3],m=c[8],v=c[9],y=c[10],b=c[11];return c!==a&&(a[4]=c[4],a[5]=c[5],a[6]=c[6],a[7]=c[7],a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15]),a[0]=u*p-m*g,a[1]=d*p-v*g,a[2]=f*p-y*g,a[3]=_*p-b*g,a[8]=u*g+m*p,a[9]=d*g+v*p,a[10]=f*g+y*p,a[11]=_*g+b*p,a},e.rotateZ=function(a,c,h){var g=Math.sin(h),p=Math.cos(h),u=c[0],d=c[1],f=c[2],_=c[3],m=c[4],v=c[5],y=c[6],b=c[7];return c!==a&&(a[8]=c[8],a[9]=c[9],a[10]=c[10],a[11]=c[11],a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15]),a[0]=u*p+m*g,a[1]=d*p+v*g,a[2]=f*p+y*g,a[3]=_*p+b*g,a[4]=m*p-u*g,a[5]=v*p-d*g,a[6]=y*p-f*g,a[7]=b*p-_*g,a},e.fromTranslation=function(a,c){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=c[0],a[13]=c[1],a[14]=c[2],a[15]=1,a},e.fromScaling=function(a,c){return a[0]=c[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=c[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=c[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},e.fromRotation=function(a,c,h){var g=h[0],p=h[1],u=h[2],d=Math.sqrt(g*g+p*p+u*u),f=void 0,_=void 0,m=void 0;return d<r.EPSILON?null:(g*=d=1/d,p*=d,u*=d,f=Math.sin(c),_=Math.cos(c),m=1-_,a[0]=g*g*m+_,a[1]=p*g*m+u*f,a[2]=u*g*m-p*f,a[3]=0,a[4]=g*p*m-u*f,a[5]=p*p*m+_,a[6]=u*p*m+g*f,a[7]=0,a[8]=g*u*m+p*f,a[9]=p*u*m-g*f,a[10]=u*u*m+_,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a)},e.fromXRotation=function(a,c){var h=Math.sin(c),g=Math.cos(c);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=g,a[6]=h,a[7]=0,a[8]=0,a[9]=-h,a[10]=g,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},e.fromYRotation=function(a,c){var h=Math.sin(c),g=Math.cos(c);return a[0]=g,a[1]=0,a[2]=-h,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=h,a[9]=0,a[10]=g,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},e.fromZRotation=function(a,c){var h=Math.sin(c),g=Math.cos(c);return a[0]=g,a[1]=h,a[2]=0,a[3]=0,a[4]=-h,a[5]=g,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},e.fromRotationTranslation=i,e.fromQuat2=function(a,c){var h=new r.ARRAY_TYPE(3),g=-c[0],p=-c[1],u=-c[2],d=c[3],f=c[4],_=c[5],m=c[6],v=c[7],y=g*g+p*p+u*u+d*d;return y>0?(h[0]=2*(f*d+v*g+_*u-m*p)/y,h[1]=2*(_*d+v*p+m*g-f*u)/y,h[2]=2*(m*d+v*u+f*p-_*g)/y):(h[0]=2*(f*d+v*g+_*u-m*p),h[1]=2*(_*d+v*p+m*g-f*u),h[2]=2*(m*d+v*u+f*p-_*g)),i(a,c,h),a},e.getTranslation=function(a,c){return a[0]=c[12],a[1]=c[13],a[2]=c[14],a},e.getScaling=function(a,c){var h=c[0],g=c[1],p=c[2],u=c[4],d=c[5],f=c[6],_=c[8],m=c[9],v=c[10];return a[0]=Math.sqrt(h*h+g*g+p*p),a[1]=Math.sqrt(u*u+d*d+f*f),a[2]=Math.sqrt(_*_+m*m+v*v),a},e.getRotation=function(a,c){var h=c[0]+c[5]+c[10],g=0;return h>0?(g=2*Math.sqrt(h+1),a[3]=.25*g,a[0]=(c[6]-c[9])/g,a[1]=(c[8]-c[2])/g,a[2]=(c[1]-c[4])/g):c[0]>c[5]&&c[0]>c[10]?(g=2*Math.sqrt(1+c[0]-c[5]-c[10]),a[3]=(c[6]-c[9])/g,a[0]=.25*g,a[1]=(c[1]+c[4])/g,a[2]=(c[8]+c[2])/g):c[5]>c[10]?(g=2*Math.sqrt(1+c[5]-c[0]-c[10]),a[3]=(c[8]-c[2])/g,a[0]=(c[1]+c[4])/g,a[1]=.25*g,a[2]=(c[6]+c[9])/g):(g=2*Math.sqrt(1+c[10]-c[0]-c[5]),a[3]=(c[1]-c[4])/g,a[0]=(c[8]+c[2])/g,a[1]=(c[6]+c[9])/g,a[2]=.25*g),a},e.fromRotationTranslationScale=function(a,c,h,g){var p=c[0],u=c[1],d=c[2],f=c[3],_=p+p,m=u+u,v=d+d,y=p*_,b=p*m,x=p*v,E=u*m,T=u*v,M=d*v,D=f*_,U=f*m,L=f*v,se=g[0],$=g[1],H=g[2];return a[0]=(1-(E+M))*se,a[1]=(b+L)*se,a[2]=(x-U)*se,a[3]=0,a[4]=(b-L)*$,a[5]=(1-(y+M))*$,a[6]=(T+D)*$,a[7]=0,a[8]=(x+U)*H,a[9]=(T-D)*H,a[10]=(1-(y+E))*H,a[11]=0,a[12]=h[0],a[13]=h[1],a[14]=h[2],a[15]=1,a},e.fromRotationTranslationScaleOrigin=function(a,c,h,g,p){var u=c[0],d=c[1],f=c[2],_=c[3],m=u+u,v=d+d,y=f+f,b=u*m,x=u*v,E=u*y,T=d*v,M=d*y,D=f*y,U=_*m,L=_*v,se=_*y,$=g[0],H=g[1],ae=g[2],ue=p[0],me=p[1],Ue=p[2],st=(1-(T+D))*$,ft=(x+se)*$,Ze=(E-L)*$,gt=(x-se)*H,ce=(1-(b+D))*H,oe=(M+U)*H,yt=(E+L)*ae,X=(M-U)*ae,Tt=(1-(b+T))*ae;return a[0]=st,a[1]=ft,a[2]=Ze,a[3]=0,a[4]=gt,a[5]=ce,a[6]=oe,a[7]=0,a[8]=yt,a[9]=X,a[10]=Tt,a[11]=0,a[12]=h[0]+ue-(st*ue+gt*me+yt*Ue),a[13]=h[1]+me-(ft*ue+ce*me+X*Ue),a[14]=h[2]+Ue-(Ze*ue+oe*me+Tt*Ue),a[15]=1,a},e.fromQuat=function(a,c){var h=c[0],g=c[1],p=c[2],u=c[3],d=h+h,f=g+g,_=p+p,m=h*d,v=g*d,y=g*f,b=p*d,x=p*f,E=p*_,T=u*d,M=u*f,D=u*_;return a[0]=1-y-E,a[1]=v+D,a[2]=b-M,a[3]=0,a[4]=v-D,a[5]=1-m-E,a[6]=x+T,a[7]=0,a[8]=b+M,a[9]=x-T,a[10]=1-m-y,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},e.frustum=function(a,c,h,g,p,u,d){var f=1/(h-c),_=1/(p-g),m=1/(u-d);return a[0]=2*u*f,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=2*u*_,a[6]=0,a[7]=0,a[8]=(h+c)*f,a[9]=(p+g)*_,a[10]=(d+u)*m,a[11]=-1,a[12]=0,a[13]=0,a[14]=d*u*2*m,a[15]=0,a},e.perspective=function(a,c,h,g,p){var u=1/Math.tan(c/2),d=void 0;return a[0]=u/h,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=u,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,p!=null&&p!==1/0?(d=1/(g-p),a[10]=(p+g)*d,a[14]=2*p*g*d):(a[10]=-1,a[14]=-2*g),a},e.perspectiveFromFieldOfView=function(a,c,h,g){var p=Math.tan(c.upDegrees*Math.PI/180),u=Math.tan(c.downDegrees*Math.PI/180),d=Math.tan(c.leftDegrees*Math.PI/180),f=Math.tan(c.rightDegrees*Math.PI/180),_=2/(d+f),m=2/(p+u);return a[0]=_,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=m,a[6]=0,a[7]=0,a[8]=-(d-f)*_*.5,a[9]=(p-u)*m*.5,a[10]=g/(h-g),a[11]=-1,a[12]=0,a[13]=0,a[14]=g*h/(h-g),a[15]=0,a},e.ortho=function(a,c,h,g,p,u,d){var f=1/(c-h),_=1/(g-p),m=1/(u-d);return a[0]=-2*f,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*_,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*m,a[11]=0,a[12]=(c+h)*f,a[13]=(p+g)*_,a[14]=(d+u)*m,a[15]=1,a},e.lookAt=function(a,c,h,g){var p=void 0,u=void 0,d=void 0,f=void 0,_=void 0,m=void 0,v=void 0,y=void 0,b=void 0,x=void 0,E=c[0],T=c[1],M=c[2],D=g[0],U=g[1],L=g[2],se=h[0],$=h[1],H=h[2];return Math.abs(E-se)<r.EPSILON&&Math.abs(T-$)<r.EPSILON&&Math.abs(M-H)<r.EPSILON?o(a):(v=E-se,y=T-$,b=M-H,x=1/Math.sqrt(v*v+y*y+b*b),p=U*(b*=x)-L*(y*=x),u=L*(v*=x)-D*b,d=D*y-U*v,(x=Math.sqrt(p*p+u*u+d*d))?(p*=x=1/x,u*=x,d*=x):(p=0,u=0,d=0),f=y*d-b*u,_=b*p-v*d,m=v*u-y*p,(x=Math.sqrt(f*f+_*_+m*m))?(f*=x=1/x,_*=x,m*=x):(f=0,_=0,m=0),a[0]=p,a[1]=f,a[2]=v,a[3]=0,a[4]=u,a[5]=_,a[6]=y,a[7]=0,a[8]=d,a[9]=m,a[10]=b,a[11]=0,a[12]=-(p*E+u*T+d*M),a[13]=-(f*E+_*T+m*M),a[14]=-(v*E+y*T+b*M),a[15]=1,a)},e.targetTo=function(a,c,h,g){var p=c[0],u=c[1],d=c[2],f=g[0],_=g[1],m=g[2],v=p-h[0],y=u-h[1],b=d-h[2],x=v*v+y*y+b*b;x>0&&(x=1/Math.sqrt(x),v*=x,y*=x,b*=x);var E=_*b-m*y,T=m*v-f*b,M=f*y-_*v;return(x=E*E+T*T+M*M)>0&&(x=1/Math.sqrt(x),E*=x,T*=x,M*=x),a[0]=E,a[1]=T,a[2]=M,a[3]=0,a[4]=y*M-b*T,a[5]=b*E-v*M,a[6]=v*T-y*E,a[7]=0,a[8]=v,a[9]=y,a[10]=b,a[11]=0,a[12]=p,a[13]=u,a[14]=d,a[15]=1,a},e.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"},e.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))},e.add=function(a,c,h){return a[0]=c[0]+h[0],a[1]=c[1]+h[1],a[2]=c[2]+h[2],a[3]=c[3]+h[3],a[4]=c[4]+h[4],a[5]=c[5]+h[5],a[6]=c[6]+h[6],a[7]=c[7]+h[7],a[8]=c[8]+h[8],a[9]=c[9]+h[9],a[10]=c[10]+h[10],a[11]=c[11]+h[11],a[12]=c[12]+h[12],a[13]=c[13]+h[13],a[14]=c[14]+h[14],a[15]=c[15]+h[15],a},e.subtract=l,e.multiplyScalar=function(a,c,h){return a[0]=c[0]*h,a[1]=c[1]*h,a[2]=c[2]*h,a[3]=c[3]*h,a[4]=c[4]*h,a[5]=c[5]*h,a[6]=c[6]*h,a[7]=c[7]*h,a[8]=c[8]*h,a[9]=c[9]*h,a[10]=c[10]*h,a[11]=c[11]*h,a[12]=c[12]*h,a[13]=c[13]*h,a[14]=c[14]*h,a[15]=c[15]*h,a},e.multiplyScalarAndAdd=function(a,c,h,g){return a[0]=c[0]+h[0]*g,a[1]=c[1]+h[1]*g,a[2]=c[2]+h[2]*g,a[3]=c[3]+h[3]*g,a[4]=c[4]+h[4]*g,a[5]=c[5]+h[5]*g,a[6]=c[6]+h[6]*g,a[7]=c[7]+h[7]*g,a[8]=c[8]+h[8]*g,a[9]=c[9]+h[9]*g,a[10]=c[10]+h[10]*g,a[11]=c[11]+h[11]*g,a[12]=c[12]+h[12]*g,a[13]=c[13]+h[13]*g,a[14]=c[14]+h[14]*g,a[15]=c[15]+h[15]*g,a},e.exactEquals=function(a,c){return a[0]===c[0]&&a[1]===c[1]&&a[2]===c[2]&&a[3]===c[3]&&a[4]===c[4]&&a[5]===c[5]&&a[6]===c[6]&&a[7]===c[7]&&a[8]===c[8]&&a[9]===c[9]&&a[10]===c[10]&&a[11]===c[11]&&a[12]===c[12]&&a[13]===c[13]&&a[14]===c[14]&&a[15]===c[15]},e.equals=function(a,c){var h=a[0],g=a[1],p=a[2],u=a[3],d=a[4],f=a[5],_=a[6],m=a[7],v=a[8],y=a[9],b=a[10],x=a[11],E=a[12],T=a[13],M=a[14],D=a[15],U=c[0],L=c[1],se=c[2],$=c[3],H=c[4],ae=c[5],ue=c[6],me=c[7],Ue=c[8],st=c[9],ft=c[10],Ze=c[11],gt=c[12],ce=c[13],oe=c[14],yt=c[15];return Math.abs(h-U)<=r.EPSILON*Math.max(1,Math.abs(h),Math.abs(U))&&Math.abs(g-L)<=r.EPSILON*Math.max(1,Math.abs(g),Math.abs(L))&&Math.abs(p-se)<=r.EPSILON*Math.max(1,Math.abs(p),Math.abs(se))&&Math.abs(u-$)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs($))&&Math.abs(d-H)<=r.EPSILON*Math.max(1,Math.abs(d),Math.abs(H))&&Math.abs(f-ae)<=r.EPSILON*Math.max(1,Math.abs(f),Math.abs(ae))&&Math.abs(_-ue)<=r.EPSILON*Math.max(1,Math.abs(_),Math.abs(ue))&&Math.abs(m-me)<=r.EPSILON*Math.max(1,Math.abs(m),Math.abs(me))&&Math.abs(v-Ue)<=r.EPSILON*Math.max(1,Math.abs(v),Math.abs(Ue))&&Math.abs(y-st)<=r.EPSILON*Math.max(1,Math.abs(y),Math.abs(st))&&Math.abs(b-ft)<=r.EPSILON*Math.max(1,Math.abs(b),Math.abs(ft))&&Math.abs(x-Ze)<=r.EPSILON*Math.max(1,Math.abs(x),Math.abs(Ze))&&Math.abs(E-gt)<=r.EPSILON*Math.max(1,Math.abs(E),Math.abs(gt))&&Math.abs(T-ce)<=r.EPSILON*Math.max(1,Math.abs(T),Math.abs(ce))&&Math.abs(M-oe)<=r.EPSILON*Math.max(1,Math.abs(M),Math.abs(oe))&&Math.abs(D-yt)<=r.EPSILON*Math.max(1,Math.abs(D),Math.abs(yt))};var r=function(a){if(a&&a.__esModule)return a;var c={};if(a!=null)for(var h in a)Object.prototype.hasOwnProperty.call(a,h)&&(c[h]=a[h]);return c.default=a,c}(t(0));function o(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function s(a,c,h){var g=c[0],p=c[1],u=c[2],d=c[3],f=c[4],_=c[5],m=c[6],v=c[7],y=c[8],b=c[9],x=c[10],E=c[11],T=c[12],M=c[13],D=c[14],U=c[15],L=h[0],se=h[1],$=h[2],H=h[3];return a[0]=L*g+se*f+$*y+H*T,a[1]=L*p+se*_+$*b+H*M,a[2]=L*u+se*m+$*x+H*D,a[3]=L*d+se*v+$*E+H*U,L=h[4],se=h[5],$=h[6],H=h[7],a[4]=L*g+se*f+$*y+H*T,a[5]=L*p+se*_+$*b+H*M,a[6]=L*u+se*m+$*x+H*D,a[7]=L*d+se*v+$*E+H*U,L=h[8],se=h[9],$=h[10],H=h[11],a[8]=L*g+se*f+$*y+H*T,a[9]=L*p+se*_+$*b+H*M,a[10]=L*u+se*m+$*x+H*D,a[11]=L*d+se*v+$*E+H*U,L=h[12],se=h[13],$=h[14],H=h[15],a[12]=L*g+se*f+$*y+H*T,a[13]=L*p+se*_+$*b+H*M,a[14]=L*u+se*m+$*x+H*D,a[15]=L*d+se*v+$*E+H*U,a}function i(a,c,h){var g=c[0],p=c[1],u=c[2],d=c[3],f=g+g,_=p+p,m=u+u,v=g*f,y=g*_,b=g*m,x=p*_,E=p*m,T=u*m,M=d*f,D=d*_,U=d*m;return a[0]=1-(x+T),a[1]=y+U,a[2]=b-D,a[3]=0,a[4]=y-U,a[5]=1-(v+T),a[6]=E+M,a[7]=0,a[8]=b+D,a[9]=E-M,a[10]=1-(v+x),a[11]=0,a[12]=h[0],a[13]=h[1],a[14]=h[2],a[15]=1,a}function l(a,c,h){return a[0]=c[0]-h[0],a[1]=c[1]-h[1],a[2]=c[2]-h[2],a[3]=c[3]-h[3],a[4]=c[4]-h[4],a[5]=c[5]-h[5],a[6]=c[6]-h[6],a[7]=c[7]-h[7],a[8]=c[8]-h[8],a[9]=c[9]-h[9],a[10]=c[10]-h[10],a[11]=c[11]-h[11],a[12]=c[12]-h[12],a[13]=c[13]-h[13],a[14]=c[14]-h[14],a[15]=c[15]-h[15],a}e.mul=s,e.sub=l},function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sub=e.mul=void 0,e.create=function(){var i=new r.ARRAY_TYPE(9);return r.ARRAY_TYPE!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i},e.fromMat4=function(i,l){return i[0]=l[0],i[1]=l[1],i[2]=l[2],i[3]=l[4],i[4]=l[5],i[5]=l[6],i[6]=l[8],i[7]=l[9],i[8]=l[10],i},e.clone=function(i){var l=new r.ARRAY_TYPE(9);return l[0]=i[0],l[1]=i[1],l[2]=i[2],l[3]=i[3],l[4]=i[4],l[5]=i[5],l[6]=i[6],l[7]=i[7],l[8]=i[8],l},e.copy=function(i,l){return i[0]=l[0],i[1]=l[1],i[2]=l[2],i[3]=l[3],i[4]=l[4],i[5]=l[5],i[6]=l[6],i[7]=l[7],i[8]=l[8],i},e.fromValues=function(i,l,a,c,h,g,p,u,d){var f=new r.ARRAY_TYPE(9);return f[0]=i,f[1]=l,f[2]=a,f[3]=c,f[4]=h,f[5]=g,f[6]=p,f[7]=u,f[8]=d,f},e.set=function(i,l,a,c,h,g,p,u,d,f){return i[0]=l,i[1]=a,i[2]=c,i[3]=h,i[4]=g,i[5]=p,i[6]=u,i[7]=d,i[8]=f,i},e.identity=function(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=1,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},e.transpose=function(i,l){if(i===l){var a=l[1],c=l[2],h=l[5];i[1]=l[3],i[2]=l[6],i[3]=a,i[5]=l[7],i[6]=c,i[7]=h}else i[0]=l[0],i[1]=l[3],i[2]=l[6],i[3]=l[1],i[4]=l[4],i[5]=l[7],i[6]=l[2],i[7]=l[5],i[8]=l[8];return i},e.invert=function(i,l){var a=l[0],c=l[1],h=l[2],g=l[3],p=l[4],u=l[5],d=l[6],f=l[7],_=l[8],m=_*p-u*f,v=-_*g+u*d,y=f*g-p*d,b=a*m+c*v+h*y;return b?(b=1/b,i[0]=m*b,i[1]=(-_*c+h*f)*b,i[2]=(u*c-h*p)*b,i[3]=v*b,i[4]=(_*a-h*d)*b,i[5]=(-u*a+h*g)*b,i[6]=y*b,i[7]=(-f*a+c*d)*b,i[8]=(p*a-c*g)*b,i):null},e.adjoint=function(i,l){var a=l[0],c=l[1],h=l[2],g=l[3],p=l[4],u=l[5],d=l[6],f=l[7],_=l[8];return i[0]=p*_-u*f,i[1]=h*f-c*_,i[2]=c*u-h*p,i[3]=u*d-g*_,i[4]=a*_-h*d,i[5]=h*g-a*u,i[6]=g*f-p*d,i[7]=c*d-a*f,i[8]=a*p-c*g,i},e.determinant=function(i){var l=i[0],a=i[1],c=i[2],h=i[3],g=i[4],p=i[5],u=i[6],d=i[7],f=i[8];return l*(f*g-p*d)+a*(-f*h+p*u)+c*(d*h-g*u)},e.multiply=o,e.translate=function(i,l,a){var c=l[0],h=l[1],g=l[2],p=l[3],u=l[4],d=l[5],f=l[6],_=l[7],m=l[8],v=a[0],y=a[1];return i[0]=c,i[1]=h,i[2]=g,i[3]=p,i[4]=u,i[5]=d,i[6]=v*c+y*p+f,i[7]=v*h+y*u+_,i[8]=v*g+y*d+m,i},e.rotate=function(i,l,a){var c=l[0],h=l[1],g=l[2],p=l[3],u=l[4],d=l[5],f=l[6],_=l[7],m=l[8],v=Math.sin(a),y=Math.cos(a);return i[0]=y*c+v*p,i[1]=y*h+v*u,i[2]=y*g+v*d,i[3]=y*p-v*c,i[4]=y*u-v*h,i[5]=y*d-v*g,i[6]=f,i[7]=_,i[8]=m,i},e.scale=function(i,l,a){var c=a[0],h=a[1];return i[0]=c*l[0],i[1]=c*l[1],i[2]=c*l[2],i[3]=h*l[3],i[4]=h*l[4],i[5]=h*l[5],i[6]=l[6],i[7]=l[7],i[8]=l[8],i},e.fromTranslation=function(i,l){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=1,i[5]=0,i[6]=l[0],i[7]=l[1],i[8]=1,i},e.fromRotation=function(i,l){var a=Math.sin(l),c=Math.cos(l);return i[0]=c,i[1]=a,i[2]=0,i[3]=-a,i[4]=c,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},e.fromScaling=function(i,l){return i[0]=l[0],i[1]=0,i[2]=0,i[3]=0,i[4]=l[1],i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},e.fromMat2d=function(i,l){return i[0]=l[0],i[1]=l[1],i[2]=0,i[3]=l[2],i[4]=l[3],i[5]=0,i[6]=l[4],i[7]=l[5],i[8]=1,i},e.fromQuat=function(i,l){var a=l[0],c=l[1],h=l[2],g=l[3],p=a+a,u=c+c,d=h+h,f=a*p,_=c*p,m=c*u,v=h*p,y=h*u,b=h*d,x=g*p,E=g*u,T=g*d;return i[0]=1-m-b,i[3]=_-T,i[6]=v+E,i[1]=_+T,i[4]=1-f-b,i[7]=y-x,i[2]=v-E,i[5]=y+x,i[8]=1-f-m,i},e.normalFromMat4=function(i,l){var a=l[0],c=l[1],h=l[2],g=l[3],p=l[4],u=l[5],d=l[6],f=l[7],_=l[8],m=l[9],v=l[10],y=l[11],b=l[12],x=l[13],E=l[14],T=l[15],M=a*u-c*p,D=a*d-h*p,U=a*f-g*p,L=c*d-h*u,se=c*f-g*u,$=h*f-g*d,H=_*x-m*b,ae=_*E-v*b,ue=_*T-y*b,me=m*E-v*x,Ue=m*T-y*x,st=v*T-y*E,ft=M*st-D*Ue+U*me+L*ue-se*ae+$*H;return ft?(ft=1/ft,i[0]=(u*st-d*Ue+f*me)*ft,i[1]=(d*ue-p*st-f*ae)*ft,i[2]=(p*Ue-u*ue+f*H)*ft,i[3]=(h*Ue-c*st-g*me)*ft,i[4]=(a*st-h*ue+g*ae)*ft,i[5]=(c*ue-a*Ue-g*H)*ft,i[6]=(x*$-E*se+T*L)*ft,i[7]=(E*U-b*$-T*D)*ft,i[8]=(b*se-x*U+T*M)*ft,i):null},e.projection=function(i,l,a){return i[0]=2/l,i[1]=0,i[2]=0,i[3]=0,i[4]=-2/a,i[5]=0,i[6]=-1,i[7]=1,i[8]=1,i},e.str=function(i){return"mat3("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+", "+i[4]+", "+i[5]+", "+i[6]+", "+i[7]+", "+i[8]+")"},e.frob=function(i){return Math.sqrt(Math.pow(i[0],2)+Math.pow(i[1],2)+Math.pow(i[2],2)+Math.pow(i[3],2)+Math.pow(i[4],2)+Math.pow(i[5],2)+Math.pow(i[6],2)+Math.pow(i[7],2)+Math.pow(i[8],2))},e.add=function(i,l,a){return i[0]=l[0]+a[0],i[1]=l[1]+a[1],i[2]=l[2]+a[2],i[3]=l[3]+a[3],i[4]=l[4]+a[4],i[5]=l[5]+a[5],i[6]=l[6]+a[6],i[7]=l[7]+a[7],i[8]=l[8]+a[8],i},e.subtract=s,e.multiplyScalar=function(i,l,a){return i[0]=l[0]*a,i[1]=l[1]*a,i[2]=l[2]*a,i[3]=l[3]*a,i[4]=l[4]*a,i[5]=l[5]*a,i[6]=l[6]*a,i[7]=l[7]*a,i[8]=l[8]*a,i},e.multiplyScalarAndAdd=function(i,l,a,c){return i[0]=l[0]+a[0]*c,i[1]=l[1]+a[1]*c,i[2]=l[2]+a[2]*c,i[3]=l[3]+a[3]*c,i[4]=l[4]+a[4]*c,i[5]=l[5]+a[5]*c,i[6]=l[6]+a[6]*c,i[7]=l[7]+a[7]*c,i[8]=l[8]+a[8]*c,i},e.exactEquals=function(i,l){return i[0]===l[0]&&i[1]===l[1]&&i[2]===l[2]&&i[3]===l[3]&&i[4]===l[4]&&i[5]===l[5]&&i[6]===l[6]&&i[7]===l[7]&&i[8]===l[8]},e.equals=function(i,l){var a=i[0],c=i[1],h=i[2],g=i[3],p=i[4],u=i[5],d=i[6],f=i[7],_=i[8],m=l[0],v=l[1],y=l[2],b=l[3],x=l[4],E=l[5],T=l[6],M=l[7],D=l[8];return Math.abs(a-m)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(c-v)<=r.EPSILON*Math.max(1,Math.abs(c),Math.abs(v))&&Math.abs(h-y)<=r.EPSILON*Math.max(1,Math.abs(h),Math.abs(y))&&Math.abs(g-b)<=r.EPSILON*Math.max(1,Math.abs(g),Math.abs(b))&&Math.abs(p-x)<=r.EPSILON*Math.max(1,Math.abs(p),Math.abs(x))&&Math.abs(u-E)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(d-T)<=r.EPSILON*Math.max(1,Math.abs(d),Math.abs(T))&&Math.abs(f-M)<=r.EPSILON*Math.max(1,Math.abs(f),Math.abs(M))&&Math.abs(_-D)<=r.EPSILON*Math.max(1,Math.abs(_),Math.abs(D))};var r=function(i){if(i&&i.__esModule)return i;var l={};if(i!=null)for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(l[a]=i[a]);return l.default=i,l}(t(0));function o(i,l,a){var c=l[0],h=l[1],g=l[2],p=l[3],u=l[4],d=l[5],f=l[6],_=l[7],m=l[8],v=a[0],y=a[1],b=a[2],x=a[3],E=a[4],T=a[5],M=a[6],D=a[7],U=a[8];return i[0]=v*c+y*p+b*f,i[1]=v*h+y*u+b*_,i[2]=v*g+y*d+b*m,i[3]=x*c+E*p+T*f,i[4]=x*h+E*u+T*_,i[5]=x*g+E*d+T*m,i[6]=M*c+D*p+U*f,i[7]=M*h+D*u+U*_,i[8]=M*g+D*d+U*m,i}function s(i,l,a){return i[0]=l[0]-a[0],i[1]=l[1]-a[1],i[2]=l[2]-a[2],i[3]=l[3]-a[3],i[4]=l[4]-a[4],i[5]=l[5]-a[5],i[6]=l[6]-a[6],i[7]=l[7]-a[7],i[8]=l[8]-a[8],i}e.mul=o,e.sub=s},function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.forEach=e.sqrLen=e.sqrDist=e.dist=e.div=e.mul=e.sub=e.len=void 0,e.create=o,e.clone=function(p){var u=new r.ARRAY_TYPE(2);return u[0]=p[0],u[1]=p[1],u},e.fromValues=function(p,u){var d=new r.ARRAY_TYPE(2);return d[0]=p,d[1]=u,d},e.copy=function(p,u){return p[0]=u[0],p[1]=u[1],p},e.set=function(p,u,d){return p[0]=u,p[1]=d,p},e.add=function(p,u,d){return p[0]=u[0]+d[0],p[1]=u[1]+d[1],p},e.subtract=s,e.multiply=i,e.divide=l,e.ceil=function(p,u){return p[0]=Math.ceil(u[0]),p[1]=Math.ceil(u[1]),p},e.floor=function(p,u){return p[0]=Math.floor(u[0]),p[1]=Math.floor(u[1]),p},e.min=function(p,u,d){return p[0]=Math.min(u[0],d[0]),p[1]=Math.min(u[1],d[1]),p},e.max=function(p,u,d){return p[0]=Math.max(u[0],d[0]),p[1]=Math.max(u[1],d[1]),p},e.round=function(p,u){return p[0]=Math.round(u[0]),p[1]=Math.round(u[1]),p},e.scale=function(p,u,d){return p[0]=u[0]*d,p[1]=u[1]*d,p},e.scaleAndAdd=function(p,u,d,f){return p[0]=u[0]+d[0]*f,p[1]=u[1]+d[1]*f,p},e.distance=a,e.squaredDistance=c,e.length=h,e.squaredLength=g,e.negate=function(p,u){return p[0]=-u[0],p[1]=-u[1],p},e.inverse=function(p,u){return p[0]=1/u[0],p[1]=1/u[1],p},e.normalize=function(p,u){var d=u[0],f=u[1],_=d*d+f*f;return _>0&&(_=1/Math.sqrt(_),p[0]=u[0]*_,p[1]=u[1]*_),p},e.dot=function(p,u){return p[0]*u[0]+p[1]*u[1]},e.cross=function(p,u,d){var f=u[0]*d[1]-u[1]*d[0];return p[0]=p[1]=0,p[2]=f,p},e.lerp=function(p,u,d,f){var _=u[0],m=u[1];return p[0]=_+f*(d[0]-_),p[1]=m+f*(d[1]-m),p},e.random=function(p,u){u=u||1;var d=2*r.RANDOM()*Math.PI;return p[0]=Math.cos(d)*u,p[1]=Math.sin(d)*u,p},e.transformMat2=function(p,u,d){var f=u[0],_=u[1];return p[0]=d[0]*f+d[2]*_,p[1]=d[1]*f+d[3]*_,p},e.transformMat2d=function(p,u,d){var f=u[0],_=u[1];return p[0]=d[0]*f+d[2]*_+d[4],p[1]=d[1]*f+d[3]*_+d[5],p},e.transformMat3=function(p,u,d){var f=u[0],_=u[1];return p[0]=d[0]*f+d[3]*_+d[6],p[1]=d[1]*f+d[4]*_+d[7],p},e.transformMat4=function(p,u,d){var f=u[0],_=u[1];return p[0]=d[0]*f+d[4]*_+d[12],p[1]=d[1]*f+d[5]*_+d[13],p},e.rotate=function(p,u,d,f){var _=u[0]-d[0],m=u[1]-d[1],v=Math.sin(f),y=Math.cos(f);return p[0]=_*y-m*v+d[0],p[1]=_*v+m*y+d[1],p},e.angle=function(p,u){var d=p[0],f=p[1],_=u[0],m=u[1],v=d*d+f*f;v>0&&(v=1/Math.sqrt(v));var y=_*_+m*m;y>0&&(y=1/Math.sqrt(y));var b=(d*_+f*m)*v*y;return b>1?0:b<-1?Math.PI:Math.acos(b)},e.str=function(p){return"vec2("+p[0]+", "+p[1]+")"},e.exactEquals=function(p,u){return p[0]===u[0]&&p[1]===u[1]},e.equals=function(p,u){var d=p[0],f=p[1],_=u[0],m=u[1];return Math.abs(d-_)<=r.EPSILON*Math.max(1,Math.abs(d),Math.abs(_))&&Math.abs(f-m)<=r.EPSILON*Math.max(1,Math.abs(f),Math.abs(m))};var r=function(p){if(p&&p.__esModule)return p;var u={};if(p!=null)for(var d in p)Object.prototype.hasOwnProperty.call(p,d)&&(u[d]=p[d]);return u.default=p,u}(t(0));function o(){var p=new r.ARRAY_TYPE(2);return r.ARRAY_TYPE!=Float32Array&&(p[0]=0,p[1]=0),p}function s(p,u,d){return p[0]=u[0]-d[0],p[1]=u[1]-d[1],p}function i(p,u,d){return p[0]=u[0]*d[0],p[1]=u[1]*d[1],p}function l(p,u,d){return p[0]=u[0]/d[0],p[1]=u[1]/d[1],p}function a(p,u){var d=u[0]-p[0],f=u[1]-p[1];return Math.sqrt(d*d+f*f)}function c(p,u){var d=u[0]-p[0],f=u[1]-p[1];return d*d+f*f}function h(p){var u=p[0],d=p[1];return Math.sqrt(u*u+d*d)}function g(p){var u=p[0],d=p[1];return u*u+d*d}e.len=h,e.sub=s,e.mul=i,e.div=l,e.dist=a,e.sqrDist=c,e.sqrLen=g,e.forEach=function(){var p=o();return function(u,d,f,_,m,v){var y=void 0,b=void 0;for(d||(d=2),f||(f=0),b=_?Math.min(_*d+f,u.length):u.length,y=f;y<b;y+=d)p[0]=u[y],p[1]=u[y+1],m(p,p,v),u[y]=p[0],u[y+1]=p[1];return u}}()},function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sqrLen=e.squaredLength=e.len=e.length=e.dot=e.mul=e.setReal=e.getReal=void 0,e.create=function(){var u=new r.ARRAY_TYPE(8);return r.ARRAY_TYPE!=Float32Array&&(u[0]=0,u[1]=0,u[2]=0,u[4]=0,u[5]=0,u[6]=0,u[7]=0),u[3]=1,u},e.clone=function(u){var d=new r.ARRAY_TYPE(8);return d[0]=u[0],d[1]=u[1],d[2]=u[2],d[3]=u[3],d[4]=u[4],d[5]=u[5],d[6]=u[6],d[7]=u[7],d},e.fromValues=function(u,d,f,_,m,v,y,b){var x=new r.ARRAY_TYPE(8);return x[0]=u,x[1]=d,x[2]=f,x[3]=_,x[4]=m,x[5]=v,x[6]=y,x[7]=b,x},e.fromRotationTranslationValues=function(u,d,f,_,m,v,y){var b=new r.ARRAY_TYPE(8);b[0]=u,b[1]=d,b[2]=f,b[3]=_;var x=.5*m,E=.5*v,T=.5*y;return b[4]=x*_+E*f-T*d,b[5]=E*_+T*u-x*f,b[6]=T*_+x*d-E*u,b[7]=-x*u-E*d-T*f,b},e.fromRotationTranslation=l,e.fromTranslation=function(u,d){return u[0]=0,u[1]=0,u[2]=0,u[3]=1,u[4]=.5*d[0],u[5]=.5*d[1],u[6]=.5*d[2],u[7]=0,u},e.fromRotation=function(u,d){return u[0]=d[0],u[1]=d[1],u[2]=d[2],u[3]=d[3],u[4]=0,u[5]=0,u[6]=0,u[7]=0,u},e.fromMat4=function(u,d){var f=o.create();s.getRotation(f,d);var _=new r.ARRAY_TYPE(3);return s.getTranslation(_,d),l(u,f,_),u},e.copy=a,e.identity=function(u){return u[0]=0,u[1]=0,u[2]=0,u[3]=1,u[4]=0,u[5]=0,u[6]=0,u[7]=0,u},e.set=function(u,d,f,_,m,v,y,b,x){return u[0]=d,u[1]=f,u[2]=_,u[3]=m,u[4]=v,u[5]=y,u[6]=b,u[7]=x,u},e.getDual=function(u,d){return u[0]=d[4],u[1]=d[5],u[2]=d[6],u[3]=d[7],u},e.setDual=function(u,d){return u[4]=d[0],u[5]=d[1],u[6]=d[2],u[7]=d[3],u},e.getTranslation=function(u,d){var f=d[4],_=d[5],m=d[6],v=d[7],y=-d[0],b=-d[1],x=-d[2],E=d[3];return u[0]=2*(f*E+v*y+_*x-m*b),u[1]=2*(_*E+v*b+m*y-f*x),u[2]=2*(m*E+v*x+f*b-_*y),u},e.translate=function(u,d,f){var _=d[0],m=d[1],v=d[2],y=d[3],b=.5*f[0],x=.5*f[1],E=.5*f[2],T=d[4],M=d[5],D=d[6],U=d[7];return u[0]=_,u[1]=m,u[2]=v,u[3]=y,u[4]=y*b+m*E-v*x+T,u[5]=y*x+v*b-_*E+M,u[6]=y*E+_*x-m*b+D,u[7]=-_*b-m*x-v*E+U,u},e.rotateX=function(u,d,f){var _=-d[0],m=-d[1],v=-d[2],y=d[3],b=d[4],x=d[5],E=d[6],T=d[7],M=b*y+T*_+x*v-E*m,D=x*y+T*m+E*_-b*v,U=E*y+T*v+b*m-x*_,L=T*y-b*_-x*m-E*v;return o.rotateX(u,d,f),_=u[0],m=u[1],v=u[2],y=u[3],u[4]=M*y+L*_+D*v-U*m,u[5]=D*y+L*m+U*_-M*v,u[6]=U*y+L*v+M*m-D*_,u[7]=L*y-M*_-D*m-U*v,u},e.rotateY=function(u,d,f){var _=-d[0],m=-d[1],v=-d[2],y=d[3],b=d[4],x=d[5],E=d[6],T=d[7],M=b*y+T*_+x*v-E*m,D=x*y+T*m+E*_-b*v,U=E*y+T*v+b*m-x*_,L=T*y-b*_-x*m-E*v;return o.rotateY(u,d,f),_=u[0],m=u[1],v=u[2],y=u[3],u[4]=M*y+L*_+D*v-U*m,u[5]=D*y+L*m+U*_-M*v,u[6]=U*y+L*v+M*m-D*_,u[7]=L*y-M*_-D*m-U*v,u},e.rotateZ=function(u,d,f){var _=-d[0],m=-d[1],v=-d[2],y=d[3],b=d[4],x=d[5],E=d[6],T=d[7],M=b*y+T*_+x*v-E*m,D=x*y+T*m+E*_-b*v,U=E*y+T*v+b*m-x*_,L=T*y-b*_-x*m-E*v;return o.rotateZ(u,d,f),_=u[0],m=u[1],v=u[2],y=u[3],u[4]=M*y+L*_+D*v-U*m,u[5]=D*y+L*m+U*_-M*v,u[6]=U*y+L*v+M*m-D*_,u[7]=L*y-M*_-D*m-U*v,u},e.rotateByQuatAppend=function(u,d,f){var _=f[0],m=f[1],v=f[2],y=f[3],b=d[0],x=d[1],E=d[2],T=d[3];return u[0]=b*y+T*_+x*v-E*m,u[1]=x*y+T*m+E*_-b*v,u[2]=E*y+T*v+b*m-x*_,u[3]=T*y-b*_-x*m-E*v,b=d[4],x=d[5],E=d[6],T=d[7],u[4]=b*y+T*_+x*v-E*m,u[5]=x*y+T*m+E*_-b*v,u[6]=E*y+T*v+b*m-x*_,u[7]=T*y-b*_-x*m-E*v,u},e.rotateByQuatPrepend=function(u,d,f){var _=d[0],m=d[1],v=d[2],y=d[3],b=f[0],x=f[1],E=f[2],T=f[3];return u[0]=_*T+y*b+m*E-v*x,u[1]=m*T+y*x+v*b-_*E,u[2]=v*T+y*E+_*x-m*b,u[3]=y*T-_*b-m*x-v*E,b=f[4],x=f[5],E=f[6],T=f[7],u[4]=_*T+y*b+m*E-v*x,u[5]=m*T+y*x+v*b-_*E,u[6]=v*T+y*E+_*x-m*b,u[7]=y*T-_*b-m*x-v*E,u},e.rotateAroundAxis=function(u,d,f,_){if(Math.abs(_)<r.EPSILON)return a(u,d);var m=Math.sqrt(f[0]*f[0]+f[1]*f[1]+f[2]*f[2]);_*=.5;var v=Math.sin(_),y=v*f[0]/m,b=v*f[1]/m,x=v*f[2]/m,E=Math.cos(_),T=d[0],M=d[1],D=d[2],U=d[3];u[0]=T*E+U*y+M*x-D*b,u[1]=M*E+U*b+D*y-T*x,u[2]=D*E+U*x+T*b-M*y,u[3]=U*E-T*y-M*b-D*x;var L=d[4],se=d[5],$=d[6],H=d[7];return u[4]=L*E+H*y+se*x-$*b,u[5]=se*E+H*b+$*y-L*x,u[6]=$*E+H*x+L*b-se*y,u[7]=H*E-L*y-se*b-$*x,u},e.add=function(u,d,f){return u[0]=d[0]+f[0],u[1]=d[1]+f[1],u[2]=d[2]+f[2],u[3]=d[3]+f[3],u[4]=d[4]+f[4],u[5]=d[5]+f[5],u[6]=d[6]+f[6],u[7]=d[7]+f[7],u},e.multiply=c,e.scale=function(u,d,f){return u[0]=d[0]*f,u[1]=d[1]*f,u[2]=d[2]*f,u[3]=d[3]*f,u[4]=d[4]*f,u[5]=d[5]*f,u[6]=d[6]*f,u[7]=d[7]*f,u},e.lerp=function(u,d,f,_){var m=1-_;return h(d,f)<0&&(_=-_),u[0]=d[0]*m+f[0]*_,u[1]=d[1]*m+f[1]*_,u[2]=d[2]*m+f[2]*_,u[3]=d[3]*m+f[3]*_,u[4]=d[4]*m+f[4]*_,u[5]=d[5]*m+f[5]*_,u[6]=d[6]*m+f[6]*_,u[7]=d[7]*m+f[7]*_,u},e.invert=function(u,d){var f=p(d);return u[0]=-d[0]/f,u[1]=-d[1]/f,u[2]=-d[2]/f,u[3]=d[3]/f,u[4]=-d[4]/f,u[5]=-d[5]/f,u[6]=-d[6]/f,u[7]=d[7]/f,u},e.conjugate=function(u,d){return u[0]=-d[0],u[1]=-d[1],u[2]=-d[2],u[3]=d[3],u[4]=-d[4],u[5]=-d[5],u[6]=-d[6],u[7]=d[7],u},e.normalize=function(u,d){var f=p(d);if(f>0){f=Math.sqrt(f);var _=d[0]/f,m=d[1]/f,v=d[2]/f,y=d[3]/f,b=d[4],x=d[5],E=d[6],T=d[7],M=_*b+m*x+v*E+y*T;u[0]=_,u[1]=m,u[2]=v,u[3]=y,u[4]=(b-_*M)/f,u[5]=(x-m*M)/f,u[6]=(E-v*M)/f,u[7]=(T-y*M)/f}return u},e.str=function(u){return"quat2("+u[0]+", "+u[1]+", "+u[2]+", "+u[3]+", "+u[4]+", "+u[5]+", "+u[6]+", "+u[7]+")"},e.exactEquals=function(u,d){return u[0]===d[0]&&u[1]===d[1]&&u[2]===d[2]&&u[3]===d[3]&&u[4]===d[4]&&u[5]===d[5]&&u[6]===d[6]&&u[7]===d[7]},e.equals=function(u,d){var f=u[0],_=u[1],m=u[2],v=u[3],y=u[4],b=u[5],x=u[6],E=u[7],T=d[0],M=d[1],D=d[2],U=d[3],L=d[4],se=d[5],$=d[6],H=d[7];return Math.abs(f-T)<=r.EPSILON*Math.max(1,Math.abs(f),Math.abs(T))&&Math.abs(_-M)<=r.EPSILON*Math.max(1,Math.abs(_),Math.abs(M))&&Math.abs(m-D)<=r.EPSILON*Math.max(1,Math.abs(m),Math.abs(D))&&Math.abs(v-U)<=r.EPSILON*Math.max(1,Math.abs(v),Math.abs(U))&&Math.abs(y-L)<=r.EPSILON*Math.max(1,Math.abs(y),Math.abs(L))&&Math.abs(b-se)<=r.EPSILON*Math.max(1,Math.abs(b),Math.abs(se))&&Math.abs(x-$)<=r.EPSILON*Math.max(1,Math.abs(x),Math.abs($))&&Math.abs(E-H)<=r.EPSILON*Math.max(1,Math.abs(E),Math.abs(H))};var r=i(t(0)),o=i(t(3)),s=i(t(4));function i(u){if(u&&u.__esModule)return u;var d={};if(u!=null)for(var f in u)Object.prototype.hasOwnProperty.call(u,f)&&(d[f]=u[f]);return d.default=u,d}function l(u,d,f){var _=.5*f[0],m=.5*f[1],v=.5*f[2],y=d[0],b=d[1],x=d[2],E=d[3];return u[0]=y,u[1]=b,u[2]=x,u[3]=E,u[4]=_*E+m*x-v*b,u[5]=m*E+v*y-_*x,u[6]=v*E+_*b-m*y,u[7]=-_*y-m*b-v*x,u}function a(u,d){return u[0]=d[0],u[1]=d[1],u[2]=d[2],u[3]=d[3],u[4]=d[4],u[5]=d[5],u[6]=d[6],u[7]=d[7],u}e.getReal=o.copy,e.setReal=o.copy;function c(u,d,f){var _=d[0],m=d[1],v=d[2],y=d[3],b=f[4],x=f[5],E=f[6],T=f[7],M=d[4],D=d[5],U=d[6],L=d[7],se=f[0],$=f[1],H=f[2],ae=f[3];return u[0]=_*ae+y*se+m*H-v*$,u[1]=m*ae+y*$+v*se-_*H,u[2]=v*ae+y*H+_*$-m*se,u[3]=y*ae-_*se-m*$-v*H,u[4]=_*T+y*b+m*E-v*x+M*ae+L*se+D*H-U*$,u[5]=m*T+y*x+v*b-_*E+D*ae+L*$+U*se-M*H,u[6]=v*T+y*E+_*x-m*b+U*ae+L*H+M*$-D*se,u[7]=y*T-_*b-m*x-v*E+L*ae-M*se-D*$-U*H,u}e.mul=c;var h=e.dot=o.dot,g=e.length=o.length,p=(e.len=g,e.squaredLength=o.squaredLength);e.sqrLen=p},function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sub=e.mul=void 0,e.create=function(){var i=new r.ARRAY_TYPE(6);return r.ARRAY_TYPE!=Float32Array&&(i[1]=0,i[2]=0,i[4]=0,i[5]=0),i[0]=1,i[3]=1,i},e.clone=function(i){var l=new r.ARRAY_TYPE(6);return l[0]=i[0],l[1]=i[1],l[2]=i[2],l[3]=i[3],l[4]=i[4],l[5]=i[5],l},e.copy=function(i,l){return i[0]=l[0],i[1]=l[1],i[2]=l[2],i[3]=l[3],i[4]=l[4],i[5]=l[5],i},e.identity=function(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=1,i[4]=0,i[5]=0,i},e.fromValues=function(i,l,a,c,h,g){var p=new r.ARRAY_TYPE(6);return p[0]=i,p[1]=l,p[2]=a,p[3]=c,p[4]=h,p[5]=g,p},e.set=function(i,l,a,c,h,g,p){return i[0]=l,i[1]=a,i[2]=c,i[3]=h,i[4]=g,i[5]=p,i},e.invert=function(i,l){var a=l[0],c=l[1],h=l[2],g=l[3],p=l[4],u=l[5],d=a*g-c*h;return d?(d=1/d,i[0]=g*d,i[1]=-c*d,i[2]=-h*d,i[3]=a*d,i[4]=(h*u-g*p)*d,i[5]=(c*p-a*u)*d,i):null},e.determinant=function(i){return i[0]*i[3]-i[1]*i[2]},e.multiply=o,e.rotate=function(i,l,a){var c=l[0],h=l[1],g=l[2],p=l[3],u=l[4],d=l[5],f=Math.sin(a),_=Math.cos(a);return i[0]=c*_+g*f,i[1]=h*_+p*f,i[2]=c*-f+g*_,i[3]=h*-f+p*_,i[4]=u,i[5]=d,i},e.scale=function(i,l,a){var c=l[0],h=l[1],g=l[2],p=l[3],u=l[4],d=l[5],f=a[0],_=a[1];return i[0]=c*f,i[1]=h*f,i[2]=g*_,i[3]=p*_,i[4]=u,i[5]=d,i},e.translate=function(i,l,a){var c=l[0],h=l[1],g=l[2],p=l[3],u=l[4],d=l[5],f=a[0],_=a[1];return i[0]=c,i[1]=h,i[2]=g,i[3]=p,i[4]=c*f+g*_+u,i[5]=h*f+p*_+d,i},e.fromRotation=function(i,l){var a=Math.sin(l),c=Math.cos(l);return i[0]=c,i[1]=a,i[2]=-a,i[3]=c,i[4]=0,i[5]=0,i},e.fromScaling=function(i,l){return i[0]=l[0],i[1]=0,i[2]=0,i[3]=l[1],i[4]=0,i[5]=0,i},e.fromTranslation=function(i,l){return i[0]=1,i[1]=0,i[2]=0,i[3]=1,i[4]=l[0],i[5]=l[1],i},e.str=function(i){return"mat2d("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+", "+i[4]+", "+i[5]+")"},e.frob=function(i){return Math.sqrt(Math.pow(i[0],2)+Math.pow(i[1],2)+Math.pow(i[2],2)+Math.pow(i[3],2)+Math.pow(i[4],2)+Math.pow(i[5],2)+1)},e.add=function(i,l,a){return i[0]=l[0]+a[0],i[1]=l[1]+a[1],i[2]=l[2]+a[2],i[3]=l[3]+a[3],i[4]=l[4]+a[4],i[5]=l[5]+a[5],i},e.subtract=s,e.multiplyScalar=function(i,l,a){return i[0]=l[0]*a,i[1]=l[1]*a,i[2]=l[2]*a,i[3]=l[3]*a,i[4]=l[4]*a,i[5]=l[5]*a,i},e.multiplyScalarAndAdd=function(i,l,a,c){return i[0]=l[0]+a[0]*c,i[1]=l[1]+a[1]*c,i[2]=l[2]+a[2]*c,i[3]=l[3]+a[3]*c,i[4]=l[4]+a[4]*c,i[5]=l[5]+a[5]*c,i},e.exactEquals=function(i,l){return i[0]===l[0]&&i[1]===l[1]&&i[2]===l[2]&&i[3]===l[3]&&i[4]===l[4]&&i[5]===l[5]},e.equals=function(i,l){var a=i[0],c=i[1],h=i[2],g=i[3],p=i[4],u=i[5],d=l[0],f=l[1],_=l[2],m=l[3],v=l[4],y=l[5];return Math.abs(a-d)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(c-f)<=r.EPSILON*Math.max(1,Math.abs(c),Math.abs(f))&&Math.abs(h-_)<=r.EPSILON*Math.max(1,Math.abs(h),Math.abs(_))&&Math.abs(g-m)<=r.EPSILON*Math.max(1,Math.abs(g),Math.abs(m))&&Math.abs(p-v)<=r.EPSILON*Math.max(1,Math.abs(p),Math.abs(v))&&Math.abs(u-y)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(y))};var r=function(i){if(i&&i.__esModule)return i;var l={};if(i!=null)for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(l[a]=i[a]);return l.default=i,l}(t(0));function o(i,l,a){var c=l[0],h=l[1],g=l[2],p=l[3],u=l[4],d=l[5],f=a[0],_=a[1],m=a[2],v=a[3],y=a[4],b=a[5];return i[0]=c*f+g*_,i[1]=h*f+p*_,i[2]=c*m+g*v,i[3]=h*m+p*v,i[4]=c*y+g*b+u,i[5]=h*y+p*b+d,i}function s(i,l,a){return i[0]=l[0]-a[0],i[1]=l[1]-a[1],i[2]=l[2]-a[2],i[3]=l[3]-a[3],i[4]=l[4]-a[4],i[5]=l[5]-a[5],i}e.mul=o,e.sub=s},function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sub=e.mul=void 0,e.create=function(){var i=new r.ARRAY_TYPE(4);return r.ARRAY_TYPE!=Float32Array&&(i[1]=0,i[2]=0),i[0]=1,i[3]=1,i},e.clone=function(i){var l=new r.ARRAY_TYPE(4);return l[0]=i[0],l[1]=i[1],l[2]=i[2],l[3]=i[3],l},e.copy=function(i,l){return i[0]=l[0],i[1]=l[1],i[2]=l[2],i[3]=l[3],i},e.identity=function(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=1,i},e.fromValues=function(i,l,a,c){var h=new r.ARRAY_TYPE(4);return h[0]=i,h[1]=l,h[2]=a,h[3]=c,h},e.set=function(i,l,a,c,h){return i[0]=l,i[1]=a,i[2]=c,i[3]=h,i},e.transpose=function(i,l){if(i===l){var a=l[1];i[1]=l[2],i[2]=a}else i[0]=l[0],i[1]=l[2],i[2]=l[1],i[3]=l[3];return i},e.invert=function(i,l){var a=l[0],c=l[1],h=l[2],g=l[3],p=a*g-h*c;return p?(p=1/p,i[0]=g*p,i[1]=-c*p,i[2]=-h*p,i[3]=a*p,i):null},e.adjoint=function(i,l){var a=l[0];return i[0]=l[3],i[1]=-l[1],i[2]=-l[2],i[3]=a,i},e.determinant=function(i){return i[0]*i[3]-i[2]*i[1]},e.multiply=o,e.rotate=function(i,l,a){var c=l[0],h=l[1],g=l[2],p=l[3],u=Math.sin(a),d=Math.cos(a);return i[0]=c*d+g*u,i[1]=h*d+p*u,i[2]=c*-u+g*d,i[3]=h*-u+p*d,i},e.scale=function(i,l,a){var c=l[0],h=l[1],g=l[2],p=l[3],u=a[0],d=a[1];return i[0]=c*u,i[1]=h*u,i[2]=g*d,i[3]=p*d,i},e.fromRotation=function(i,l){var a=Math.sin(l),c=Math.cos(l);return i[0]=c,i[1]=a,i[2]=-a,i[3]=c,i},e.fromScaling=function(i,l){return i[0]=l[0],i[1]=0,i[2]=0,i[3]=l[1],i},e.str=function(i){return"mat2("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+")"},e.frob=function(i){return Math.sqrt(Math.pow(i[0],2)+Math.pow(i[1],2)+Math.pow(i[2],2)+Math.pow(i[3],2))},e.LDU=function(i,l,a,c){return i[2]=c[2]/c[0],a[0]=c[0],a[1]=c[1],a[3]=c[3]-i[2]*a[1],[i,l,a]},e.add=function(i,l,a){return i[0]=l[0]+a[0],i[1]=l[1]+a[1],i[2]=l[2]+a[2],i[3]=l[3]+a[3],i},e.subtract=s,e.exactEquals=function(i,l){return i[0]===l[0]&&i[1]===l[1]&&i[2]===l[2]&&i[3]===l[3]},e.equals=function(i,l){var a=i[0],c=i[1],h=i[2],g=i[3],p=l[0],u=l[1],d=l[2],f=l[3];return Math.abs(a-p)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(c-u)<=r.EPSILON*Math.max(1,Math.abs(c),Math.abs(u))&&Math.abs(h-d)<=r.EPSILON*Math.max(1,Math.abs(h),Math.abs(d))&&Math.abs(g-f)<=r.EPSILON*Math.max(1,Math.abs(g),Math.abs(f))},e.multiplyScalar=function(i,l,a){return i[0]=l[0]*a,i[1]=l[1]*a,i[2]=l[2]*a,i[3]=l[3]*a,i},e.multiplyScalarAndAdd=function(i,l,a,c){return i[0]=l[0]+a[0]*c,i[1]=l[1]+a[1]*c,i[2]=l[2]+a[2]*c,i[3]=l[3]+a[3]*c,i};var r=function(i){if(i&&i.__esModule)return i;var l={};if(i!=null)for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(l[a]=i[a]);return l.default=i,l}(t(0));function o(i,l,a){var c=l[0],h=l[1],g=l[2],p=l[3],u=a[0],d=a[1],f=a[2],_=a[3];return i[0]=c*u+g*d,i[1]=h*u+p*d,i[2]=c*f+g*_,i[3]=h*f+p*_,i}function s(i,l,a){return i[0]=l[0]-a[0],i[1]=l[1]-a[1],i[2]=l[2]-a[2],i[3]=l[3]-a[3],i}e.mul=o,e.sub=s},function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.vec4=e.vec3=e.vec2=e.quat2=e.quat=e.mat4=e.mat3=e.mat2d=e.mat2=e.glMatrix=void 0;var r=u(t(0)),o=u(t(9)),s=u(t(8)),i=u(t(5)),l=u(t(4)),a=u(t(3)),c=u(t(7)),h=u(t(6)),g=u(t(2)),p=u(t(1));function u(d){if(d&&d.__esModule)return d;var f={};if(d!=null)for(var _ in d)Object.prototype.hasOwnProperty.call(d,_)&&(f[_]=d[_]);return f.default=d,f}e.glMatrix=r,e.mat2=o,e.mat2d=s,e.mat3=i,e.mat4=l,e.quat=a,e.quat2=c,e.vec2=h,e.vec3=g,e.vec4=p}])})});var r3=K((V4e,LN)=>{function BW(n){if(n.length===0)return null;for(var e=n[0].length,t=new Array(e),r=new Array(e),o=0;o<e;o++)t[o]=1/0,r[o]=-1/0;return n.forEach(function(s){for(var i=0;i<e;i++)r[i]=s[i]>r[i]?s[i]:r[i],t[i]=s[i]<t[i]?s[i]:t[i]}),[t,r]}LN.exports=BW});var DN=K((z4e,IN)=>{IN.exports=kW;function kW(){var n=new Float32Array(16);return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}});var kN=K((H4e,BN)=>{BN.exports=FW;function FW(n){var e=new Float32Array(16);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e}});var GN=K((j4e,FN)=>{FN.exports=GW;function GW(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}});var n3=K((q4e,UN)=>{UN.exports=UW;function UW(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}});var zN=K((W4e,VN)=>{VN.exports=VW;function VW(n,e){if(n===e){var t=e[1],r=e[2],o=e[3],s=e[6],i=e[7],l=e[11];n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=t,n[6]=e[9],n[7]=e[13],n[8]=r,n[9]=s,n[11]=e[14],n[12]=o,n[13]=i,n[14]=l}else n[0]=e[0],n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=e[1],n[5]=e[5],n[6]=e[9],n[7]=e[13],n[8]=e[2],n[9]=e[6],n[10]=e[10],n[11]=e[14],n[12]=e[3],n[13]=e[7],n[14]=e[11],n[15]=e[15];return n}});var jN=K(($4e,HN)=>{HN.exports=zW;function zW(n,e){var t=e[0],r=e[1],o=e[2],s=e[3],i=e[4],l=e[5],a=e[6],c=e[7],h=e[8],g=e[9],p=e[10],u=e[11],d=e[12],f=e[13],_=e[14],m=e[15],v=t*l-r*i,y=t*a-o*i,b=t*c-s*i,x=r*a-o*l,E=r*c-s*l,T=o*c-s*a,M=h*f-g*d,D=h*_-p*d,U=h*m-u*d,L=g*_-p*f,se=g*m-u*f,$=p*m-u*_,H=v*$-y*se+b*L+x*U-E*D+T*M;return H?(H=1/H,n[0]=(l*$-a*se+c*L)*H,n[1]=(o*se-r*$-s*L)*H,n[2]=(f*T-_*E+m*x)*H,n[3]=(p*E-g*T-u*x)*H,n[4]=(a*U-i*$-c*D)*H,n[5]=(t*$-o*U+s*D)*H,n[6]=(_*b-d*T-m*y)*H,n[7]=(h*T-p*b+u*y)*H,n[8]=(i*se-l*U+c*M)*H,n[9]=(r*U-t*se-s*M)*H,n[10]=(d*E-f*b+m*v)*H,n[11]=(g*b-h*E-u*v)*H,n[12]=(l*D-i*L-a*M)*H,n[13]=(t*L-r*D+o*M)*H,n[14]=(f*y-d*x-_*v)*H,n[15]=(h*x-g*y+p*v)*H,n):null}});var WN=K((Y4e,qN)=>{qN.exports=HW;function HW(n,e){var t=e[0],r=e[1],o=e[2],s=e[3],i=e[4],l=e[5],a=e[6],c=e[7],h=e[8],g=e[9],p=e[10],u=e[11],d=e[12],f=e[13],_=e[14],m=e[15];return n[0]=l*(p*m-u*_)-g*(a*m-c*_)+f*(a*u-c*p),n[1]=-(r*(p*m-u*_)-g*(o*m-s*_)+f*(o*u-s*p)),n[2]=r*(a*m-c*_)-l*(o*m-s*_)+f*(o*c-s*a),n[3]=-(r*(a*u-c*p)-l*(o*u-s*p)+g*(o*c-s*a)),n[4]=-(i*(p*m-u*_)-h*(a*m-c*_)+d*(a*u-c*p)),n[5]=t*(p*m-u*_)-h*(o*m-s*_)+d*(o*u-s*p),n[6]=-(t*(a*m-c*_)-i*(o*m-s*_)+d*(o*c-s*a)),n[7]=t*(a*u-c*p)-i*(o*u-s*p)+h*(o*c-s*a),n[8]=i*(g*m-u*f)-h*(l*m-c*f)+d*(l*u-c*g),n[9]=-(t*(g*m-u*f)-h*(r*m-s*f)+d*(r*u-s*g)),n[10]=t*(l*m-c*f)-i*(r*m-s*f)+d*(r*c-s*l),n[11]=-(t*(l*u-c*g)-i*(r*u-s*g)+h*(r*c-s*l)),n[12]=-(i*(g*_-p*f)-h*(l*_-a*f)+d*(l*p-a*g)),n[13]=t*(g*_-p*f)-h*(r*_-o*f)+d*(r*p-o*g),n[14]=-(t*(l*_-a*f)-i*(r*_-o*f)+d*(r*a-o*l)),n[15]=t*(l*p-a*g)-i*(r*p-o*g)+h*(r*a-o*l),n}});var YN=K((X4e,$N)=>{$N.exports=jW;function jW(n){var e=n[0],t=n[1],r=n[2],o=n[3],s=n[4],i=n[5],l=n[6],a=n[7],c=n[8],h=n[9],g=n[10],p=n[11],u=n[12],d=n[13],f=n[14],_=n[15],m=e*i-t*s,v=e*l-r*s,y=e*a-o*s,b=t*l-r*i,x=t*a-o*i,E=r*a-o*l,T=c*d-h*u,M=c*f-g*u,D=c*_-p*u,U=h*f-g*d,L=h*_-p*d,se=g*_-p*f;return m*se-v*L+y*U+b*D-x*M+E*T}});var JN=K((J4e,XN)=>{XN.exports=qW;function qW(n,e,t){var r=e[0],o=e[1],s=e[2],i=e[3],l=e[4],a=e[5],c=e[6],h=e[7],g=e[8],p=e[9],u=e[10],d=e[11],f=e[12],_=e[13],m=e[14],v=e[15],y=t[0],b=t[1],x=t[2],E=t[3];return n[0]=y*r+b*l+x*g+E*f,n[1]=y*o+b*a+x*p+E*_,n[2]=y*s+b*c+x*u+E*m,n[3]=y*i+b*h+x*d+E*v,y=t[4],b=t[5],x=t[6],E=t[7],n[4]=y*r+b*l+x*g+E*f,n[5]=y*o+b*a+x*p+E*_,n[6]=y*s+b*c+x*u+E*m,n[7]=y*i+b*h+x*d+E*v,y=t[8],b=t[9],x=t[10],E=t[11],n[8]=y*r+b*l+x*g+E*f,n[9]=y*o+b*a+x*p+E*_,n[10]=y*s+b*c+x*u+E*m,n[11]=y*i+b*h+x*d+E*v,y=t[12],b=t[13],x=t[14],E=t[15],n[12]=y*r+b*l+x*g+E*f,n[13]=y*o+b*a+x*p+E*_,n[14]=y*s+b*c+x*u+E*m,n[15]=y*i+b*h+x*d+E*v,n}});var ZN=K((K4e,KN)=>{KN.exports=WW;function WW(n,e,t){var r=t[0],o=t[1],s=t[2],i,l,a,c,h,g,p,u,d,f,_,m;return e===n?(n[12]=e[0]*r+e[4]*o+e[8]*s+e[12],n[13]=e[1]*r+e[5]*o+e[9]*s+e[13],n[14]=e[2]*r+e[6]*o+e[10]*s+e[14],n[15]=e[3]*r+e[7]*o+e[11]*s+e[15]):(i=e[0],l=e[1],a=e[2],c=e[3],h=e[4],g=e[5],p=e[6],u=e[7],d=e[8],f=e[9],_=e[10],m=e[11],n[0]=i,n[1]=l,n[2]=a,n[3]=c,n[4]=h,n[5]=g,n[6]=p,n[7]=u,n[8]=d,n[9]=f,n[10]=_,n[11]=m,n[12]=i*r+h*o+d*s+e[12],n[13]=l*r+g*o+f*s+e[13],n[14]=a*r+p*o+_*s+e[14],n[15]=c*r+u*o+m*s+e[15]),n}});var eS=K((Z4e,QN)=>{QN.exports=$W;function $W(n,e,t){var r=t[0],o=t[1],s=t[2];return n[0]=e[0]*r,n[1]=e[1]*r,n[2]=e[2]*r,n[3]=e[3]*r,n[4]=e[4]*o,n[5]=e[5]*o,n[6]=e[6]*o,n[7]=e[7]*o,n[8]=e[8]*s,n[9]=e[9]*s,n[10]=e[10]*s,n[11]=e[11]*s,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}});var rS=K((Q4e,tS)=>{tS.exports=YW;function YW(n,e,t,r){var o=r[0],s=r[1],i=r[2],l=Math.sqrt(o*o+s*s+i*i),a,c,h,g,p,u,d,f,_,m,v,y,b,x,E,T,M,D,U,L,se,$,H,ae;return Math.abs(l)<1e-6?null:(l=1/l,o*=l,s*=l,i*=l,a=Math.sin(t),c=Math.cos(t),h=1-c,g=e[0],p=e[1],u=e[2],d=e[3],f=e[4],_=e[5],m=e[6],v=e[7],y=e[8],b=e[9],x=e[10],E=e[11],T=o*o*h+c,M=s*o*h+i*a,D=i*o*h-s*a,U=o*s*h-i*a,L=s*s*h+c,se=i*s*h+o*a,$=o*i*h+s*a,H=s*i*h-o*a,ae=i*i*h+c,n[0]=g*T+f*M+y*D,n[1]=p*T+_*M+b*D,n[2]=u*T+m*M+x*D,n[3]=d*T+v*M+E*D,n[4]=g*U+f*L+y*se,n[5]=p*U+_*L+b*se,n[6]=u*U+m*L+x*se,n[7]=d*U+v*L+E*se,n[8]=g*$+f*H+y*ae,n[9]=p*$+_*H+b*ae,n[10]=u*$+m*H+x*ae,n[11]=d*$+v*H+E*ae,e!==n&&(n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n)}});var oS=K((e5e,nS)=>{nS.exports=XW;function XW(n,e,t){var r=Math.sin(t),o=Math.cos(t),s=e[4],i=e[5],l=e[6],a=e[7],c=e[8],h=e[9],g=e[10],p=e[11];return e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[4]=s*o+c*r,n[5]=i*o+h*r,n[6]=l*o+g*r,n[7]=a*o+p*r,n[8]=c*o-s*r,n[9]=h*o-i*r,n[10]=g*o-l*r,n[11]=p*o-a*r,n}});var sS=K((t5e,iS)=>{iS.exports=JW;function JW(n,e,t){var r=Math.sin(t),o=Math.cos(t),s=e[0],i=e[1],l=e[2],a=e[3],c=e[8],h=e[9],g=e[10],p=e[11];return e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=s*o-c*r,n[1]=i*o-h*r,n[2]=l*o-g*r,n[3]=a*o-p*r,n[8]=s*r+c*o,n[9]=i*r+h*o,n[10]=l*r+g*o,n[11]=a*r+p*o,n}});var lS=K((r5e,aS)=>{aS.exports=KW;function KW(n,e,t){var r=Math.sin(t),o=Math.cos(t),s=e[0],i=e[1],l=e[2],a=e[3],c=e[4],h=e[5],g=e[6],p=e[7];return e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=s*o+c*r,n[1]=i*o+h*r,n[2]=l*o+g*r,n[3]=a*o+p*r,n[4]=c*o-s*r,n[5]=h*o-i*r,n[6]=g*o-l*r,n[7]=p*o-a*r,n}});var uS=K((n5e,cS)=>{cS.exports=ZW;function ZW(n,e,t){var r,o,s,i=t[0],l=t[1],a=t[2],c=Math.sqrt(i*i+l*l+a*a);return Math.abs(c)<1e-6?null:(c=1/c,i*=c,l*=c,a*=c,r=Math.sin(e),o=Math.cos(e),s=1-o,n[0]=i*i*s+o,n[1]=l*i*s+a*r,n[2]=a*i*s-l*r,n[3]=0,n[4]=i*l*s-a*r,n[5]=l*l*s+o,n[6]=a*l*s+i*r,n[7]=0,n[8]=i*a*s+l*r,n[9]=l*a*s-i*r,n[10]=a*a*s+o,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n)}});var dS=K((o5e,pS)=>{pS.exports=QW;function QW(n,e,t){var r=e[0],o=e[1],s=e[2],i=e[3],l=r+r,a=o+o,c=s+s,h=r*l,g=r*a,p=r*c,u=o*a,d=o*c,f=s*c,_=i*l,m=i*a,v=i*c;return n[0]=1-(u+f),n[1]=g+v,n[2]=p-m,n[3]=0,n[4]=g-v,n[5]=1-(h+f),n[6]=d+_,n[7]=0,n[8]=p+m,n[9]=d-_,n[10]=1-(h+u),n[11]=0,n[12]=t[0],n[13]=t[1],n[14]=t[2],n[15]=1,n}});var mS=K((i5e,fS)=>{fS.exports=e$;function e$(n,e){return n[0]=e[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=e[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=e[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}});var _S=K((s5e,hS)=>{hS.exports=t$;function t$(n,e){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=e[0],n[13]=e[1],n[14]=e[2],n[15]=1,n}});var vS=K((a5e,gS)=>{gS.exports=r$;function r$(n,e){var t=Math.sin(e),r=Math.cos(e);return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=r,n[6]=t,n[7]=0,n[8]=0,n[9]=-t,n[10]=r,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}});var bS=K((l5e,yS)=>{yS.exports=n$;function n$(n,e){var t=Math.sin(e),r=Math.cos(e);return n[0]=r,n[1]=0,n[2]=-t,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=t,n[9]=0,n[10]=r,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}});var CS=K((c5e,xS)=>{xS.exports=o$;function o$(n,e){var t=Math.sin(e),r=Math.cos(e);return n[0]=r,n[1]=t,n[2]=0,n[3]=0,n[4]=-t,n[5]=r,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}});var ES=K((u5e,TS)=>{TS.exports=i$;function i$(n,e){var t=e[0],r=e[1],o=e[2],s=e[3],i=t+t,l=r+r,a=o+o,c=t*i,h=r*i,g=r*l,p=o*i,u=o*l,d=o*a,f=s*i,_=s*l,m=s*a;return n[0]=1-g-d,n[1]=h+m,n[2]=p-_,n[3]=0,n[4]=h-m,n[5]=1-c-d,n[6]=u+f,n[7]=0,n[8]=p+_,n[9]=u-f,n[10]=1-c-g,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}});var MS=K((p5e,AS)=>{AS.exports=s$;function s$(n,e,t,r,o,s,i){var l=1/(t-e),a=1/(o-r),c=1/(s-i);return n[0]=s*2*l,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=s*2*a,n[6]=0,n[7]=0,n[8]=(t+e)*l,n[9]=(o+r)*a,n[10]=(i+s)*c,n[11]=-1,n[12]=0,n[13]=0,n[14]=i*s*2*c,n[15]=0,n}});var SS=K((d5e,NS)=>{NS.exports=a$;function a$(n,e,t,r,o){var s=1/Math.tan(e/2),i=1/(r-o);return n[0]=s/t,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=s,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=(o+r)*i,n[11]=-1,n[12]=0,n[13]=0,n[14]=2*o*r*i,n[15]=0,n}});var OS=K((f5e,PS)=>{PS.exports=l$;function l$(n,e,t,r){var o=Math.tan(e.upDegrees*Math.PI/180),s=Math.tan(e.downDegrees*Math.PI/180),i=Math.tan(e.leftDegrees*Math.PI/180),l=Math.tan(e.rightDegrees*Math.PI/180),a=2/(i+l),c=2/(o+s);return n[0]=a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=c,n[6]=0,n[7]=0,n[8]=-((i-l)*a*.5),n[9]=(o-s)*c*.5,n[10]=r/(t-r),n[11]=-1,n[12]=0,n[13]=0,n[14]=r*t/(t-r),n[15]=0,n}});var RS=K((m5e,wS)=>{wS.exports=c$;function c$(n,e,t,r,o,s,i){var l=1/(e-t),a=1/(r-o),c=1/(s-i);return n[0]=-2*l,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*a,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*c,n[11]=0,n[12]=(e+t)*l,n[13]=(o+r)*a,n[14]=(i+s)*c,n[15]=1,n}});var IS=K((h5e,LS)=>{var u$=n3();LS.exports=p$;function p$(n,e,t,r){var o,s,i,l,a,c,h,g,p,u,d=e[0],f=e[1],_=e[2],m=r[0],v=r[1],y=r[2],b=t[0],x=t[1],E=t[2];return Math.abs(d-b)<1e-6&&Math.abs(f-x)<1e-6&&Math.abs(_-E)<1e-6?u$(n):(h=d-b,g=f-x,p=_-E,u=1/Math.sqrt(h*h+g*g+p*p),h*=u,g*=u,p*=u,o=v*p-y*g,s=y*h-m*p,i=m*g-v*h,u=Math.sqrt(o*o+s*s+i*i),u?(u=1/u,o*=u,s*=u,i*=u):(o=0,s=0,i=0),l=g*i-p*s,a=p*o-h*i,c=h*s-g*o,u=Math.sqrt(l*l+a*a+c*c),u?(u=1/u,l*=u,a*=u,c*=u):(l=0,a=0,c=0),n[0]=o,n[1]=l,n[2]=h,n[3]=0,n[4]=s,n[5]=a,n[6]=g,n[7]=0,n[8]=i,n[9]=c,n[10]=p,n[11]=0,n[12]=-(o*d+s*f+i*_),n[13]=-(l*d+a*f+c*_),n[14]=-(h*d+g*f+p*_),n[15]=1,n)}});var BS=K((_5e,DS)=>{DS.exports=d$;function d$(n){return"mat4("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+", "+n[4]+", "+n[5]+", "+n[6]+", "+n[7]+", "+n[8]+", "+n[9]+", "+n[10]+", "+n[11]+", "+n[12]+", "+n[13]+", "+n[14]+", "+n[15]+")"}});var FS=K((g5e,kS)=>{kS.exports={create:DN(),clone:kN(),copy:GN(),identity:n3(),transpose:zN(),invert:jN(),adjoint:WN(),determinant:YN(),multiply:JN(),translate:ZN(),scale:eS(),rotate:rS(),rotateX:oS(),rotateY:sS(),rotateZ:lS(),fromRotation:uS(),fromRotationTranslation:dS(),fromScaling:mS(),fromTranslation:_S(),fromXRotation:vS(),fromYRotation:bS(),fromZRotation:CS(),fromQuat:ES(),frustum:MS(),perspective:SS(),perspectiveFromFieldOfView:OS(),ortho:RS(),lookAt:IS(),str:BS()}});var zS=K((v5e,VS)=>{VS.exports=o3;o3.strict=GS;o3.loose=US;var f$=Object.prototype.toString,m$={"[object Int8Array]":!0,"[object Int16Array]":!0,"[object Int32Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Uint16Array]":!0,"[object Uint32Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0};function o3(n){return GS(n)||US(n)}function GS(n){return n instanceof Int8Array||n instanceof Int16Array||n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray||n instanceof Uint16Array||n instanceof Uint32Array||n instanceof Float32Array||n instanceof Float64Array}function US(n){return m$[f$.call(n)]}});var jS=K((y5e,HS)=>{HS.exports=function(n){if(!n||!n.dtype)return!1;var e=new RegExp("function View[0-9]+d(:?"+n.dtype+")+");return e.test(String(n.constructor))}});var i3=K((b5e,KS)=>{"use strict";var qS=zS(),h$=jS(),WS="array of arrays",$S="array of typed arrays",YS="flat array",XS="typed array",JS="ndarray";KS.exports={identify:_$,ARRAY_OF_ARRAYS:WS,ARRAY_OF_TYPED_ARRAYS:$S,FLAT_ARRAY:YS,TYPED_ARRAY:XS,NDARRAY:JS};function _$(n){if(Array.isArray(n)&&Array.isArray(n[0]))return WS;if(Array.isArray(n)&&qS(n[0]))return $S;if(Array.isArray(n))return YS;if(h$(n))return JS;if(qS(n))return XS;throw new Error("geo-identify-position-format: Could not identify position format.")}});var QS=K((x5e,ZS)=>{"use strict";function g$(n){for(var e=new Array(n),t=0;t<n;++t)e[t]=t;return e}ZS.exports=g$});var rP=K((C5e,tP)=>{tP.exports=function(n){return n!=null&&(eP(n)||v$(n)||!!n._isBuffer)};function eP(n){return!!n.constructor&&typeof n.constructor.isBuffer=="function"&&n.constructor.isBuffer(n)}function v$(n){return typeof n.readFloatLE=="function"&&typeof n.slice=="function"&&eP(n.slice(0,0))}});var oP=K((T5e,nP)=>{var y$=QS(),b$=rP(),x$=typeof Float64Array!="undefined";function C$(n,e){return n[0]-e[0]}function T$(){var n=this.stride,e=new Array(n.length),t;for(t=0;t<e.length;++t)e[t]=[Math.abs(n[t]),t];e.sort(C$);var r=new Array(e.length);for(t=0;t<r.length;++t)r[t]=e[t][1];return r}function E$(n,e){var t=["View",e,"d",n].join("");e<0&&(t="View_Nil"+n);var r=n==="generic";if(e===-1){var o="function "+t+"(a){this.data=a;};var proto="+t+".prototype;proto.dtype='"+n+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+t+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+t+"(a){return new "+t+"(a);}",f=new Function(o);return f()}else if(e===0){var o="function "+t+"(a,d) {this.data = a;this.offset = d};var proto="+t+".prototype;proto.dtype='"+n+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+t+"_copy() {return new "+t+"(this.data,this.offset)};proto.pick=function "+t+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+t+"_get(){return "+(r?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+t+"_set(v){return "+(r?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+t+"(a,b,c,d){return new "+t+"(a,d)}",f=new Function("TrivialArray",o);return f(Bf[n][0])}var o=["'use strict'"],s=y$(e),i=s.map(function(_){return"i"+_}),l="this.offset+"+s.map(function(_){return"this.stride["+_+"]*i"+_}).join("+"),a=s.map(function(_){return"b"+_}).join(","),c=s.map(function(_){return"c"+_}).join(",");o.push("function "+t+"(a,"+a+","+c+",d){this.data=a","this.shape=["+a+"]","this.stride=["+c+"]","this.offset=d|0}","var proto="+t+".prototype","proto.dtype='"+n+"'","proto.dimension="+e),o.push("Object.defineProperty(proto,'size',{get:function "+t+"_size(){return "+s.map(function(_){return"this.shape["+_+"]"}).join("*"),"}})"),e===1?o.push("proto.order=[0]"):(o.push("Object.defineProperty(proto,'order',{get:"),e<4?(o.push("function "+t+"_order(){"),e===2?o.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):e===3&&o.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):o.push("ORDER})")),o.push("proto.set=function "+t+"_set("+i.join(",")+",v){"),r?o.push("return this.data.set("+l+",v)}"):o.push("return this.data["+l+"]=v}"),o.push("proto.get=function "+t+"_get("+i.join(",")+"){"),r?o.push("return this.data.get("+l+")}"):o.push("return this.data["+l+"]}"),o.push("proto.index=function "+t+"_index(",i.join(),"){return "+l+"}"),o.push("proto.hi=function "+t+"_hi("+i.join(",")+"){return new "+t+"(this.data,"+s.map(function(_){return["(typeof i",_,"!=='number'||i",_,"<0)?this.shape[",_,"]:i",_,"|0"].join("")}).join(",")+","+s.map(function(_){return"this.stride["+_+"]"}).join(",")+",this.offset)}");var h=s.map(function(_){return"a"+_+"=this.shape["+_+"]"}),g=s.map(function(_){return"c"+_+"=this.stride["+_+"]"});o.push("proto.lo=function "+t+"_lo("+i.join(",")+"){var b=this.offset,d=0,"+h.join(",")+","+g.join(","));for(var p=0;p<e;++p)o.push("if(typeof i"+p+"==='number'&&i"+p+">=0){d=i"+p+"|0;b+=c"+p+"*d;a"+p+"-=d}");o.push("return new "+t+"(this.data,"+s.map(function(_){return"a"+_}).join(",")+","+s.map(function(_){return"c"+_}).join(",")+",b)}"),o.push("proto.step=function "+t+"_step("+i.join(",")+"){var "+s.map(function(_){return"a"+_+"=this.shape["+_+"]"}).join(",")+","+s.map(function(_){return"b"+_+"=this.stride["+_+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var p=0;p<e;++p)o.push("if(typeof i"+p+"==='number'){d=i"+p+"|0;if(d<0){c+=b"+p+"*(a"+p+"-1);a"+p+"=ceil(-a"+p+"/d)}else{a"+p+"=ceil(a"+p+"/d)}b"+p+"*=d}");o.push("return new "+t+"(this.data,"+s.map(function(_){return"a"+_}).join(",")+","+s.map(function(_){return"b"+_}).join(",")+",c)}");for(var u=new Array(e),d=new Array(e),p=0;p<e;++p)u[p]="a[i"+p+"]",d[p]="b[i"+p+"]";o.push("proto.transpose=function "+t+"_transpose("+i+"){"+i.map(function(_,m){return _+"=("+_+"===undefined?"+m+":"+_+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+t+"(this.data,"+u.join(",")+","+d.join(",")+",this.offset)}"),o.push("proto.pick=function "+t+"_pick("+i+"){var a=[],b=[],c=this.offset");for(var p=0;p<e;++p)o.push("if(typeof i"+p+"==='number'&&i"+p+">=0){c=(c+this.stride["+p+"]*i"+p+")|0}else{a.push(this.shape["+p+"]);b.push(this.stride["+p+"])}");o.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),o.push("return function construct_"+t+"(data,shape,stride,offset){return new "+t+"(data,"+s.map(function(_){return"shape["+_+"]"}).join(",")+","+s.map(function(_){return"stride["+_+"]"}).join(",")+",offset)}");var f=new Function("CTOR_LIST","ORDER",o.join(`
`));return f(Bf[n],T$)}function A$(n){if(b$(n))return"buffer";if(x$)switch(Object.prototype.toString.call(n)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(n)?"array":"generic"}var Bf={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],bigint64:[],biguint64:[],buffer:[],generic:[]};function M$(n,e,t,r){if(n===void 0){var c=Bf.array[0];return c([])}else typeof n=="number"&&(n=[n]);e===void 0&&(e=[n.length]);var o=e.length;if(t===void 0){t=new Array(o);for(var s=o-1,i=1;s>=0;--s)t[s]=i,i*=e[s]}if(r===void 0){r=0;for(var s=0;s<o;++s)t[s]<0&&(r-=(e[s]-1)*t[s])}for(var l=A$(n),a=Bf[l];a.length<=o+1;)a.push(E$(l,a.length-1));var c=a[o+1];return c(n,e,t,r)}nP.exports=M$});var kf=K((E5e,iP)=>{"use strict";var vn=i3(),N$=oP();iP.exports={convert:S$,FLAT_ARRAY:vn.FLAT_ARRAY,ARRAY_OF_ARRAYS:vn.ARRAY_OF_ARRAYS,TYPED_ARRAY:vn.TYPED_ARRAY,ARRAY_OF_TYPED_ARRAYS:vn.ARRAY_OF_TYPED_ARRAYS,NDARRAY:vn.NDARRAY};function S$(n,e,t){e=e===void 0?vn.TYPED_ARRAY:e;var r=[vn.FLAT_ARRAY,vn.ARRAY_OF_ARRAYS,vn.TYPED_ARRAY,vn.ARRAY_OF_TYPED_ARRAYS,vn.NDARRAY];if(r.indexOf(e)===-1)throw new Error("geo-convert-position-format: Unknown target format "+e);var o=vn.identify(n),s;if(o===vn.FLAT_ARRAY)s=new Float32Array(n);else if(o===vn.TYPED_ARRAY)s=new Float32Array(n);else if(o===vn.ARRAY_OF_ARRAYS){s=[];for(var i=0;i<n.length;i++)s.push.apply(s,n[i]);s=new Float32Array(s)}else if(o===vn.ARRAY_OF_TYPED_ARRAYS){s=[];for(var i=0;i<n.length;i++)s.push.apply(s,n[i]);s=new Float32Array(s)}else if(o===vn.NDARRAY)s=new Float32Array(n.data);else throw new Error("geo-convert-position-format: Could not convert from incoming format "+o);if(t===void 0&&(s.length%3==0?t=3:s.length%2==0?t=2:t=1),[1,2,3].indexOf(t)===-1)throw new Error("geo-convert-position-format: Stride "+t+" not a valid stride - must be 1, 2, or 3");if(s.length%t!=0)throw new Error("geo-convert-position-format: Stride "+t+" incompatible with element count "+s.length);if(e===vn.TYPED_ARRAY)return s;if(e===vn.FLAT_ARRAY)return Array.prototype.slice.call(s);if(e===vn.ARRAY_OF_ARRAYS){for(var l=[],i=0,a=0,c=s.length/t;a<c;a++){for(var h=[],g=0;g<t;g++)h.push(s[i++]);l.push(h)}return l}else if(e===vn.ARRAY_OF_TYPED_ARRAYS){for(var l=[],i=0,a=0,c=s.length/t;a<c;a++){for(var h=[],g=0;g<t;g++)h.push(s[i++]);l.push(new Float32Array(h))}return l}else if(e===vn.NDARRAY)return N$(s);throw new Error("geo-convert-position-format: Could not convert to target format "+e)}});var s3=K((A5e,sP)=>{sP.exports=1e-6});var a3=K((M5e,aP)=>{aP.exports=P$;function P$(){var n=new Float32Array(3);return n[0]=0,n[1]=0,n[2]=0,n}});var cP=K((N5e,lP)=>{lP.exports=O$;function O$(n){var e=new Float32Array(3);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e}});var l3=K((S5e,uP)=>{uP.exports=w$;function w$(n,e,t){var r=new Float32Array(3);return r[0]=n,r[1]=e,r[2]=t,r}});var c3=K((P5e,pP)=>{pP.exports=R$;function R$(n,e){var t=e[0],r=e[1],o=e[2],s=t*t+r*r+o*o;return s>0&&(s=1/Math.sqrt(s),n[0]=e[0]*s,n[1]=e[1]*s,n[2]=e[2]*s),n}});var u3=K((O5e,dP)=>{dP.exports=L$;function L$(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}});var _P=K((w5e,hP)=>{hP.exports=D$;var fP=l3(),mP=c3(),I$=u3();function D$(n,e){var t=fP(n[0],n[1],n[2]),r=fP(e[0],e[1],e[2]);mP(t,t),mP(r,r);var o=I$(t,r);return o>1?0:Math.acos(o)}});var vP=K((R5e,gP)=>{gP.exports=B$;function B$(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n}});var bP=K((L5e,yP)=>{yP.exports=k$;function k$(n,e,t,r){return n[0]=e,n[1]=t,n[2]=r,n}});var CP=K((I5e,xP)=>{xP.exports=F$;var p3=s3();function F$(n,e){var t=n[0],r=n[1],o=n[2],s=e[0],i=e[1],l=e[2];return Math.abs(t-s)<=p3*Math.max(1,Math.abs(t),Math.abs(s))&&Math.abs(r-i)<=p3*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(o-l)<=p3*Math.max(1,Math.abs(o),Math.abs(l))}});var EP=K((D5e,TP)=>{TP.exports=G$;function G$(n,e){return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]}});var MP=K((B5e,AP)=>{AP.exports=U$;function U$(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n}});var d3=K((k5e,NP)=>{NP.exports=V$;function V$(n,e,t){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n}});var PP=K((F5e,SP)=>{SP.exports=d3()});var f3=K((G5e,OP)=>{OP.exports=z$;function z$(n,e,t){return n[0]=e[0]*t[0],n[1]=e[1]*t[1],n[2]=e[2]*t[2],n}});var RP=K((U5e,wP)=>{wP.exports=f3()});var m3=K((V5e,LP)=>{LP.exports=H$;function H$(n,e,t){return n[0]=e[0]/t[0],n[1]=e[1]/t[1],n[2]=e[2]/t[2],n}});var DP=K((z5e,IP)=>{IP.exports=m3()});var kP=K((H5e,BP)=>{BP.exports=j$;function j$(n,e,t){return n[0]=Math.min(e[0],t[0]),n[1]=Math.min(e[1],t[1]),n[2]=Math.min(e[2],t[2]),n}});var GP=K((j5e,FP)=>{FP.exports=q$;function q$(n,e,t){return n[0]=Math.max(e[0],t[0]),n[1]=Math.max(e[1],t[1]),n[2]=Math.max(e[2],t[2]),n}});var VP=K((q5e,UP)=>{UP.exports=W$;function W$(n,e){return n[0]=Math.floor(e[0]),n[1]=Math.floor(e[1]),n[2]=Math.floor(e[2]),n}});var HP=K((W5e,zP)=>{zP.exports=$$;function $$(n,e){return n[0]=Math.ceil(e[0]),n[1]=Math.ceil(e[1]),n[2]=Math.ceil(e[2]),n}});var qP=K(($5e,jP)=>{jP.exports=Y$;function Y$(n,e){return n[0]=Math.round(e[0]),n[1]=Math.round(e[1]),n[2]=Math.round(e[2]),n}});var $P=K((Y5e,WP)=>{WP.exports=X$;function X$(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n}});var XP=K((X5e,YP)=>{YP.exports=J$;function J$(n,e,t,r){return n[0]=e[0]+t[0]*r,n[1]=e[1]+t[1]*r,n[2]=e[2]+t[2]*r,n}});var h3=K((J5e,JP)=>{JP.exports=K$;function K$(n,e){var t=e[0]-n[0],r=e[1]-n[1],o=e[2]-n[2];return Math.sqrt(t*t+r*r+o*o)}});var ZP=K((K5e,KP)=>{KP.exports=h3()});var _3=K((Z5e,QP)=>{QP.exports=Z$;function Z$(n,e){var t=e[0]-n[0],r=e[1]-n[1],o=e[2]-n[2];return t*t+r*r+o*o}});var tO=K((Q5e,eO)=>{eO.exports=_3()});var g3=K((e8e,rO)=>{rO.exports=Q$;function Q$(n){var e=n[0],t=n[1],r=n[2];return Math.sqrt(e*e+t*t+r*r)}});var oO=K((t8e,nO)=>{nO.exports=g3()});var v3=K((r8e,iO)=>{iO.exports=eY;function eY(n){var e=n[0],t=n[1],r=n[2];return e*e+t*t+r*r}});var aO=K((n8e,sO)=>{sO.exports=v3()});var cO=K((o8e,lO)=>{lO.exports=tY;function tY(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n}});var pO=K((i8e,uO)=>{uO.exports=rY;function rY(n,e){return n[0]=1/e[0],n[1]=1/e[1],n[2]=1/e[2],n}});var fO=K((s8e,dO)=>{dO.exports=nY;function nY(n,e,t){var r=e[0],o=e[1],s=e[2],i=t[0],l=t[1],a=t[2];return n[0]=o*a-s*l,n[1]=s*i-r*a,n[2]=r*l-o*i,n}});var hO=K((a8e,mO)=>{mO.exports=oY;function oY(n,e,t,r){var o=e[0],s=e[1],i=e[2];return n[0]=o+r*(t[0]-o),n[1]=s+r*(t[1]-s),n[2]=i+r*(t[2]-i),n}});var gO=K((l8e,_O)=>{_O.exports=iY;function iY(n,e){e=e||1;var t=Math.random()*2*Math.PI,r=Math.random()*2-1,o=Math.sqrt(1-r*r)*e;return n[0]=Math.cos(t)*o,n[1]=Math.sin(t)*o,n[2]=r*e,n}});var yO=K((c8e,vO)=>{vO.exports=sY;function sY(n,e,t){var r=e[0],o=e[1],s=e[2],i=t[3]*r+t[7]*o+t[11]*s+t[15];return i=i||1,n[0]=(t[0]*r+t[4]*o+t[8]*s+t[12])/i,n[1]=(t[1]*r+t[5]*o+t[9]*s+t[13])/i,n[2]=(t[2]*r+t[6]*o+t[10]*s+t[14])/i,n}});var xO=K((u8e,bO)=>{bO.exports=aY;function aY(n,e,t){var r=e[0],o=e[1],s=e[2];return n[0]=r*t[0]+o*t[3]+s*t[6],n[1]=r*t[1]+o*t[4]+s*t[7],n[2]=r*t[2]+o*t[5]+s*t[8],n}});var TO=K((p8e,CO)=>{CO.exports=lY;function lY(n,e,t){var r=e[0],o=e[1],s=e[2],i=t[0],l=t[1],a=t[2],c=t[3],h=c*r+l*s-a*o,g=c*o+a*r-i*s,p=c*s+i*o-l*r,u=-i*r-l*o-a*s;return n[0]=h*c+u*-i+g*-a-p*-l,n[1]=g*c+u*-l+p*-i-h*-a,n[2]=p*c+u*-a+h*-l-g*-i,n}});var AO=K((d8e,EO)=>{EO.exports=cY;function cY(n,e,t,r){var o=t[1],s=t[2],i=e[1]-o,l=e[2]-s,a=Math.sin(r),c=Math.cos(r);return n[0]=e[0],n[1]=o+i*c-l*a,n[2]=s+i*a+l*c,n}});var NO=K((f8e,MO)=>{MO.exports=uY;function uY(n,e,t,r){var o=t[0],s=t[2],i=e[0]-o,l=e[2]-s,a=Math.sin(r),c=Math.cos(r);return n[0]=o+l*a+i*c,n[1]=e[1],n[2]=s+l*c-i*a,n}});var PO=K((m8e,SO)=>{SO.exports=pY;function pY(n,e,t,r){var o=t[0],s=t[1],i=e[0]-o,l=e[1]-s,a=Math.sin(r),c=Math.cos(r);return n[0]=o+i*c-l*a,n[1]=s+i*a+l*c,n[2]=e[2],n}});var wO=K((h8e,OO)=>{OO.exports=dY;var J0=a3()();function dY(n,e,t,r,o,s){var i,l;for(e||(e=3),t||(t=0),r?l=Math.min(r*e+t,n.length):l=n.length,i=t;i<l;i+=e)J0[0]=n[i],J0[1]=n[i+1],J0[2]=n[i+2],o(J0,J0,s),n[i]=J0[0],n[i+1]=J0[1],n[i+2]=J0[2];return n}});var LO=K((_8e,RO)=>{RO.exports={EPSILON:s3(),create:a3(),clone:cP(),angle:_P(),fromValues:l3(),copy:vP(),set:bP(),equals:CP(),exactEquals:EP(),add:MP(),subtract:d3(),sub:PP(),multiply:f3(),mul:RP(),divide:m3(),div:DP(),min:kP(),max:GP(),floor:VP(),ceil:HP(),round:qP(),scale:$P(),scaleAndAdd:XP(),distance:h3(),dist:ZP(),squaredDistance:_3(),sqrDist:tO(),length:g3(),len:oO(),squaredLength:v3(),sqrLen:aO(),negate:cO(),inverse:pO(),normalize:c3(),dot:u3(),cross:fO(),lerp:hO(),random:gO(),transformMat4:yO(),transformMat3:xO(),transformQuat:TO(),rotateX:AO(),rotateY:NO(),rotateZ:PO(),forEach:wO()}});var y3=K((g8e,BO)=>{"use strict";var IO=i3(),DO=kf(),fY=LO();BO.exports=mY;function mY(n,e){for(var t=IO.identify(n),r=DO.convert(n,IO.ARRAY_OF_ARRAYS,3),o=0;o<r.length;o++)fY.transformMat4(r[o],r[o],e);return r=DO.convert(r,t,3),r}});var UO=K((v8e,GO)=>{"use strict";var hY=r3(),kO=FS(),_Y=y3(),FO=kf();GO.exports=function(e,t){t=Object.assign({center:[0,0,0]},t||{}),e=FO.convert(e,FO.ARRAY_OF_ARRAYS);var r=hY(e),o=[-.5*(r[0][0]+r[1][0])+t.center[0],-.5*(r[0][1]+r[1][1])+t.center[1],-.5*(r[0][2]+r[1][2])+t.center[2]],s=kO.create();kO.translate(s,s,o);var i=_Y(e,s);return i}});var VO=K(b3=>{var gY=1e-6,vY=1e-6;b3.vertexNormals=function(n,e,t){for(var r=e.length,o=new Array(r),s=t===void 0?gY:t,i=0;i<r;++i)o[i]=[0,0,0];for(var i=0;i<n.length;++i)for(var l=n[i],a=0,c=l[l.length-1],h=l[0],g=0;g<l.length;++g){a=c,c=h,h=l[(g+1)%l.length];for(var p=e[a],u=e[c],d=e[h],f=new Array(3),_=0,m=new Array(3),v=0,y=0;y<3;++y)f[y]=p[y]-u[y],_+=f[y]*f[y],m[y]=d[y]-u[y],v+=m[y]*m[y];if(_*v>s)for(var b=o[c],x=1/Math.sqrt(_*v),y=0;y<3;++y){var E=(y+1)%3,T=(y+2)%3;b[y]+=x*(m[E]*f[T]-m[T]*f[E])}}for(var i=0;i<r;++i){for(var b=o[i],M=0,y=0;y<3;++y)M+=b[y]*b[y];if(M>s)for(var x=1/Math.sqrt(M),y=0;y<3;++y)b[y]*=x;else for(var y=0;y<3;++y)b[y]=0}return o};b3.faceNormals=function(n,e,t){for(var r=n.length,o=new Array(r),s=t===void 0?vY:t,i=0;i<r;++i){for(var l=n[i],a=new Array(3),c=0;c<3;++c)a[c]=e[l[c]];for(var h=new Array(3),g=new Array(3),c=0;c<3;++c)h[c]=a[1][c]-a[0][c],g[c]=a[2][c]-a[0][c];for(var p=new Array(3),u=0,c=0;c<3;++c){var d=(c+1)%3,f=(c+2)%3;p[c]=h[d]*g[f]-h[f]*g[d],u+=p[c]*p[c]}u>s?u=1/Math.sqrt(u):u=0;for(var c=0;c<3;++c)p[c]*=u;o[i]=p}return o}});var HO=K((b8e,zO)=>{zO.exports=yY;function yY(n){for(var e=[],t=[],r=0,o=0;r<n.length;)t.push([o++,o++,o++]),e.push([n[r++],n[r++],n[r++]],[n[r++],n[r++],n[r++]],[n[r++],n[r++],n[r++]]);return{positions:e,cells:t}}});var jO=K((x8e,Ff)=>{var bY=function(){"use strict";function n(i,l,a,c){var h;typeof l=="object"&&(a=l.depth,c=l.prototype,h=l.filter,l=l.circular);var g=[],p=[],u=typeof Buffer!="undefined";typeof l=="undefined"&&(l=!0),typeof a=="undefined"&&(a=1/0);function d(f,_){if(f===null)return null;if(_==0)return f;var m,v;if(typeof f!="object")return f;if(n.__isArray(f))m=[];else if(n.__isRegExp(f))m=new RegExp(f.source,s(f)),f.lastIndex&&(m.lastIndex=f.lastIndex);else if(n.__isDate(f))m=new Date(f.getTime());else{if(u&&Buffer.isBuffer(f))return Buffer.allocUnsafe?m=Buffer.allocUnsafe(f.length):m=new Buffer(f.length),f.copy(m),m;typeof c=="undefined"?(v=Object.getPrototypeOf(f),m=Object.create(v)):(m=Object.create(c),v=c)}if(l){var y=g.indexOf(f);if(y!=-1)return p[y];g.push(f),p.push(m)}for(var b in f){var x;v&&(x=Object.getOwnPropertyDescriptor(v,b)),!(x&&x.set==null)&&(m[b]=d(f[b],_-1))}return m}return d(i,a)}n.clonePrototype=function(l){if(l===null)return null;var a=function(){};return a.prototype=l,new a};function e(i){return Object.prototype.toString.call(i)}n.__objToStr=e;function t(i){return typeof i=="object"&&e(i)==="[object Date]"}n.__isDate=t;function r(i){return typeof i=="object"&&e(i)==="[object Array]"}n.__isArray=r;function o(i){return typeof i=="object"&&e(i)==="[object RegExp]"}n.__isRegExp=o;function s(i){var l="";return i.global&&(l+="g"),i.ignoreCase&&(l+="i"),i.multiline&&(l+="m"),l}return n.__getRegExpFlags=s,n}();typeof Ff=="object"&&Ff.exports&&(Ff.exports=bY)});var WO=K((C8e,qO)=>{var xY=jO();qO.exports=function(n,e){return n=n||{},Object.keys(e).forEach(function(t){typeof n[t]=="undefined"&&(n[t]=xY(e[t]))}),n}});var YO=K((T8e,$O)=>{"use strict";var CY=wN(),js=RN().mat4,TY=UO(),EY=r3(),AY=y3(),Gf=kf(),MY=VO().vertexNormals,NY=HO(),SY=WO();$O.exports=function(n,e){e=SY(e,{cells:void 0,regl:!1,bias:.01,resolution:512}),n=TY(n);let t=EY(n),r=[1/(t[1][0]-t[0][0]),1/(t[1][1]-t[0][1]),1/(t[1][2]-t[0][2])],o=js.scale([],js.create(),r);n=AY(n,o);let s=Gf.convert(n,Gf.TYPED_ARRAY),i={cells:e.cells,positions:n};i.cells===void 0&&(i=NY(s));let l;e.normals===void 0?l=MY(i.cells,i.positions,0):l=e.normals;let a=Gf.convert(l,Gf.TYPED_ARRAY);if(s.length%3!=0)throw new Error("geo-ambient-occlusion: Position array not divisible by three.");let c=s.length/3,h=1;for(;h*h<c;)h*=2;let g=new Float32Array(h*h*3);g.set(s);let p=new Float32Array(h*h*3);p.set(a);let u=["OES_texture_float"];if(c>65535&&e.cells!==void 0&&u.push("OES_element_index_uint"),e.regl){for(let ae of u)if(!e.regl.hasExtension(ae))throw new Error("geo-ambient-occlusion: Provided regl context needs the "+ae+" extension for this mesh.")}let d,f;e.regl?(d=e.regl,f=!1):(d=CY({canvas:document.createElement("canvas"),extensions:u}),f=!0);let _=H(e.resolution),m={vert:`
      precision highp float;
      attribute vec3 position;
      uniform mat4 model, projection;
      varying vec3 vPos;
      void main() {
        gl_Position = projection * model * vec4(position, 1);
        vPos = vec3(model * vec4(position, 1));
      }
    `,frag:`
      precision highp float;
      varying vec3 vPos;
      void main() {
        gl_FragColor = vec4(vPos, 1);
      }
    `,attributes:{position:n},uniforms:{model:d.prop("model"),projection:d.prop("projection")},viewport:{x:0,y:0,width:e.resolution,height:e.resolution},framebuffer:_};e.cells?m.elements=e.cells:m.count=c;let v=d(m),y=[H(h),H(h)],b=d.texture({width:h,height:h,data:g,format:"rgb",type:"float"}),x=d.texture({width:h,height:h,data:p,format:"rgb",type:"float"}),E=d({vert:`
      precision highp float;
      attribute vec2 position;
      void main() {
          gl_Position = vec4(position, 0, 1);
      }
    `,frag:`
      precision highp float;

      uniform sampler2D tPosition, tSource, tVertex, tNormal;
      uniform float count, bias;
      uniform vec2 resolution;
      uniform mat4 model;

      const float INVSQRT3 = 0.5773502691896258; // 1/sqrt(3)

      void main() {
          vec2 texel = gl_FragCoord.xy/resolution;
          vec3 vert = texture2D(tVertex, texel).rgb;
          vert = vec3(model * vec4(vert, 1));
          vec3 norm = texture2D(tNormal, texel).rgb;
          norm = vec3(model * vec4(norm, 1));
          float z = texture2D(tPosition, INVSQRT3 * vert.xy + 0.5).z;
          float o = 0.0;
          if ((vert.z - z) < -bias) {
              o = 1.0;
          }
          vec4 src = texture2D(tSource, texel);
          if (dot(norm, vec3(0,0,1)) > 0.0) {
            gl_FragColor = src + vec4(o, 1, 0, 0);
          } else {
            gl_FragColor = src;
          }
      }
    `,attributes:{position:[-1,-1,1,-1,1,1,-1,-1,1,1,-1,1]},uniforms:{tPosition:_,tSource:d.prop("source"),tVertex:b,tNormal:x,count:d.prop("count"),bias:d.prop("bias"),resolution:[h,h],model:d.prop("model")},viewport:{x:0,y:0,width:h,height:h},framebuffer:d.prop("destination"),count:6}),T=0,M=0,D=Math.sqrt(3)/2,U=js.ortho([],-D,D,-D,D,-D,D);function L(){T=1-T;let ae=y[T],ue=y[1-T];M++;let me=js.create();js.rotateX(me,me,Math.random()*100),js.rotateY(me,me,Math.random()*100),js.rotateZ(me,me,Math.random()*100),d.clear({color:[0,0,0,1],depth:1,framebuffer:_}),v({model:me,projection:U}),d.clear({color:[0,0,0,1],depth:1,framebuffer:ue}),E({source:ae,destination:ue,count:M,bias:e.bias,model:me})}function se(){let ae;y[1-T].use(()=>{ae=d.read()});let ue=new Float32Array(c);for(let me=0;me<c;me++){let Ue=me*4,st=ae[Ue+1];ue[me]=st===0?0:ae[Ue+0]/st}return ue}function $(){b.destroy(),_.destroy(),y[0].destroy(),y[1].destroy(),f&&d.destroy()}function H(ae){return d.framebuffer({width:ae,height:ae,colorFormat:"rgba",colorType:"float"})}return{sample:L,report:se,dispose:$}}});var bw=K((Qxe,yw)=>{yw.exports=`#define LIGHT_WORLD_SIZE 0.005
// #define LIGHT_FRUSTUM_WIDTH 1.0
// #define PCSS_FILTER_SIZE 1.0
#define LIGHT_SIZE_UV (PCSS_FILTER_SIZE * LIGHT_WORLD_SIZE)
#define NEAR_PLANE 9.5

// #define NUM_SAMPLES 32
#define NUM_RINGS 11
#define BLOCKER_SEARCH_NUM_SAMPLES NUM_SAMPLES
#define PCF_NUM_SAMPLES NUM_SAMPLES

vec2 poissonDisk[NUM_SAMPLES];

void initPoissonSamples( const in vec2 randomSeed ) {
	float ANGLE_STEP = PI2 * float( NUM_RINGS ) / float( NUM_SAMPLES );
	float INV_NUM_SAMPLES = 1.0 / float( NUM_SAMPLES );

	// jsfiddle that shows sample pattern: https://jsfiddle.net/a16ff1p7/
	float angle = rand( randomSeed ) * PI2;
	float radius = INV_NUM_SAMPLES;
	float radiusStep = radius;

	for( int i = 0; i < NUM_SAMPLES; i ++ ) {
		poissonDisk[i] = vec2( cos( angle ), sin( angle ) ) * pow( radius, 0.75 );
		radius += radiusStep;
		angle += ANGLE_STEP;
	}
}

float penumbraSize( const in float zReceiver, const in float zBlocker ) { // Parallel plane estimation
	return (zReceiver - zBlocker) / zBlocker;
}

float findBlocker( sampler2D shadowMap, const in vec2 uv, const in float zReceiver ) {
	// This uses similar triangles to compute what
	// area of the shadow map we should search
	float searchRadius = LIGHT_SIZE_UV * ( zReceiver - NEAR_PLANE ) / zReceiver;
	float blockerDepthSum = 0.0;
	int numBlockers = 0;

	for( int i = 0; i < BLOCKER_SEARCH_NUM_SAMPLES; i++ ) {
		float shadowMapDepth = unpackRGBAToDepth(texture2D(shadowMap, uv + poissonDisk[i] * searchRadius));
		if ( shadowMapDepth < zReceiver ) {
			blockerDepthSum += shadowMapDepth;
			numBlockers ++;
		}
	}

	if( numBlockers == 0 ) return -1.0;

	return blockerDepthSum / float( numBlockers );
}

float PCF_Filter(sampler2D shadowMap, vec2 uv, float zReceiver, float filterRadius ) {
	float sum = 0.0;
	for( int i = 0; i < PCF_NUM_SAMPLES; i ++ ) {
		float depth = unpackRGBAToDepth( texture2D( shadowMap, uv + poissonDisk[ i ] * filterRadius ) );
		if( zReceiver <= depth ) sum += 1.0;
	}
	for( int i = 0; i < PCF_NUM_SAMPLES; i ++ ) {
		float depth = unpackRGBAToDepth( texture2D( shadowMap, uv + -poissonDisk[ i ].yx * filterRadius ) );
		if( zReceiver <= depth ) sum += 1.0;
	}
	return sum / ( 2.0 * float( PCF_NUM_SAMPLES ) );
}

float PCSS ( sampler2D shadowMap, vec4 coords ) {
	vec2 uv = coords.xy;
	float zReceiver = coords.z; // Assumed to be eye-space z in this code

	initPoissonSamples( uv );
	// STEP 1: blocker search
	float avgBlockerDepth = findBlocker( shadowMap, uv, zReceiver );

	//There are no occluders so early out (this saves filtering)
	if( avgBlockerDepth == -1.0 ) return 1.0;

	// STEP 2: penumbra size
	float penumbraRatio = penumbraSize( zReceiver, avgBlockerDepth );
	float filterRadius = penumbraRatio * LIGHT_SIZE_UV * NEAR_PLANE / zReceiver;

	// STEP 3: filtering
	//return avgBlockerDepth;
	return PCF_Filter( shadowMap, uv, zReceiver, filterRadius );
}`});var Cw=K((eCe,xw)=>{xw.exports="return PCSS( shadowMap, shadowCoord );"});function Id(){let n=null,e=!1,t=null,r=null;function o(s,i){t(s,i),r=n.requestAnimationFrame(o)}return{start:function(){e!==!0&&t!==null&&(r=n.requestAnimationFrame(o),e=!0)},stop:function(){n.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function sy(n,e){let t=e.isWebGL2,r=new WeakMap;function o(c,h){let g=c.array,p=c.usage,u=n.createBuffer();n.bindBuffer(h,u),n.bufferData(h,g,p),c.onUploadCallback();let d=n.FLOAT;return g instanceof Float32Array?d=n.FLOAT:g instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):g instanceof Uint16Array?c.isFloat16BufferAttribute?t?d=n.HALF_FLOAT:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):d=n.UNSIGNED_SHORT:g instanceof Int16Array?d=n.SHORT:g instanceof Uint32Array?d=n.UNSIGNED_INT:g instanceof Int32Array?d=n.INT:g instanceof Int8Array?d=n.BYTE:(g instanceof Uint8Array||g instanceof Uint8ClampedArray)&&(d=n.UNSIGNED_BYTE),{buffer:u,type:d,bytesPerElement:g.BYTES_PER_ELEMENT,version:c.version}}function s(c,h,g){let p=h.array,u=h.updateRange;n.bindBuffer(g,c),u.count===-1?n.bufferSubData(g,0,p):(t?n.bufferSubData(g,u.offset*p.BYTES_PER_ELEMENT,p,u.offset,u.count):n.bufferSubData(g,u.offset*p.BYTES_PER_ELEMENT,p.subarray(u.offset,u.offset+u.count)),u.count=-1)}function i(c){return c.isInterleavedBufferAttribute&&(c=c.data),r.get(c)}function l(c){c.isInterleavedBufferAttribute&&(c=c.data);let h=r.get(c);h&&(n.deleteBuffer(h.buffer),r.delete(c))}function a(c,h){if(c.isGLBufferAttribute){let p=r.get(c);(!p||p.version<c.version)&&r.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}c.isInterleavedBufferAttribute&&(c=c.data);let g=r.get(c);g===void 0?r.set(c,o(c,h)):g.version<c.version&&(s(g.buffer,c,h),g.version=c.version)}return{get:i,remove:l,update:a}}var wi=class extends Gt{constructor(e=1,t=1,r=1,o=1,s=1,i=1){super();this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:o,heightSegments:s,depthSegments:i};let l=this;o=Math.floor(o),s=Math.floor(s),i=Math.floor(i);let a=[],c=[],h=[],g=[],p=0,u=0;d("z","y","x",-1,-1,r,t,e,i,s,0),d("z","y","x",1,-1,r,t,-e,i,s,1),d("x","z","y",1,1,e,r,t,o,i,2),d("x","z","y",1,-1,e,r,-t,o,i,3),d("x","y","z",1,-1,e,t,r,o,s,4),d("x","y","z",-1,-1,e,t,-r,o,s,5),this.setIndex(a),this.setAttribute("position",new _t(c,3)),this.setAttribute("normal",new _t(h,3)),this.setAttribute("uv",new _t(g,2));function d(f,_,m,v,y,b,x,E,T,M,D){let U=b/T,L=x/M,se=b/2,$=x/2,H=E/2,ae=T+1,ue=M+1,me=0,Ue=0,st=new F;for(let ft=0;ft<ue;ft++){let Ze=ft*L-$;for(let gt=0;gt<ae;gt++){let ce=gt*U-se;st[f]=ce*v,st[_]=Ze*y,st[m]=H,c.push(st.x,st.y,st.z),st[f]=0,st[_]=0,st[m]=E>0?1:-1,h.push(st.x,st.y,st.z),g.push(gt/T),g.push(1-ft/M),me+=1}}for(let ft=0;ft<M;ft++)for(let Ze=0;Ze<T;Ze++){let gt=p+Ze+ae*ft,ce=p+Ze+ae*(ft+1),oe=p+(Ze+1)+ae*(ft+1),yt=p+(Ze+1)+ae*ft;a.push(gt,ce,yt),a.push(ce,oe,yt),Ue+=6}l.addGroup(u,Ue,D),u+=Ue,p+=me}}static fromJSON(e){return new wi(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};var B0=class extends Gt{constructor(e=1,t=1,r=1,o=1){super();this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:o};let s=e/2,i=t/2,l=Math.floor(r),a=Math.floor(o),c=l+1,h=a+1,g=e/l,p=t/a,u=[],d=[],f=[],_=[];for(let m=0;m<h;m++){let v=m*p-i;for(let y=0;y<c;y++){let b=y*g-s;d.push(b,-v,0),f.push(0,0,1),_.push(y/l),_.push(1-m/a)}}for(let m=0;m<a;m++)for(let v=0;v<l;v++){let y=v+c*m,b=v+c*(m+1),x=v+1+c*(m+1),E=v+1+c*m;u.push(y,b,E),u.push(b,x,E)}this.setIndex(u),this.setAttribute("position",new _t(d,3)),this.setAttribute("normal",new _t(f,3)),this.setAttribute("uv",new _t(_,2))}static fromJSON(e){return new B0(e.width,e.height,e.widthSegments,e.heightSegments)}};function r0(n){let e={};for(let t in n){e[t]={};for(let r in n[t]){let o=n[t][r];o&&(o.isColor||o.isMatrix3||o.isMatrix4||o.isVector2||o.isVector3||o.isVector4||o.isTexture||o.isQuaternion)?e[t][r]=o.clone():Array.isArray(o)?e[t][r]=o.slice():e[t][r]=o}}return e}function to(n){let e={};for(let t=0;t<n.length;t++){let r=r0(n[t]);for(let o in r)e[o]=r[o]}return e}var ll={clone:r0,merge:to};var ay=`
void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}
`;var ly=`
void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}
`;var co=class extends gn{constructor(e){super();this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=ay,this.fragmentShader=ly,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&(e.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=r0(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(let o in this.uniforms){let i=this.uniforms[o].value;i&&i.isTexture?t.uniforms[o]={type:"t",value:i.toJSON(e).uuid}:i&&i.isColor?t.uniforms[o]={type:"c",value:i.getHex()}:i&&i.isVector2?t.uniforms[o]={type:"v2",value:i.toArray()}:i&&i.isVector3?t.uniforms[o]={type:"v3",value:i.toArray()}:i&&i.isVector4?t.uniforms[o]={type:"v4",value:i.toArray()}:i&&i.isMatrix3?t.uniforms[o]={type:"m3",value:i.toArray()}:i&&i.isMatrix4?t.uniforms[o]={type:"m4",value:i.toArray()}:t.uniforms[o]={value:i}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;let r={};for(let o in this.extensions)this.extensions[o]===!0&&(r[o]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}};co.prototype.isShaderMaterial=!0;var cy=`
#ifdef USE_ALPHAMAP

	diffuseColor.a *= texture2D( alphaMap, vUv ).g;

#endif
`;var uy=`
#ifdef USE_ALPHAMAP

	uniform sampler2D alphaMap;

#endif
`;var py=`
#ifdef USE_ALPHATEST

	if ( diffuseColor.a < alphaTest ) discard;

#endif
`;var dy=`
#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif
`;var fy=`
#ifdef USE_AOMAP

	// reads channel R, compatible with a combined OcclusionRoughnessMetallic (RGB) texture
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;

	reflectedLight.indirectDiffuse *= ambientOcclusion;

	#if defined( USE_ENVMAP ) && defined( STANDARD )

		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );

		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );

	#endif

#endif
`;var my=`
#ifdef USE_AOMAP

	uniform sampler2D aoMap;
	uniform float aoMapIntensity;

#endif
`;var hy=`
vec3 transformed = vec3( position );
`;var _y=`
vec3 objectNormal = vec3( normal );

#ifdef USE_TANGENT

	vec3 objectTangent = vec3( tangent.xyz );

#endif
`;var gy=`

vec3 BRDF_Lambert( const in vec3 diffuseColor ) {

	return RECIPROCAL_PI * diffuseColor;

} // validated

vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {

	// Original approximation by Christophe Schlick '94
	// float fresnel = pow( 1.0 - dotVH, 5.0 );

	// Optimized variant (presented by Epic at SIGGRAPH '13)
	// https://cdn2.unrealengine.com/Resources/files/2013SiggraphPresentationsNotes-26915738.pdf
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );

	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );

} // validated

// Moving Frostbite to Physically Based Rendering 3.0 - page 12, listing 2
// https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {

	float a2 = pow2( alpha );

	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );

	return 0.5 / max( gv + gl, EPSILON );

}

// Microfacet Models for Refraction through Rough Surfaces - equation (33)
// http://graphicrants.blogspot.com/2013/08/specular-brdf-reference.html
// alpha is "roughness squared" in Disney\u2019s reparameterization
float D_GGX( const in float alpha, const in float dotNH ) {

	float a2 = pow2( alpha );

	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0; // avoid alpha = 0 with dotNH = 1

	return RECIPROCAL_PI * a2 / pow2( denom );

}

// GGX Distribution, Schlick Fresnel, GGX_SmithCorrelated Visibility
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {

	float alpha = pow2( roughness ); // UE4's roughness

	vec3 halfDir = normalize( lightDir + viewDir );

	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );

	vec3 F = F_Schlick( f0, f90, dotVH );

	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );

	float D = D_GGX( alpha, dotNH );

	return F * ( V * D );

}

// Rect Area Light

// Real-Time Polygonal-Light Shading with Linearly Transformed Cosines
// by Eric Heitz, Jonathan Dupuy, Stephen Hill and David Neubelt
// code: https://github.com/selfshadow/ltc_code/

vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {

	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;

	float dotNV = saturate( dot( N, V ) );

	// texture parameterized by sqrt( GGX alpha ) and sqrt( 1 - cos( theta ) )
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );

	uv = uv * LUT_SCALE + LUT_BIAS;

	return uv;

}

float LTC_ClippedSphereFormFactor( const in vec3 f ) {

	// Real-Time Area Lighting: a Journey from Research to Production (p.102)
	// An approximation of the form factor of a horizon-clipped rectangle.

	float l = length( f );

	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );

}

vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {

	float x = dot( v1, v2 );

	float y = abs( x );

	// rational polynomial approximation to theta / sin( theta ) / 2PI
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;

	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;

	return cross( v1, v2 ) * theta_sintheta;

}

vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {

	// bail if point is on back side of plane of light
	// assumes ccw winding order of light vertices
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );

	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );

	// construct orthonormal basis around N
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 ); // negated from paper; possibly due to a different handedness of world coordinate system

	// compute transform
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );

	// transform rect
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );

	// project rect onto sphere
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );

	// calculate vector form factor
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );

	// adjust for horizon clipping
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );

/*
	// alternate method of adjusting for horizon clipping (see referece)
	// refactoring required
	float len = length( vectorFormFactor );
	float z = vectorFormFactor.z / len;

	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;

	// tabulated horizon-clipped sphere, apparently...
	vec2 uv = vec2( z * 0.5 + 0.5, len );
	uv = uv * LUT_SCALE + LUT_BIAS;

	float scale = texture2D( ltc_2, uv ).w;

	float result = len * scale;
*/

	return vec3( result );

}

// End Rect Area Light


float G_BlinnPhong_Implicit( /* const in float dotNL, const in float dotNV */ ) {

	// geometry term is (n dot l)(n dot v) / 4(n dot l)(n dot v)
	return 0.25;

}

float D_BlinnPhong( const in float shininess, const in float dotNH ) {

	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );

}

vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {

	vec3 halfDir = normalize( lightDir + viewDir );

	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );

	vec3 F = F_Schlick( specularColor, 1.0, dotVH );

	float G = G_BlinnPhong_Implicit( /* dotNL, dotNV */ );

	float D = D_BlinnPhong( shininess, dotNH );

	return F * ( G * D );

} // validated

#if defined( USE_SHEEN )

// https://github.com/google/filament/blob/master/shaders/src/brdf.fs
float D_Charlie( float roughness, float dotNH ) {

	float alpha = pow2( roughness );

	// Estevez and Kulla 2017, "Production Friendly Microfacet Sheen BRDF"
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 ); // 2^(-14/2), so sin2h^2 > 0 in fp16

	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );

}

// https://github.com/google/filament/blob/master/shaders/src/brdf.fs
float V_Neubelt( float dotNV, float dotNL ) {

	// Neubelt and Pettineo 2013, "Crafting a Next-gen Material Pipeline for The Order: 1886"
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );

}

vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenTint, const in float sheenRoughness ) {

	vec3 halfDir = normalize( lightDir + viewDir );

	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );

	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );

	return sheenTint * ( D * V );

}

#endif
`;var vy=`
#ifdef USE_BUMPMAP

	uniform sampler2D bumpMap;
	uniform float bumpScale;

	// Bump Mapping Unparametrized Surfaces on the GPU by Morten S. Mikkelsen
	// http://api.unrealengine.com/attachments/Engine/Rendering/LightingAndShadows/BumpMappingWithoutTangentSpace/mm_sfgrad_bump.pdf

	// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)

	vec2 dHdxy_fwd() {

		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );

		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;

		return vec2( dBx, dBy );

	}

	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {

		// Workaround for Adreno 3XX dFd*( vec3 ) bug. See #9988

		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;		// normalized

		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );

		float fDet = dot( vSigmaX, R1 ) * faceDirection;

		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );

	}

#endif
`;var yy=`
#if NUM_CLIPPING_PLANES > 0

	vec4 plane;

	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {

		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;

	}
	#pragma unroll_loop_end

	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES

		bool clipped = true;

		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {

			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;

		}
		#pragma unroll_loop_end

		if ( clipped ) discard;

	#endif

#endif
`;var by=`
#if NUM_CLIPPING_PLANES > 0

	varying vec3 vClipPosition;

	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];

#endif
`;var xy=`
#if NUM_CLIPPING_PLANES > 0

	varying vec3 vClipPosition;

#endif
`;var Cy=`
#if NUM_CLIPPING_PLANES > 0

	vClipPosition = - mvPosition.xyz;

#endif
`;var Ty=`
#if defined( USE_COLOR_ALPHA )

	diffuseColor *= vColor;

#elif defined( USE_COLOR )

	diffuseColor.rgb *= vColor;

#endif
`;var Ey=`
#if defined( USE_COLOR_ALPHA )

	varying vec4 vColor;

#elif defined( USE_COLOR )

	varying vec3 vColor;

#endif
`;var Ay=`
#if defined( USE_COLOR_ALPHA )

	varying vec4 vColor;

#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )

	varying vec3 vColor;

#endif
`;var My=`
#if defined( USE_COLOR_ALPHA )

	vColor = vec4( 1.0 );

#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )

	vColor = vec3( 1.0 );

#endif

#ifdef USE_COLOR

	vColor *= color;

#endif

#ifdef USE_INSTANCING_COLOR

	vColor.xyz *= instanceColor.xyz;

#endif
`;var Ny=`
#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6

#ifndef saturate
// <tonemapping_pars_fragment> may have defined saturate() already
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )

float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }

// expects values in the range of [0,1]x[0,1], returns values in the [0,1] range.
// do not collapse into a single function per: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/
highp float rand( const in vec2 uv ) {

	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );

	return fract( sin( sn ) * c );

}

#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif

struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};

struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};

struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};

vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

}

vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {

	// dir can be either a direction vector or a normal vector
	// upper-left 3x3 of matrix is assumed to be orthogonal

	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );

}

mat3 transposeMat3( const in mat3 m ) {

	mat3 tmp;

	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );

	return tmp;

}

// https://en.wikipedia.org/wiki/Relative_luminance
float linearToRelativeLuminance( const in vec3 color ) {

	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );

	return dot( weights, color.rgb );

}

bool isPerspectiveMatrix( mat4 m ) {

	return m[ 2 ][ 3 ] == - 1.0;

}

vec2 equirectUv( in vec3 dir ) {

	// dir is assumed to be unit length

	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;

	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;

	return vec2( u, v );

}
`;var Sy=`
#ifdef ENVMAP_TYPE_CUBE_UV

	#define cubeUV_maxMipLevel 8.0
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_maxTileSize 256.0
	#define cubeUV_minTileSize 16.0

	// These shader functions convert between the UV coordinates of a single face of
	// a cubemap, the 0-5 integer index of a cube face, and the direction vector for
	// sampling a textureCube (not generally normalized ).

	float getFace( vec3 direction ) {

		vec3 absDirection = abs( direction );

		float face = - 1.0;

		if ( absDirection.x > absDirection.z ) {

			if ( absDirection.x > absDirection.y )

				face = direction.x > 0.0 ? 0.0 : 3.0;

			else

				face = direction.y > 0.0 ? 1.0 : 4.0;

		} else {

			if ( absDirection.z > absDirection.y )

				face = direction.z > 0.0 ? 2.0 : 5.0;

			else

				face = direction.y > 0.0 ? 1.0 : 4.0;

		}

		return face;

	}

	// RH coordinate system; PMREM face-indexing convention
	vec2 getUV( vec3 direction, float face ) {

		vec2 uv;

		if ( face == 0.0 ) {

			uv = vec2( direction.z, direction.y ) / abs( direction.x ); // pos x

		} else if ( face == 1.0 ) {

			uv = vec2( - direction.x, - direction.z ) / abs( direction.y ); // pos y

		} else if ( face == 2.0 ) {

			uv = vec2( - direction.x, direction.y ) / abs( direction.z ); // pos z

		} else if ( face == 3.0 ) {

			uv = vec2( - direction.z, direction.y ) / abs( direction.x ); // neg x

		} else if ( face == 4.0 ) {

			uv = vec2( - direction.x, direction.z ) / abs( direction.y ); // neg y

		} else {

			uv = vec2( direction.x, direction.y ) / abs( direction.z ); // neg z

		}

		return 0.5 * ( uv + 1.0 );

	}

	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {

		float face = getFace( direction );

		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );

		mipInt = max( mipInt, cubeUV_minMipLevel );

		float faceSize = exp2( mipInt );

		float texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );

		vec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );

		vec2 f = fract( uv );

		uv += 0.5 - f;

		if ( face > 2.0 ) {

			uv.y += faceSize;

			face -= 3.0;

		}

		uv.x += face * faceSize;

		if ( mipInt < cubeUV_maxMipLevel ) {

			uv.y += 2.0 * cubeUV_maxTileSize;

		}

		uv.y += filterInt * 2.0 * cubeUV_minTileSize;

		uv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );

		uv *= texelSize;

		vec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;

		uv.x += texelSize;

		vec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;

		uv.y += texelSize;

		vec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;

		uv.x -= texelSize;

		vec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;

		vec3 tm = mix( tl, tr, f.x );

		vec3 bm = mix( bl, br, f.x );

		return mix( tm, bm, f.y );

	}

	// These defines must match with PMREMGenerator

	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0

	float roughnessToMip( float roughness ) {

		float mip = 0.0;

		if ( roughness >= r1 ) {

			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;

		} else if ( roughness >= r4 ) {

			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;

		} else if ( roughness >= r5 ) {

			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;

		} else if ( roughness >= r6 ) {

			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;

		} else {

			mip = - 2.0 * log2( 1.16 * roughness ); // 1.16 = 1.79^0.25
		}

		return mip;

	}

	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {

		float mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );

		float mipF = fract( mip );

		float mipInt = floor( mip );

		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );

		if ( mipF == 0.0 ) {

			return vec4( color0, 1.0 );

		} else {

			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );

			return vec4( mix( color0, color1, mipF ), 1.0 );

		}

	}

#endif
`;var Py=`
vec3 transformedNormal = objectNormal;

#ifdef USE_INSTANCING

	// this is in lieu of a per-instance normal-matrix
	// shear transforms in the instance matrix are not supported

	mat3 m = mat3( instanceMatrix );

	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );

	transformedNormal = m * transformedNormal;

#endif

transformedNormal = normalMatrix * transformedNormal;

#ifdef FLIP_SIDED

	transformedNormal = - transformedNormal;

#endif

#ifdef USE_TANGENT

	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;

	#ifdef FLIP_SIDED

		transformedTangent = - transformedTangent;

	#endif

#endif
`;var Oy=`
#ifdef USE_DISPLACEMENTMAP

	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;

#endif
`;var wy=`
#ifdef USE_DISPLACEMENTMAP

	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );

#endif
`;var Ry=`
#ifdef USE_EMISSIVEMAP

	vec4 emissiveColor = texture2D( emissiveMap, vUv );

	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;

	totalEmissiveRadiance *= emissiveColor.rgb;

#endif
`;var Ly=`
#ifdef USE_EMISSIVEMAP

	uniform sampler2D emissiveMap;

#endif
`;var Iy=`
gl_FragColor = linearToOutputTexel( gl_FragColor );
`;var Dy=`
// For a discussion of what this is, please read this: http://lousodrome.net/blog/light/2013/05/26/gamma-correct-and-hdr-rendering-in-a-32-bits-buffer/

vec4 LinearToLinear( in vec4 value ) {
	return value;
}

vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );
}

vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );
}

vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}

vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}

vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}

vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
	// return vec4( value.brg, ( 3.0 + 128.0 ) / 256.0 );
}

// reference: http://iwasbeingirony.blogspot.ca/2010/06/difference-between-rgbm-and-rgbd.html
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}

vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}

// reference: http://iwasbeingirony.blogspot.ca/2010/06/difference-between-rgbm-and-rgbd.html
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}

vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float D = max( maxRange / maxRGB, 1.0 );
	// NOTE: The implementation with min causes the shader to not compile on
	// a common Alcatel A502DL in Chrome 78/Android 8.1. Some research suggests 
	// that the chipset is Mediatek MT6739 w/ IMG PowerVR GE8100 GPU.
	// D = min( floor( D ) / 255.0, 1.0 );
	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}

// LogLuv reference: http://graphicrants.blogspot.ca/2009/04/rgbm-color-encoding.html

// M matrix, for encoding
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value ) {
	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;
	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract( Le );
	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;
	return vResult;
}

// Inverse M matrix, for decoding
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;
	return vec4( max( vRGB, 0.0 ), 1.0 );
}
`;var By=`
#ifdef USE_ENVMAP

	#ifdef ENV_WORLDPOS

		vec3 cameraToFrag;

		if ( isOrthographic ) {

			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );

		} else {

			cameraToFrag = normalize( vWorldPosition - cameraPosition );

		}

		// Transforming Normal Vectors with the Inverse Transformation
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );

		#ifdef ENVMAP_MODE_REFLECTION

			vec3 reflectVec = reflect( cameraToFrag, worldNormal );

		#else

			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );

		#endif

	#else

		vec3 reflectVec = vReflect;

	#endif

	#ifdef ENVMAP_TYPE_CUBE

		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );

		envColor = envMapTexelToLinear( envColor );

	#elif defined( ENVMAP_TYPE_CUBE_UV )

		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );

	#else

		vec4 envColor = vec4( 0.0 );

	#endif

	#ifdef ENVMAP_BLENDING_MULTIPLY

		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );

	#elif defined( ENVMAP_BLENDING_MIX )

		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );

	#elif defined( ENVMAP_BLENDING_ADD )

		outgoingLight += envColor.xyz * specularStrength * reflectivity;

	#endif

#endif
`;var ky=`
#ifdef USE_ENVMAP

	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform int maxMipLevel;

	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif
`;var Fy=`
#ifdef USE_ENVMAP

	uniform float reflectivity;

	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )

		#define ENV_WORLDPOS

	#endif

	#ifdef ENV_WORLDPOS

		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif

#endif
`;var Gy=`
#ifdef USE_ENVMAP

	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )

		#define ENV_WORLDPOS

	#endif

	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;

	#else

		varying vec3 vReflect;
		uniform float refractionRatio;

	#endif

#endif
`;var Uy=`
#ifdef USE_ENVMAP

	#ifdef ENV_WORLDPOS

		vWorldPosition = worldPosition.xyz;

	#else

		vec3 cameraToVertex;

		if ( isOrthographic ) {

			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );

		} else {

			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );

		}

		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );

		#ifdef ENVMAP_MODE_REFLECTION

			vReflect = reflect( cameraToVertex, worldNormal );

		#else

			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );

		#endif

	#endif

#endif
`;var Vy=`
#ifdef USE_FOG

	vFogDepth = - mvPosition.z;

#endif
`;var zy=`
#ifdef USE_FOG

	varying float vFogDepth;

#endif
`;var Hy=`
#ifdef USE_FOG

	#ifdef FOG_EXP2

		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );

	#else

		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );

	#endif

	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );

#endif
`;var jy=`
#ifdef USE_FOG

	uniform vec3 fogColor;
	varying float vFogDepth;

	#ifdef FOG_EXP2

		uniform float fogDensity;

	#else

		uniform float fogNear;
		uniform float fogFar;

	#endif

#endif
`;var qy=`

#ifdef USE_GRADIENTMAP

	uniform sampler2D gradientMap;

#endif

vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {

	// dotNL will be from -1.0 to 1.0
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );

	#ifdef USE_GRADIENTMAP

		return texture2D( gradientMap, coord ).rgb;

	#else

		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );

	#endif

}
`;var Wy=`
#ifdef USE_LIGHTMAP

	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;

	#ifndef PHYSICALLY_CORRECT_LIGHTS

		lightMapIrradiance *= PI;

	#endif

	reflectedLight.indirectDiffuse += lightMapIrradiance;

#endif
`;var $y=`
#ifdef USE_LIGHTMAP

	uniform sampler2D lightMap;
	uniform float lightMapIntensity;

#endif
`;var Yy=`
vec3 diffuse = vec3( 1.0 );

GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );

GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;

vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif

IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;

vIndirectFront += getAmbientLightIrradiance( ambientLightColor );

vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );

#ifdef DOUBLE_SIDED

	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );

	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );

#endif

#if NUM_POINT_LIGHTS > 0

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {

		getPointLightInfo( pointLights[ i ], geometry, directLight );

		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;

		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;

		#ifdef DOUBLE_SIDED

			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;

		#endif

	}
	#pragma unroll_loop_end

#endif

#if NUM_SPOT_LIGHTS > 0

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {

		getSpotLightInfo( spotLights[ i ], geometry, directLight );

		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;

		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;

		#ifdef DOUBLE_SIDED

			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;

		#endif
	}
	#pragma unroll_loop_end

#endif

#if NUM_DIR_LIGHTS > 0

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {

		getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );

		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;

		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;

		#ifdef DOUBLE_SIDED

			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;

		#endif

	}
	#pragma unroll_loop_end

#endif

#if NUM_HEMI_LIGHTS > 0

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {

		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );

		#ifdef DOUBLE_SIDED

			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );

		#endif

	}
	#pragma unroll_loop_end

#endif
`;var Xy=`
uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];

// get the irradiance (radiance convolved with cosine lobe) at the point 'normal' on the unit sphere
// source: https://graphics.stanford.edu/papers/envmap/envmap.pdf
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {

	// normal is assumed to have unit length

	float x = normal.x, y = normal.y, z = normal.z;

	// band 0
	vec3 result = shCoefficients[ 0 ] * 0.886227;

	// band 1
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;

	// band 2
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );

	return result;

}

vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {

	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );

	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );

	return irradiance;

}

vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {

	vec3 irradiance = ambientLightColor;

	return irradiance;

}

float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {

	#if defined ( PHYSICALLY_CORRECT_LIGHTS )

		// based upon Frostbite 3 Moving to Physically-based Rendering
		// page 32, equation 26: E[window1]
		// https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );

		if ( cutoffDistance > 0.0 ) {

			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );

		}

		return distanceFalloff;

	#else

		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {

			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );

		}

		return 1.0;

	#endif

}

float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {

	return smoothstep( coneCosine, penumbraCosine, angleCosine );

}

#if NUM_DIR_LIGHTS > 0

	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};

	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];

	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {

		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;

	}

#endif


#if NUM_POINT_LIGHTS > 0

	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};

	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];

	// light is an out parameter as having it as a return value caused compiler errors on some devices
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {

		vec3 lVector = pointLight.position - geometry.position;

		light.direction = normalize( lVector );

		float lightDistance = length( lVector );

		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );

	}

#endif


#if NUM_SPOT_LIGHTS > 0

	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};

	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];

	// light is an out parameter as having it as a return value caused compiler errors on some devices
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {

		vec3 lVector = spotLight.position - geometry.position;

		light.direction = normalize( lVector );

		float angleCos = dot( light.direction, spotLight.direction );

		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );

		if ( spotAttenuation > 0.0 ) {

			float lightDistance = length( lVector );

			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );

		} else {

			light.color = vec3( 0.0 );
			light.visible = false;

		}

	}

#endif


#if NUM_RECT_AREA_LIGHTS > 0

	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};

	// Pre-computed values of LinearTransformedCosine approximation of BRDF
	// BRDF approximation Texture is 64x64
	uniform sampler2D ltc_1; // RGBA Float
	uniform sampler2D ltc_2; // RGBA Float

	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];

#endif


#if NUM_HEMI_LIGHTS > 0

	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};

	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];

	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {

		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;

		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );

		return irradiance;

	}

#endif
`;var Jy=`
#if defined( USE_ENVMAP )

	#ifdef ENVMAP_MODE_REFRACTION

		uniform float refractionRatio;

	#endif

	vec3 getIBLIrradiance( const in vec3 normal ) {

		#if defined( ENVMAP_TYPE_CUBE_UV )

			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );

			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );

			return PI * envMapColor.rgb * envMapIntensity;

		#else

			return vec3( 0.0 );

		#endif

	}

	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {

		#if defined( ENVMAP_TYPE_CUBE_UV )

			vec3 reflectVec;

			#ifdef ENVMAP_MODE_REFLECTION

				reflectVec = reflect( - viewDir, normal );

				// Mixing the reflection with the normal is more accurate and keeps rough objects from gathering light from behind their tangent plane.
				reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );

			#else

				reflectVec = refract( - viewDir, normal, refractionRatio );

			#endif

			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );

			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );

			return envMapColor.rgb * envMapIntensity;

		#else

			return vec3( 0.0 );

		#endif

	}

#endif
`;var Ky=`
ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;
`;var Zy=`
varying vec3 vViewPosition;

struct ToonMaterial {

	vec3 diffuseColor;

};

void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {

	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;

	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {

	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon

#define Material_LightProbeLOD( material )	(0)
`;var Qy=`
BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;
`;var eb=`
varying vec3 vViewPosition;

struct BlinnPhongMaterial {

	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;

};

void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {

	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;

	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;

}

void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {

	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong

#define Material_LightProbeLOD( material )	(0)
`;var tb=`
PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );

vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );

material.roughness = max( roughnessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.
material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );

#ifdef IOR

	#ifdef SPECULAR

		float specularIntensityFactor = specularIntensity;
		vec3 specularTintFactor = specularTint;

		#ifdef USE_SPECULARINTENSITYMAP

			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;

		#endif

		#ifdef USE_SPECULARTINTMAP

			specularTintFactor *= specularTintMapTexelToLinear( texture2D( specularTintMap, vUv ) ).rgb;

		#endif

		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );

	#else

		float specularIntensityFactor = 1.0;
		vec3 specularTintFactor = vec3( 1.0 );
		material.specularF90 = 1.0;

	#endif

	material.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularTintFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );

#else

	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;

#endif

#ifdef USE_CLEARCOAT

	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;

	#ifdef USE_CLEARCOATMAP

		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;

	#endif

	#ifdef USE_CLEARCOAT_ROUGHNESSMAP

		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;

	#endif

	material.clearcoat = saturate( material.clearcoat ); // Burley clearcoat model
	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );

#endif

#ifdef USE_SHEEN

	material.sheenTint = sheenTint;
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );

#endif
`;var rb=`
struct PhysicalMaterial {

	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;

	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif

	#ifdef USE_SHEEN
		vec3 sheenTint;
		float sheenRoughness;
	#endif

};

// temporary
vec3 clearcoatSpecular = vec3( 0.0 );

// Analytical approximation of the DFG LUT, one half of the
// split-sum approximation used in indirect specular lighting.
// via 'environmentBRDF' from "Physically Based Shading on Mobile"
// https://www.unrealengine.com/blog/physically-based-shading-on-mobile
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {

	float dotNV = saturate( dot( normal, viewDir ) );

	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );

	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );

	vec4 r = roughness * c0 + c1;

	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;

	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;

	return fab;

}

vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {

	vec2 fab = DFGApprox( normal, viewDir, roughness );

	return specularColor * fab.x + specularF90 * fab.y;

}

// Fdez-Ag\xFCera's "Multiple-Scattering Microfacet Model for Real-Time Image Based Lighting"
// Approximates multiscattering in order to preserve energy.
// http://www.jcgt.org/published/0008/01/03/
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {

	vec2 fab = DFGApprox( normal, viewDir, roughness );

	vec3 FssEss = specularColor * fab.x + specularF90 * fab.y;

	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;

	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619; // 1/21
	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );

	singleScatter += FssEss;
	multiScatter += Fms * Ems;

}

#if NUM_RECT_AREA_LIGHTS > 0

	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {

		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;

		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight; // counterclockwise; light shines in local neg z direction
		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;

		vec2 uv = LTC_Uv( normal, viewDir, roughness );

		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );

		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);

		// LTC Fresnel Approximation by Stephen Hill
		// http://blog.selfshadow.com/publications/s2016-advances/s2016_ltc_fresnel.pdf
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );

		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );

		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );

	}

#endif

void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {

	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );

	vec3 irradiance = dotNL * directLight.color;

	#ifdef USE_CLEARCOAT

		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );

		vec3 ccIrradiance = dotNLcc * directLight.color;

		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );

	#endif

	#ifdef USE_SHEEN

		reflectedLight.directSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenTint, material.sheenRoughness );

	#endif

	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );


	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}

void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {

	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {

	#ifdef USE_CLEARCOAT

		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );

	#endif

	// Both indirect specular and indirect diffuse light accumulate here

	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;

	computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );

	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );

	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;

	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;

}

#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical

// ref: https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {

	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );

}
`;var nb=`
/**
 * This is a template that can be used to light a material, it uses pluggable
 * RenderEquations (RE)for specific lighting scenarios.
 *
 * Instructions for use:
 * - Ensure that both RE_Direct, RE_IndirectDiffuse and RE_IndirectSpecular are defined
 * - If you have defined an RE_IndirectSpecular, you need to also provide a Material_LightProbeLOD. <---- ???
 * - Create a material parameter that is to be passed as the third parameter to your lighting functions.
 *
 * TODO:
 * - Add area light support.
 * - Add sphere light support.
 * - Add diffuse light probe (irradiance cubemap) support.
 */

GeometricContext geometry;

geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );

#ifdef USE_CLEARCOAT

	geometry.clearcoatNormal = clearcoatNormal;

#endif

IncidentLight directLight;

#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )

	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {

		pointLight = pointLights[ i ];

		getPointLightInfo( pointLight, geometry, directLight );

		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif

		RE_Direct( directLight, geometry, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )

	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {

		spotLight = spotLights[ i ];

		getSpotLightInfo( spotLight, geometry, directLight );

		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif

		RE_Direct( directLight, geometry, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )

	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {

		directionalLight = directionalLights[ i ];

		getDirectionalLightInfo( directionalLight, geometry, directLight );

		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif

		RE_Direct( directLight, geometry, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )

	RectAreaLight rectAreaLight;

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {

		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if defined( RE_IndirectDiffuse )

	vec3 iblIrradiance = vec3( 0.0 );

	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );

	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );

	#if ( NUM_HEMI_LIGHTS > 0 )

		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {

			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );

		}
		#pragma unroll_loop_end

	#endif

#endif

#if defined( RE_IndirectSpecular )

	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );

#endif
`;var ob=`
#if defined( RE_IndirectDiffuse )

	#ifdef USE_LIGHTMAP

		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;

		#ifndef PHYSICALLY_CORRECT_LIGHTS

			lightMapIrradiance *= PI;

		#endif

		irradiance += lightMapIrradiance;

	#endif

	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )

		iblIrradiance += getIBLIrradiance( geometry.normal );

	#endif

#endif

#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )

	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );

	#ifdef USE_CLEARCOAT

		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );

	#endif

#endif
`;var ib=`
#if defined( RE_IndirectDiffuse )

	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );

#endif

#if defined( RE_IndirectSpecular )

	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );

#endif
`;var sb=`
#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )

	// Doing a strict comparison with == 1.0 can cause noise artifacts
	// on some platforms. See issue #17623.
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;

#endif
`;var ab=`
#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )

	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;

#endif
`;var lb=`
#ifdef USE_LOGDEPTHBUF

	#ifdef USE_LOGDEPTHBUF_EXT

		varying float vFragDepth;
		varying float vIsPerspective;

	#else

		uniform float logDepthBufFC;

	#endif

#endif
`;var cb=`
#ifdef USE_LOGDEPTHBUF

	#ifdef USE_LOGDEPTHBUF_EXT

		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );

	#else

		if ( isPerspectiveMatrix( projectionMatrix ) ) {

			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;

			gl_Position.z *= gl_Position.w;

		}

	#endif

#endif
`;var ub=`
#ifdef USE_MAP

	vec4 texelColor = texture2D( map, vUv );

	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;

#endif
`;var pb=`
#ifdef USE_MAP

	uniform sampler2D map;

#endif
`;var db=`
#if defined( USE_MAP ) || defined( USE_ALPHAMAP )

	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;

#endif

#ifdef USE_MAP

	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );

#endif

#ifdef USE_ALPHAMAP

	diffuseColor.a *= texture2D( alphaMap, uv ).g;

#endif
`;var fb=`
#if defined( USE_MAP ) || defined( USE_ALPHAMAP )

	uniform mat3 uvTransform;

#endif

#ifdef USE_MAP

	uniform sampler2D map;

#endif

#ifdef USE_ALPHAMAP

	uniform sampler2D alphaMap;

#endif
`;var mb=`
float metalnessFactor = metalness;

#ifdef USE_METALNESSMAP

	vec4 texelMetalness = texture2D( metalnessMap, vUv );

	// reads channel B, compatible with a combined OcclusionRoughnessMetallic (RGB) texture
	metalnessFactor *= texelMetalness.b;

#endif
`;var hb=`
#ifdef USE_METALNESSMAP

	uniform sampler2D metalnessMap;

#endif
`;var _b=`
#ifdef USE_MORPHNORMALS

	// morphTargetBaseInfluence is set based on BufferGeometry.morphTargetsRelative value:
	// When morphTargetsRelative is false, this is set to 1 - sum(influences); this results in normal = sum((target - base) * influence)
	// When morphTargetsRelative is true, this is set to 1; as a result, all morph targets are simply added to the base after weighting
	objectNormal *= morphTargetBaseInfluence;

	#ifdef MORPHTARGETS_TEXTURE

		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {

			if ( morphTargetInfluences[ i ] > 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1, 2 ) * morphTargetInfluences[ i ];

		}

	#else

		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];

	#endif

#endif
`;var gb=`
#ifdef USE_MORPHTARGETS

	uniform float morphTargetBaseInfluence;

	#ifdef MORPHTARGETS_TEXTURE

		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform vec2 morphTargetsTextureSize;

		vec3 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset, const in int stride ) {

			float texelIndex = float( vertexIndex * stride + offset );
			float y = floor( texelIndex / morphTargetsTextureSize.x );
			float x = texelIndex - y * morphTargetsTextureSize.x;

			vec3 morphUV = vec3( ( x + 0.5 ) / morphTargetsTextureSize.x, y / morphTargetsTextureSize.y, morphTargetIndex );
			return texture( morphTargetsTexture, morphUV ).xyz;

		}

	#else

		#ifndef USE_MORPHNORMALS

			uniform float morphTargetInfluences[ 8 ];

		#else

			uniform float morphTargetInfluences[ 4 ];

		#endif

	#endif

#endif
`;var vb=`
#ifdef USE_MORPHTARGETS

	// morphTargetBaseInfluence is set based on BufferGeometry.morphTargetsRelative value:
	// When morphTargetsRelative is false, this is set to 1 - sum(influences); this results in position = sum((target - base) * influence)
	// When morphTargetsRelative is true, this is set to 1; as a result, all morph targets are simply added to the base after weighting
	transformed *= morphTargetBaseInfluence;

	#ifdef MORPHTARGETS_TEXTURE

		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {

			#ifndef USE_MORPHNORMALS

				if ( morphTargetInfluences[ i ] > 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 1 ) * morphTargetInfluences[ i ];

			#else

				if ( morphTargetInfluences[ i ] > 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 2 ) * morphTargetInfluences[ i ];

			#endif

		}

	#else

		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];

		#ifndef USE_MORPHNORMALS

			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];

		#endif

	#endif

#endif
`;var yb=`
float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;

#ifdef FLAT_SHADED

	// Workaround for Adreno GPUs not able to do dFdx( vViewPosition )

	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );

#else

	vec3 normal = normalize( vNormal );

	#ifdef DOUBLE_SIDED

		normal = normal * faceDirection;

	#endif

	#ifdef USE_TANGENT

		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );

		#ifdef DOUBLE_SIDED

			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;

		#endif

		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )

			mat3 vTBN = mat3( tangent, bitangent, normal );

		#endif

	#endif

#endif

// non perturbed normal for clearcoat among others

vec3 geometryNormal = normal;

`;var bb=`

#ifdef OBJECTSPACE_NORMALMAP

	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0; // overrides both flatShading and attribute normals

	#ifdef FLIP_SIDED

		normal = - normal;

	#endif

	#ifdef DOUBLE_SIDED

		normal = normal * faceDirection;

	#endif

	normal = normalize( normalMatrix * normal );

#elif defined( TANGENTSPACE_NORMALMAP )

	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;

	#ifdef USE_TANGENT

		normal = normalize( vTBN * mapN );

	#else

		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );

	#endif

#elif defined( USE_BUMPMAP )

	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );

#endif
`;var xb=`
#ifndef FLAT_SHADED

	varying vec3 vNormal;

	#ifdef USE_TANGENT

		varying vec3 vTangent;
		varying vec3 vBitangent;

	#endif

#endif
`;var Cb=`
#ifndef FLAT_SHADED

	varying vec3 vNormal;

	#ifdef USE_TANGENT

		varying vec3 vTangent;
		varying vec3 vBitangent;

	#endif

#endif
`;var Tb=`
#ifndef FLAT_SHADED // normal is computed with derivatives when FLAT_SHADED

	vNormal = normalize( transformedNormal );

	#ifdef USE_TANGENT

		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );

	#endif

#endif
`;var Eb=`
#ifdef USE_NORMALMAP

	uniform sampler2D normalMap;
	uniform vec2 normalScale;

#endif

#ifdef OBJECTSPACE_NORMALMAP

	uniform mat3 normalMatrix;

#endif

#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )

	// Normal Mapping Without Precomputed Tangents
	// http://www.thetenthplanet.de/archives/1180

	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {

		// Workaround for Adreno 3XX dFd*( vec3 ) bug. See #9988

		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );

		vec3 N = surf_norm; // normalized

		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );

		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;

		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );

		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );

	}

#endif
`;var Ab=`
#ifdef USE_CLEARCOAT

	vec3 clearcoatNormal = geometryNormal;

#endif
`;var Mb=`
#ifdef USE_CLEARCOAT_NORMALMAP

	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;

	#ifdef USE_TANGENT

		clearcoatNormal = normalize( vTBN * clearcoatMapN );

	#else

		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );

	#endif

#endif
`;var Nb=`

#ifdef USE_CLEARCOATMAP

	uniform sampler2D clearcoatMap;

#endif

#ifdef USE_CLEARCOAT_ROUGHNESSMAP

	uniform sampler2D clearcoatRoughnessMap;

#endif

#ifdef USE_CLEARCOAT_NORMALMAP

	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;

#endif
`;var Sb=`
#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif

// https://github.com/mrdoob/three.js/pull/22425
#ifdef USE_TRANSMISSION
diffuseColor.a *= transmissionAlpha + 0.1;
#endif

gl_FragColor = vec4( outgoingLight, diffuseColor.a );
`;var Pb=`
vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}

vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}

const float PackUpscale = 256. / 255.; // fraction -> 0..1 (including 1)
const float UnpackDownscale = 255. / 256.; // 0..1 -> fraction (excluding 1)

const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );

const float ShiftRight8 = 1. / 256.;

vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8; // tidy overflow
	return r * PackUpscale;
}

float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}

vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}

vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}

// NOTE: viewZ/eyeZ is < 0 when in front of the camera per OpenGL conventions

float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}

// NOTE: https://twitter.com/gonnavis/status/1377183786949959682

float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}
`;var Ob=`
#ifdef PREMULTIPLIED_ALPHA

	// Get get normal blending with premultipled, use with CustomBlending, OneFactor, OneMinusSrcAlphaFactor, AddEquation.
	gl_FragColor.rgb *= gl_FragColor.a;

#endif
`;var wb=`
vec4 mvPosition = vec4( transformed, 1.0 );

#ifdef USE_INSTANCING

	mvPosition = instanceMatrix * mvPosition;

#endif

mvPosition = modelViewMatrix * mvPosition;

gl_Position = projectionMatrix * mvPosition;
`;var Rb=`
#ifdef DITHERING

	gl_FragColor.rgb = dithering( gl_FragColor.rgb );

#endif
`;var Lb=`
#ifdef DITHERING

	// based on https://www.shadertoy.com/view/MslGR8
	vec3 dithering( vec3 color ) {
		//Calculate grid position
		float grid_position = rand( gl_FragCoord.xy );

		//Shift the individual colors differently, thus making it even harder to see the dithering pattern
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );

		//modify shift acording to grid position.
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );

		//shift the color by dither_shift
		return color + dither_shift_RGB;
	}

#endif
`;var Ib=`
float roughnessFactor = roughness;

#ifdef USE_ROUGHNESSMAP

	vec4 texelRoughness = texture2D( roughnessMap, vUv );

	// reads channel G, compatible with a combined OcclusionRoughnessMetallic (RGB) texture
	roughnessFactor *= texelRoughness.g;

#endif
`;var Db=`
#ifdef USE_ROUGHNESSMAP

	uniform sampler2D roughnessMap;

#endif
`;var Dd=`
#ifdef USE_SHADOWMAP

	#if NUM_DIR_LIGHT_SHADOWS > 0

		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];

		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};

		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];

	#endif

	#if NUM_SPOT_LIGHT_SHADOWS > 0

		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];

		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};

		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];

	#endif

	#if NUM_POINT_LIGHT_SHADOWS > 0

		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];

		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};

		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];

	#endif

	/*
	#if NUM_RECT_AREA_LIGHTS > 0

		// TODO (abelnation): create uniforms for area light shadows

	#endif
	*/

	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {

		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );

	}

	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {

		return unpackRGBATo2Half( texture2D( shadow, uv ) );

	}

	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){

		float occlusion = 1.0;

		vec2 distribution = texture2DDistribution( shadow, uv );

		float hard_shadow = step( compare , distribution.x ); // Hard Shadow

		if (hard_shadow != 1.0 ) {

			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance ); // Chebeyshevs inequality
			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed
			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );

		}
		return occlusion;

	}

	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {

		float shadow = 1.0;

		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;

		// if ( something && something ) breaks ATI OpenGL shader compiler
		// if ( all( something, something ) ) using this instead

		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );

		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );

		bool frustumTest = all( frustumTestVec );

		if ( frustumTest ) {

		#if defined( SHADOWMAP_TYPE_PCF )

			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;

			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;

			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );

		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )

			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;

			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;

			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );

		#elif defined( SHADOWMAP_TYPE_VSM )

			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );

		#else // no percentage-closer filtering:

			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );

		#endif

		}

		return shadow;

	}

	// cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D
	// vector suitable for 2D texture mapping. This code uses the following layout for the
	// 2D texture:
	//
	// xzXZ
	//  y Y
	//
	// Y - Positive y direction
	// y - Negative y direction
	// X - Positive x direction
	// x - Negative x direction
	// Z - Positive z direction
	// z - Negative z direction
	//
	// Source and test bed:
	// https://gist.github.com/tschw/da10c43c467ce8afd0c4

	vec2 cubeToUV( vec3 v, float texelSizeY ) {

		// Number of texels to avoid at the edge of each square

		vec3 absV = abs( v );

		// Intersect unit cube

		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;

		// Apply scale to avoid seams

		// two texels less per square (one texel will do for NEAREST)
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );

		// Unwrap

		// space: -1 ... 1 range for each square
		//
		// #X##		dim    := ( 4 , 2 )
		//  # #		center := ( 1 , 1 )

		vec2 planar = v.xy;

		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;

		if ( absV.z >= almostOne ) {

			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;

		} else if ( absV.x >= almostOne ) {

			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;

		} else if ( absV.y >= almostOne ) {

			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;

		}

		// Transform to UV space

		// scale := 0.5 / dim
		// translate := ( center + 0.5 ) / dim
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );

	}

	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {

		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );

		// for point lights, the uniform @vShadowCoord is re-purposed to hold
		// the vector from the light to the world-space position of the fragment.
		vec3 lightToPosition = shadowCoord.xyz;

		// dp = normalized distance from light to fragment position
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?
		dp += shadowBias;

		// bd3D = base direction 3D
		vec3 bd3D = normalize( lightToPosition );

		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )

			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;

			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );

		#else // no percentage-closer filtering

			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );

		#endif

	}

#endif
`;var Bb=`
#ifdef USE_SHADOWMAP

	#if NUM_DIR_LIGHT_SHADOWS > 0

		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];

		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};

		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];

	#endif

	#if NUM_SPOT_LIGHT_SHADOWS > 0

		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];

		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};

		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];

	#endif

	#if NUM_POINT_LIGHT_SHADOWS > 0

		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];

		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};

		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];

	#endif

	/*
	#if NUM_RECT_AREA_LIGHTS > 0

		// TODO (abelnation): uniforms for area light shadows

	#endif
	*/

#endif
`;var kb=`
#ifdef USE_SHADOWMAP

	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0

		// Offsetting the position used for querying occlusion along the world normal can be used to reduce shadow acne.
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;

	#endif

	#if NUM_DIR_LIGHT_SHADOWS > 0

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {

		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;

	}
	#pragma unroll_loop_end

	#endif

	#if NUM_SPOT_LIGHT_SHADOWS > 0

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {

		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;

	}
	#pragma unroll_loop_end

	#endif

	#if NUM_POINT_LIGHT_SHADOWS > 0

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {

		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;

	}
	#pragma unroll_loop_end

	#endif

	/*
	#if NUM_RECT_AREA_LIGHTS > 0

		// TODO (abelnation): update vAreaShadowCoord with area light info

	#endif
	*/

#endif
`;var Fb=`
float getShadowMask() {

	float shadow = 1.0;

	#ifdef USE_SHADOWMAP

	#if NUM_DIR_LIGHT_SHADOWS > 0

	DirectionalLightShadow directionalLight;

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {

		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;

	}
	#pragma unroll_loop_end

	#endif

	#if NUM_SPOT_LIGHT_SHADOWS > 0

	SpotLightShadow spotLight;

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {

		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;

	}
	#pragma unroll_loop_end

	#endif

	#if NUM_POINT_LIGHT_SHADOWS > 0

	PointLightShadow pointLight;

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {

		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;

	}
	#pragma unroll_loop_end

	#endif

	/*
	#if NUM_RECT_AREA_LIGHTS > 0

		// TODO (abelnation): update shadow for Area light

	#endif
	*/

	#endif

	return shadow;

}
`;var Gb=`
#ifdef USE_SKINNING

	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );

#endif
`;var Ub=`
#ifdef USE_SKINNING

	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;

	#ifdef BONE_TEXTURE

		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;

		mat4 getBoneMatrix( const in float i ) {

			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );

			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );

			y = dy * ( y + 0.5 );

			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );

			mat4 bone = mat4( v1, v2, v3, v4 );

			return bone;

		}

	#else

		uniform mat4 boneMatrices[ MAX_BONES ];

		mat4 getBoneMatrix( const in float i ) {

			mat4 bone = boneMatrices[ int(i) ];
			return bone;

		}

	#endif

#endif
`;var Vb=`
#ifdef USE_SKINNING

	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );

	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;

	transformed = ( bindMatrixInverse * skinned ).xyz;

#endif
`;var zb=`
#ifdef USE_SKINNING

	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;

	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;

	#ifdef USE_TANGENT

		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;

	#endif

#endif
`;var Hb=`
float specularStrength;

#ifdef USE_SPECULARMAP

	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;

#else

	specularStrength = 1.0;

#endif
`;var jb=`
#ifdef USE_SPECULARMAP

	uniform sampler2D specularMap;

#endif
`;var qb=`
#if defined( TONE_MAPPING )

	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );

#endif
`;var Wb=`
#ifndef saturate
// <common> may have defined saturate() already
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif

uniform float toneMappingExposure;

// exposure only
vec3 LinearToneMapping( vec3 color ) {

	return toneMappingExposure * color;

}

// source: https://www.cs.utah.edu/~reinhard/cdrom/
vec3 ReinhardToneMapping( vec3 color ) {

	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );

}

// source: http://filmicworlds.com/blog/filmic-tonemapping-operators/
vec3 OptimizedCineonToneMapping( vec3 color ) {

	// optimized filmic operator by Jim Hejl and Richard Burgess-Dawson
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );

}

// source: https://github.com/selfshadow/ltc_code/blob/master/webgl/shaders/ltc/ltc_blit.fs
vec3 RRTAndODTFit( vec3 v ) {

	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;

}

// this implementation of ACES is modified to accommodate a brighter viewing environment.
// the scale factor of 1/0.6 is subjective. see discussion in #19621.

vec3 ACESFilmicToneMapping( vec3 color ) {

	// sRGB => XYZ => D65_2_D60 => AP1 => RRT_SAT
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ), // transposed from source
		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);

	// ODT_SAT => XYZ => D60_2_D65 => sRGB
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ), // transposed from source
		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);

	color *= toneMappingExposure / 0.6;

	color = ACESInputMat * color;

	// Apply RRT and ODT
	color = RRTAndODTFit( color );

	color = ACESOutputMat * color;

	// Clamp to [0, 1]
	return saturate( color );

}

vec3 CustomToneMapping( vec3 color ) { return color; }
`;var $b=`
#ifdef USE_TRANSMISSION

	float transmissionAlpha = 1.0;
	float transmissionFactor = transmission;
	float thicknessFactor = thickness;

	#ifdef USE_TRANSMISSIONMAP

		transmissionFactor *= texture2D( transmissionMap, vUv ).r;

	#endif

	#ifdef USE_THICKNESSMAP

		thicknessFactor *= texture2D( thicknessMap, vUv ).g;

	#endif

	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );

	vec4 transmission = getIBLVolumeRefraction(
		n, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,
		attenuationTint, attenuationDistance );

	totalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );
	transmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );
#endif
`;var Yb=`
#ifdef USE_TRANSMISSION

	// Transmission code is based on glTF-Sampler-Viewer
	// https://github.com/KhronosGroup/glTF-Sample-Viewer

	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationTint;

	#ifdef USE_TRANSMISSIONMAP

		uniform sampler2D transmissionMap;

	#endif

	#ifdef USE_THICKNESSMAP

		uniform sampler2D thicknessMap;

	#endif

	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;

	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;

	varying vec3 vWorldPosition;

	vec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {

		// Direction of refracted light.
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );

		// Compute rotation-independant scaling of the model matrix.
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );

		// The thickness is specified in local space.
		return normalize( refractionVector ) * thickness * modelScale;

	}

	float applyIorToRoughness( float roughness, float ior ) {

		// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and
		// an IOR of 1.5 results in the default amount of microfacet refraction.
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );

	}

	vec4 getTransmissionSample( vec2 fragCoord, float roughness, float ior ) {

		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );

		#ifdef TEXTURE_LOD_EXT

			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );

		#else

			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );

		#endif

	}

	vec3 applyVolumeAttenuation( vec3 radiance, float transmissionDistance, vec3 attenuationColor, float attenuationDistance ) {

		if ( attenuationDistance == 0.0 ) {

			// Attenuation distance is +\u221E (which we indicate by zero), i.e. the transmitted color is not attenuated at all.
			return radiance;

		} else {

			// Compute light attenuation using Beer's law.
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance ); // Beer's law
			return transmittance * radiance;

		}

	}

	vec4 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 diffuseColor, vec3 specularColor, float specularF90,
		vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness,
		vec3 attenuationColor, float attenuationDistance ) {

		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;

		// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;

		// Sample framebuffer to get pixel the refracted ray hits.
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );

		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );

		// Get the specular component.
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );

		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );

	}
#endif
`;var Xb=`
#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )

	varying vec2 vUv;

#endif
`;var Jb=`
#ifdef USE_UV

	#ifdef UVS_VERTEX_ONLY

		vec2 vUv;

	#else

		varying vec2 vUv;

	#endif

	uniform mat3 uvTransform;

#endif
`;var Kb=`
#ifdef USE_UV

	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;

#endif
`;var Zb=`
#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )

	varying vec2 vUv2;

#endif
`;var Qb=`
#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )

	attribute vec2 uv2;
	varying vec2 vUv2;

	uniform mat3 uv2Transform;

#endif
`;var ex=`
#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )

	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;

#endif
`;var tx=`
#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )

	vec4 worldPosition = vec4( transformed, 1.0 );

	#ifdef USE_INSTANCING

		worldPosition = instanceMatrix * worldPosition;

	#endif

	worldPosition = modelMatrix * worldPosition;

#endif
`;var rx=`
varying vec2 vUv;
uniform mat3 uvTransform;

void main() {

	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;

	gl_Position = vec4( position.xy, 1.0, 1.0 );

}
`,nx=`
uniform sampler2D t2D;

varying vec2 vUv;

void main() {

	vec4 texColor = texture2D( t2D, vUv );

	gl_FragColor = mapTexelToLinear( texColor );

	#include <tonemapping_fragment>
	#include <encodings_fragment>

}
`;var ox=`
varying vec3 vWorldDirection;

#include <common>

void main() {

	vWorldDirection = transformDirection( position, modelMatrix );

	#include <begin_vertex>
	#include <project_vertex>

	gl_Position.z = gl_Position.w; // set z to camera.far

}
`,ix=`
#include <envmap_common_pars_fragment>
uniform float opacity;

varying vec3 vWorldDirection;

#include <cube_uv_reflection_fragment>

void main() {

	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>

	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;

	#include <tonemapping_fragment>
	#include <encodings_fragment>

}
`;var sx=`
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

// This is used for computing an equivalent of gl_FragCoord.z that is as high precision as possible.
// Some platforms compute gl_FragCoord at a lower precision which makes the manually computed value better for
// depth-based postprocessing effects. Reproduced on iPad with A10 processor / iPadOS 13.3.1.
varying vec2 vHighPrecisionZW;

void main() {

	#include <uv_vertex>

	#include <skinbase_vertex>

	#ifdef USE_DISPLACEMENTMAP

		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>

	#endif

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vHighPrecisionZW = gl_Position.zw;

}
`,ax=`
#if DEPTH_PACKING == 3200

	uniform float opacity;

#endif

#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

varying vec2 vHighPrecisionZW;

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( 1.0 );

	#if DEPTH_PACKING == 3200

		diffuseColor.a = opacity;

	#endif

	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>

	#include <logdepthbuf_fragment>

	// Higher precision equivalent of gl_FragCoord.z. This assumes depthRange has been left to its default values.
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;

	#if DEPTH_PACKING == 3200

		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );

	#elif DEPTH_PACKING == 3201

		gl_FragColor = packDepthToRGBA( fragCoordZ );

	#endif

}
`;var lx=`
#define DISTANCE

varying vec3 vWorldPosition;

#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>

	#include <skinbase_vertex>

	#ifdef USE_DISPLACEMENTMAP

		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>

	#endif

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>

	vWorldPosition = worldPosition.xyz;

}
`,cx=`
#define DISTANCE

uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;

#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>

void main () {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( 1.0 );

	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>

	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist ); // clamp to [ 0, 1 ]

	gl_FragColor = packDepthToRGBA( dist );

}
`;var ux=`
varying vec3 vWorldDirection;

#include <common>

void main() {

	vWorldDirection = transformDirection( position, modelMatrix );

	#include <begin_vertex>
	#include <project_vertex>

}
`,px=`
uniform sampler2D tEquirect;

varying vec3 vWorldDirection;

#include <common>

void main() {

	vec3 direction = normalize( vWorldDirection );

	vec2 sampleUV = equirectUv( direction );

	vec4 texColor = texture2D( tEquirect, sampleUV );

	gl_FragColor = mapTexelToLinear( texColor );

	#include <tonemapping_fragment>
	#include <encodings_fragment>

}
`;var dx=`
uniform float scale;
attribute float lineDistance;

varying float vLineDistance;

#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	vLineDistance = scale * lineDistance;

	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>

}
`,fx=`
uniform vec3 diffuse;
uniform float opacity;

uniform float dashSize;
uniform float totalSize;

varying float vLineDistance;

#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	if ( mod( vLineDistance, totalSize ) > dashSize ) {

		discard;

	}

	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );

	#include <logdepthbuf_fragment>
	#include <color_fragment>

	outgoingLight = diffuseColor.rgb; // simple shader

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>

}
`;var mx=`
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>

	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )

		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>

	#endif

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>

}
`,hx=`
uniform vec3 diffuse;
uniform float opacity;

#ifndef FLAT_SHADED

	varying vec3 vNormal;

#endif

#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>

	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );

	// accumulation (baked indirect lighting only)
	#ifdef USE_LIGHTMAP

		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;

	#else

		reflectedLight.indirectDiffuse += vec3( 1.0 );

	#endif

	// modulation
	#include <aomap_fragment>

	reflectedLight.indirectDiffuse *= diffuseColor.rgb;

	vec3 outgoingLight = reflectedLight.indirectDiffuse;

	#include <envmap_fragment>

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`;var _x=`
#define LAMBERT

varying vec3 vLightFront;
varying vec3 vIndirectFront;

#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif

#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}
`,gx=`
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;

varying vec3 vLightFront;
varying vec3 vIndirectFront;

#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif


#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>

	// accumulation

	#ifdef DOUBLE_SIDED

		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;

	#else

		reflectedLight.indirectDiffuse += vIndirectFront;

	#endif

	#include <lightmap_fragment>

	reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );

	#ifdef DOUBLE_SIDED

		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;

	#else

		reflectedLight.directDiffuse = vLightFront;

	#endif

	reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();

	// modulation

	#include <aomap_fragment>

	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;

	#include <envmap_fragment>

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}
`;var vx=`
#define MATCAP

varying vec3 vViewPosition;

#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>

#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>

	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>

	vViewPosition = - mvPosition.xyz;

}
`,yx=`
#define MATCAP

uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;

varying vec3 vViewPosition;

#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>

	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks

	#ifdef USE_MATCAP

		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );

	#else

		vec4 matcapColor = vec4( 1.0 );

	#endif

	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`;var bx=`
#define NORMAL

#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )

	varying vec3 vViewPosition;

#endif

#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )

	vViewPosition = - mvPosition.xyz;

#endif

}
`,xx=`
#define NORMAL

uniform float opacity;

#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )

	varying vec3 vViewPosition;

#endif

#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>

	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );

}
`;var Cx=`
#define PHONG

varying vec3 vViewPosition;

#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vViewPosition = - mvPosition.xyz;

	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>

}
`,Tx=`
#define PHONG

uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;

#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>

	// accumulation
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>

	// modulation
	#include <aomap_fragment>

	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;

	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`;var Ex=`
#define STANDARD

varying vec3 vViewPosition;

#ifdef USE_TRANSMISSION

	varying vec3 vWorldPosition;

#endif

#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vViewPosition = - mvPosition.xyz;

	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>

#ifdef USE_TRANSMISSION

	vWorldPosition = worldPosition.xyz;

#endif
}
`,Ax=`
#define STANDARD

#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif

uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;

#ifdef IOR
	uniform float ior;
#endif

#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularTint;

	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif

	#ifdef USE_SPECULARTINTMAP
		uniform sampler2D specularTintMap;
	#endif
#endif

#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif

#ifdef USE_SHEEN
	uniform vec3 sheenTint;
	uniform float sheenRoughness;
#endif

varying vec3 vViewPosition;

#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>

	// accumulation
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>

	// modulation
	#include <aomap_fragment>

	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;

	#include <transmission_fragment>

	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;

	#ifdef USE_CLEARCOAT

		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );

		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );

		outgoingLight = outgoingLight * ( 1.0 - clearcoat * Fcc ) + clearcoatSpecular * clearcoat;

	#endif

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`;var Mx=`
#define TOON

varying vec3 vViewPosition;

#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vViewPosition = - mvPosition.xyz;

	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>

}
`,Nx=`
#define TOON

uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;

#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>

	// accumulation
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>

	// modulation
	#include <aomap_fragment>

	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`;var Sx=`
uniform float size;
uniform float scale;

#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>

	gl_PointSize = size;

	#ifdef USE_SIZEATTENUATION

		bool isPerspective = isPerspectiveMatrix( projectionMatrix );

		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );

	#endif

	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>

}
`,Px=`
uniform vec3 diffuse;
uniform float opacity;

#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );

	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>

	outgoingLight = diffuseColor.rgb;

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>

}
`;var Ox=`
#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>

void main() {

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>

	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>

}
`,wx=`
uniform vec3 color;
uniform float opacity;

#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>

void main() {

	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );

	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>

}
`;var Rx=`
uniform float rotation;
uniform vec2 center;

#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>

	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );

	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

	#ifndef USE_SIZEATTENUATION

		bool isPerspective = isPerspectiveMatrix( projectionMatrix );

		if ( isPerspective ) scale *= - mvPosition.z;

	#endif

	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;

	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;

	mvPosition.xy += rotatedPosition;

	gl_Position = projectionMatrix * mvPosition;

	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>

}
`,Lx=`
uniform vec3 diffuse;
uniform float opacity;

#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>

	outgoingLight = diffuseColor.rgb;

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>

}
`;var dr={alphamap_fragment:cy,alphamap_pars_fragment:uy,alphatest_fragment:py,alphatest_pars_fragment:dy,aomap_fragment:fy,aomap_pars_fragment:my,begin_vertex:hy,beginnormal_vertex:_y,bsdfs:gy,bumpmap_pars_fragment:vy,clipping_planes_fragment:yy,clipping_planes_pars_fragment:by,clipping_planes_pars_vertex:xy,clipping_planes_vertex:Cy,color_fragment:Ty,color_pars_fragment:Ey,color_pars_vertex:Ay,color_vertex:My,common:Ny,cube_uv_reflection_fragment:Sy,defaultnormal_vertex:Py,displacementmap_pars_vertex:Oy,displacementmap_vertex:wy,emissivemap_fragment:Ry,emissivemap_pars_fragment:Ly,encodings_fragment:Iy,encodings_pars_fragment:Dy,envmap_fragment:By,envmap_common_pars_fragment:ky,envmap_pars_fragment:Fy,envmap_pars_vertex:Gy,envmap_physical_pars_fragment:Jy,envmap_vertex:Uy,fog_vertex:Vy,fog_pars_vertex:zy,fog_fragment:Hy,fog_pars_fragment:jy,gradientmap_pars_fragment:qy,lightmap_fragment:Wy,lightmap_pars_fragment:$y,lights_lambert_vertex:Yy,lights_pars_begin:Xy,lights_toon_fragment:Ky,lights_toon_pars_fragment:Zy,lights_phong_fragment:Qy,lights_phong_pars_fragment:eb,lights_physical_fragment:tb,lights_physical_pars_fragment:rb,lights_fragment_begin:nb,lights_fragment_maps:ob,lights_fragment_end:ib,logdepthbuf_fragment:sb,logdepthbuf_pars_fragment:ab,logdepthbuf_pars_vertex:lb,logdepthbuf_vertex:cb,map_fragment:ub,map_pars_fragment:pb,map_particle_fragment:db,map_particle_pars_fragment:fb,metalnessmap_fragment:mb,metalnessmap_pars_fragment:hb,morphnormal_vertex:_b,morphtarget_pars_vertex:gb,morphtarget_vertex:vb,normal_fragment_begin:yb,normal_fragment_maps:bb,normal_pars_fragment:xb,normal_pars_vertex:Cb,normal_vertex:Tb,normalmap_pars_fragment:Eb,clearcoat_normal_fragment_begin:Ab,clearcoat_normal_fragment_maps:Mb,clearcoat_pars_fragment:Nb,output_fragment:Sb,packing:Pb,premultiplied_alpha_fragment:Ob,project_vertex:wb,dithering_fragment:Rb,dithering_pars_fragment:Lb,roughnessmap_fragment:Ib,roughnessmap_pars_fragment:Db,shadowmap_pars_fragment:Dd,shadowmap_pars_vertex:Bb,shadowmap_vertex:kb,shadowmask_pars_fragment:Fb,skinbase_vertex:Gb,skinning_pars_vertex:Ub,skinning_vertex:Vb,skinnormal_vertex:zb,specularmap_fragment:Hb,specularmap_pars_fragment:jb,tonemapping_fragment:qb,tonemapping_pars_fragment:Wb,transmission_fragment:$b,transmission_pars_fragment:Yb,uv_pars_fragment:Xb,uv_pars_vertex:Jb,uv_vertex:Kb,uv2_pars_fragment:Zb,uv2_pars_vertex:Qb,uv2_vertex:ex,worldpos_vertex:tx,background_vert:rx,background_frag:nx,cube_vert:ox,cube_frag:ix,depth_vert:sx,depth_frag:ax,distanceRGBA_vert:lx,distanceRGBA_frag:cx,equirect_vert:ux,equirect_frag:px,linedashed_vert:dx,linedashed_frag:fx,meshbasic_vert:mx,meshbasic_frag:hx,meshlambert_vert:_x,meshlambert_frag:gx,meshmatcap_vert:vx,meshmatcap_frag:yx,meshnormal_vert:bx,meshnormal_frag:xx,meshphong_vert:Cx,meshphong_frag:Tx,meshphysical_vert:Ex,meshphysical_frag:Ax,meshtoon_vert:Mx,meshtoon_frag:Nx,points_vert:Sx,points_frag:Px,shadow_vert:Ox,shadow_frag:wx,sprite_vert:Rx,sprite_frag:Lx};var vt={common:{diffuse:{value:new Ke(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Io},uv2Transform:{value:new Io},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new re(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ke(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ke(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Io}},sprite:{diffuse:{value:new Ke(16777215)},opacity:{value:1},center:{value:new re(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Io}}};var Jo={basic:{uniforms:to([vt.common,vt.specularmap,vt.envmap,vt.aomap,vt.lightmap,vt.fog]),vertexShader:dr.meshbasic_vert,fragmentShader:dr.meshbasic_frag},lambert:{uniforms:to([vt.common,vt.specularmap,vt.envmap,vt.aomap,vt.lightmap,vt.emissivemap,vt.fog,vt.lights,{emissive:{value:new Ke(0)}}]),vertexShader:dr.meshlambert_vert,fragmentShader:dr.meshlambert_frag},phong:{uniforms:to([vt.common,vt.specularmap,vt.envmap,vt.aomap,vt.lightmap,vt.emissivemap,vt.bumpmap,vt.normalmap,vt.displacementmap,vt.fog,vt.lights,{emissive:{value:new Ke(0)},specular:{value:new Ke(1118481)},shininess:{value:30}}]),vertexShader:dr.meshphong_vert,fragmentShader:dr.meshphong_frag},standard:{uniforms:to([vt.common,vt.envmap,vt.aomap,vt.lightmap,vt.emissivemap,vt.bumpmap,vt.normalmap,vt.displacementmap,vt.roughnessmap,vt.metalnessmap,vt.fog,vt.lights,{emissive:{value:new Ke(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:dr.meshphysical_vert,fragmentShader:dr.meshphysical_frag},toon:{uniforms:to([vt.common,vt.aomap,vt.lightmap,vt.emissivemap,vt.bumpmap,vt.normalmap,vt.displacementmap,vt.gradientmap,vt.fog,vt.lights,{emissive:{value:new Ke(0)}}]),vertexShader:dr.meshtoon_vert,fragmentShader:dr.meshtoon_frag},matcap:{uniforms:to([vt.common,vt.bumpmap,vt.normalmap,vt.displacementmap,vt.fog,{matcap:{value:null}}]),vertexShader:dr.meshmatcap_vert,fragmentShader:dr.meshmatcap_frag},points:{uniforms:to([vt.points,vt.fog]),vertexShader:dr.points_vert,fragmentShader:dr.points_frag},dashed:{uniforms:to([vt.common,vt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:dr.linedashed_vert,fragmentShader:dr.linedashed_frag},depth:{uniforms:to([vt.common,vt.displacementmap]),vertexShader:dr.depth_vert,fragmentShader:dr.depth_frag},normal:{uniforms:to([vt.common,vt.bumpmap,vt.normalmap,vt.displacementmap,{opacity:{value:1}}]),vertexShader:dr.meshnormal_vert,fragmentShader:dr.meshnormal_frag},sprite:{uniforms:to([vt.sprite,vt.fog]),vertexShader:dr.sprite_vert,fragmentShader:dr.sprite_frag},background:{uniforms:{uvTransform:{value:new Io},t2D:{value:null}},vertexShader:dr.background_vert,fragmentShader:dr.background_frag},cube:{uniforms:to([vt.envmap,{opacity:{value:1}}]),vertexShader:dr.cube_vert,fragmentShader:dr.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:dr.equirect_vert,fragmentShader:dr.equirect_frag},distanceRGBA:{uniforms:to([vt.common,vt.displacementmap,{referencePosition:{value:new F},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:dr.distanceRGBA_vert,fragmentShader:dr.distanceRGBA_frag},shadow:{uniforms:to([vt.lights,vt.fog,{color:{value:new Ke(0)},opacity:{value:1}}]),vertexShader:dr.shadow_vert,fragmentShader:dr.shadow_frag}};Jo.physical={uniforms:to([Jo.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new re(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenTint:{value:new Ke(0)},sheenRoughness:{value:0},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new re},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationTint:{value:new Ke(0)},specularIntensity:{value:0},specularIntensityMap:{value:null},specularTint:{value:new Ke(1,1,1)},specularTintMap:{value:null}}]),vertexShader:dr.meshphysical_vert,fragmentShader:dr.meshphysical_frag};function Ix(n,e,t,r,o){let s=new Ke(0),i=0,l,a,c=null,h=0,g=null;function p(d,f){let _=!1,m=f.isScene===!0?f.background:null;m&&m.isTexture&&(m=e.get(m));let v=n.xr,y=v.getSession&&v.getSession();y&&y.environmentBlendMode==="additive"&&(m=null),m===null?u(s,i):m&&m.isColor&&(u(m,1),_=!0),(n.autoClear||_)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),m&&(m.isCubeTexture||m.mapping===Si)?(a===void 0&&(a=new wr(new wi(1,1,1),new co({name:"BackgroundCubeMaterial",uniforms:r0(Jo.cube.uniforms),vertexShader:Jo.cube.vertexShader,fragmentShader:Jo.cube.fragmentShader,side:Nr,depthTest:!1,depthWrite:!1,fog:!1})),a.geometry.deleteAttribute("normal"),a.geometry.deleteAttribute("uv"),a.onBeforeRender=function(b,x,E){this.matrixWorld.copyPosition(E.matrixWorld)},Object.defineProperty(a.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(a)),a.material.uniforms.envMap.value=m,a.material.uniforms.flipEnvMap.value=m.isCubeTexture&&m.isRenderTargetTexture===!1?-1:1,(c!==m||h!==m.version||g!==n.toneMapping)&&(a.material.needsUpdate=!0,c=m,h=m.version,g=n.toneMapping),d.unshift(a,a.geometry,a.material,0,0,null)):m&&m.isTexture&&(l===void 0&&(l=new wr(new B0(2,2),new co({name:"BackgroundMaterial",uniforms:r0(Jo.background.uniforms),vertexShader:Jo.background.vertexShader,fragmentShader:Jo.background.fragmentShader,side:eo,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(l)),l.material.uniforms.t2D.value=m,m.matrixAutoUpdate===!0&&m.updateMatrix(),l.material.uniforms.uvTransform.value.copy(m.matrix),(c!==m||h!==m.version||g!==n.toneMapping)&&(l.material.needsUpdate=!0,c=m,h=m.version,g=n.toneMapping),d.unshift(l,l.geometry,l.material,0,0,null))}function u(d,f){t.buffers.color.setClear(d.r,d.g,d.b,f,o)}return{getClearColor:function(){return s},setClearColor:function(d,f=1){s.set(d),i=f,u(s,i)},getClearAlpha:function(){return i},setClearAlpha:function(d){i=d,u(s,i)},render:p}}function Dx(n,e,t,r){let o=n.getParameter(n.MAX_VERTEX_ATTRIBS),s=r.isWebGL2?null:e.get("OES_vertex_array_object"),i=r.isWebGL2||s!==null,l={},a=f(null),c=a;function h($,H,ae,ue,me){let Ue=!1;if(i){let st=d(ue,ae,H);c!==st&&(c=st,p(c.object)),Ue=_(ue,me),Ue&&m(ue,me)}else{let st=H.wireframe===!0;(c.geometry!==ue.id||c.program!==ae.id||c.wireframe!==st)&&(c.geometry=ue.id,c.program=ae.id,c.wireframe=st,Ue=!0)}$.isInstancedMesh===!0&&(Ue=!0),me!==null&&t.update(me,n.ELEMENT_ARRAY_BUFFER),Ue&&(T($,H,ae,ue),me!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.get(me).buffer))}function g(){return r.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}function p($){return r.isWebGL2?n.bindVertexArray($):s.bindVertexArrayOES($)}function u($){return r.isWebGL2?n.deleteVertexArray($):s.deleteVertexArrayOES($)}function d($,H,ae){let ue=ae.wireframe===!0,me=l[$.id];me===void 0&&(me={},l[$.id]=me);let Ue=me[H.id];Ue===void 0&&(Ue={},me[H.id]=Ue);let st=Ue[ue];return st===void 0&&(st=f(g()),Ue[ue]=st),st}function f($){let H=[],ae=[],ue=[];for(let me=0;me<o;me++)H[me]=0,ae[me]=0,ue[me]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:H,enabledAttributes:ae,attributeDivisors:ue,object:$,attributes:{},index:null}}function _($,H){let ae=c.attributes,ue=$.attributes,me=0;for(let Ue in ue){let st=ae[Ue],ft=ue[Ue];if(st===void 0||st.attribute!==ft||st.data!==ft.data)return!0;me++}return c.attributesNum!==me||c.index!==H}function m($,H){let ae={},ue=$.attributes,me=0;for(let Ue in ue){let st=ue[Ue],ft={};ft.attribute=st,st.data&&(ft.data=st.data),ae[Ue]=ft,me++}c.attributes=ae,c.attributesNum=me,c.index=H}function v(){let $=c.newAttributes;for(let H=0,ae=$.length;H<ae;H++)$[H]=0}function y($){b($,0)}function b($,H){let ae=c.newAttributes,ue=c.enabledAttributes,me=c.attributeDivisors;ae[$]=1,ue[$]===0&&(n.enableVertexAttribArray($),ue[$]=1),me[$]!==H&&((r.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"]($,H),me[$]=H)}function x(){let $=c.newAttributes,H=c.enabledAttributes;for(let ae=0,ue=H.length;ae<ue;ae++)H[ae]!==$[ae]&&(n.disableVertexAttribArray(ae),H[ae]=0)}function E($,H,ae,ue,me,Ue){r.isWebGL2===!0&&(ae===n.INT||ae===n.UNSIGNED_INT)?n.vertexAttribIPointer($,H,ae,me,Ue):n.vertexAttribPointer($,H,ae,ue,me,Ue)}function T($,H,ae,ue){if(r.isWebGL2===!1&&($.isInstancedMesh||ue.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;v();let me=ue.attributes,Ue=ae.getAttributes(),st=H.defaultAttributeValues;for(let ft in Ue){let Ze=Ue[ft];if(Ze.location>=0){let gt=me[ft];if(gt===void 0&&(ft==="instanceMatrix"&&$.instanceMatrix&&(gt=$.instanceMatrix),ft==="instanceColor"&&$.instanceColor&&(gt=$.instanceColor)),gt!==void 0){let ce=gt.normalized,oe=gt.itemSize,yt=t.get(gt);if(yt===void 0)continue;let X=yt.buffer,Tt=yt.type,At=yt.bytesPerElement;if(gt.isInterleavedBufferAttribute){let Nt=gt.data,Mt=Nt.stride,Vt=gt.offset;if(Nt&&Nt.isInstancedInterleavedBuffer){for(let Re=0;Re<Ze.locationSize;Re++)b(Ze.location+Re,Nt.meshPerAttribute);$.isInstancedMesh!==!0&&ue._maxInstanceCount===void 0&&(ue._maxInstanceCount=Nt.meshPerAttribute*Nt.count)}else for(let Re=0;Re<Ze.locationSize;Re++)y(Ze.location+Re);n.bindBuffer(n.ARRAY_BUFFER,X);for(let Re=0;Re<Ze.locationSize;Re++)E(Ze.location+Re,oe/Ze.locationSize,Tt,ce,Mt*At,(Vt+oe/Ze.locationSize*Re)*At)}else{if(gt.isInstancedBufferAttribute){for(let Nt=0;Nt<Ze.locationSize;Nt++)b(Ze.location+Nt,gt.meshPerAttribute);$.isInstancedMesh!==!0&&ue._maxInstanceCount===void 0&&(ue._maxInstanceCount=gt.meshPerAttribute*gt.count)}else for(let Nt=0;Nt<Ze.locationSize;Nt++)y(Ze.location+Nt);n.bindBuffer(n.ARRAY_BUFFER,X);for(let Nt=0;Nt<Ze.locationSize;Nt++)E(Ze.location+Nt,oe/Ze.locationSize,Tt,ce,oe*At,oe/Ze.locationSize*Nt*At)}}else if(st!==void 0){let ce=st[ft];if(ce!==void 0)switch(ce.length){case 2:n.vertexAttrib2fv(Ze.location,ce);break;case 3:n.vertexAttrib3fv(Ze.location,ce);break;case 4:n.vertexAttrib4fv(Ze.location,ce);break;default:n.vertexAttrib1fv(Ze.location,ce)}}}}x()}function M(){L();for(let $ in l){let H=l[$];for(let ae in H){let ue=H[ae];for(let me in ue)u(ue[me].object),delete ue[me];delete H[ae]}delete l[$]}}function D($){if(l[$.id]===void 0)return;let H=l[$.id];for(let ae in H){let ue=H[ae];for(let me in ue)u(ue[me].object),delete ue[me];delete H[ae]}delete l[$.id]}function U($){for(let H in l){let ae=l[H];if(ae[$.id]===void 0)continue;let ue=ae[$.id];for(let me in ue)u(ue[me].object),delete ue[me];delete ae[$.id]}}function L(){se(),c!==a&&(c=a,p(c.object))}function se(){a.geometry=null,a.program=null,a.wireframe=!1}return{setup:h,reset:L,resetDefaultState:se,dispose:M,releaseStatesOfGeometry:D,releaseStatesOfProgram:U,initAttributes:v,enableAttribute:y,disableUnusedAttributes:x}}function Bx(n,e,t,r){let o=r.isWebGL2,s;function i(c){s=c}function l(c,h){n.drawArrays(s,c,h),t.update(h,s,1)}function a(c,h,g){if(g===0)return;let p,u;if(o)p=n,u="drawArraysInstanced";else if(p=e.get("ANGLE_instanced_arrays"),u="drawArraysInstancedANGLE",p===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}p[u](s,c,h,g),t.update(h,s,g)}this.setMode=i,this.render=l,this.renderInstances=a}function kx(n,e,t){let r;function o(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){let T=e.get("EXT_texture_filter_anisotropic");r=n.getParameter(T.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function s(T){if(T==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";T="mediump"}return T==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let i=typeof WebGL2RenderingContext!="undefined"&&n instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext!="undefined"&&n instanceof WebGL2ComputeRenderingContext,l=t.precision!==void 0?t.precision:"highp",a=s(l);a!==l&&(console.warn("THREE.WebGLRenderer:",l,"not supported, using",a,"instead."),l=a);let c=i||e.has("WEBGL_draw_buffers"),h=t.logarithmicDepthBuffer===!0,g=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),p=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),u=n.getParameter(n.MAX_TEXTURE_SIZE),d=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),f=n.getParameter(n.MAX_VERTEX_ATTRIBS),_=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),m=n.getParameter(n.MAX_VARYING_VECTORS),v=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),y=p>0,b=i||e.has("OES_texture_float"),x=y&&b,E=i?n.getParameter(n.MAX_SAMPLES):0;return{isWebGL2:i,drawBuffers:c,getMaxAnisotropy:o,getMaxPrecision:s,precision:l,logarithmicDepthBuffer:h,maxTextures:g,maxVertexTextures:p,maxTextureSize:u,maxCubemapSize:d,maxAttributes:f,maxVertexUniforms:_,maxVaryings:m,maxFragmentUniforms:v,vertexTextures:y,floatFragmentTextures:b,floatVertexTextures:x,maxSamples:E}}function Fx(n){let e=this,t=null,r=0,o=!1,s=!1,i=new jv,l=new Io,a={value:null,needsUpdate:!1};this.uniform=a,this.numPlanes=0,this.numIntersection=0,this.init=function(g,p,u){let d=g.length!==0||p||r!==0||o;return o=p,t=h(g,u,0),r=g.length,d},this.beginShadows=function(){s=!0,h(null)},this.endShadows=function(){s=!1,c()},this.setState=function(g,p,u){let d=g.clippingPlanes,f=g.clipIntersection,_=g.clipShadows,m=n.get(g);if(!o||d===null||d.length===0||s&&!_)s?h(null):c();else{let v=s?0:r,y=v*4,b=m.clippingState||null;a.value=b,b=h(d,p,y,u);for(let x=0;x!==y;++x)b[x]=t[x];m.clippingState=b,this.numIntersection=f?this.numPlanes:0,this.numPlanes+=v}};function c(){a.value!==t&&(a.value=t,a.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function h(g,p,u,d){let f=g!==null?g.length:0,_=null;if(f!==0){if(_=a.value,d!==!0||_===null){let m=u+f*4,v=p.matrixWorldInverse;l.getNormalMatrix(v),(_===null||_.length<m)&&(_=new Float32Array(m));for(let y=0,b=u;y!==f;++y,b+=4)i.copy(g[y]).applyMatrix4(v,l),i.normal.toArray(_,b),_[b+3]=i.constant}a.value=_,a.needsUpdate=!0}return e.numPlanes=f,e.numIntersection=0,_}}var Yn=class extends tl{constructor(e,t,r={}){super();this.width=e,this.height=t,this.depth=1,this.scissor=new kt(0,0,e,t),this.scissorTest=!1,this.viewport=new kt(0,0,e,t),this.texture=new Yo(void 0,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.texture.isRenderTargetTexture=!0,this.texture.image={width:e,height:t,depth:1},this.texture.generateMipmaps=r.generateMipmaps!==void 0?r.generateMipmaps:!1,this.texture.internalFormat=r.internalFormat!==void 0?r.internalFormat:null,this.texture.minFilter=r.minFilter!==void 0?r.minFilter:Sn,this.depthBuffer=r.depthBuffer!==void 0?r.depthBuffer:!0,this.stencilBuffer=r.stencilBuffer!==void 0?r.stencilBuffer:!1,this.depthTexture=r.depthTexture!==void 0?r.depthTexture:null}setTexture(e){e.image={width:this.width,height:this.height,depth:this.depth},this.texture=e}setSize(e,t,r=1){(this.width!==e||this.height!==t||this.depth!==r)&&(this.width=e,this.height=t,this.depth=r,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.image={...this.texture.image},this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}};Yn.prototype.isWebGLRenderTarget=!0;var cl=90,ul=1,z1=class extends On{constructor(e,t,r){super();if(this.type="CubeCamera",r.isWebGLCubeRenderTarget!==!0){console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");return}this.renderTarget=r;let o=new qn(cl,ul,e,t);o.layers=this.layers,o.up.set(0,-1,0),o.lookAt(new F(1,0,0)),this.add(o);let s=new qn(cl,ul,e,t);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new F(-1,0,0)),this.add(s);let i=new qn(cl,ul,e,t);i.layers=this.layers,i.up.set(0,0,1),i.lookAt(new F(0,1,0)),this.add(i);let l=new qn(cl,ul,e,t);l.layers=this.layers,l.up.set(0,0,-1),l.lookAt(new F(0,-1,0)),this.add(l);let a=new qn(cl,ul,e,t);a.layers=this.layers,a.up.set(0,-1,0),a.lookAt(new F(0,0,1)),this.add(a);let c=new qn(cl,ul,e,t);c.layers=this.layers,c.up.set(0,-1,0),c.lookAt(new F(0,0,-1)),this.add(c)}update(e,t){this.parent===null&&this.updateMatrixWorld();let r=this.renderTarget,[o,s,i,l,a,c]=this.children,h=e.xr.enabled,g=e.getRenderTarget();e.xr.enabled=!1;let p=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0),e.render(t,o),e.setRenderTarget(r,1),e.render(t,s),e.setRenderTarget(r,2),e.render(t,i),e.setRenderTarget(r,3),e.render(t,l),e.setRenderTarget(r,4),e.render(t,a),r.texture.generateMipmaps=p,e.setRenderTarget(r,5),e.render(t,c),e.setRenderTarget(g),e.xr.enabled=h}};var k0=class extends Yo{constructor(e,t,r,o,s,i,l,a,c,h){e=e!==void 0?e:[],t=t!==void 0?t:Ni;super(e,t,r,o,s,i,l,a,c,h);this.flipY=!1}get images(){return this.image}set images(e){this.image=e}};k0.prototype.isCubeTexture=!0;var Bd=class extends Yn{constructor(e,t,r){Number.isInteger(t)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),t=r);super(e,e,t);t=t||{},this.texture=new k0(void 0,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Sn,this.texture._needsFlipEnvMap=!1}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.format=nn,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},o=new wi(5,5,5),s=new co({name:"CubemapFromEquirect",uniforms:r0(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:Nr,blending:To});s.uniforms.tEquirect.value=t;let i=new wr(o,s),l=t.minFilter;return t.minFilter===R0&&(t.minFilter=Sn),new z1(1,10,this).update(e,i),t.minFilter=l,i.geometry.dispose(),i.material.dispose(),this}clear(e,t,r,o){let s=e.getRenderTarget();for(let i=0;i<6;i++)e.setRenderTarget(this,i),e.clear(t,r,o);e.setRenderTarget(s)}};Bd.prototype.isWebGLCubeRenderTarget=!0;function Gx(n){let e=new WeakMap;function t(i,l){return l===Ms?i.mapping=Ni:l===Ns&&(i.mapping=e0),i}function r(i){if(i&&i.isTexture&&i.isRenderTargetTexture===!1){let l=i.mapping;if(l===Ms||l===Ns)if(e.has(i)){let a=e.get(i).texture;return t(a,i.mapping)}else{let a=i.image;if(a&&a.height>0){let c=n.getRenderTarget(),h=new Bd(a.height/2);return h.fromEquirectangularTexture(n,i),e.set(i,h),n.setRenderTarget(c),i.addEventListener("dispose",o),t(h.texture,i.mapping)}else return null}}return i}function o(i){let l=i.target;l.removeEventListener("dispose",o);let a=e.get(l);a!==void 0&&(e.delete(l),a.dispose())}function s(){e=new WeakMap}return{get:r,dispose:s}}var F0=class extends co{constructor(e){super(e);this.type="RawShaderMaterial"}};F0.prototype.isRawShaderMaterial=!0;var pl=4,G0=8,Ri=Math.pow(2,G0),Ux=[.125,.215,.35,.446,.526,.582],Vx=G0-pl+1+Ux.length,dl=20,U0={[Pn]:0,[Wo]:1,[Os]:2,[Ka]:3,[Za]:4,[Qa]:5,[Ps]:6},H1=new Pd,{_lodPlanes:eu,_sizeLods:zx,_sigmas:kd}=_B(),Hx=new Ke,j1=null,Rs=(1+Math.sqrt(5))/2,fl=1/Rs,jx=[new F(1,1,1),new F(-1,1,1),new F(1,1,-1),new F(-1,1,-1),new F(0,Rs,fl),new F(0,Rs,-fl),new F(fl,0,Rs),new F(-fl,0,Rs),new F(Rs,fl,0),new F(-Rs,fl,0)],q1=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._blurMaterial=gB(dl),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,o=100){j1=this._renderer.getRenderTarget();let s=this._allocateTargets();return this._sceneToCubeUV(e,r,o,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e){return this._fromTexture(e)}fromCubemap(e){return this._fromTexture(e)}compileCubemapShader(){this._cubemapShader===null&&(this._cubemapShader=$x(),this._compileMaterial(this._cubemapShader))}compileEquirectangularShader(){this._equirectShader===null&&(this._equirectShader=Wx(),this._compileMaterial(this._equirectShader))}dispose(){this._blurMaterial.dispose(),this._cubemapShader!==null&&this._cubemapShader.dispose(),this._equirectShader!==null&&this._equirectShader.dispose();for(let e=0;e<eu.length;e++)eu[e].dispose()}_cleanup(e){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(j1),e.scissorTest=!1,Fd(e,0,0,e.width,e.height)}_fromTexture(e){j1=this._renderer.getRenderTarget();let t=this._allocateTargets(e);return this._textureToCubeUV(e,t),this._applyPMREM(t),this._cleanup(t),t}_allocateTargets(e){let t={magFilter:Ur,minFilter:Ur,generateMipmaps:!1,type:oi,format:rv,encoding:hB(e)?e.encoding:Os,depthBuffer:!1},r=qx(t);return r.depthBuffer=!e,this._pingPongRenderTarget=qx(t),r}_compileMaterial(e){let t=new wr(eu[0],e);this._renderer.compile(t,H1)}_sceneToCubeUV(e,t,r,o){let s=90,i=1,l=new qn(s,i,t,r),a=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],h=this._renderer,g=h.autoClear,p=h.outputEncoding,u=h.toneMapping;h.getClearColor(Hx),h.toneMapping=Lo,h.outputEncoding=Pn,h.autoClear=!1;let d=new nl({name:"PMREM.Background",side:Nr,depthWrite:!1,depthTest:!1}),f=new wr(new wi,d),_=!1,m=e.background;m?m.isColor&&(d.color.copy(m),e.background=null,_=!0):(d.color.copy(Hx),_=!0);for(let v=0;v<6;v++){let y=v%3;y==0?(l.up.set(0,a[v],0),l.lookAt(c[v],0,0)):y==1?(l.up.set(0,0,a[v]),l.lookAt(0,c[v],0)):(l.up.set(0,a[v],0),l.lookAt(0,0,c[v])),Fd(o,y*Ri,v>2?Ri:0,Ri,Ri),h.setRenderTarget(o),_&&h.render(f,l),h.render(e,l)}f.geometry.dispose(),f.material.dispose(),h.toneMapping=u,h.outputEncoding=p,h.autoClear=g,e.background=m}_setEncoding(e,t){this._renderer.capabilities.isWebGL2===!0&&t.format===nn&&t.type===oi&&t.encoding===Wo?e.value=U0[Pn]:e.value=U0[t.encoding]}_textureToCubeUV(e,t){let r=this._renderer;e.isCubeTexture?this._cubemapShader==null&&(this._cubemapShader=$x()):this._equirectShader==null&&(this._equirectShader=Wx());let o=e.isCubeTexture?this._cubemapShader:this._equirectShader,s=new wr(eu[0],o),i=o.uniforms;i.envMap.value=e,e.isCubeTexture||i.texelSize.value.set(1/e.image.width,1/e.image.height),this._setEncoding(i.inputEncoding,e),this._setEncoding(i.outputEncoding,t.texture),Fd(t,0,0,3*Ri,2*Ri),r.setRenderTarget(t),r.render(s,H1)}_applyPMREM(e){let t=this._renderer,r=t.autoClear;t.autoClear=!1;for(let o=1;o<Vx;o++){let s=Math.sqrt(kd[o]*kd[o]-kd[o-1]*kd[o-1]),i=jx[(o-1)%jx.length];this._blur(e,o-1,o,s,i)}t.autoClear=r}_blur(e,t,r,o,s){let i=this._pingPongRenderTarget;this._halfBlur(e,i,t,r,o,"latitudinal",s),this._halfBlur(i,e,r,r,o,"longitudinal",s)}_halfBlur(e,t,r,o,s,i,l){let a=this._renderer,c=this._blurMaterial;i!=="latitudinal"&&i!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let h=3,g=new wr(eu[o],c),p=c.uniforms,u=zx[r]-1,d=isFinite(s)?Math.PI/(2*u):2*Math.PI/(2*dl-1),f=s/d,_=isFinite(s)?1+Math.floor(h*f):dl;_>dl&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${_} samples when the maximum is set to ${dl}`);let m=[],v=0;for(let E=0;E<dl;++E){let T=E/f,M=Math.exp(-T*T/2);m.push(M),E==0?v+=M:E<_&&(v+=2*M)}for(let E=0;E<m.length;E++)m[E]=m[E]/v;p.envMap.value=e.texture,p.samples.value=_,p.weights.value=m,p.latitudinal.value=i==="latitudinal",l&&(p.poleAxis.value=l),p.dTheta.value=d,p.mipInt.value=G0-r,this._setEncoding(p.inputEncoding,e.texture),this._setEncoding(p.outputEncoding,e.texture);let y=zx[o],b=3*Math.max(0,Ri-2*y),x=(o===0?0:2*Ri)+2*y*(o>G0-pl?o-G0+pl:0);Fd(t,b,x,3*y,2*y),a.setRenderTarget(t),a.render(g,H1)}};function hB(n){return n===void 0||n.type!==oi?!1:n.encoding===Pn||n.encoding===Wo||n.encoding===Ps}function _B(){let n=[],e=[],t=[],r=G0;for(let o=0;o<Vx;o++){let s=Math.pow(2,r);e.push(s);let i=1/s;o>G0-pl?i=Ux[o-G0+pl-1]:o==0&&(i=0),t.push(i);let l=1/(s-1),a=-l/2,c=1+l/2,h=[a,a,c,a,c,c,a,a,c,c,a,c],g=6,p=6,u=3,d=2,f=1,_=new Float32Array(u*p*g),m=new Float32Array(d*p*g),v=new Float32Array(f*p*g);for(let b=0;b<g;b++){let x=b%3*2/3-1,E=b>2?0:-1,T=[x,E,0,x+2/3,E,0,x+2/3,E+1,0,x,E,0,x+2/3,E+1,0,x,E+1,0];_.set(T,u*p*b),m.set(h,d*p*b);let M=[b,b,b,b,b,b];v.set(M,f*p*b)}let y=new Gt;y.setAttribute("position",new lo(_,u)),y.setAttribute("uv",new lo(m,d)),y.setAttribute("faceIndex",new lo(v,f)),n.push(y),r>pl&&r--}return{_lodPlanes:n,_sizeLods:e,_sigmas:t}}function qx(n){let e=new Yn(3*Ri,3*Ri,n);return e.texture.mapping=Si,e.texture.name="PMREM.cubeUv",e.scissorTest=!0,e}function Fd(n,e,t,r,o){n.viewport.set(e,t,r,o),n.scissor.set(e,t,r,o)}function gB(n){let e=new Float32Array(n),t=new F(0,1,0);return new F0({name:"SphericalGaussianBlur",defines:{n},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:e},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:t},inputEncoding:{value:U0[Pn]},outputEncoding:{value:U0[Pn]}},vertexShader:W1(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			${$1()}

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:To,depthTest:!1,depthWrite:!1})}function Wx(){let n=new re(1,1);return new F0({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:n},inputEncoding:{value:U0[Pn]},outputEncoding:{value:U0[Pn]}},vertexShader:W1(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform vec2 texelSize;

			${$1()}

			#include <common>

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				vec2 f = fract( uv / texelSize - 0.5 );
				uv -= f * texelSize;
				vec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.x += texelSize.x;
				vec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.y += texelSize.y;
				vec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.x -= texelSize.x;
				vec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;

				vec3 tm = mix( tl, tr, f.x );
				vec3 bm = mix( bl, br, f.x );
				gl_FragColor.rgb = mix( tm, bm, f.y );

				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:To,depthTest:!1,depthWrite:!1})}function $x(){return new F0({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:U0[Pn]},outputEncoding:{value:U0[Pn]}},vertexShader:W1(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			${$1()}

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;
				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:To,depthTest:!1,depthWrite:!1})}function W1(){return`

		precision mediump float;
		precision mediump int;

		attribute vec3 position;
		attribute vec2 uv;
		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function $1(){return`

		uniform int inputEncoding;
		uniform int outputEncoding;

		#include <encodings_pars_fragment>

		vec4 inputTexelToLinear( vec4 value ) {

			if ( inputEncoding == 0 ) {

				return value;

			} else if ( inputEncoding == 1 ) {

				return sRGBToLinear( value );

			} else if ( inputEncoding == 2 ) {

				return RGBEToLinear( value );

			} else if ( inputEncoding == 3 ) {

				return RGBMToLinear( value, 7.0 );

			} else if ( inputEncoding == 4 ) {

				return RGBMToLinear( value, 16.0 );

			} else if ( inputEncoding == 5 ) {

				return RGBDToLinear( value, 256.0 );

			} else {

				return GammaToLinear( value, 2.2 );

			}

		}

		vec4 linearToOutputTexel( vec4 value ) {

			if ( outputEncoding == 0 ) {

				return value;

			} else if ( outputEncoding == 1 ) {

				return LinearTosRGB( value );

			} else if ( outputEncoding == 2 ) {

				return LinearToRGBE( value );

			} else if ( outputEncoding == 3 ) {

				return LinearToRGBM( value, 7.0 );

			} else if ( outputEncoding == 4 ) {

				return LinearToRGBM( value, 16.0 );

			} else if ( outputEncoding == 5 ) {

				return LinearToRGBD( value, 256.0 );

			} else {

				return LinearToGamma( value, 2.2 );

			}

		}

		vec4 envMapTexelToLinear( vec4 color ) {

			return inputTexelToLinear( color );

		}
	`}function Yx(n){let e=new WeakMap,t=null;function r(l){if(l&&l.isTexture&&l.isRenderTargetTexture===!1){let a=l.mapping,c=a===Ms||a===Ns,h=a===Ni||a===e0;if(c||h){if(e.has(l))return e.get(l).texture;{let g=l.image;if(c&&g&&g.height>0||h&&g&&o(g)){let p=n.getRenderTarget();t===null&&(t=new q1(n));let u=c?t.fromEquirectangular(l):t.fromCubemap(l);return e.set(l,u),n.setRenderTarget(p),l.addEventListener("dispose",s),u.texture}else return null}}}return l}function o(l){let a=0,c=6;for(let h=0;h<c;h++)l[h]!==void 0&&a++;return a===c}function s(l){let a=l.target;a.removeEventListener("dispose",s);let c=e.get(a);c!==void 0&&(e.delete(a),c.dispose())}function i(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:r,dispose:i}}function Xx(n){let e={};function t(r){if(e[r]!==void 0)return e[r];let o;switch(r){case"WEBGL_depth_texture":o=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":o=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":o=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":o=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:o=n.getExtension(r)}return e[r]=o,o}return{has:function(r){return t(r)!==null},init:function(r){r.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float")},get:function(r){let o=t(r);return o===null&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),o}}}function Jx(n,e,t,r){let o={},s=new WeakMap;function i(g){let p=g.target;p.index!==null&&e.remove(p.index);for(let d in p.attributes)e.remove(p.attributes[d]);p.removeEventListener("dispose",i),delete o[p.id];let u=s.get(p);u&&(e.remove(u),s.delete(p)),r.releaseStatesOfGeometry(p),p.isInstancedBufferGeometry===!0&&delete p._maxInstanceCount,t.memory.geometries--}function l(g,p){return o[p.id]===!0||(p.addEventListener("dispose",i),o[p.id]=!0,t.memory.geometries++),p}function a(g){let p=g.attributes;for(let d in p)e.update(p[d],n.ARRAY_BUFFER);let u=g.morphAttributes;for(let d in u){let f=u[d];for(let _=0,m=f.length;_<m;_++)e.update(f[_],n.ARRAY_BUFFER)}}function c(g){let p=[],u=g.index,d=g.attributes.position,f=0;if(u!==null){let v=u.array;f=u.version;for(let y=0,b=v.length;y<b;y+=3){let x=v[y+0],E=v[y+1],T=v[y+2];p.push(x,E,E,T,T,x)}}else{let v=d.array;f=d.version;for(let y=0,b=v.length/3-1;y<b;y+=3){let x=y+0,E=y+1,T=y+2;p.push(x,E,E,T,T,x)}}let _=new(Kv(p)>65535?Nd:Md)(p,1);_.version=f;let m=s.get(g);m&&e.remove(m),s.set(g,_)}function h(g){let p=s.get(g);if(p){let u=g.index;u!==null&&p.version<u.version&&c(g)}else c(g);return s.get(g)}return{get:l,update:a,getWireframeAttribute:h}}function Kx(n,e,t,r){let o=r.isWebGL2,s;function i(p){s=p}let l,a;function c(p){l=p.type,a=p.bytesPerElement}function h(p,u){n.drawElements(s,u,l,p*a),t.update(u,s,1)}function g(p,u,d){if(d===0)return;let f,_;if(o)f=n,_="drawElementsInstanced";else if(f=e.get("ANGLE_instanced_arrays"),_="drawElementsInstancedANGLE",f===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}f[_](s,u,l,p*a,d),t.update(u,s,d)}this.setMode=i,this.setIndex=c,this.render=h,this.renderInstances=g}function Zx(n){let e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function r(s,i,l){switch(t.calls++,i){case n.TRIANGLES:t.triangles+=l*(s/3);break;case n.LINES:t.lines+=l*(s/2);break;case n.LINE_STRIP:t.lines+=l*(s-1);break;case n.LINE_LOOP:t.lines+=l*s;break;case n.POINTS:t.points+=l*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",i);break}}function o(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:o,update:r}}var ml=class extends Yo{constructor(e=null,t=1,r=1,o=1){super(null);this.image={data:e,width:t,height:r,depth:o},this.magFilter=Ur,this.minFilter=Ur,this.wrapR=rn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}};ml.prototype.isDataTexture2DArray=!0;function vB(n,e){return n[0]-e[0]}function yB(n,e){return Math.abs(e[1])-Math.abs(n[1])}function Qx(n,e){let t=1,r=e.isInterleavedBufferAttribute?e.data.array:e.array;r instanceof Int8Array?t=127:r instanceof Int16Array?t=32767:r instanceof Int32Array?t=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",r),n.divideScalar(t)}function eC(n,e,t){let r={},o=new Float32Array(8),s=new WeakMap,i=new F,l=[];for(let c=0;c<8;c++)l[c]=[c,0];function a(c,h,g,p){let u=c.morphTargetInfluences;if(e.isWebGL2===!0){let d=h.morphAttributes.position.length,f=s.get(h);if(f===void 0||f.count!==d){f!==void 0&&f.texture.dispose();let v=h.morphAttributes.normal!==void 0,y=h.morphAttributes.position,b=h.morphAttributes.normal||[],x=h.attributes.position.count,E=v===!0?2:1,T=x*E,M=1;T>e.maxTextureSize&&(M=Math.ceil(T/e.maxTextureSize),T=e.maxTextureSize);let D=new Float32Array(T*M*4*d),U=new ml(D,T,M,d);U.format=nn,U.type=ho;let L=E*4;for(let se=0;se<d;se++){let $=y[se],H=b[se],ae=T*M*4*se;for(let ue=0;ue<$.count;ue++){i.fromBufferAttribute($,ue),$.normalized===!0&&Qx(i,$);let me=ue*L;D[ae+me+0]=i.x,D[ae+me+1]=i.y,D[ae+me+2]=i.z,D[ae+me+3]=0,v===!0&&(i.fromBufferAttribute(H,ue),H.normalized===!0&&Qx(i,H),D[ae+me+4]=i.x,D[ae+me+5]=i.y,D[ae+me+6]=i.z,D[ae+me+7]=0)}}f={count:d,texture:U,size:new re(T,M)},s.set(h,f)}let _=0;for(let v=0;v<u.length;v++)_+=u[v];let m=h.morphTargetsRelative?1:1-_;p.getUniforms().setValue(n,"morphTargetBaseInfluence",m),p.getUniforms().setValue(n,"morphTargetInfluences",u),p.getUniforms().setValue(n,"morphTargetsTexture",f.texture,t),p.getUniforms().setValue(n,"morphTargetsTextureSize",f.size)}else{let d=u===void 0?0:u.length,f=r[h.id];if(f===void 0||f.length!==d){f=[];for(let b=0;b<d;b++)f[b]=[b,0];r[h.id]=f}for(let b=0;b<d;b++){let x=f[b];x[0]=b,x[1]=u[b]}f.sort(yB);for(let b=0;b<8;b++)b<d&&f[b][1]?(l[b][0]=f[b][0],l[b][1]=f[b][1]):(l[b][0]=Number.MAX_SAFE_INTEGER,l[b][1]=0);l.sort(vB);let _=h.morphAttributes.position,m=h.morphAttributes.normal,v=0;for(let b=0;b<8;b++){let x=l[b],E=x[0],T=x[1];E!==Number.MAX_SAFE_INTEGER&&T?(_&&h.getAttribute("morphTarget"+b)!==_[E]&&h.setAttribute("morphTarget"+b,_[E]),m&&h.getAttribute("morphNormal"+b)!==m[E]&&h.setAttribute("morphNormal"+b,m[E]),o[b]=T,v+=T):(_&&h.hasAttribute("morphTarget"+b)===!0&&h.deleteAttribute("morphTarget"+b),m&&h.hasAttribute("morphNormal"+b)===!0&&h.deleteAttribute("morphNormal"+b),o[b]=0)}let y=h.morphTargetsRelative?1:1-v;p.getUniforms().setValue(n,"morphTargetBaseInfluence",y),p.getUniforms().setValue(n,"morphTargetInfluences",o)}}return{update:a}}var V0=class extends Yn{constructor(e,t,r){super(e,t,r);this.samples=4}copy(e){return super.copy.call(this,e),this.samples=e.samples,this}};V0.prototype.isWebGLMultisampleRenderTarget=!0;function tC(n,e,t,r){let o=new WeakMap;function s(a){let c=r.render.frame,h=a.geometry,g=e.get(a,h);return o.get(g)!==c&&(e.update(g),o.set(g,c)),a.isInstancedMesh&&(a.hasEventListener("dispose",l)===!1&&a.addEventListener("dispose",l),t.update(a.instanceMatrix,n.ARRAY_BUFFER),a.instanceColor!==null&&t.update(a.instanceColor,n.ARRAY_BUFFER)),g}function i(){o=new WeakMap}function l(a){let c=a.target;c.removeEventListener("dispose",l),t.remove(c.instanceMatrix),c.instanceColor!==null&&t.remove(c.instanceColor)}return{update:s,dispose:i}}var Gd=class extends Yo{constructor(e=null,t=1,r=1,o=1){super(null);this.image={data:e,width:t,height:r,depth:o},this.magFilter=Ur,this.minFilter=Ur,this.wrapR=rn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}};Gd.prototype.isDataTexture3D=!0;var rC=new Yo,bB=new ml,xB=new Gd,nC=new k0,oC=[],iC=[],sC=new Float32Array(16),aC=new Float32Array(9),lC=new Float32Array(4);function hl(n,e,t){let r=n[0];if(r<=0||r>0)return n;let o=e*t,s=oC[o];if(s===void 0&&(s=new Float32Array(o),oC[o]=s),e!==0){r.toArray(s,0);for(let i=1,l=0;i!==e;++i)l+=t,n[i].toArray(s,l)}return s}function go(n,e){if(n.length!==e.length)return!1;for(let t=0,r=n.length;t<r;t++)if(n[t]!==e[t])return!1;return!0}function uo(n,e){for(let t=0,r=e.length;t<r;t++)n[t]=e[t]}function cC(n,e){let t=iC[e];t===void 0&&(t=new Int32Array(e),iC[e]=t);for(let r=0;r!==e;++r)t[r]=n.allocateTextureUnit();return t}function CB(n,e){let t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function TB(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(go(t,e))return;n.uniform2fv(this.addr,e),uo(t,e)}}function EB(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(go(t,e))return;n.uniform3fv(this.addr,e),uo(t,e)}}function AB(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(go(t,e))return;n.uniform4fv(this.addr,e),uo(t,e)}}function MB(n,e){let t=this.cache,r=e.elements;if(r===void 0){if(go(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),uo(t,e)}else{if(go(t,r))return;lC.set(r),n.uniformMatrix2fv(this.addr,!1,lC),uo(t,r)}}function NB(n,e){let t=this.cache,r=e.elements;if(r===void 0){if(go(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),uo(t,e)}else{if(go(t,r))return;aC.set(r),n.uniformMatrix3fv(this.addr,!1,aC),uo(t,r)}}function SB(n,e){let t=this.cache,r=e.elements;if(r===void 0){if(go(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),uo(t,e)}else{if(go(t,r))return;sC.set(r),n.uniformMatrix4fv(this.addr,!1,sC),uo(t,r)}}function PB(n,e){let t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function OB(n,e){let t=this.cache;go(t,e)||(n.uniform2iv(this.addr,e),uo(t,e))}function wB(n,e){let t=this.cache;go(t,e)||(n.uniform3iv(this.addr,e),uo(t,e))}function RB(n,e){let t=this.cache;go(t,e)||(n.uniform4iv(this.addr,e),uo(t,e))}function LB(n,e){let t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function IB(n,e){let t=this.cache;go(t,e)||(n.uniform2uiv(this.addr,e),uo(t,e))}function DB(n,e){let t=this.cache;go(t,e)||(n.uniform3uiv(this.addr,e),uo(t,e))}function BB(n,e){let t=this.cache;go(t,e)||(n.uniform4uiv(this.addr,e),uo(t,e))}function kB(n,e,t){let r=this.cache,o=t.allocateTextureUnit();r[0]!==o&&(n.uniform1i(this.addr,o),r[0]=o),t.safeSetTexture2D(e||rC,o)}function FB(n,e,t){let r=this.cache,o=t.allocateTextureUnit();r[0]!==o&&(n.uniform1i(this.addr,o),r[0]=o),t.setTexture3D(e||xB,o)}function GB(n,e,t){let r=this.cache,o=t.allocateTextureUnit();r[0]!==o&&(n.uniform1i(this.addr,o),r[0]=o),t.safeSetTextureCube(e||nC,o)}function UB(n,e,t){let r=this.cache,o=t.allocateTextureUnit();r[0]!==o&&(n.uniform1i(this.addr,o),r[0]=o),t.setTexture2DArray(e||bB,o)}function VB(n){switch(n){case 5126:return CB;case 35664:return TB;case 35665:return EB;case 35666:return AB;case 35674:return MB;case 35675:return NB;case 35676:return SB;case 5124:case 35670:return PB;case 35667:case 35671:return OB;case 35668:case 35672:return wB;case 35669:case 35673:return RB;case 5125:return LB;case 36294:return IB;case 36295:return DB;case 36296:return BB;case 35678:case 36198:case 36298:case 36306:case 35682:return kB;case 35679:case 36299:case 36307:return FB;case 35680:case 36300:case 36308:case 36293:return GB;case 36289:case 36303:case 36311:case 36292:return UB}}function zB(n,e){n.uniform1fv(this.addr,e)}function HB(n,e){let t=hl(e,this.size,2);n.uniform2fv(this.addr,t)}function jB(n,e){let t=hl(e,this.size,3);n.uniform3fv(this.addr,t)}function qB(n,e){let t=hl(e,this.size,4);n.uniform4fv(this.addr,t)}function WB(n,e){let t=hl(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function $B(n,e){let t=hl(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function YB(n,e){let t=hl(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function XB(n,e){n.uniform1iv(this.addr,e)}function JB(n,e){n.uniform2iv(this.addr,e)}function KB(n,e){n.uniform3iv(this.addr,e)}function ZB(n,e){n.uniform4iv(this.addr,e)}function QB(n,e){n.uniform1uiv(this.addr,e)}function ek(n,e){n.uniform2uiv(this.addr,e)}function tk(n,e){n.uniform3uiv(this.addr,e)}function rk(n,e){n.uniform4uiv(this.addr,e)}function nk(n,e,t){let r=e.length,o=cC(t,r);n.uniform1iv(this.addr,o);for(let s=0;s!==r;++s)t.safeSetTexture2D(e[s]||rC,o[s])}function ok(n,e,t){let r=e.length,o=cC(t,r);n.uniform1iv(this.addr,o);for(let s=0;s!==r;++s)t.safeSetTextureCube(e[s]||nC,o[s])}function ik(n){switch(n){case 5126:return zB;case 35664:return HB;case 35665:return jB;case 35666:return qB;case 35674:return WB;case 35675:return $B;case 35676:return YB;case 5124:case 35670:return XB;case 35667:case 35671:return JB;case 35668:case 35672:return KB;case 35669:case 35673:return ZB;case 5125:return QB;case 36294:return ek;case 36295:return tk;case 36296:return rk;case 35678:case 36198:case 36298:case 36306:case 35682:return nk;case 35680:case 36300:case 36308:case 36293:return ok}}function sk(n,e,t){this.id=n,this.addr=t,this.cache=[],this.setValue=VB(e.type)}function uC(n,e,t){this.id=n,this.addr=t,this.cache=[],this.size=e.size,this.setValue=ik(e.type)}uC.prototype.updateCache=function(n){let e=this.cache;n instanceof Float32Array&&e.length!==n.length&&(this.cache=new Float32Array(n.length)),uo(e,n)};function pC(n){this.id=n,this.seq=[],this.map={}}pC.prototype.setValue=function(n,e,t){let r=this.seq;for(let o=0,s=r.length;o!==s;++o){let i=r[o];i.setValue(n,e[i.id],t)}};var Y1=/(\w+)(\])?(\[|\.)?/g;function dC(n,e){n.seq.push(e),n.map[e.id]=e}function ak(n,e,t){let r=n.name,o=r.length;for(Y1.lastIndex=0;;){let s=Y1.exec(r),i=Y1.lastIndex,l=s[1],a=s[2]==="]",c=s[3];if(a&&(l=l|0),c===void 0||c==="["&&i+2===o){dC(t,c===void 0?new sk(l,n,e):new uC(l,n,e));break}else{let g=t.map[l];g===void 0&&(g=new pC(l),dC(t,g)),t=g}}}function Li(n,e){this.seq=[],this.map={};let t=n.getProgramParameter(e,n.ACTIVE_UNIFORMS);for(let r=0;r<t;++r){let o=n.getActiveUniform(e,r),s=n.getUniformLocation(e,o.name);ak(o,s,this)}}Li.prototype.setValue=function(n,e,t,r){let o=this.map[e];o!==void 0&&o.setValue(n,t,r)};Li.prototype.setOptional=function(n,e,t){let r=e[t];r!==void 0&&this.setValue(n,t,r)};Li.upload=function(n,e,t,r){for(let o=0,s=e.length;o!==s;++o){let i=e[o],l=t[i.id];l.needsUpdate!==!1&&i.setValue(n,l.value,r)}};Li.seqWithValue=function(n,e){let t=[];for(let r=0,o=n.length;r!==o;++r){let s=n[r];s.id in e&&t.push(s)}return t};function X1(n,e,t){let r=n.createShader(e);return n.shaderSource(r,t),n.compileShader(r),r}var lk=0;function ck(n){let e=n.split(`
`);for(let t=0;t<e.length;t++)e[t]=t+1+": "+e[t];return e.join(`
`)}function fC(n){switch(n){case Pn:return["Linear","( value )"];case Wo:return["sRGB","( value )"];case Os:return["RGBE","( value )"];case Ka:return["RGBM","( value, 7.0 )"];case Za:return["RGBM","( value, 16.0 )"];case Qa:return["RGBD","( value, 256.0 )"];case Ps:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case Cd:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",n),["Linear","( value )"]}}function mC(n,e,t){let r=n.getShaderParameter(e,n.COMPILE_STATUS),o=n.getShaderInfoLog(e).trim();return r&&o===""?"":t.toUpperCase()+`

`+o+`

`+ck(n.getShaderSource(e))}function _l(n,e){let t=fC(e);return"vec4 "+n+"( vec4 value ) { return "+t[0]+"ToLinear"+t[1]+"; }"}function uk(n,e){let t=fC(e);return"vec4 "+n+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function pk(n,e){let t;switch(e){case hd:t="Linear";break;case _d:t="Reinhard";break;case gd:t="OptimizedCineon";break;case vd:t="ACESFilmic";break;case Wg:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function dk(n){return[n.extensionDerivatives||n.envMapCubeUV||n.bumpMap||n.tangentSpaceNormalMap||n.clearcoatNormalMap||n.flatShading||n.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(tu).join(`
`)}function fk(n){let e=[];for(let t in n){let r=n[t];r!==!1&&e.push("#define "+t+" "+r)}return e.join(`
`)}function mk(n,e){let t={},r=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let o=0;o<r;o++){let s=n.getActiveAttrib(e,o),i=s.name,l=1;s.type===n.FLOAT_MAT2&&(l=2),s.type===n.FLOAT_MAT3&&(l=3),s.type===n.FLOAT_MAT4&&(l=4),t[i]={type:s.type,location:n.getAttribLocation(e,i),locationSize:l}}return t}function tu(n){return n!==""}function hC(n,e){return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function _C(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}var hk=/^[ \t]*#include +<([\w\d./]+)>/gm;function J1(n){return n.replace(hk,_k)}function _k(n,e){let t=dr[e];if(t===void 0)throw new Error("Can not resolve #include <"+e+">");return J1(t)}var gk=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,vk=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function gC(n){return n.replace(vk,vC).replace(gk,yk)}function yk(n,e,t,r){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),vC(n,e,t,r)}function vC(n,e,t,r){let o="";for(let s=parseInt(e);s<parseInt(t);s++)o+=r.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return o}function yC(n){let e="precision "+n.precision+` float;
precision `+n.precision+" int;";return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function bk(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===$a?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===dd?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===Qi&&(e="SHADOWMAP_TYPE_VSM"),e}function xk(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case Ni:case e0:e="ENVMAP_TYPE_CUBE";break;case Si:case Ss:e="ENVMAP_TYPE_CUBE_UV";break}return e}function Ck(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case e0:case Ss:e="ENVMAP_MODE_REFRACTION";break}return e}function Tk(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case w0:e="ENVMAP_BLENDING_MULTIPLY";break;case fd:e="ENVMAP_BLENDING_MIX";break;case md:e="ENVMAP_BLENDING_ADD";break}return e}function bC(n,e,t,r){let o=n.getContext(),s=t.defines,i=t.vertexShader,l=t.fragmentShader,a=bk(t),c=xk(t),h=Ck(t),g=Tk(t),p=n.gammaFactor>0?n.gammaFactor:1,u=t.isWebGL2?"":dk(t),d=fk(s),f=o.createProgram(),_,m,v=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(_=[d].filter(tu).join(`
`),_.length>0&&(_+=`
`),m=[u,d].filter(tu).join(`
`),m.length>0&&(m+=`
`)):(_=[yC(t),"#define SHADER_NAME "+t.shaderName,d,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+p,"#define MAX_BONES "+t.maxBones,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+h:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularTintMap?"#define USE_SPECULARTINTMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.useVertexTexture?"#define BONE_TEXTURE":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphTargets&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargets&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+a:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(tu).join(`
`),m=[u,yC(t),"#define SHADER_NAME "+t.shaderName,d,"#define GAMMA_FACTOR "+p,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+h:"",t.envMap?"#define "+g:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularTintMap?"#define USE_SPECULARTINTMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+a:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(t.extensionShaderTextureLOD||t.envMap)&&t.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Lo?"#define TONE_MAPPING":"",t.toneMapping!==Lo?dr.tonemapping_pars_fragment:"",t.toneMapping!==Lo?pk("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.format===qo?"#define OPAQUE":"",dr.encodings_pars_fragment,t.map?_l("mapTexelToLinear",t.mapEncoding):"",t.matcap?_l("matcapTexelToLinear",t.matcapEncoding):"",t.envMap?_l("envMapTexelToLinear",t.envMapEncoding):"",t.emissiveMap?_l("emissiveMapTexelToLinear",t.emissiveMapEncoding):"",t.specularTintMap?_l("specularTintMapTexelToLinear",t.specularTintMapEncoding):"",t.lightMap?_l("lightMapTexelToLinear",t.lightMapEncoding):"",uk("linearToOutputTexel",t.outputEncoding),t.depthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(tu).join(`
`)),i=J1(i),i=hC(i,t),i=_C(i,t),l=J1(l),l=hC(l,t),l=_C(l,t),i=gC(i),l=gC(l),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(v=`#version 300 es
`,_=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+_,m=["#define varying in",t.glslVersion===B1?"":"out highp vec4 pc_fragColor;",t.glslVersion===B1?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+m);let y=v+_+i,b=v+m+l,x=X1(o,o.VERTEX_SHADER,y),E=X1(o,o.FRAGMENT_SHADER,b);if(o.attachShader(f,x),o.attachShader(f,E),t.index0AttributeName!==void 0?o.bindAttribLocation(f,0,t.index0AttributeName):t.morphTargets===!0&&o.bindAttribLocation(f,0,"position"),o.linkProgram(f),n.debug.checkShaderErrors){let D=o.getProgramInfoLog(f).trim(),U=o.getShaderInfoLog(x).trim(),L=o.getShaderInfoLog(E).trim(),se=!0,$=!0;if(o.getProgramParameter(f,o.LINK_STATUS)===!1){se=!1;let H=mC(o,x,"vertex"),ae=mC(o,E,"fragment");console.error("THREE.WebGLProgram: Shader Error "+o.getError()+" - VALIDATE_STATUS "+o.getProgramParameter(f,o.VALIDATE_STATUS)+`

Program Info Log: `+D+`
`+H+`
`+ae)}else D!==""?console.warn("THREE.WebGLProgram: Program Info Log:",D):(U===""||L==="")&&($=!1);$&&(this.diagnostics={runnable:se,programLog:D,vertexShader:{log:U,prefix:_},fragmentShader:{log:L,prefix:m}})}o.deleteShader(x),o.deleteShader(E);let T;this.getUniforms=function(){return T===void 0&&(T=new Li(o,f)),T};let M;return this.getAttributes=function(){return M===void 0&&(M=mk(o,f)),M},this.destroy=function(){r.releaseStatesOfProgram(this),o.deleteProgram(f),this.program=void 0},this.name=t.shaderName,this.id=lk++,this.cacheKey=e,this.usedTimes=1,this.program=f,this.vertexShader=x,this.fragmentShader=E,this}function xC(n,e,t,r,o,s,i){let l=[],a=o.isWebGL2,c=o.logarithmicDepthBuffer,h=o.floatVertexTextures,g=o.maxVertexUniforms,p=o.vertexTextures,u=o.precision,d={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},f=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoat","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","specularIntensityMap","specularTintMap","specularTintMapEncoding","roughnessMap","metalnessMap","gradientMap","alphaMap","alphaTest","combine","vertexColors","vertexAlphas","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","morphTargetsCount","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","format","sheen","transmission","transmissionMap","thicknessMap"];function _(T){let D=T.skeleton.bones;if(h)return 1024;{let L=Math.floor((g-20)/4),se=Math.min(L,D.length);return se<D.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+D.length+" bones. This GPU supports "+se+"."),0):se}}function m(T){let M;return T&&T.isTexture?M=T.encoding:T&&T.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),M=T.texture.encoding):M=Pn,a&&T&&T.isTexture&&T.format===nn&&T.type===oi&&T.encoding===Wo&&(M=Pn),M}function v(T,M,D,U,L){let se=U.fog,$=T.isMeshStandardMaterial?U.environment:null,H=(T.isMeshStandardMaterial?t:e).get(T.envMap||$),ae=d[T.type],ue=L.isSkinnedMesh?_(L):0;T.precision!==null&&(u=o.getMaxPrecision(T.precision),u!==T.precision&&console.warn("THREE.WebGLProgram.getParameters:",T.precision,"not supported, using",u,"instead."));let me,Ue;if(ae){let ce=Jo[ae];me=ce.vertexShader,Ue=ce.fragmentShader}else me=T.vertexShader,Ue=T.fragmentShader;let st=n.getRenderTarget(),ft=T.alphaTest>0,Ze=T.clearcoat>0;return{isWebGL2:a,shaderID:ae,shaderName:T.type,vertexShader:me,fragmentShader:Ue,defines:T.defines,isRawShaderMaterial:T.isRawShaderMaterial===!0,glslVersion:T.glslVersion,precision:u,instancing:L.isInstancedMesh===!0,instancingColor:L.isInstancedMesh===!0&&L.instanceColor!==null,supportsVertexTextures:p,outputEncoding:st!==null?m(st.texture):n.outputEncoding,map:!!T.map,mapEncoding:m(T.map),matcap:!!T.matcap,matcapEncoding:m(T.matcap),envMap:!!H,envMapMode:H&&H.mapping,envMapEncoding:m(H),envMapCubeUV:!!H&&(H.mapping===Si||H.mapping===Ss),lightMap:!!T.lightMap,lightMapEncoding:m(T.lightMap),aoMap:!!T.aoMap,emissiveMap:!!T.emissiveMap,emissiveMapEncoding:m(T.emissiveMap),bumpMap:!!T.bumpMap,normalMap:!!T.normalMap,objectSpaceNormalMap:T.normalMapType===Td,tangentSpaceNormalMap:T.normalMapType===$o,clearcoat:Ze,clearcoatMap:Ze&&!!T.clearcoatMap,clearcoatRoughnessMap:Ze&&!!T.clearcoatRoughnessMap,clearcoatNormalMap:Ze&&!!T.clearcoatNormalMap,displacementMap:!!T.displacementMap,roughnessMap:!!T.roughnessMap,metalnessMap:!!T.metalnessMap,specularMap:!!T.specularMap,specularIntensityMap:!!T.specularIntensityMap,specularTintMap:!!T.specularTintMap,specularTintMapEncoding:m(T.specularTintMap),alphaMap:!!T.alphaMap,alphaTest:ft,gradientMap:!!T.gradientMap,sheen:T.sheen>0,transmission:T.transmission>0,transmissionMap:!!T.transmissionMap,thicknessMap:!!T.thicknessMap,combine:T.combine,vertexTangents:!!T.normalMap&&!!L.geometry&&!!L.geometry.attributes.tangent,vertexColors:T.vertexColors,vertexAlphas:T.vertexColors===!0&&!!L.geometry&&!!L.geometry.attributes.color&&L.geometry.attributes.color.itemSize===4,vertexUvs:!!T.map||!!T.bumpMap||!!T.normalMap||!!T.specularMap||!!T.alphaMap||!!T.emissiveMap||!!T.roughnessMap||!!T.metalnessMap||!!T.clearcoatMap||!!T.clearcoatRoughnessMap||!!T.clearcoatNormalMap||!!T.displacementMap||!!T.transmissionMap||!!T.thicknessMap||!!T.specularIntensityMap||!!T.specularTintMap,uvsVertexOnly:!(!!T.map||!!T.bumpMap||!!T.normalMap||!!T.specularMap||!!T.alphaMap||!!T.emissiveMap||!!T.roughnessMap||!!T.metalnessMap||!!T.clearcoatNormalMap||T.transmission>0||!!T.transmissionMap||!!T.thicknessMap||!!T.specularIntensityMap||!!T.specularTintMap)&&!!T.displacementMap,fog:!!se,useFog:T.fog,fogExp2:se&&se.isFogExp2,flatShading:!!T.flatShading,sizeAttenuation:T.sizeAttenuation,logarithmicDepthBuffer:c,skinning:L.isSkinnedMesh===!0&&ue>0,maxBones:ue,useVertexTexture:h,morphTargets:!!L.geometry&&!!L.geometry.morphAttributes.position,morphNormals:!!L.geometry&&!!L.geometry.morphAttributes.normal,morphTargetsCount:!!L.geometry&&!!L.geometry.morphAttributes.position?L.geometry.morphAttributes.position.length:0,numDirLights:M.directional.length,numPointLights:M.point.length,numSpotLights:M.spot.length,numRectAreaLights:M.rectArea.length,numHemiLights:M.hemi.length,numDirLightShadows:M.directionalShadowMap.length,numPointLightShadows:M.pointShadowMap.length,numSpotLightShadows:M.spotShadowMap.length,numClippingPlanes:i.numPlanes,numClipIntersection:i.numIntersection,format:T.format,dithering:T.dithering,shadowMapEnabled:n.shadowMap.enabled&&D.length>0,shadowMapType:n.shadowMap.type,toneMapping:T.toneMapped?n.toneMapping:Lo,physicallyCorrectLights:n.physicallyCorrectLights,premultipliedAlpha:T.premultipliedAlpha,doubleSided:T.side===Ho,flipSided:T.side===Nr,depthPacking:T.depthPacking!==void 0?T.depthPacking:!1,index0AttributeName:T.index0AttributeName,extensionDerivatives:T.extensions&&T.extensions.derivatives,extensionFragDepth:T.extensions&&T.extensions.fragDepth,extensionDrawBuffers:T.extensions&&T.extensions.drawBuffers,extensionShaderTextureLOD:T.extensions&&T.extensions.shaderTextureLOD,rendererExtensionFragDepth:a||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:a||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:a||r.has("EXT_shader_texture_lod"),customProgramCacheKey:T.customProgramCacheKey()}}function y(T){let M=[];if(T.shaderID?M.push(T.shaderID):(M.push(T.fragmentShader),M.push(T.vertexShader)),T.defines!==void 0)for(let D in T.defines)M.push(D),M.push(T.defines[D]);if(T.isRawShaderMaterial===!1){for(let D=0;D<f.length;D++)M.push(T[f[D]]);M.push(n.outputEncoding),M.push(n.gammaFactor)}return M.push(T.customProgramCacheKey),M.join()}function b(T){let M=d[T.type],D;if(M){let U=Jo[M];D=ll.clone(U.uniforms)}else D=T.uniforms;return D}function x(T,M){let D;for(let U=0,L=l.length;U<L;U++){let se=l[U];if(se.cacheKey===M){D=se,++D.usedTimes;break}}return D===void 0&&(D=new bC(n,M,T,s),l.push(D)),D}function E(T){if(--T.usedTimes==0){let M=l.indexOf(T);l[M]=l[l.length-1],l.pop(),T.destroy()}}return{getParameters:v,getProgramCacheKey:y,getUniforms:b,acquireProgram:x,releaseProgram:E,programs:l}}function CC(){let n=new WeakMap;function e(s){let i=n.get(s);return i===void 0&&(i={},n.set(s,i)),i}function t(s){n.delete(s)}function r(s,i,l){n.get(s)[i]=l}function o(){n=new WeakMap}return{get:e,remove:t,update:r,dispose:o}}function Ek(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.program!==e.program?n.program.id-e.program.id:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function TC(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function EC(n){let e=[],t=0,r=[],o=[],s=[],i={id:-1};function l(){t=0,r.length=0,o.length=0,s.length=0}function a(u,d,f,_,m,v){let y=e[t],b=n.get(f);return y===void 0?(y={id:u.id,object:u,geometry:d,material:f,program:b.program||i,groupOrder:_,renderOrder:u.renderOrder,z:m,group:v},e[t]=y):(y.id=u.id,y.object=u,y.geometry=d,y.material=f,y.program=b.program||i,y.groupOrder=_,y.renderOrder=u.renderOrder,y.z=m,y.group=v),t++,y}function c(u,d,f,_,m,v){let y=a(u,d,f,_,m,v);f.transmission>0?o.push(y):f.transparent===!0?s.push(y):r.push(y)}function h(u,d,f,_,m,v){let y=a(u,d,f,_,m,v);f.transmission>0?o.unshift(y):f.transparent===!0?s.unshift(y):r.unshift(y)}function g(u,d){r.length>1&&r.sort(u||Ek),o.length>1&&o.sort(d||TC),s.length>1&&s.sort(d||TC)}function p(){for(let u=t,d=e.length;u<d;u++){let f=e[u];if(f.id===null)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.program=null,f.group=null}}return{opaque:r,transmissive:o,transparent:s,init:l,push:c,unshift:h,finish:p,sort:g}}function AC(n){let e=new WeakMap;function t(o,s){let i;return e.has(o)===!1?(i=new EC(n),e.set(o,[i])):s>=e.get(o).length?(i=new EC(n),e.get(o).push(i)):i=e.get(o)[s],i}function r(){e=new WeakMap}return{get:t,dispose:r}}function Ak(){let n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new F,color:new Ke};break;case"SpotLight":t={position:new F,direction:new F,color:new Ke,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new F,color:new Ke,distance:0,decay:0};break;case"HemisphereLight":t={direction:new F,skyColor:new Ke,groundColor:new Ke};break;case"RectAreaLight":t={color:new Ke,position:new F,halfWidth:new F,halfHeight:new F};break}return n[e.id]=t,t}}}function Mk(){let n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new re};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new re};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new re,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}var Nk=0;function Sk(n,e){return(e.castShadow?1:0)-(n.castShadow?1:0)}function MC(n,e){let t=new Ak,r=Mk(),o={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let h=0;h<9;h++)o.probe.push(new F);let s=new F,i=new vr,l=new vr;function a(h,g){let p=0,u=0,d=0;for(let D=0;D<9;D++)o.probe[D].set(0,0,0);let f=0,_=0,m=0,v=0,y=0,b=0,x=0,E=0;h.sort(Sk);let T=g!==!0?Math.PI:1;for(let D=0,U=h.length;D<U;D++){let L=h[D],se=L.color,$=L.intensity,H=L.distance,ae=L.shadow&&L.shadow.map?L.shadow.map.texture:null;if(L.isAmbientLight)p+=se.r*$*T,u+=se.g*$*T,d+=se.b*$*T;else if(L.isLightProbe)for(let ue=0;ue<9;ue++)o.probe[ue].addScaledVector(L.sh.coefficients[ue],$);else if(L.isDirectionalLight){let ue=t.get(L);if(ue.color.copy(L.color).multiplyScalar(L.intensity*T),L.castShadow){let me=L.shadow,Ue=r.get(L);Ue.shadowBias=me.bias,Ue.shadowNormalBias=me.normalBias,Ue.shadowRadius=me.radius,Ue.shadowMapSize=me.mapSize,o.directionalShadow[f]=Ue,o.directionalShadowMap[f]=ae,o.directionalShadowMatrix[f]=L.shadow.matrix,b++}o.directional[f]=ue,f++}else if(L.isSpotLight){let ue=t.get(L);if(ue.position.setFromMatrixPosition(L.matrixWorld),ue.color.copy(se).multiplyScalar($*T),ue.distance=H,ue.coneCos=Math.cos(L.angle),ue.penumbraCos=Math.cos(L.angle*(1-L.penumbra)),ue.decay=L.decay,L.castShadow){let me=L.shadow,Ue=r.get(L);Ue.shadowBias=me.bias,Ue.shadowNormalBias=me.normalBias,Ue.shadowRadius=me.radius,Ue.shadowMapSize=me.mapSize,o.spotShadow[m]=Ue,o.spotShadowMap[m]=ae,o.spotShadowMatrix[m]=L.shadow.matrix,E++}o.spot[m]=ue,m++}else if(L.isRectAreaLight){let ue=t.get(L);ue.color.copy(se).multiplyScalar($),ue.halfWidth.set(L.width*.5,0,0),ue.halfHeight.set(0,L.height*.5,0),o.rectArea[v]=ue,v++}else if(L.isPointLight){let ue=t.get(L);if(ue.color.copy(L.color).multiplyScalar(L.intensity*T),ue.distance=L.distance,ue.decay=L.decay,L.castShadow){let me=L.shadow,Ue=r.get(L);Ue.shadowBias=me.bias,Ue.shadowNormalBias=me.normalBias,Ue.shadowRadius=me.radius,Ue.shadowMapSize=me.mapSize,Ue.shadowCameraNear=me.camera.near,Ue.shadowCameraFar=me.camera.far,o.pointShadow[_]=Ue,o.pointShadowMap[_]=ae,o.pointShadowMatrix[_]=L.shadow.matrix,x++}o.point[_]=ue,_++}else if(L.isHemisphereLight){let ue=t.get(L);ue.skyColor.copy(L.color).multiplyScalar($*T),ue.groundColor.copy(L.groundColor).multiplyScalar($*T),o.hemi[y]=ue,y++}}v>0&&(e.isWebGL2?(o.rectAreaLTC1=vt.LTC_FLOAT_1,o.rectAreaLTC2=vt.LTC_FLOAT_2):n.has("OES_texture_float_linear")===!0?(o.rectAreaLTC1=vt.LTC_FLOAT_1,o.rectAreaLTC2=vt.LTC_FLOAT_2):n.has("OES_texture_half_float_linear")===!0?(o.rectAreaLTC1=vt.LTC_HALF_1,o.rectAreaLTC2=vt.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),o.ambient[0]=p,o.ambient[1]=u,o.ambient[2]=d;let M=o.hash;(M.directionalLength!==f||M.pointLength!==_||M.spotLength!==m||M.rectAreaLength!==v||M.hemiLength!==y||M.numDirectionalShadows!==b||M.numPointShadows!==x||M.numSpotShadows!==E)&&(o.directional.length=f,o.spot.length=m,o.rectArea.length=v,o.point.length=_,o.hemi.length=y,o.directionalShadow.length=b,o.directionalShadowMap.length=b,o.pointShadow.length=x,o.pointShadowMap.length=x,o.spotShadow.length=E,o.spotShadowMap.length=E,o.directionalShadowMatrix.length=b,o.pointShadowMatrix.length=x,o.spotShadowMatrix.length=E,M.directionalLength=f,M.pointLength=_,M.spotLength=m,M.rectAreaLength=v,M.hemiLength=y,M.numDirectionalShadows=b,M.numPointShadows=x,M.numSpotShadows=E,o.version=Nk++)}function c(h,g){let p=0,u=0,d=0,f=0,_=0,m=g.matrixWorldInverse;for(let v=0,y=h.length;v<y;v++){let b=h[v];if(b.isDirectionalLight){let x=o.directional[p];x.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),x.direction.sub(s),x.direction.transformDirection(m),p++}else if(b.isSpotLight){let x=o.spot[d];x.position.setFromMatrixPosition(b.matrixWorld),x.position.applyMatrix4(m),x.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),x.direction.sub(s),x.direction.transformDirection(m),d++}else if(b.isRectAreaLight){let x=o.rectArea[f];x.position.setFromMatrixPosition(b.matrixWorld),x.position.applyMatrix4(m),l.identity(),i.copy(b.matrixWorld),i.premultiply(m),l.extractRotation(i),x.halfWidth.set(b.width*.5,0,0),x.halfHeight.set(0,b.height*.5,0),x.halfWidth.applyMatrix4(l),x.halfHeight.applyMatrix4(l),f++}else if(b.isPointLight){let x=o.point[u];x.position.setFromMatrixPosition(b.matrixWorld),x.position.applyMatrix4(m),u++}else if(b.isHemisphereLight){let x=o.hemi[_];x.direction.setFromMatrixPosition(b.matrixWorld),x.direction.transformDirection(m),x.direction.normalize(),_++}}}return{setup:a,setupView:c,state:o}}function NC(n,e){let t=new MC(n,e),r=[],o=[];function s(){r.length=0,o.length=0}function i(g){r.push(g)}function l(g){o.push(g)}function a(g){t.setup(r,g)}function c(g){t.setupView(r,g)}return{init:s,state:{lightsArray:r,shadowsArray:o,lights:t},setupLights:a,setupLightsView:c,pushLight:i,pushShadow:l}}function SC(n,e){let t=new WeakMap;function r(s,i=0){let l;return t.has(s)===!1?(l=new NC(n,e),t.set(s,[l])):i>=t.get(s).length?(l=new NC(n,e),t.get(s).push(l)):l=t.get(s)[i],l}function o(){t=new WeakMap}return{get:r,dispose:o}}var gl=class extends gn{constructor(e){super();this.type="MeshDepthMaterial",this.depthPacking=Gv,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}};gl.prototype.isMeshDepthMaterial=!0;var vl=class extends gn{constructor(e){super();this.type="MeshDistanceMaterial",this.referencePosition=new F,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}};vl.prototype.isMeshDistanceMaterial=!0;var PC=`
void main() {

	gl_Position = vec4( position, 1.0 );

}
`,OC=`
uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
uniform float samples;

#include <packing>

void main() {

	float mean = 0.0;
	float squared_mean = 0.0;

	// This seems totally useless but it's a crazy work around for a Adreno compiler bug
	// float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );

	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {

		float uvOffset = uvStart + i * uvStride;

		#ifdef HORIZONTAL_PASS

			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;

		#else

			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;

		#endif

	}

	mean = mean / samples;
	squared_mean = squared_mean / samples;

	float std_dev = sqrt( squared_mean - mean * mean );

	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );

}
`;function wC(n,e,t){let r=new Ad,o=new re,s=new re,i=new kt,l=new gl({depthPacking:Uv}),a=new vl,c={},h=t.maxTextureSize,g={0:Nr,1:eo,2:Ho},p=new co({uniforms:{shadow_pass:{value:null},resolution:{value:new re},radius:{value:4},samples:{value:8}},vertexShader:PC,fragmentShader:OC}),u=p.clone();u.defines.HORIZONTAL_PASS=1;let d=new Gt;d.setAttribute("position",new lo(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let f=new wr(d,p),_=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=$a,this.render=function(b,x,E){if(_.enabled===!1||_.autoUpdate===!1&&_.needsUpdate===!1||b.length===0)return;let T=n.getRenderTarget(),M=n.getActiveCubeFace(),D=n.getActiveMipmapLevel(),U=n.state;U.setBlending(To),U.buffers.color.setClear(1,1,1,1),U.buffers.depth.setTest(!0),U.setScissorTest(!1);for(let L=0,se=b.length;L<se;L++){let $=b[L],H=$.shadow;if(H===void 0){console.warn("THREE.WebGLShadowMap:",$,"has no shadow.");continue}if(H.autoUpdate===!1&&H.needsUpdate===!1)continue;o.copy(H.mapSize);let ae=H.getFrameExtents();if(o.multiply(ae),s.copy(H.mapSize),(o.x>h||o.y>h)&&(o.x>h&&(s.x=Math.floor(h/ae.x),o.x=s.x*ae.x,H.mapSize.x=s.x),o.y>h&&(s.y=Math.floor(h/ae.y),o.y=s.y*ae.y,H.mapSize.y=s.y)),H.map===null&&!H.isPointLightShadow&&this.type===Qi){let me={minFilter:Sn,magFilter:Sn,format:nn};H.map=new Yn(o.x,o.y,me),H.map.texture.name=$.name+".shadowMap",H.mapPass=new Yn(o.x,o.y,me),H.camera.updateProjectionMatrix()}if(H.map===null){let me={minFilter:Ur,magFilter:Ur,format:nn};H.map=new Yn(o.x,o.y,me),H.map.texture.name=$.name+".shadowMap",H.camera.updateProjectionMatrix()}n.setRenderTarget(H.map),n.clear();let ue=H.getViewportCount();for(let me=0;me<ue;me++){let Ue=H.getViewport(me);i.set(s.x*Ue.x,s.y*Ue.y,s.x*Ue.z,s.y*Ue.w),U.viewport(i),H.updateMatrices($,me),r=H.getFrustum(),y(x,E,H.camera,$,this.type)}!H.isPointLightShadow&&this.type===Qi&&m(H,E),H.needsUpdate=!1}_.needsUpdate=!1,n.setRenderTarget(T,M,D)};function m(b,x){let E=e.update(f);p.uniforms.shadow_pass.value=b.map.texture,p.uniforms.resolution.value=b.mapSize,p.uniforms.radius.value=b.radius,p.uniforms.samples.value=b.blurSamples,n.setRenderTarget(b.mapPass),n.clear(),n.renderBufferDirect(x,null,E,p,f,null),u.uniforms.shadow_pass.value=b.mapPass.texture,u.uniforms.resolution.value=b.mapSize,u.uniforms.radius.value=b.radius,u.uniforms.samples.value=b.blurSamples,n.setRenderTarget(b.map),n.clear(),n.renderBufferDirect(x,null,E,u,f,null)}function v(b,x,E,T,M,D,U){let L=null,se=T.isPointLight===!0?b.customDistanceMaterial:b.customDepthMaterial;if(se!==void 0?L=se:L=T.isPointLight===!0?a:l,n.localClippingEnabled&&E.clipShadows===!0&&E.clippingPlanes.length!==0||E.displacementMap&&E.displacementScale!==0||E.alphaMap&&E.alphaTest>0){let $=L.uuid,H=E.uuid,ae=c[$];ae===void 0&&(ae={},c[$]=ae);let ue=ae[H];ue===void 0&&(ue=L.clone(),ae[H]=ue),L=ue}return L.visible=E.visible,L.wireframe=E.wireframe,U===Qi?L.side=E.shadowSide!==null?E.shadowSide:E.side:L.side=E.shadowSide!==null?E.shadowSide:g[E.side],L.alphaMap=E.alphaMap,L.alphaTest=E.alphaTest,L.clipShadows=E.clipShadows,L.clippingPlanes=E.clippingPlanes,L.clipIntersection=E.clipIntersection,L.displacementMap=E.displacementMap,L.displacementScale=E.displacementScale,L.displacementBias=E.displacementBias,L.wireframeLinewidth=E.wireframeLinewidth,L.linewidth=E.linewidth,T.isPointLight===!0&&L.isMeshDistanceMaterial===!0&&(L.referencePosition.setFromMatrixPosition(T.matrixWorld),L.nearDistance=M,L.farDistance=D),L}function y(b,x,E,T,M){if(b.visible===!1)return;if(b.layers.test(x.layers)&&(b.isMesh||b.isLine||b.isPoints)&&(b.castShadow||b.receiveShadow&&M===Qi)&&(!b.frustumCulled||r.intersectsObject(b))){b.modelViewMatrix.multiplyMatrices(E.matrixWorldInverse,b.matrixWorld);let L=e.update(b),se=b.material;if(Array.isArray(se)){let $=L.groups;for(let H=0,ae=$.length;H<ae;H++){let ue=$[H],me=se[ue.materialIndex];if(me&&me.visible){let Ue=v(b,L,me,T,E.near,E.far,M);n.renderBufferDirect(E,null,L,Ue,b,ue)}}}else if(se.visible){let $=v(b,L,se,T,E.near,E.far,M);n.renderBufferDirect(E,null,L,$,b,null)}}let U=b.children;for(let L=0,se=U.length;L<se;L++)y(U[L],x,E,T,M)}}function RC(n,e,t){let r=t.isWebGL2;function o(){let Y=!1,ot=new kt,Oe=null,bt=new kt(0,0,0,0);return{setMask:function(Pt){Oe!==Pt&&!Y&&(n.colorMask(Pt,Pt,Pt,Pt),Oe=Pt)},setLocked:function(Pt){Y=Pt},setClear:function(Pt,Zt,ne,Et,Or){Or===!0&&(Pt*=Et,Zt*=Et,ne*=Et),ot.set(Pt,Zt,ne,Et),bt.equals(ot)===!1&&(n.clearColor(Pt,Zt,ne,Et),bt.copy(ot))},reset:function(){Y=!1,Oe=null,bt.set(-1,0,0,0)}}}function s(){let Y=!1,ot=null,Oe=null,bt=null;return{setTest:function(Pt){Pt?oe(n.DEPTH_TEST):yt(n.DEPTH_TEST)},setMask:function(Pt){ot!==Pt&&!Y&&(n.depthMask(Pt),ot=Pt)},setFunc:function(Pt){if(Oe!==Pt){if(Pt)switch(Pt){case Gg:n.depthFunc(n.NEVER);break;case Ug:n.depthFunc(n.ALWAYS);break;case Vg:n.depthFunc(n.LESS);break;case A1:n.depthFunc(n.LEQUAL);break;case zg:n.depthFunc(n.EQUAL);break;case Hg:n.depthFunc(n.GEQUAL);break;case jg:n.depthFunc(n.GREATER);break;case qg:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}else n.depthFunc(n.LEQUAL);Oe=Pt}},setLocked:function(Pt){Y=Pt},setClear:function(Pt){bt!==Pt&&(n.clearDepth(Pt),bt=Pt)},reset:function(){Y=!1,ot=null,Oe=null,bt=null}}}function i(){let Y=!1,ot=null,Oe=null,bt=null,Pt=null,Zt=null,ne=null,Et=null,Or=null;return{setTest:function(cr){Y||(cr?oe(n.STENCIL_TEST):yt(n.STENCIL_TEST))},setMask:function(cr){ot!==cr&&!Y&&(n.stencilMask(cr),ot=cr)},setFunc:function(cr,an,Vn){(Oe!==cr||bt!==an||Pt!==Vn)&&(n.stencilFunc(cr,an,Vn),Oe=cr,bt=an,Pt=Vn)},setOp:function(cr,an,Vn){(Zt!==cr||ne!==an||Et!==Vn)&&(n.stencilOp(cr,an,Vn),Zt=cr,ne=an,Et=Vn)},setLocked:function(cr){Y=cr},setClear:function(cr){Or!==cr&&(n.clearStencil(cr),Or=cr)},reset:function(){Y=!1,ot=null,Oe=null,bt=null,Pt=null,Zt=null,ne=null,Et=null,Or=null}}}let l=new o,a=new s,c=new i,h={},g=null,p={},u=null,d=!1,f=null,_=null,m=null,v=null,y=null,b=null,x=null,E=!1,T=null,M=null,D=null,U=null,L=null,se=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS),$=!1,H=0,ae=n.getParameter(n.VERSION);ae.indexOf("WebGL")!==-1?(H=parseFloat(/^WebGL (\d)/.exec(ae)[1]),$=H>=1):ae.indexOf("OpenGL ES")!==-1&&(H=parseFloat(/^OpenGL ES (\d)/.exec(ae)[1]),$=H>=2);let ue=null,me={},Ue=n.getParameter(n.SCISSOR_BOX),st=n.getParameter(n.VIEWPORT),ft=new kt().fromArray(Ue),Ze=new kt().fromArray(st);function gt(Y,ot,Oe){let bt=new Uint8Array(4),Pt=n.createTexture();n.bindTexture(Y,Pt),n.texParameteri(Y,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(Y,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let Zt=0;Zt<Oe;Zt++)n.texImage2D(ot+Zt,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,bt);return Pt}let ce={};ce[n.TEXTURE_2D]=gt(n.TEXTURE_2D,n.TEXTURE_2D,1),ce[n.TEXTURE_CUBE_MAP]=gt(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),l.setClear(0,0,0,1),a.setClear(1),c.setClear(0),oe(n.DEPTH_TEST),a.setFunc(A1),tt(!1),ut(C1),oe(n.CULL_FACE),Vt(To);function oe(Y){h[Y]!==!0&&(n.enable(Y),h[Y]=!0)}function yt(Y){h[Y]!==!1&&(n.disable(Y),h[Y]=!1)}function X(Y){Y!==g&&(n.bindFramebuffer(n.FRAMEBUFFER,Y),g=Y)}function Tt(Y,ot){return ot===null&&g!==null&&(ot=g),p[Y]!==ot?(n.bindFramebuffer(Y,ot),p[Y]=ot,r&&(Y===n.DRAW_FRAMEBUFFER&&(p[n.FRAMEBUFFER]=ot),Y===n.FRAMEBUFFER&&(p[n.DRAW_FRAMEBUFFER]=ot)),!0):!1}function At(Y){return u!==Y?(n.useProgram(Y),u=Y,!0):!1}let Nt={[Ya]:n.FUNC_ADD,[Mg]:n.FUNC_SUBTRACT,[Ng]:n.FUNC_REVERSE_SUBTRACT};if(r)Nt[T1]=n.MIN,Nt[E1]=n.MAX;else{let Y=e.get("EXT_blend_minmax");Y!==null&&(Nt[T1]=Y.MIN_EXT,Nt[E1]=Y.MAX_EXT)}let Mt={[Sg]:n.ZERO,[Pg]:n.ONE,[Og]:n.SRC_COLOR,[Rg]:n.SRC_ALPHA,[Fg]:n.SRC_ALPHA_SATURATE,[Bg]:n.DST_COLOR,[Ig]:n.DST_ALPHA,[wg]:n.ONE_MINUS_SRC_COLOR,[Lg]:n.ONE_MINUS_SRC_ALPHA,[kg]:n.ONE_MINUS_DST_COLOR,[Dg]:n.ONE_MINUS_DST_ALPHA};function Vt(Y,ot,Oe,bt,Pt,Zt,ne,Et){if(Y===To){d===!0&&(yt(n.BLEND),d=!1);return}if(d===!1&&(oe(n.BLEND),d=!0),Y!==Ag){if(Y!==f||Et!==E){if((_!==Ya||y!==Ya)&&(n.blendEquation(n.FUNC_ADD),_=Ya,y=Ya),Et)switch(Y){case Es:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case Wc:n.blendFunc(n.ONE,n.ONE);break;case $c:n.blendFuncSeparate(n.ZERO,n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ONE_MINUS_SRC_ALPHA);break;case Yc:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",Y);break}else switch(Y){case Es:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case Wc:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case $c:n.blendFunc(n.ZERO,n.ONE_MINUS_SRC_COLOR);break;case Yc:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",Y);break}m=null,v=null,b=null,x=null,f=Y,E=Et}return}Pt=Pt||ot,Zt=Zt||Oe,ne=ne||bt,(ot!==_||Pt!==y)&&(n.blendEquationSeparate(Nt[ot],Nt[Pt]),_=ot,y=Pt),(Oe!==m||bt!==v||Zt!==b||ne!==x)&&(n.blendFuncSeparate(Mt[Oe],Mt[bt],Mt[Zt],Mt[ne]),m=Oe,v=bt,b=Zt,x=ne),f=Y,E=null}function Re(Y,ot){Y.side===Ho?yt(n.CULL_FACE):oe(n.CULL_FACE);let Oe=Y.side===Nr;ot&&(Oe=!Oe),tt(Oe),Y.blending===Es&&Y.transparent===!1?Vt(To):Vt(Y.blending,Y.blendEquation,Y.blendSrc,Y.blendDst,Y.blendEquationAlpha,Y.blendSrcAlpha,Y.blendDstAlpha,Y.premultipliedAlpha),a.setFunc(Y.depthFunc),a.setTest(Y.depthTest),a.setMask(Y.depthWrite),l.setMask(Y.colorWrite);let bt=Y.stencilWrite;c.setTest(bt),bt&&(c.setMask(Y.stencilWriteMask),c.setFunc(Y.stencilFunc,Y.stencilRef,Y.stencilFuncMask),c.setOp(Y.stencilFail,Y.stencilZFail,Y.stencilZPass)),pt(Y.polygonOffset,Y.polygonOffsetFactor,Y.polygonOffsetUnits),Y.alphaToCoverage===!0?oe(n.SAMPLE_ALPHA_TO_COVERAGE):yt(n.SAMPLE_ALPHA_TO_COVERAGE)}function tt(Y){T!==Y&&(Y?n.frontFace(n.CW):n.frontFace(n.CCW),T=Y)}function ut(Y){Y!==Cg?(oe(n.CULL_FACE),Y!==M&&(Y===C1?n.cullFace(n.BACK):Y===Tg?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):yt(n.CULL_FACE),M=Y}function It(Y){Y!==D&&($&&n.lineWidth(Y),D=Y)}function pt(Y,ot,Oe){Y?(oe(n.POLYGON_OFFSET_FILL),(U!==ot||L!==Oe)&&(n.polygonOffset(ot,Oe),U=ot,L=Oe)):yt(n.POLYGON_OFFSET_FILL)}function V(Y){Y?oe(n.SCISSOR_TEST):yt(n.SCISSOR_TEST)}function B(Y){Y===void 0&&(Y=n.TEXTURE0+se-1),ue!==Y&&(n.activeTexture(Y),ue=Y)}function Pe(Y,ot){ue===null&&B();let Oe=me[ue];Oe===void 0&&(Oe={type:void 0,texture:void 0},me[ue]=Oe),(Oe.type!==Y||Oe.texture!==ot)&&(n.bindTexture(Y,ot||ce[Y]),Oe.type=Y,Oe.texture=ot)}function lt(){let Y=me[ue];Y!==void 0&&Y.type!==void 0&&(n.bindTexture(Y.type,null),Y.type=void 0,Y.texture=void 0)}function A(){try{n.compressedTexImage2D.apply(n,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function St(){try{n.texImage2D.apply(n,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function Ut(){try{n.texImage3D.apply(n,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function Dt(Y){ft.equals(Y)===!1&&(n.scissor(Y.x,Y.y,Y.z,Y.w),ft.copy(Y))}function De(Y){Ze.equals(Y)===!1&&(n.viewport(Y.x,Y.y,Y.z,Y.w),Ze.copy(Y))}function Le(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),r===!0&&(n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),h={},ue=null,me={},g=null,p={},u=null,d=!1,f=null,_=null,m=null,v=null,y=null,b=null,x=null,E=!1,T=null,M=null,D=null,U=null,L=null,ft.set(0,0,n.canvas.width,n.canvas.height),Ze.set(0,0,n.canvas.width,n.canvas.height),l.reset(),a.reset(),c.reset()}return{buffers:{color:l,depth:a,stencil:c},enable:oe,disable:yt,bindFramebuffer:Tt,bindXRFramebuffer:X,useProgram:At,setBlending:Vt,setMaterial:Re,setFlipSided:tt,setCullFace:ut,setLineWidth:It,setPolygonOffset:pt,setScissorTest:V,activeTexture:B,bindTexture:Pe,unbindTexture:lt,compressedTexImage2D:A,texImage2D:St,texImage3D:Ut,scissor:Dt,viewport:De,reset:Le}}function LC(n,e,t,r,o,s,i){let l=o.isWebGL2,a=o.maxTextures,c=o.maxCubemapSize,h=o.maxTextureSize,g=o.maxSamples,p=new WeakMap,u,d=!1;try{d=typeof OffscreenCanvas!="undefined"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function f(V,B){return d?new OffscreenCanvas(V,B):Sd("canvas")}function _(V,B,Pe,lt){let A=1;if((V.width>lt||V.height>lt)&&(A=lt/Math.max(V.width,V.height)),A<1||B===!0)if(typeof HTMLImageElement!="undefined"&&V instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&V instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&V instanceof ImageBitmap){let St=B?Vv:Math.floor,Ut=St(A*V.width),Dt=St(A*V.height);u===void 0&&(u=f(Ut,Dt));let De=Pe?f(Ut,Dt):u;return De.width=Ut,De.height=Dt,De.getContext("2d").drawImage(V,0,0,Ut,Dt),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+V.width+"x"+V.height+") to ("+Ut+"x"+Dt+")."),De}else return"data"in V&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+V.width+"x"+V.height+")."),V;return V}function m(V){return F1(V.width)&&F1(V.height)}function v(V){return l?!1:V.wrapS!==rn||V.wrapT!==rn||V.minFilter!==Ur&&V.minFilter!==Sn}function y(V,B){return V.generateMipmaps&&B&&V.minFilter!==Ur&&V.minFilter!==Sn}function b(V,B,Pe,lt,A=1){n.generateMipmap(V);let St=r.get(B);St.__maxMipLevel=Math.log2(Math.max(Pe,lt,A))}function x(V,B,Pe,lt){if(l===!1)return B;if(V!==null){if(n[V]!==void 0)return n[V];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+V+"'")}let A=B;return B===n.RED&&(Pe===n.FLOAT&&(A=n.R32F),Pe===n.HALF_FLOAT&&(A=n.R16F),Pe===n.UNSIGNED_BYTE&&(A=n.R8)),B===n.RGB&&(Pe===n.FLOAT&&(A=n.RGB32F),Pe===n.HALF_FLOAT&&(A=n.RGB16F),Pe===n.UNSIGNED_BYTE&&(A=n.RGB8)),B===n.RGBA&&(Pe===n.FLOAT&&(A=n.RGBA32F),Pe===n.HALF_FLOAT&&(A=n.RGBA16F),Pe===n.UNSIGNED_BYTE&&(A=lt===Wo?n.SRGB8_ALPHA8:n.RGBA8)),(A===n.R16F||A===n.R32F||A===n.RGBA16F||A===n.RGBA32F)&&e.get("EXT_color_buffer_float"),A}function E(V){return V===Ur||V===Xc||V===Jc?n.NEAREST:n.LINEAR}function T(V){let B=V.target;B.removeEventListener("dispose",T),D(B),B.isVideoTexture&&p.delete(B),i.memory.textures--}function M(V){let B=V.target;B.removeEventListener("dispose",M),U(B)}function D(V){let B=r.get(V);B.__webglInit!==void 0&&(n.deleteTexture(B.__webglTexture),r.remove(V))}function U(V){let B=V.texture,Pe=r.get(V),lt=r.get(B);if(!!V){if(lt.__webglTexture!==void 0&&(n.deleteTexture(lt.__webglTexture),i.memory.textures--),V.depthTexture&&V.depthTexture.dispose(),V.isWebGLCubeRenderTarget)for(let A=0;A<6;A++)n.deleteFramebuffer(Pe.__webglFramebuffer[A]),Pe.__webglDepthbuffer&&n.deleteRenderbuffer(Pe.__webglDepthbuffer[A]);else n.deleteFramebuffer(Pe.__webglFramebuffer),Pe.__webglDepthbuffer&&n.deleteRenderbuffer(Pe.__webglDepthbuffer),Pe.__webglMultisampledFramebuffer&&n.deleteFramebuffer(Pe.__webglMultisampledFramebuffer),Pe.__webglColorRenderbuffer&&n.deleteRenderbuffer(Pe.__webglColorRenderbuffer),Pe.__webglDepthRenderbuffer&&n.deleteRenderbuffer(Pe.__webglDepthRenderbuffer);if(V.isWebGLMultipleRenderTargets)for(let A=0,St=B.length;A<St;A++){let Ut=r.get(B[A]);Ut.__webglTexture&&(n.deleteTexture(Ut.__webglTexture),i.memory.textures--),r.remove(B[A])}r.remove(B),r.remove(V)}}let L=0;function se(){L=0}function $(){let V=L;return V>=a&&console.warn("THREE.WebGLTextures: Trying to use "+V+" texture units while this GPU supports only "+a),L+=1,V}function H(V,B){let Pe=r.get(V);if(V.isVideoTexture&&Re(V),V.version>0&&Pe.__version!==V.version){let lt=V.image;if(lt===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(lt.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{gt(Pe,V,B);return}}t.activeTexture(n.TEXTURE0+B),t.bindTexture(n.TEXTURE_2D,Pe.__webglTexture)}function ae(V,B){let Pe=r.get(V);if(V.version>0&&Pe.__version!==V.version){gt(Pe,V,B);return}t.activeTexture(n.TEXTURE0+B),t.bindTexture(n.TEXTURE_2D_ARRAY,Pe.__webglTexture)}function ue(V,B){let Pe=r.get(V);if(V.version>0&&Pe.__version!==V.version){gt(Pe,V,B);return}t.activeTexture(n.TEXTURE0+B),t.bindTexture(n.TEXTURE_3D,Pe.__webglTexture)}function me(V,B){let Pe=r.get(V);if(V.version>0&&Pe.__version!==V.version){ce(Pe,V,B);return}t.activeTexture(n.TEXTURE0+B),t.bindTexture(n.TEXTURE_CUBE_MAP,Pe.__webglTexture)}let Ue={[yd]:n.REPEAT,[rn]:n.CLAMP_TO_EDGE,[bd]:n.MIRRORED_REPEAT},st={[Ur]:n.NEAREST,[Xc]:n.NEAREST_MIPMAP_NEAREST,[Jc]:n.NEAREST_MIPMAP_LINEAR,[Sn]:n.LINEAR,[xd]:n.LINEAR_MIPMAP_NEAREST,[R0]:n.LINEAR_MIPMAP_LINEAR};function ft(V,B,Pe){if(Pe?(n.texParameteri(V,n.TEXTURE_WRAP_S,Ue[B.wrapS]),n.texParameteri(V,n.TEXTURE_WRAP_T,Ue[B.wrapT]),(V===n.TEXTURE_3D||V===n.TEXTURE_2D_ARRAY)&&n.texParameteri(V,n.TEXTURE_WRAP_R,Ue[B.wrapR]),n.texParameteri(V,n.TEXTURE_MAG_FILTER,st[B.magFilter]),n.texParameteri(V,n.TEXTURE_MIN_FILTER,st[B.minFilter])):(n.texParameteri(V,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(V,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),(V===n.TEXTURE_3D||V===n.TEXTURE_2D_ARRAY)&&n.texParameteri(V,n.TEXTURE_WRAP_R,n.CLAMP_TO_EDGE),(B.wrapS!==rn||B.wrapT!==rn)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(V,n.TEXTURE_MAG_FILTER,E(B.magFilter)),n.texParameteri(V,n.TEXTURE_MIN_FILTER,E(B.minFilter)),B.minFilter!==Ur&&B.minFilter!==Sn&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),e.has("EXT_texture_filter_anisotropic")===!0){let lt=e.get("EXT_texture_filter_anisotropic");if(B.type===ho&&e.has("OES_texture_float_linear")===!1||l===!1&&B.type===jo&&e.has("OES_texture_half_float_linear")===!1)return;(B.anisotropy>1||r.get(B).__currentAnisotropy)&&(n.texParameterf(V,lt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(B.anisotropy,o.getMaxAnisotropy())),r.get(B).__currentAnisotropy=B.anisotropy)}}function Ze(V,B){V.__webglInit===void 0&&(V.__webglInit=!0,B.addEventListener("dispose",T),V.__webglTexture=n.createTexture(),i.memory.textures++)}function gt(V,B,Pe){let lt=n.TEXTURE_2D;B.isDataTexture2DArray&&(lt=n.TEXTURE_2D_ARRAY),B.isDataTexture3D&&(lt=n.TEXTURE_3D),Ze(V,B),t.activeTexture(n.TEXTURE0+Pe),t.bindTexture(lt,V.__webglTexture),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,B.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,B.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,B.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,n.NONE);let A=v(B)&&m(B.image)===!1,St=_(B.image,A,!1,h),Ut=m(St)||l,Dt=s.convert(B.format),De=s.convert(B.type),Le=x(B.internalFormat,Dt,De,B.encoding);ft(lt,B,Ut);let Y,ot=B.mipmaps;if(B.isDepthTexture)Le=n.DEPTH_COMPONENT,l?B.type===ho?Le=n.DEPTH_COMPONENT32F:B.type===Xa?Le=n.DEPTH_COMPONENT24:B.type===Ja?Le=n.DEPTH24_STENCIL8:Le=n.DEPTH_COMPONENT16:B.type===ho&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),B.format===Zc&&Le===n.DEPTH_COMPONENT&&B.type!==Kc&&B.type!==Xa&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),B.type=Kc,De=s.convert(B.type)),B.format===Qc&&Le===n.DEPTH_COMPONENT&&(Le=n.DEPTH_STENCIL,B.type!==Ja&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),B.type=Ja,De=s.convert(B.type))),t.texImage2D(n.TEXTURE_2D,0,Le,St.width,St.height,0,Dt,De,null);else if(B.isDataTexture)if(ot.length>0&&Ut){for(let Oe=0,bt=ot.length;Oe<bt;Oe++)Y=ot[Oe],t.texImage2D(n.TEXTURE_2D,Oe,Le,Y.width,Y.height,0,Dt,De,Y.data);B.generateMipmaps=!1,V.__maxMipLevel=ot.length-1}else t.texImage2D(n.TEXTURE_2D,0,Le,St.width,St.height,0,Dt,De,St.data),V.__maxMipLevel=0;else if(B.isCompressedTexture){for(let Oe=0,bt=ot.length;Oe<bt;Oe++)Y=ot[Oe],B.format!==nn&&B.format!==qo?Dt!==null?t.compressedTexImage2D(n.TEXTURE_2D,Oe,Le,Y.width,Y.height,0,Y.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):t.texImage2D(n.TEXTURE_2D,Oe,Le,Y.width,Y.height,0,Dt,De,Y.data);V.__maxMipLevel=ot.length-1}else if(B.isDataTexture2DArray)t.texImage3D(n.TEXTURE_2D_ARRAY,0,Le,St.width,St.height,St.depth,0,Dt,De,St.data),V.__maxMipLevel=0;else if(B.isDataTexture3D)t.texImage3D(n.TEXTURE_3D,0,Le,St.width,St.height,St.depth,0,Dt,De,St.data),V.__maxMipLevel=0;else if(ot.length>0&&Ut){for(let Oe=0,bt=ot.length;Oe<bt;Oe++)Y=ot[Oe],t.texImage2D(n.TEXTURE_2D,Oe,Le,Dt,De,Y);B.generateMipmaps=!1,V.__maxMipLevel=ot.length-1}else t.texImage2D(n.TEXTURE_2D,0,Le,Dt,De,St),V.__maxMipLevel=0;y(B,Ut)&&b(lt,B,St.width,St.height),V.__version=B.version,B.onUpdate&&B.onUpdate(B)}function ce(V,B,Pe){if(B.image.length!==6)return;Ze(V,B),t.activeTexture(n.TEXTURE0+Pe),t.bindTexture(n.TEXTURE_CUBE_MAP,V.__webglTexture),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,B.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,B.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,B.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,n.NONE);let lt=B&&(B.isCompressedTexture||B.image[0].isCompressedTexture),A=B.image[0]&&B.image[0].isDataTexture,St=[];for(let Oe=0;Oe<6;Oe++)!lt&&!A?St[Oe]=_(B.image[Oe],!1,!0,c):St[Oe]=A?B.image[Oe].image:B.image[Oe];let Ut=St[0],Dt=m(Ut)||l,De=s.convert(B.format),Le=s.convert(B.type),Y=x(B.internalFormat,De,Le,B.encoding);ft(n.TEXTURE_CUBE_MAP,B,Dt);let ot;if(lt){for(let Oe=0;Oe<6;Oe++){ot=St[Oe].mipmaps;for(let bt=0;bt<ot.length;bt++){let Pt=ot[bt];B.format!==nn&&B.format!==qo?De!==null?t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,bt,Y,Pt.width,Pt.height,0,Pt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,bt,Y,Pt.width,Pt.height,0,De,Le,Pt.data)}}V.__maxMipLevel=ot.length-1}else{ot=B.mipmaps;for(let Oe=0;Oe<6;Oe++)if(A){t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,0,Y,St[Oe].width,St[Oe].height,0,De,Le,St[Oe].data);for(let bt=0;bt<ot.length;bt++){let Zt=ot[bt].image[Oe].image;t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,bt+1,Y,Zt.width,Zt.height,0,De,Le,Zt.data)}}else{t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,0,Y,De,Le,St[Oe]);for(let bt=0;bt<ot.length;bt++){let Pt=ot[bt];t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,bt+1,Y,De,Le,Pt.image[Oe])}}V.__maxMipLevel=ot.length}y(B,Dt)&&b(n.TEXTURE_CUBE_MAP,B,Ut.width,Ut.height),V.__version=B.version,B.onUpdate&&B.onUpdate(B)}function oe(V,B,Pe,lt,A){let St=s.convert(Pe.format),Ut=s.convert(Pe.type),Dt=x(Pe.internalFormat,St,Ut,Pe.encoding);A===n.TEXTURE_3D||A===n.TEXTURE_2D_ARRAY?t.texImage3D(A,0,Dt,B.width,B.height,B.depth,0,St,Ut,null):t.texImage2D(A,0,Dt,B.width,B.height,0,St,Ut,null),t.bindFramebuffer(n.FRAMEBUFFER,V),n.framebufferTexture2D(n.FRAMEBUFFER,lt,A,r.get(Pe).__webglTexture,0),t.bindFramebuffer(n.FRAMEBUFFER,null)}function yt(V,B,Pe){if(n.bindRenderbuffer(n.RENDERBUFFER,V),B.depthBuffer&&!B.stencilBuffer){let lt=n.DEPTH_COMPONENT16;if(Pe){let A=B.depthTexture;A&&A.isDepthTexture&&(A.type===ho?lt=n.DEPTH_COMPONENT32F:A.type===Xa&&(lt=n.DEPTH_COMPONENT24));let St=Vt(B);n.renderbufferStorageMultisample(n.RENDERBUFFER,St,lt,B.width,B.height)}else n.renderbufferStorage(n.RENDERBUFFER,lt,B.width,B.height);n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,V)}else if(B.depthBuffer&&B.stencilBuffer){if(Pe){let lt=Vt(B);n.renderbufferStorageMultisample(n.RENDERBUFFER,lt,n.DEPTH24_STENCIL8,B.width,B.height)}else n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,B.width,B.height);n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,V)}else{let lt=B.isWebGLMultipleRenderTargets===!0?B.texture[0]:B.texture,A=s.convert(lt.format),St=s.convert(lt.type),Ut=x(lt.internalFormat,A,St,lt.encoding);if(Pe){let Dt=Vt(B);n.renderbufferStorageMultisample(n.RENDERBUFFER,Dt,Ut,B.width,B.height)}else n.renderbufferStorage(n.RENDERBUFFER,Ut,B.width,B.height)}n.bindRenderbuffer(n.RENDERBUFFER,null)}function X(V,B){if(B&&B.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,V),!(B.depthTexture&&B.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get(B.depthTexture).__webglTexture||B.depthTexture.image.width!==B.width||B.depthTexture.image.height!==B.height)&&(B.depthTexture.image.width=B.width,B.depthTexture.image.height=B.height,B.depthTexture.needsUpdate=!0),H(B.depthTexture,0);let lt=r.get(B.depthTexture).__webglTexture;if(B.depthTexture.format===Zc)n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,lt,0);else if(B.depthTexture.format===Qc)n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,lt,0);else throw new Error("Unknown depthTexture format")}function Tt(V){let B=r.get(V),Pe=V.isWebGLCubeRenderTarget===!0;if(V.depthTexture){if(Pe)throw new Error("target.depthTexture not supported in Cube render targets");X(B.__webglFramebuffer,V)}else if(Pe){B.__webglDepthbuffer=[];for(let lt=0;lt<6;lt++)t.bindFramebuffer(n.FRAMEBUFFER,B.__webglFramebuffer[lt]),B.__webglDepthbuffer[lt]=n.createRenderbuffer(),yt(B.__webglDepthbuffer[lt],V,!1)}else t.bindFramebuffer(n.FRAMEBUFFER,B.__webglFramebuffer),B.__webglDepthbuffer=n.createRenderbuffer(),yt(B.__webglDepthbuffer,V,!1);t.bindFramebuffer(n.FRAMEBUFFER,null)}function At(V){let B=V.texture,Pe=r.get(V),lt=r.get(B);V.addEventListener("dispose",M),V.isWebGLMultipleRenderTargets!==!0&&(lt.__webglTexture=n.createTexture(),lt.__version=B.version,i.memory.textures++);let A=V.isWebGLCubeRenderTarget===!0,St=V.isWebGLMultipleRenderTargets===!0,Ut=V.isWebGLMultisampleRenderTarget===!0,Dt=B.isDataTexture3D||B.isDataTexture2DArray,De=m(V)||l;if(l&&B.format===qo&&(B.type===ho||B.type===jo)&&(B.format=nn,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),A){Pe.__webglFramebuffer=[];for(let Le=0;Le<6;Le++)Pe.__webglFramebuffer[Le]=n.createFramebuffer()}else if(Pe.__webglFramebuffer=n.createFramebuffer(),St)if(o.drawBuffers){let Le=V.texture;for(let Y=0,ot=Le.length;Y<ot;Y++){let Oe=r.get(Le[Y]);Oe.__webglTexture===void 0&&(Oe.__webglTexture=n.createTexture(),i.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(Ut)if(l){Pe.__webglMultisampledFramebuffer=n.createFramebuffer(),Pe.__webglColorRenderbuffer=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,Pe.__webglColorRenderbuffer);let Le=s.convert(B.format),Y=s.convert(B.type),ot=x(B.internalFormat,Le,Y,B.encoding),Oe=Vt(V);n.renderbufferStorageMultisample(n.RENDERBUFFER,Oe,ot,V.width,V.height),t.bindFramebuffer(n.FRAMEBUFFER,Pe.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,Pe.__webglColorRenderbuffer),n.bindRenderbuffer(n.RENDERBUFFER,null),V.depthBuffer&&(Pe.__webglDepthRenderbuffer=n.createRenderbuffer(),yt(Pe.__webglDepthRenderbuffer,V,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(A){t.bindTexture(n.TEXTURE_CUBE_MAP,lt.__webglTexture),ft(n.TEXTURE_CUBE_MAP,B,De);for(let Le=0;Le<6;Le++)oe(Pe.__webglFramebuffer[Le],V,B,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Le);y(B,De)&&b(n.TEXTURE_CUBE_MAP,B,V.width,V.height),t.unbindTexture()}else if(St){let Le=V.texture;for(let Y=0,ot=Le.length;Y<ot;Y++){let Oe=Le[Y],bt=r.get(Oe);t.bindTexture(n.TEXTURE_2D,bt.__webglTexture),ft(n.TEXTURE_2D,Oe,De),oe(Pe.__webglFramebuffer,V,Oe,n.COLOR_ATTACHMENT0+Y,n.TEXTURE_2D),y(Oe,De)&&b(n.TEXTURE_2D,Oe,V.width,V.height)}t.unbindTexture()}else{let Le=n.TEXTURE_2D;Dt&&(l?Le=B.isDataTexture3D?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),t.bindTexture(Le,lt.__webglTexture),ft(Le,B,De),oe(Pe.__webglFramebuffer,V,B,n.COLOR_ATTACHMENT0,Le),y(B,De)&&b(Le,B,V.width,V.height,V.depth),t.unbindTexture()}V.depthBuffer&&Tt(V)}function Nt(V){let B=m(V)||l,Pe=V.isWebGLMultipleRenderTargets===!0?V.texture:[V.texture];for(let lt=0,A=Pe.length;lt<A;lt++){let St=Pe[lt];if(y(St,B)){let Ut=V.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,Dt=r.get(St).__webglTexture;t.bindTexture(Ut,Dt),b(Ut,St,V.width,V.height),t.unbindTexture()}}}function Mt(V){if(V.isWebGLMultisampleRenderTarget)if(l){let B=V.width,Pe=V.height,lt=n.COLOR_BUFFER_BIT;V.depthBuffer&&(lt|=n.DEPTH_BUFFER_BIT),V.stencilBuffer&&(lt|=n.STENCIL_BUFFER_BIT);let A=r.get(V);t.bindFramebuffer(n.READ_FRAMEBUFFER,A.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,A.__webglFramebuffer),n.blitFramebuffer(0,0,B,Pe,0,0,B,Pe,lt,n.NEAREST),t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,A.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")}function Vt(V){return l&&V.isWebGLMultisampleRenderTarget?Math.min(g,V.samples):0}function Re(V){let B=i.render.frame;p.get(V)!==B&&(p.set(V,B),V.update())}let tt=!1,ut=!1;function It(V,B){V&&V.isWebGLRenderTarget&&(tt===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),tt=!0),V=V.texture),H(V,B)}function pt(V,B){V&&V.isWebGLCubeRenderTarget&&(ut===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),ut=!0),V=V.texture),me(V,B)}this.allocateTextureUnit=$,this.resetTextureUnits=se,this.setTexture2D=H,this.setTexture2DArray=ae,this.setTexture3D=ue,this.setTextureCube=me,this.setupRenderTarget=At,this.updateRenderTargetMipmap=Nt,this.updateMultisampleRenderTarget=Mt,this.safeSetTexture2D=It,this.safeSetTextureCube=pt}function IC(n,e,t){let r=t.isWebGL2;function o(s){let i;if(s===oi)return n.UNSIGNED_BYTE;if(s===Jg)return n.UNSIGNED_SHORT_4_4_4_4;if(s===Kg)return n.UNSIGNED_SHORT_5_5_5_1;if(s===Zg)return n.UNSIGNED_SHORT_5_6_5;if(s===$g)return n.BYTE;if(s===Yg)return n.SHORT;if(s===Kc)return n.UNSIGNED_SHORT;if(s===Xg)return n.INT;if(s===Xa)return n.UNSIGNED_INT;if(s===ho)return n.FLOAT;if(s===jo)return r?n.HALF_FLOAT:(i=e.get("OES_texture_half_float"),i!==null?i.HALF_FLOAT_OES:null);if(s===Qg)return n.ALPHA;if(s===qo)return n.RGB;if(s===nn)return n.RGBA;if(s===ev)return n.LUMINANCE;if(s===tv)return n.LUMINANCE_ALPHA;if(s===Zc)return n.DEPTH_COMPONENT;if(s===Qc)return n.DEPTH_STENCIL;if(s===nv)return n.RED;if(s===ov)return n.RED_INTEGER;if(s===iv)return n.RG;if(s===sv)return n.RG_INTEGER;if(s===av)return n.RGB_INTEGER;if(s===lv)return n.RGBA_INTEGER;if(s===M1||s===N1||s===S1||s===P1)if(i=e.get("WEBGL_compressed_texture_s3tc"),i!==null){if(s===M1)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===N1)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===S1)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===P1)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===O1||s===w1||s===R1||s===L1)if(i=e.get("WEBGL_compressed_texture_pvrtc"),i!==null){if(s===O1)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===w1)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===R1)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===L1)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===cv)return i=e.get("WEBGL_compressed_texture_etc1"),i!==null?i.COMPRESSED_RGB_ETC1_WEBGL:null;if((s===I1||s===D1)&&(i=e.get("WEBGL_compressed_texture_etc"),i!==null)){if(s===I1)return i.COMPRESSED_RGB8_ETC2;if(s===D1)return i.COMPRESSED_RGBA8_ETC2_EAC}if(s===uv||s===pv||s===dv||s===fv||s===mv||s===hv||s===_v||s===gv||s===vv||s===yv||s===bv||s===xv||s===Cv||s===Tv||s===Av||s===Mv||s===Nv||s===Sv||s===Pv||s===Ov||s===wv||s===Rv||s===Lv||s===Iv||s===Dv||s===Bv||s===kv||s===Fv)return i=e.get("WEBGL_compressed_texture_astc"),i!==null?s:null;if(s===Ev)return i=e.get("EXT_texture_compression_bptc"),i!==null?s:null;if(s===Ja)return r?n.UNSIGNED_INT_24_8:(i=e.get("WEBGL_depth_texture"),i!==null?i.UNSIGNED_INT_24_8_WEBGL:null)}return{convert:o}}var Ud=class extends qn{constructor(e=[]){super();this.cameras=e}};Ud.prototype.isArrayCamera=!0;var Ok={type:"move"},nu=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Tr,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Tr,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new F,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new F),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Tr,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new F,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new F),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,r){let o=null,s=null,i=null,l=this._targetRay,a=this._grip,c=this._hand;if(e&&t.session.visibilityState!=="visible-blurred")if(l!==null&&(o=t.getPose(e.targetRaySpace,r),o!==null&&(l.matrix.fromArray(o.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),o.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(o.linearVelocity)):l.hasLinearVelocity=!1,o.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(o.angularVelocity)):l.hasAngularVelocity=!1,this.dispatchEvent(Ok))),c&&e.hand){i=!0;for(let f of e.hand.values()){let _=t.getJointPose(f,r);if(c.joints[f.jointName]===void 0){let v=new Tr;v.matrixAutoUpdate=!1,v.visible=!1,c.joints[f.jointName]=v,c.add(v)}let m=c.joints[f.jointName];_!==null&&(m.matrix.fromArray(_.transform.matrix),m.matrix.decompose(m.position,m.rotation,m.scale),m.jointRadius=_.radius),m.visible=_!==null}let h=c.joints["index-finger-tip"],g=c.joints["thumb-tip"],p=h.position.distanceTo(g.position),u=.02,d=.005;c.inputState.pinching&&p>u+d?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&p<=u-d&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else a!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,r),s!==null&&(a.matrix.fromArray(s.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),s.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(s.linearVelocity)):a.hasLinearVelocity=!1,s.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(s.angularVelocity)):a.hasAngularVelocity=!1));return l!==null&&(l.visible=o!==null),a!==null&&(a.visible=s!==null),c!==null&&(c.visible=i!==null),this}};var K1=class extends tl{constructor(e,t){super();let r=this,o=e.state,s=null,i=1,l=null,a="local-floor",c=null,h=null,g=null,p=null,u=null,d=!1,f=null,_=null,m=null,v=null,y=null,b=null,x=[],E=new Map,T=new qn;T.layers.enable(1),T.viewport=new kt;let M=new qn;M.layers.enable(2),M.viewport=new kt;let D=[T,M],U=new Ud;U.layers.enable(1),U.layers.enable(2);let L=null,se=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(ce){let oe=x[ce];return oe===void 0&&(oe=new nu,x[ce]=oe),oe.getTargetRaySpace()},this.getControllerGrip=function(ce){let oe=x[ce];return oe===void 0&&(oe=new nu,x[ce]=oe),oe.getGripSpace()},this.getHand=function(ce){let oe=x[ce];return oe===void 0&&(oe=new nu,x[ce]=oe),oe.getHandSpace()};function $(ce){let oe=E.get(ce.inputSource);oe&&oe.dispatchEvent({type:ce.type,data:ce.inputSource})}function H(){E.forEach(function(ce,oe){ce.disconnect(oe)}),E.clear(),L=null,se=null,o.bindXRFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),g&&t.deleteFramebuffer(g),f&&t.deleteFramebuffer(f),_&&t.deleteRenderbuffer(_),m&&t.deleteRenderbuffer(m),g=null,f=null,_=null,m=null,u=null,p=null,h=null,s=null,gt.stop(),r.isPresenting=!1,r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(ce){i=ce,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ce){a=ce,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l},this.getBaseLayer=function(){return p!==null?p:u},this.getBinding=function(){return h},this.getFrame=function(){return v},this.getSession=function(){return s},this.setSession=async function(ce){if(s=ce,s!==null){s.addEventListener("select",$),s.addEventListener("selectstart",$),s.addEventListener("selectend",$),s.addEventListener("squeeze",$),s.addEventListener("squeezestart",$),s.addEventListener("squeezeend",$),s.addEventListener("end",H),s.addEventListener("inputsourceschange",ae);let oe=t.getContextAttributes();if(oe.xrCompatible!==!0&&await t.makeXRCompatible(),s.renderState.layers===void 0){let yt={antialias:oe.antialias,alpha:oe.alpha,depth:oe.depth,stencil:oe.stencil,framebufferScaleFactor:i};u=new XRWebGLLayer(s,t,yt),s.updateRenderState({baseLayer:u})}else if(t instanceof WebGLRenderingContext){let yt={antialias:!0,alpha:oe.alpha,depth:oe.depth,stencil:oe.stencil,framebufferScaleFactor:i};u=new XRWebGLLayer(s,t,yt),s.updateRenderState({layers:[u]})}else{d=oe.antialias;let yt=null;oe.depth&&(b=t.DEPTH_BUFFER_BIT,oe.stencil&&(b|=t.STENCIL_BUFFER_BIT),y=oe.stencil?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,yt=oe.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24);let X={colorFormat:oe.alpha?t.RGBA8:t.RGB8,depthFormat:yt,scaleFactor:i};h=new XRWebGLBinding(s,t),p=h.createProjectionLayer(X),g=t.createFramebuffer(),s.updateRenderState({layers:[p]}),d&&(f=t.createFramebuffer(),_=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,_),t.renderbufferStorageMultisample(t.RENDERBUFFER,4,t.RGBA8,p.textureWidth,p.textureHeight),o.bindFramebuffer(t.FRAMEBUFFER,f),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,_),t.bindRenderbuffer(t.RENDERBUFFER,null),yt!==null&&(m=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,m),t.renderbufferStorageMultisample(t.RENDERBUFFER,4,yt,p.textureWidth,p.textureHeight),t.framebufferRenderbuffer(t.FRAMEBUFFER,y,t.RENDERBUFFER,m),t.bindRenderbuffer(t.RENDERBUFFER,null)),o.bindFramebuffer(t.FRAMEBUFFER,null))}l=await s.requestReferenceSpace(a),gt.setContext(s),gt.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}};function ae(ce){let oe=s.inputSources;for(let yt=0;yt<x.length;yt++)E.set(oe[yt],x[yt]);for(let yt=0;yt<ce.removed.length;yt++){let X=ce.removed[yt],Tt=E.get(X);Tt&&(Tt.dispatchEvent({type:"disconnected",data:X}),E.delete(X))}for(let yt=0;yt<ce.added.length;yt++){let X=ce.added[yt],Tt=E.get(X);Tt&&Tt.dispatchEvent({type:"connected",data:X})}}let ue=new F,me=new F;function Ue(ce,oe,yt){ue.setFromMatrixPosition(oe.matrixWorld),me.setFromMatrixPosition(yt.matrixWorld);let X=ue.distanceTo(me),Tt=oe.projectionMatrix.elements,At=yt.projectionMatrix.elements,Nt=Tt[14]/(Tt[10]-1),Mt=Tt[14]/(Tt[10]+1),Vt=(Tt[9]+1)/Tt[5],Re=(Tt[9]-1)/Tt[5],tt=(Tt[8]-1)/Tt[0],ut=(At[8]+1)/At[0],It=Nt*tt,pt=Nt*ut,V=X/(-tt+ut),B=V*-tt;oe.matrixWorld.decompose(ce.position,ce.quaternion,ce.scale),ce.translateX(B),ce.translateZ(V),ce.matrixWorld.compose(ce.position,ce.quaternion,ce.scale),ce.matrixWorldInverse.copy(ce.matrixWorld).invert();let Pe=Nt+V,lt=Mt+V,A=It-B,St=pt+(X-B),Ut=Vt*Mt/lt*Pe,Dt=Re*Mt/lt*Pe;ce.projectionMatrix.makePerspective(A,St,Ut,Dt,Pe,lt)}function st(ce,oe){oe===null?ce.matrixWorld.copy(ce.matrix):ce.matrixWorld.multiplyMatrices(oe.matrixWorld,ce.matrix),ce.matrixWorldInverse.copy(ce.matrixWorld).invert()}this.updateCamera=function(ce){if(s===null)return;U.near=M.near=T.near=ce.near,U.far=M.far=T.far=ce.far,(L!==U.near||se!==U.far)&&(s.updateRenderState({depthNear:U.near,depthFar:U.far}),L=U.near,se=U.far);let oe=ce.parent,yt=U.cameras;st(U,oe);for(let Tt=0;Tt<yt.length;Tt++)st(yt[Tt],oe);U.matrixWorld.decompose(U.position,U.quaternion,U.scale),ce.position.copy(U.position),ce.quaternion.copy(U.quaternion),ce.scale.copy(U.scale),ce.matrix.copy(U.matrix),ce.matrixWorld.copy(U.matrixWorld);let X=ce.children;for(let Tt=0,At=X.length;Tt<At;Tt++)X[Tt].updateMatrixWorld(!0);yt.length===2?Ue(U,T,M):U.projectionMatrix.copy(T.projectionMatrix)},this.getCamera=function(){return U},this.getFoveation=function(){if(p!==null)return p.fixedFoveation;if(u!==null)return u.fixedFoveation},this.setFoveation=function(ce){p!==null&&(p.fixedFoveation=ce),u!==null&&u.fixedFoveation!==void 0&&(u.fixedFoveation=ce)};let ft=null;function Ze(ce,oe){if(c=oe.getViewerPose(l),v=oe,c!==null){let X=c.views;u!==null&&o.bindXRFramebuffer(u.framebuffer);let Tt=!1;X.length!==U.cameras.length&&(U.cameras.length=0,Tt=!0);for(let At=0;At<X.length;At++){let Nt=X[At],Mt=null;if(u!==null)Mt=u.getViewport(Nt);else{let Re=h.getViewSubImage(p,Nt);o.bindXRFramebuffer(g),Re.depthStencilTexture!==void 0&&t.framebufferTexture2D(t.FRAMEBUFFER,y,t.TEXTURE_2D,Re.depthStencilTexture,0),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,Re.colorTexture,0),Mt=Re.viewport}let Vt=D[At];Vt.matrix.fromArray(Nt.transform.matrix),Vt.projectionMatrix.fromArray(Nt.projectionMatrix),Vt.viewport.set(Mt.x,Mt.y,Mt.width,Mt.height),At===0&&U.matrix.copy(Vt.matrix),Tt===!0&&U.cameras.push(Vt)}d&&(o.bindXRFramebuffer(f),b!==null&&t.clear(b))}let yt=s.inputSources;for(let X=0;X<x.length;X++){let Tt=x[X],At=yt[X];Tt.update(At,oe,l)}if(ft&&ft(ce,oe),d){let X=p.textureWidth,Tt=p.textureHeight;o.bindFramebuffer(t.READ_FRAMEBUFFER,f),o.bindFramebuffer(t.DRAW_FRAMEBUFFER,g),t.invalidateFramebuffer(t.READ_FRAMEBUFFER,[y]),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,[y]),t.blitFramebuffer(0,0,X,Tt,0,0,X,Tt,t.COLOR_BUFFER_BIT,t.NEAREST),t.invalidateFramebuffer(t.READ_FRAMEBUFFER,[t.COLOR_ATTACHMENT0]),o.bindFramebuffer(t.READ_FRAMEBUFFER,null),o.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),o.bindFramebuffer(t.FRAMEBUFFER,f)}v=null}let gt=new Id;gt.setAnimationLoop(Ze),this.setAnimationLoop=function(ce){ft=ce},this.dispose=function(){}}};function DC(n){function e(m,v){m.fogColor.value.copy(v.color),v.isFog?(m.fogNear.value=v.near,m.fogFar.value=v.far):v.isFogExp2&&(m.fogDensity.value=v.density)}function t(m,v,y,b,x){v.isMeshBasicMaterial?r(m,v):v.isMeshLambertMaterial?(r(m,v),a(m,v)):v.isMeshToonMaterial?(r(m,v),h(m,v)):v.isMeshPhongMaterial?(r(m,v),c(m,v)):v.isMeshStandardMaterial?(r(m,v),v.isMeshPhysicalMaterial?p(m,v,x):g(m,v)):v.isMeshMatcapMaterial?(r(m,v),u(m,v)):v.isMeshDepthMaterial?(r(m,v),d(m,v)):v.isMeshDistanceMaterial?(r(m,v),f(m,v)):v.isMeshNormalMaterial?(r(m,v),_(m,v)):v.isLineBasicMaterial?(o(m,v),v.isLineDashedMaterial&&s(m,v)):v.isPointsMaterial?i(m,v,y,b):v.isSpriteMaterial?l(m,v):v.isShadowMaterial?(m.color.value.copy(v.color),m.opacity.value=v.opacity):v.isShaderMaterial&&(v.uniformsNeedUpdate=!1)}function r(m,v){m.opacity.value=v.opacity,v.color&&m.diffuse.value.copy(v.color),v.emissive&&m.emissive.value.copy(v.emissive).multiplyScalar(v.emissiveIntensity),v.map&&(m.map.value=v.map),v.alphaMap&&(m.alphaMap.value=v.alphaMap),v.specularMap&&(m.specularMap.value=v.specularMap),v.alphaTest>0&&(m.alphaTest.value=v.alphaTest);let y=n.get(v).envMap;if(y){m.envMap.value=y,m.flipEnvMap.value=y.isCubeTexture&&y.isRenderTargetTexture===!1?-1:1,m.reflectivity.value=v.reflectivity,m.ior.value=v.ior,m.refractionRatio.value=v.refractionRatio;let E=n.get(y).__maxMipLevel;E!==void 0&&(m.maxMipLevel.value=E)}v.lightMap&&(m.lightMap.value=v.lightMap,m.lightMapIntensity.value=v.lightMapIntensity),v.aoMap&&(m.aoMap.value=v.aoMap,m.aoMapIntensity.value=v.aoMapIntensity);let b;v.map?b=v.map:v.specularMap?b=v.specularMap:v.displacementMap?b=v.displacementMap:v.normalMap?b=v.normalMap:v.bumpMap?b=v.bumpMap:v.roughnessMap?b=v.roughnessMap:v.metalnessMap?b=v.metalnessMap:v.alphaMap?b=v.alphaMap:v.emissiveMap?b=v.emissiveMap:v.clearcoatMap?b=v.clearcoatMap:v.clearcoatNormalMap?b=v.clearcoatNormalMap:v.clearcoatRoughnessMap?b=v.clearcoatRoughnessMap:v.specularIntensityMap?b=v.specularIntensityMap:v.specularTintMap?b=v.specularTintMap:v.transmissionMap?b=v.transmissionMap:v.thicknessMap&&(b=v.thicknessMap),b!==void 0&&(b.isWebGLRenderTarget&&(b=b.texture),b.matrixAutoUpdate===!0&&b.updateMatrix(),m.uvTransform.value.copy(b.matrix));let x;v.aoMap?x=v.aoMap:v.lightMap&&(x=v.lightMap),x!==void 0&&(x.isWebGLRenderTarget&&(x=x.texture),x.matrixAutoUpdate===!0&&x.updateMatrix(),m.uv2Transform.value.copy(x.matrix))}function o(m,v){m.diffuse.value.copy(v.color),m.opacity.value=v.opacity}function s(m,v){m.dashSize.value=v.dashSize,m.totalSize.value=v.dashSize+v.gapSize,m.scale.value=v.scale}function i(m,v,y,b){m.diffuse.value.copy(v.color),m.opacity.value=v.opacity,m.size.value=v.size*y,m.scale.value=b*.5,v.map&&(m.map.value=v.map),v.alphaMap&&(m.alphaMap.value=v.alphaMap),v.alphaTest>0&&(m.alphaTest.value=v.alphaTest);let x;v.map?x=v.map:v.alphaMap&&(x=v.alphaMap),x!==void 0&&(x.matrixAutoUpdate===!0&&x.updateMatrix(),m.uvTransform.value.copy(x.matrix))}function l(m,v){m.diffuse.value.copy(v.color),m.opacity.value=v.opacity,m.rotation.value=v.rotation,v.map&&(m.map.value=v.map),v.alphaMap&&(m.alphaMap.value=v.alphaMap),v.alphaTest>0&&(m.alphaTest.value=v.alphaTest);let y;v.map?y=v.map:v.alphaMap&&(y=v.alphaMap),y!==void 0&&(y.matrixAutoUpdate===!0&&y.updateMatrix(),m.uvTransform.value.copy(y.matrix))}function a(m,v){v.emissiveMap&&(m.emissiveMap.value=v.emissiveMap)}function c(m,v){m.specular.value.copy(v.specular),m.shininess.value=Math.max(v.shininess,1e-4),v.emissiveMap&&(m.emissiveMap.value=v.emissiveMap),v.bumpMap&&(m.bumpMap.value=v.bumpMap,m.bumpScale.value=v.bumpScale,v.side===Nr&&(m.bumpScale.value*=-1)),v.normalMap&&(m.normalMap.value=v.normalMap,m.normalScale.value.copy(v.normalScale),v.side===Nr&&m.normalScale.value.negate()),v.displacementMap&&(m.displacementMap.value=v.displacementMap,m.displacementScale.value=v.displacementScale,m.displacementBias.value=v.displacementBias)}function h(m,v){v.gradientMap&&(m.gradientMap.value=v.gradientMap),v.emissiveMap&&(m.emissiveMap.value=v.emissiveMap),v.bumpMap&&(m.bumpMap.value=v.bumpMap,m.bumpScale.value=v.bumpScale,v.side===Nr&&(m.bumpScale.value*=-1)),v.normalMap&&(m.normalMap.value=v.normalMap,m.normalScale.value.copy(v.normalScale),v.side===Nr&&m.normalScale.value.negate()),v.displacementMap&&(m.displacementMap.value=v.displacementMap,m.displacementScale.value=v.displacementScale,m.displacementBias.value=v.displacementBias)}function g(m,v){m.roughness.value=v.roughness,m.metalness.value=v.metalness,v.roughnessMap&&(m.roughnessMap.value=v.roughnessMap),v.metalnessMap&&(m.metalnessMap.value=v.metalnessMap),v.emissiveMap&&(m.emissiveMap.value=v.emissiveMap),v.bumpMap&&(m.bumpMap.value=v.bumpMap,m.bumpScale.value=v.bumpScale,v.side===Nr&&(m.bumpScale.value*=-1)),v.normalMap&&(m.normalMap.value=v.normalMap,m.normalScale.value.copy(v.normalScale),v.side===Nr&&m.normalScale.value.negate()),v.displacementMap&&(m.displacementMap.value=v.displacementMap,m.displacementScale.value=v.displacementScale,m.displacementBias.value=v.displacementBias),n.get(v).envMap&&(m.envMapIntensity.value=v.envMapIntensity)}function p(m,v,y){g(m,v),m.ior.value=v.ior,v.sheen>0&&(m.sheenTint.value.copy(v.sheenTint).multiplyScalar(v.sheen),m.sheenRoughness.value=v.sheenRoughness),v.clearcoat>0&&(m.clearcoat.value=v.clearcoat,m.clearcoatRoughness.value=v.clearcoatRoughness,v.clearcoatMap&&(m.clearcoatMap.value=v.clearcoatMap),v.clearcoatRoughnessMap&&(m.clearcoatRoughnessMap.value=v.clearcoatRoughnessMap),v.clearcoatNormalMap&&(m.clearcoatNormalScale.value.copy(v.clearcoatNormalScale),m.clearcoatNormalMap.value=v.clearcoatNormalMap,v.side===Nr&&m.clearcoatNormalScale.value.negate())),v.transmission>0&&(m.transmission.value=v.transmission,m.transmissionSamplerMap.value=y.texture,m.transmissionSamplerSize.value.set(y.width,y.height),v.transmissionMap&&(m.transmissionMap.value=v.transmissionMap),m.thickness.value=v.thickness,v.thicknessMap&&(m.thicknessMap.value=v.thicknessMap),m.attenuationDistance.value=v.attenuationDistance,m.attenuationTint.value.copy(v.attenuationTint)),m.specularIntensity.value=v.specularIntensity,m.specularTint.value.copy(v.specularTint),v.specularIntensityMap&&(m.specularIntensityMap.value=v.specularIntensityMap),v.specularTintMap&&(m.specularTintMap.value=v.specularTintMap)}function u(m,v){v.matcap&&(m.matcap.value=v.matcap),v.bumpMap&&(m.bumpMap.value=v.bumpMap,m.bumpScale.value=v.bumpScale,v.side===Nr&&(m.bumpScale.value*=-1)),v.normalMap&&(m.normalMap.value=v.normalMap,m.normalScale.value.copy(v.normalScale),v.side===Nr&&m.normalScale.value.negate()),v.displacementMap&&(m.displacementMap.value=v.displacementMap,m.displacementScale.value=v.displacementScale,m.displacementBias.value=v.displacementBias)}function d(m,v){v.displacementMap&&(m.displacementMap.value=v.displacementMap,m.displacementScale.value=v.displacementScale,m.displacementBias.value=v.displacementBias)}function f(m,v){v.displacementMap&&(m.displacementMap.value=v.displacementMap,m.displacementScale.value=v.displacementScale,m.displacementBias.value=v.displacementBias),m.referencePosition.value.copy(v.referencePosition),m.nearDistance.value=v.nearDistance,m.farDistance.value=v.farDistance}function _(m,v){v.bumpMap&&(m.bumpMap.value=v.bumpMap,m.bumpScale.value=v.bumpScale,v.side===Nr&&(m.bumpScale.value*=-1)),v.normalMap&&(m.normalMap.value=v.normalMap,m.normalScale.value.copy(v.normalScale),v.side===Nr&&m.normalScale.value.negate()),v.displacementMap&&(m.displacementMap.value=v.displacementMap,m.displacementScale.value=v.displacementScale,m.displacementBias.value=v.displacementBias)}return{refreshFogUniforms:e,refreshMaterialUniforms:t}}function wk(){let n=Sd("canvas");return n.style.display="block",n}function Vd(n={}){let e=n.canvas!==void 0?n.canvas:wk(),t=n.context!==void 0?n.context:null,r=n.alpha!==void 0?n.alpha:!1,o=n.depth!==void 0?n.depth:!0,s=n.stencil!==void 0?n.stencil:!0,i=n.antialias!==void 0?n.antialias:!1,l=n.premultipliedAlpha!==void 0?n.premultipliedAlpha:!0,a=n.preserveDrawingBuffer!==void 0?n.preserveDrawingBuffer:!1,c=n.powerPreference!==void 0?n.powerPreference:"default",h=n.failIfMajorPerformanceCaveat!==void 0?n.failIfMajorPerformanceCaveat:!1,g=null,p=null,u=[],d=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=Pn,this.physicallyCorrectLights=!1,this.toneMapping=Lo,this.toneMappingExposure=1;let f=this,_=!1,m=0,v=0,y=null,b=-1,x=null,E=new kt,T=new kt,M=null,D=e.width,U=e.height,L=1,se=null,$=null,H=new kt(0,0,D,U),ae=new kt(0,0,D,U),ue=!1,me=[],Ue=new Ad,st=!1,ft=!1,Ze=null,gt=new vr,ce=new F,oe={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function yt(){return y===null?L:1}let X=t;function Tt(k,ye){for(let he=0;he<k.length;he++){let be=k[he],Ye=e.getContext(be,ye);if(Ye!==null)return Ye}return null}try{let k={alpha:r,depth:o,stencil:s,antialias:i,premultipliedAlpha:l,preserveDrawingBuffer:a,powerPreference:c,failIfMajorPerformanceCaveat:h};if(e.addEventListener("webglcontextlost",ne,!1),e.addEventListener("webglcontextrestored",Et,!1),X===null){let ye=["webgl2","webgl","experimental-webgl"];if(f.isWebGL1Renderer===!0&&ye.shift(),X=Tt(ye,k),X===null)throw Tt(ye)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}X.getShaderPrecisionFormat===void 0&&(X.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(k){throw console.error("THREE.WebGLRenderer: "+k.message),k}let At,Nt,Mt,Vt,Re,tt,ut,It,pt,V,B,Pe,lt,A,St,Ut,Dt,De,Le,Y,ot,Oe,bt;function Pt(){At=new Xx(X),Nt=new kx(X,At,n),At.init(Nt),Oe=new IC(X,At,Nt),Mt=new RC(X,At,Nt),me[0]=X.BACK,Vt=new Zx(X),Re=new CC,tt=new LC(X,At,Mt,Re,Nt,Oe,Vt),ut=new Gx(f),It=new Yx(f),pt=new sy(X,Nt),bt=new Dx(X,At,pt,Nt),V=new Jx(X,pt,Vt,bt),B=new tC(X,V,pt,Vt),Le=new eC(X,Nt,tt),Ut=new Fx(Re),Pe=new xC(f,ut,It,At,Nt,bt,Ut),lt=new DC(Re),A=new AC(Re),St=new SC(At,Nt),De=new Ix(f,ut,Mt,B,l),Dt=new wC(f,B,Nt),Y=new Bx(X,At,Vt,Nt),ot=new Kx(X,At,Vt,Nt),Vt.programs=Pe.programs,f.capabilities=Nt,f.extensions=At,f.properties=Re,f.renderLists=A,f.shadowMap=Dt,f.state=Mt,f.info=Vt}Pt();let Zt=new K1(f,X);this.xr=Zt,this.getContext=function(){return X},this.getContextAttributes=function(){return X.getContextAttributes()},this.forceContextLoss=function(){let k=At.get("WEBGL_lose_context");k&&k.loseContext()},this.forceContextRestore=function(){let k=At.get("WEBGL_lose_context");k&&k.restoreContext()},this.getPixelRatio=function(){return L},this.setPixelRatio=function(k){k!==void 0&&(L=k,this.setSize(D,U,!1))},this.getSize=function(k){return k.set(D,U)},this.setSize=function(k,ye,he){if(Zt.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}D=k,U=ye,e.width=Math.floor(k*L),e.height=Math.floor(ye*L),he!==!1&&(e.style.width=k+"px",e.style.height=ye+"px"),this.setViewport(0,0,k,ye)},this.getDrawingBufferSize=function(k){return k.set(D*L,U*L).floor()},this.setDrawingBufferSize=function(k,ye,he){D=k,U=ye,L=he,e.width=Math.floor(k*he),e.height=Math.floor(ye*he),this.setViewport(0,0,k,ye)},this.getCurrentViewport=function(k){return k.copy(E)},this.getViewport=function(k){return k.copy(H)},this.setViewport=function(k,ye,he,be){k.isVector4?H.set(k.x,k.y,k.z,k.w):H.set(k,ye,he,be),Mt.viewport(E.copy(H).multiplyScalar(L).floor())},this.getScissor=function(k){return k.copy(ae)},this.setScissor=function(k,ye,he,be){k.isVector4?ae.set(k.x,k.y,k.z,k.w):ae.set(k,ye,he,be),Mt.scissor(T.copy(ae).multiplyScalar(L).floor())},this.getScissorTest=function(){return ue},this.setScissorTest=function(k){Mt.setScissorTest(ue=k)},this.setOpaqueSort=function(k){se=k},this.setTransparentSort=function(k){$=k},this.getClearColor=function(k){return k.copy(De.getClearColor())},this.setClearColor=function(){De.setClearColor.apply(De,arguments)},this.getClearAlpha=function(){return De.getClearAlpha()},this.setClearAlpha=function(){De.setClearAlpha.apply(De,arguments)},this.clear=function(k,ye,he){let be=0;(k===void 0||k)&&(be|=X.COLOR_BUFFER_BIT),(ye===void 0||ye)&&(be|=X.DEPTH_BUFFER_BIT),(he===void 0||he)&&(be|=X.STENCIL_BUFFER_BIT),X.clear(be)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",ne,!1),e.removeEventListener("webglcontextrestored",Et,!1),A.dispose(),St.dispose(),Re.dispose(),ut.dispose(),It.dispose(),B.dispose(),bt.dispose(),Zt.dispose(),Zt.removeEventListener("sessionstart",A0),Zt.removeEventListener("sessionend",po),Ze&&(Ze.dispose(),Ze=null),Ln.stop()};function ne(k){k.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),_=!0}function Et(){console.log("THREE.WebGLRenderer: Context Restored."),_=!1;let k=Vt.autoReset,ye=Dt.enabled,he=Dt.autoUpdate,be=Dt.needsUpdate,Ye=Dt.type;Pt(),Vt.autoReset=k,Dt.enabled=ye,Dt.autoUpdate=he,Dt.needsUpdate=be,Dt.type=Ye}function Or(k){let ye=k.target;ye.removeEventListener("dispose",Or),cr(ye)}function cr(k){an(k),Re.remove(k)}function an(k){let ye=Re.get(k).programs;ye!==void 0&&ye.forEach(function(he){Pe.releaseProgram(he)})}function Vn(k,ye){k.render(function(he){f.renderBufferImmediate(he,ye)})}this.renderBufferImmediate=function(k,ye){bt.initAttributes();let he=Re.get(k);k.hasPositions&&!he.position&&(he.position=X.createBuffer()),k.hasNormals&&!he.normal&&(he.normal=X.createBuffer()),k.hasUvs&&!he.uv&&(he.uv=X.createBuffer()),k.hasColors&&!he.color&&(he.color=X.createBuffer());let be=ye.getAttributes();k.hasPositions&&(X.bindBuffer(X.ARRAY_BUFFER,he.position),X.bufferData(X.ARRAY_BUFFER,k.positionArray,X.DYNAMIC_DRAW),bt.enableAttribute(be.position.location),X.vertexAttribPointer(be.position.location,3,X.FLOAT,!1,0,0)),k.hasNormals&&(X.bindBuffer(X.ARRAY_BUFFER,he.normal),X.bufferData(X.ARRAY_BUFFER,k.normalArray,X.DYNAMIC_DRAW),bt.enableAttribute(be.normal.location),X.vertexAttribPointer(be.normal.location,3,X.FLOAT,!1,0,0)),k.hasUvs&&(X.bindBuffer(X.ARRAY_BUFFER,he.uv),X.bufferData(X.ARRAY_BUFFER,k.uvArray,X.DYNAMIC_DRAW),bt.enableAttribute(be.uv.location),X.vertexAttribPointer(be.uv.location,2,X.FLOAT,!1,0,0)),k.hasColors&&(X.bindBuffer(X.ARRAY_BUFFER,he.color),X.bufferData(X.ARRAY_BUFFER,k.colorArray,X.DYNAMIC_DRAW),bt.enableAttribute(be.color.location),X.vertexAttribPointer(be.color.location,3,X.FLOAT,!1,0,0)),bt.disableUnusedAttributes(),X.drawArrays(X.TRIANGLES,0,k.count),k.count=0},this.renderBufferDirect=function(k,ye,he,be,Ye,tr){ye===null&&(ye=oe);let qt=Ye.isMesh&&Ye.matrixWorld.determinant()<0,Wt=Bp(k,ye,he,be,Ye);Mt.setMaterial(be,qt);let pr=he.index,Mr=he.attributes.position;if(pr===null){if(Mr===void 0||Mr.count===0)return}else if(pr.count===0)return;let _r=1;be.wireframe===!0&&(pr=V.getWireframeAttribute(he),_r=2),bt.setup(Ye,be,Wt,he,pr);let br,Qr=Y;pr!==null&&(br=pt.get(pr),Qr=ot,Qr.setIndex(br));let Wi=pr!==null?pr.count:Mr.count,Cr=he.drawRange.start*_r,cs=he.drawRange.count*_r,Gr=tr!==null?tr.start*_r:0,$i=tr!==null?tr.count*_r:1/0,Yi=Math.max(Cr,Gr),Xi=Math.min(Wi,Cr+cs,Gr+$i)-1,Ti=Math.max(0,Xi-Yi+1);if(Ti!==0){if(Ye.isMesh)be.wireframe===!0?(Mt.setLineWidth(be.wireframeLinewidth*yt()),Qr.setMode(X.LINES)):Qr.setMode(X.TRIANGLES);else if(Ye.isLine){let en=be.linewidth;en===void 0&&(en=1),Mt.setLineWidth(en*yt()),Ye.isLineSegments?Qr.setMode(X.LINES):Ye.isLineLoop?Qr.setMode(X.LINE_LOOP):Qr.setMode(X.LINE_STRIP)}else Ye.isPoints?Qr.setMode(X.POINTS):Ye.isSprite&&Qr.setMode(X.TRIANGLES);if(Ye.isInstancedMesh)Qr.renderInstances(Yi,Ti,Ye.count);else if(he.isInstancedBufferGeometry){let en=Math.min(he.instanceCount,he._maxInstanceCount);Qr.renderInstances(Yi,Ti,en)}else Qr.render(Yi,Ti)}},this.compile=function(k,ye){p=St.get(k),p.init(),d.push(p),k.traverseVisible(function(he){he.isLight&&he.layers.test(ye.layers)&&(p.pushLight(he),he.castShadow&&p.pushShadow(he))}),p.setupLights(f.physicallyCorrectLights),k.traverse(function(he){let be=he.material;if(be)if(Array.isArray(be))for(let Ye=0;Ye<be.length;Ye++){let tr=be[Ye];Sc(tr,k,he)}else Sc(be,k,he)}),d.pop(),p=null};let Oo=null;function Ip(k){Oo&&Oo(k)}function A0(){Ln.stop()}function po(){Ln.start()}let Ln=new Id;Ln.setAnimationLoop(Ip),typeof window!="undefined"&&Ln.setContext(window),this.setAnimationLoop=function(k){Oo=k,Zt.setAnimationLoop(k),k===null?Ln.stop():Ln.start()},Zt.addEventListener("sessionstart",A0),Zt.addEventListener("sessionend",po),this.render=function(k,ye){if(ye!==void 0&&ye.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(_===!0)return;k.autoUpdate===!0&&k.updateMatrixWorld(),ye.parent===null&&ye.updateMatrixWorld(),Zt.enabled===!0&&Zt.isPresenting===!0&&(Zt.cameraAutoUpdate===!0&&Zt.updateCamera(ye),ye=Zt.getCamera()),k.isScene===!0&&k.onBeforeRender(f,k,ye,y),p=St.get(k,d.length),p.init(),d.push(p),gt.multiplyMatrices(ye.projectionMatrix,ye.matrixWorldInverse),Ue.setFromProjectionMatrix(gt),ft=this.localClippingEnabled,st=Ut.init(this.clippingPlanes,ft,ye),g=A.get(k,u.length),g.init(),u.push(g),ls(k,ye,0,f.sortObjects),g.finish(),f.sortObjects===!0&&g.sort(se,$),st===!0&&Ut.beginShadows();let he=p.state.shadowsArray;if(Dt.render(he,k,ye),st===!0&&Ut.endShadows(),this.info.autoReset===!0&&this.info.reset(),De.render(g,k),p.setupLights(f.physicallyCorrectLights),ye.isArrayCamera){let be=ye.cameras;for(let Ye=0,tr=be.length;Ye<tr;Ye++){let qt=be[Ye];Mn(g,k,qt,qt.viewport)}}else Mn(g,k,ye);y!==null&&(tt.updateMultisampleRenderTarget(y),tt.updateRenderTargetMipmap(y)),k.isScene===!0&&k.onAfterRender(f,k,ye),Mt.buffers.depth.setTest(!0),Mt.buffers.depth.setMask(!0),Mt.buffers.color.setMask(!0),Mt.setPolygonOffset(!1),bt.resetDefaultState(),b=-1,x=null,d.pop(),d.length>0?p=d[d.length-1]:p=null,u.pop(),u.length>0?g=u[u.length-1]:g=null};function ls(k,ye,he,be){if(k.visible===!1)return;if(k.layers.test(ye.layers)){if(k.isGroup)he=k.renderOrder;else if(k.isLOD)k.autoUpdate===!0&&k.update(ye);else if(k.isLight)p.pushLight(k),k.castShadow&&p.pushShadow(k);else if(k.isSprite){if(!k.frustumCulled||Ue.intersectsSprite(k)){be&&ce.setFromMatrixPosition(k.matrixWorld).applyMatrix4(gt);let qt=B.update(k),Wt=k.material;Wt.visible&&g.push(k,qt,Wt,he,ce.z,null)}}else if(k.isImmediateRenderObject)be&&ce.setFromMatrixPosition(k.matrixWorld).applyMatrix4(gt),g.push(k,null,k.material,he,ce.z,null);else if((k.isMesh||k.isLine||k.isPoints)&&(k.isSkinnedMesh&&k.skeleton.frame!==Vt.render.frame&&(k.skeleton.update(),k.skeleton.frame=Vt.render.frame),!k.frustumCulled||Ue.intersectsObject(k))){be&&ce.setFromMatrixPosition(k.matrixWorld).applyMatrix4(gt);let qt=B.update(k),Wt=k.material;if(Array.isArray(Wt)){let pr=qt.groups;for(let Mr=0,_r=pr.length;Mr<_r;Mr++){let br=pr[Mr],Qr=Wt[br.materialIndex];Qr&&Qr.visible&&g.push(k,qt,Qr,he,ce.z,br)}}else Wt.visible&&g.push(k,qt,Wt,he,ce.z,null)}}let tr=k.children;for(let qt=0,Wt=tr.length;qt<Wt;qt++)ls(tr[qt],ye,he,be)}function Mn(k,ye,he,be){let Ye=k.opaque,tr=k.transmissive,qt=k.transparent;p.setupLightsView(he),tr.length>0&&xh(Ye,ye,he),be&&Mt.viewport(E.copy(be)),Ye.length>0&&Oa(Ye,ye,he),tr.length>0&&Oa(tr,ye,he),qt.length>0&&Oa(qt,ye,he)}function xh(k,ye,he){if(Ze===null){let qt=i===!0&&Nt.isWebGL2===!0?V0:Yn;Ze=new qt(1024,1024,{generateMipmaps:!0,type:Oe.convert(jo)!==null?jo:oi,minFilter:R0,magFilter:Ur,wrapS:rn,wrapT:rn})}let be=f.getRenderTarget();f.setRenderTarget(Ze),f.clear();let Ye=f.toneMapping;f.toneMapping=Lo,Oa(k,ye,he),f.toneMapping=Ye,tt.updateMultisampleRenderTarget(Ze),tt.updateRenderTargetMipmap(Ze),f.setRenderTarget(be)}function Oa(k,ye,he){let be=ye.isScene===!0?ye.overrideMaterial:null;for(let Ye=0,tr=k.length;Ye<tr;Ye++){let qt=k[Ye],Wt=qt.object,pr=qt.geometry,Mr=be===null?qt.material:be,_r=qt.group;Wt.layers.test(he.layers)&&Ch(Wt,ye,he,pr,Mr,_r)}}function Ch(k,ye,he,be,Ye,tr){if(k.onBeforeRender(f,ye,he,be,Ye,tr),k.modelViewMatrix.multiplyMatrices(he.matrixWorldInverse,k.matrixWorld),k.normalMatrix.getNormalMatrix(k.modelViewMatrix),Ye.onBeforeRender(f,ye,he,be,k,tr),k.isImmediateRenderObject){let qt=Bp(he,ye,be,Ye,k);Mt.setMaterial(Ye),bt.reset(),Vn(k,qt)}else Ye.transparent===!0&&Ye.side===Ho?(Ye.side=Nr,Ye.needsUpdate=!0,f.renderBufferDirect(he,ye,be,Ye,k,tr),Ye.side=eo,Ye.needsUpdate=!0,f.renderBufferDirect(he,ye,be,Ye,k,tr),Ye.side=Ho):f.renderBufferDirect(he,ye,be,Ye,k,tr);k.onAfterRender(f,ye,he,be,Ye,tr)}function Sc(k,ye,he){ye.isScene!==!0&&(ye=oe);let be=Re.get(k),Ye=p.state.lights,tr=p.state.shadowsArray,qt=Ye.state.version,Wt=Pe.getParameters(k,Ye.state,tr,ye,he),pr=Pe.getProgramCacheKey(Wt),Mr=be.programs;be.environment=k.isMeshStandardMaterial?ye.environment:null,be.fog=ye.fog,be.envMap=(k.isMeshStandardMaterial?It:ut).get(k.envMap||be.environment),Mr===void 0&&(k.addEventListener("dispose",Or),Mr=new Map,be.programs=Mr);let _r=Mr.get(pr);if(_r!==void 0){if(be.currentProgram===_r&&be.lightsStateVersion===qt)return Dp(k,Wt),_r}else Wt.uniforms=Pe.getUniforms(k),k.onBuild(Wt,f),k.onBeforeCompile(Wt,f),_r=Pe.acquireProgram(Wt,pr),Mr.set(pr,_r),be.uniforms=Wt.uniforms;let br=be.uniforms;(!k.isShaderMaterial&&!k.isRawShaderMaterial||k.clipping===!0)&&(br.clippingPlanes=Ut.uniform),Dp(k,Wt),be.needsLights=Eh(k),be.lightsStateVersion=qt,be.needsLights&&(br.ambientLightColor.value=Ye.state.ambient,br.lightProbe.value=Ye.state.probe,br.directionalLights.value=Ye.state.directional,br.directionalLightShadows.value=Ye.state.directionalShadow,br.spotLights.value=Ye.state.spot,br.spotLightShadows.value=Ye.state.spotShadow,br.rectAreaLights.value=Ye.state.rectArea,br.ltc_1.value=Ye.state.rectAreaLTC1,br.ltc_2.value=Ye.state.rectAreaLTC2,br.pointLights.value=Ye.state.point,br.pointLightShadows.value=Ye.state.pointShadow,br.hemisphereLights.value=Ye.state.hemi,br.directionalShadowMap.value=Ye.state.directionalShadowMap,br.directionalShadowMatrix.value=Ye.state.directionalShadowMatrix,br.spotShadowMap.value=Ye.state.spotShadowMap,br.spotShadowMatrix.value=Ye.state.spotShadowMatrix,br.pointShadowMap.value=Ye.state.pointShadowMap,br.pointShadowMatrix.value=Ye.state.pointShadowMatrix);let Qr=_r.getUniforms(),Wi=Li.seqWithValue(Qr.seq,br);return be.currentProgram=_r,be.uniformsList=Wi,_r}function Dp(k,ye){let he=Re.get(k);he.outputEncoding=ye.outputEncoding,he.instancing=ye.instancing,he.skinning=ye.skinning,he.morphTargets=ye.morphTargets,he.morphNormals=ye.morphNormals,he.morphTargetsCount=ye.morphTargetsCount,he.numClippingPlanes=ye.numClippingPlanes,he.numIntersection=ye.numClipIntersection,he.vertexAlphas=ye.vertexAlphas,he.vertexTangents=ye.vertexTangents}function Bp(k,ye,he,be,Ye){ye.isScene!==!0&&(ye=oe),tt.resetTextureUnits();let tr=ye.fog,qt=be.isMeshStandardMaterial?ye.environment:null,Wt=y===null?f.outputEncoding:y.texture.encoding,pr=(be.isMeshStandardMaterial?It:ut).get(be.envMap||qt),Mr=be.vertexColors===!0&&!!he&&!!he.attributes.color&&he.attributes.color.itemSize===4,_r=!!be.normalMap&&!!he&&!!he.attributes.tangent,br=!!he&&!!he.morphAttributes.position,Qr=!!he&&!!he.morphAttributes.normal,Wi=!!he&&!!he.morphAttributes.position?he.morphAttributes.position.length:0,Cr=Re.get(be),cs=p.state.lights;if(st===!0&&(ft===!0||k!==x)){let wo=k===x&&be.id===b;Ut.setState(be,k,wo)}let Gr=!1;be.version===Cr.__version?(Cr.needsLights&&Cr.lightsStateVersion!==cs.state.version||Cr.outputEncoding!==Wt||Ye.isInstancedMesh&&Cr.instancing===!1||!Ye.isInstancedMesh&&Cr.instancing===!0||Ye.isSkinnedMesh&&Cr.skinning===!1||!Ye.isSkinnedMesh&&Cr.skinning===!0||Cr.envMap!==pr||be.fog&&Cr.fog!==tr||Cr.numClippingPlanes!==void 0&&(Cr.numClippingPlanes!==Ut.numPlanes||Cr.numIntersection!==Ut.numIntersection)||Cr.vertexAlphas!==Mr||Cr.vertexTangents!==_r||Cr.morphTargets!==br||Cr.morphNormals!==Qr||Nt.isWebGL2===!0&&Cr.morphTargetsCount!==Wi)&&(Gr=!0):(Gr=!0,Cr.__version=be.version);let $i=Cr.currentProgram;Gr===!0&&($i=Sc(be,ye,Ye));let Yi=!1,Xi=!1,Ti=!1,en=$i.getUniforms(),us=Cr.uniforms;if(Mt.useProgram($i.program)&&(Yi=!0,Xi=!0,Ti=!0),be.id!==b&&(b=be.id,Xi=!0),Yi||x!==k){if(en.setValue(X,"projectionMatrix",k.projectionMatrix),Nt.logarithmicDepthBuffer&&en.setValue(X,"logDepthBufFC",2/(Math.log(k.far+1)/Math.LN2)),x!==k&&(x=k,Xi=!0,Ti=!0),be.isShaderMaterial||be.isMeshPhongMaterial||be.isMeshToonMaterial||be.isMeshStandardMaterial||be.envMap){let wo=en.map.cameraPosition;wo!==void 0&&wo.setValue(X,ce.setFromMatrixPosition(k.matrixWorld))}(be.isMeshPhongMaterial||be.isMeshToonMaterial||be.isMeshLambertMaterial||be.isMeshBasicMaterial||be.isMeshStandardMaterial||be.isShaderMaterial)&&en.setValue(X,"isOrthographic",k.isOrthographicCamera===!0),(be.isMeshPhongMaterial||be.isMeshToonMaterial||be.isMeshLambertMaterial||be.isMeshBasicMaterial||be.isMeshStandardMaterial||be.isShaderMaterial||be.isShadowMaterial||Ye.isSkinnedMesh)&&en.setValue(X,"viewMatrix",k.matrixWorldInverse)}if(Ye.isSkinnedMesh){en.setOptional(X,Ye,"bindMatrix"),en.setOptional(X,Ye,"bindMatrixInverse");let wo=Ye.skeleton;wo&&(Nt.floatVertexTextures?(wo.boneTexture===null&&wo.computeBoneTexture(),en.setValue(X,"boneTexture",wo.boneTexture,tt),en.setValue(X,"boneTextureSize",wo.boneTextureSize)):en.setOptional(X,wo,"boneMatrices"))}return!!he&&(he.morphAttributes.position!==void 0||he.morphAttributes.normal!==void 0)&&Le.update(Ye,he,be,$i),(Xi||Cr.receiveShadow!==Ye.receiveShadow)&&(Cr.receiveShadow=Ye.receiveShadow,en.setValue(X,"receiveShadow",Ye.receiveShadow)),Xi&&(en.setValue(X,"toneMappingExposure",f.toneMappingExposure),Cr.needsLights&&Th(us,Ti),tr&&be.fog&&lt.refreshFogUniforms(us,tr),lt.refreshMaterialUniforms(us,be,L,U,Ze),Li.upload(X,Cr.uniformsList,us,tt)),be.isShaderMaterial&&be.uniformsNeedUpdate===!0&&(Li.upload(X,Cr.uniformsList,us,tt),be.uniformsNeedUpdate=!1),be.isSpriteMaterial&&en.setValue(X,"center",Ye.center),en.setValue(X,"modelViewMatrix",Ye.modelViewMatrix),en.setValue(X,"normalMatrix",Ye.normalMatrix),en.setValue(X,"modelMatrix",Ye.matrixWorld),$i}function Th(k,ye){k.ambientLightColor.needsUpdate=ye,k.lightProbe.needsUpdate=ye,k.directionalLights.needsUpdate=ye,k.directionalLightShadows.needsUpdate=ye,k.pointLights.needsUpdate=ye,k.pointLightShadows.needsUpdate=ye,k.spotLights.needsUpdate=ye,k.spotLightShadows.needsUpdate=ye,k.rectAreaLights.needsUpdate=ye,k.hemisphereLights.needsUpdate=ye}function Eh(k){return k.isMeshLambertMaterial||k.isMeshToonMaterial||k.isMeshPhongMaterial||k.isMeshStandardMaterial||k.isShadowMaterial||k.isShaderMaterial&&k.lights===!0}this.getActiveCubeFace=function(){return m},this.getActiveMipmapLevel=function(){return v},this.getRenderTarget=function(){return y},this.setRenderTarget=function(k,ye=0,he=0){y=k,m=ye,v=he,k&&Re.get(k).__webglFramebuffer===void 0&&tt.setupRenderTarget(k);let be=null,Ye=!1,tr=!1;if(k){let Wt=k.texture;(Wt.isDataTexture3D||Wt.isDataTexture2DArray)&&(tr=!0);let pr=Re.get(k).__webglFramebuffer;k.isWebGLCubeRenderTarget?(be=pr[ye],Ye=!0):k.isWebGLMultisampleRenderTarget?be=Re.get(k).__webglMultisampledFramebuffer:be=pr,E.copy(k.viewport),T.copy(k.scissor),M=k.scissorTest}else E.copy(H).multiplyScalar(L).floor(),T.copy(ae).multiplyScalar(L).floor(),M=ue;if(Mt.bindFramebuffer(X.FRAMEBUFFER,be)&&Nt.drawBuffers){let Wt=!1;if(k)if(k.isWebGLMultipleRenderTargets){let pr=k.texture;if(me.length!==pr.length||me[0]!==X.COLOR_ATTACHMENT0){for(let Mr=0,_r=pr.length;Mr<_r;Mr++)me[Mr]=X.COLOR_ATTACHMENT0+Mr;me.length=pr.length,Wt=!0}}else(me.length!==1||me[0]!==X.COLOR_ATTACHMENT0)&&(me[0]=X.COLOR_ATTACHMENT0,me.length=1,Wt=!0);else(me.length!==1||me[0]!==X.BACK)&&(me[0]=X.BACK,me.length=1,Wt=!0);Wt&&(Nt.isWebGL2?X.drawBuffers(me):At.get("WEBGL_draw_buffers").drawBuffersWEBGL(me))}if(Mt.viewport(E),Mt.scissor(T),Mt.setScissorTest(M),Ye){let Wt=Re.get(k.texture);X.framebufferTexture2D(X.FRAMEBUFFER,X.COLOR_ATTACHMENT0,X.TEXTURE_CUBE_MAP_POSITIVE_X+ye,Wt.__webglTexture,he)}else if(tr){let Wt=Re.get(k.texture),pr=ye||0;X.framebufferTextureLayer(X.FRAMEBUFFER,X.COLOR_ATTACHMENT0,Wt.__webglTexture,he||0,pr)}b=-1},this.readRenderTargetPixels=function(k,ye,he,be,Ye,tr,qt){if(!(k&&k.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Wt=Re.get(k).__webglFramebuffer;if(k.isWebGLCubeRenderTarget&&qt!==void 0&&(Wt=Wt[qt]),Wt){Mt.bindFramebuffer(X.FRAMEBUFFER,Wt);try{let pr=k.texture,Mr=pr.format,_r=pr.type;if(Mr!==nn&&Oe.convert(Mr)!==X.getParameter(X.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}let br=_r===jo&&(At.has("EXT_color_buffer_half_float")||Nt.isWebGL2&&At.has("EXT_color_buffer_float"));if(_r!==oi&&Oe.convert(_r)!==X.getParameter(X.IMPLEMENTATION_COLOR_READ_TYPE)&&!(_r===ho&&(Nt.isWebGL2||At.has("OES_texture_float")||At.has("WEBGL_color_buffer_float")))&&!br){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}X.checkFramebufferStatus(X.FRAMEBUFFER)===X.FRAMEBUFFER_COMPLETE?ye>=0&&ye<=k.width-be&&he>=0&&he<=k.height-Ye&&X.readPixels(ye,he,be,Ye,Oe.convert(Mr),Oe.convert(_r),tr):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{let pr=y!==null?Re.get(y).__webglFramebuffer:null;Mt.bindFramebuffer(X.FRAMEBUFFER,pr)}}},this.copyFramebufferToTexture=function(k,ye,he=0){let be=Math.pow(2,-he),Ye=Math.floor(ye.image.width*be),tr=Math.floor(ye.image.height*be),qt=Oe.convert(ye.format);Nt.isWebGL2&&(qt===X.RGB&&(qt=X.RGB8),qt===X.RGBA&&(qt=X.RGBA8)),tt.setTexture2D(ye,0),X.copyTexImage2D(X.TEXTURE_2D,he,qt,k.x,k.y,Ye,tr,0),Mt.unbindTexture()},this.copyTextureToTexture=function(k,ye,he,be=0){let Ye=ye.image.width,tr=ye.image.height,qt=Oe.convert(he.format),Wt=Oe.convert(he.type);tt.setTexture2D(he,0),X.pixelStorei(X.UNPACK_FLIP_Y_WEBGL,he.flipY),X.pixelStorei(X.UNPACK_PREMULTIPLY_ALPHA_WEBGL,he.premultiplyAlpha),X.pixelStorei(X.UNPACK_ALIGNMENT,he.unpackAlignment),ye.isDataTexture?X.texSubImage2D(X.TEXTURE_2D,be,k.x,k.y,Ye,tr,qt,Wt,ye.image.data):ye.isCompressedTexture?X.compressedTexSubImage2D(X.TEXTURE_2D,be,k.x,k.y,ye.mipmaps[0].width,ye.mipmaps[0].height,qt,ye.mipmaps[0].data):X.texSubImage2D(X.TEXTURE_2D,be,k.x,k.y,qt,Wt,ye.image),be===0&&he.generateMipmaps&&X.generateMipmap(X.TEXTURE_2D),Mt.unbindTexture()},this.copyTextureToTexture3D=function(k,ye,he,be,Ye=0){if(f.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}let tr=k.max.x-k.min.x+1,qt=k.max.y-k.min.y+1,Wt=k.max.z-k.min.z+1,pr=Oe.convert(be.format),Mr=Oe.convert(be.type),_r;if(be.isDataTexture3D)tt.setTexture3D(be,0),_r=X.TEXTURE_3D;else if(be.isDataTexture2DArray)tt.setTexture2DArray(be,0),_r=X.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}X.pixelStorei(X.UNPACK_FLIP_Y_WEBGL,be.flipY),X.pixelStorei(X.UNPACK_PREMULTIPLY_ALPHA_WEBGL,be.premultiplyAlpha),X.pixelStorei(X.UNPACK_ALIGNMENT,be.unpackAlignment);let br=X.getParameter(X.UNPACK_ROW_LENGTH),Qr=X.getParameter(X.UNPACK_IMAGE_HEIGHT),Wi=X.getParameter(X.UNPACK_SKIP_PIXELS),Cr=X.getParameter(X.UNPACK_SKIP_ROWS),cs=X.getParameter(X.UNPACK_SKIP_IMAGES),Gr=he.isCompressedTexture?he.mipmaps[0]:he.image;X.pixelStorei(X.UNPACK_ROW_LENGTH,Gr.width),X.pixelStorei(X.UNPACK_IMAGE_HEIGHT,Gr.height),X.pixelStorei(X.UNPACK_SKIP_PIXELS,k.min.x),X.pixelStorei(X.UNPACK_SKIP_ROWS,k.min.y),X.pixelStorei(X.UNPACK_SKIP_IMAGES,k.min.z),he.isDataTexture||he.isDataTexture3D?X.texSubImage3D(_r,Ye,ye.x,ye.y,ye.z,tr,qt,Wt,pr,Mr,Gr.data):he.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),X.compressedTexSubImage3D(_r,Ye,ye.x,ye.y,ye.z,tr,qt,Wt,pr,Gr.data)):X.texSubImage3D(_r,Ye,ye.x,ye.y,ye.z,tr,qt,Wt,pr,Mr,Gr),X.pixelStorei(X.UNPACK_ROW_LENGTH,br),X.pixelStorei(X.UNPACK_IMAGE_HEIGHT,Qr),X.pixelStorei(X.UNPACK_SKIP_PIXELS,Wi),X.pixelStorei(X.UNPACK_SKIP_ROWS,Cr),X.pixelStorei(X.UNPACK_SKIP_IMAGES,cs),Ye===0&&be.generateMipmaps&&X.generateMipmap(_r),Mt.unbindTexture()},this.initTexture=function(k){tt.setTexture2D(k,0),Mt.unbindTexture()},this.resetState=function(){m=0,v=0,y=null,Mt.reset(),bt.reset()},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}var BC={};var Z1=class{constructor(){this._next_renderer_id=0,this._renderers=new Map,this._firstRenderer=null,this._printDebug=!1,this._require_webgl2=!1,this._resolves=[]}setPrintDebug(e=!0){this._printDebug=e}printDebug(){return this._printDebug}printDebugMessage(e){!this._printDebug||console.warn("[Poly debug]",e)}setRequireWebGL2(){this._require_webgl2||(this._require_webgl2=!0)}webgl2Available(){return this._webgl2_available===void 0&&(this._webgl2_available=this._set_webgl2_available()),this._webgl2_available}_set_webgl2_available(){let e=document.createElement("canvas");return(window.WebGL2RenderingContext&&e.getContext("webgl2"))!=null}createWebGLRenderer(e){let t=new Vd(e);return this.printDebugMessage(["create renderer:",e]),t}getRenderingContext(e){let t=null;return this._require_webgl2&&(t=this._getRenderingContextWebgl(e,!0),t||console.warn("failed to create webgl2 context")),t||(t=this._getRenderingContextWebgl(e,!1)),t}_getRenderingContextWebgl(e,t){let r;this.webgl2Available()?r="webgl2":r=t?"webgl2":"webgl";let o=e.getContext(r,BC);return o?this.printDebugMessage(`create gl context: ${r}.`):(r=t?"experimental-webgl2":"experimental-webgl",this.printDebugMessage(`create gl context: ${r}.`),o=e.getContext(r,BC)),o}registerRenderer(e){if(e._polygonId)throw new Error("render already registered");let t=this._next_renderer_id+=1;e._polygonId=t,this._renderers.set(t,e),this._renderers.size==1&&this._flushCallbacksWithRenderer(e),this._updateCache()}deregisterRenderer(e){let t=e._polygonId;this._renderers.delete(t),e.dispose(),this._updateCache()}deregisterAllRenderers(){let e=[];this._renderers.forEach((t,r)=>{e.push(t)});for(let t of e)this.deregisterRenderer(t)}_updateCache(){this._firstRenderer=null,this._renderers.forEach(e=>{this._firstRenderer=this._firstRenderer||e})}firstRenderer(){return this._firstRenderer}renderers(){return Object.values(this._renderers)}_flushCallbacksWithRenderer(e){let t=[];for(let r of this._resolves)t.push(r);this._resolves=[];for(let r of t)r(e)}async waitForRenderer(){let e=this.firstRenderer();return e||new Promise((t,r)=>{this._resolves.push(t)})}renderTarget(e,t,r){return this.webgl2Available()?new V0(e,t,r):new Yn(e,t,r)}};var Q1=class{constructor(){this._root="/three/js/libs",this._BASISPath="/basis",this._DRACOPath="/draco",this._DRACOGLTFPath="/draco/gltf"}root(){return this._root}setRoot(e){this._root=e}BASISPath(){return this._BASISPath}DRACOPath(){return this._DRACOPath}DRACOGLTFPath(){return this._DRACOGLTFPath}};var ii=class{constructor(e){this.poly=e,this._node_register=new Map,this._node_register_categories=new Map,this._node_register_options=new Map}static type(e){return this.filterType(e.type())}static filterType(e){return e.toLowerCase()}register(e,t,r){let o=e.context(),s=ii.type(e),i=this._node_register.get(o);if(i||(i=new Map,this._node_register.set(o,i)),i.get(s)){console.error(`node ${o}/${s} already registered`);return}if(i.set(s,e),t){let a=this._node_register_categories.get(o);a||(a=new Map,this._node_register_categories.set(o,a)),a.set(s,t)}if(r){let a=this._node_register_options.get(o);a||(a=new Map,this._node_register_options.set(o,a)),a.set(s,r)}this.poly.pluginsRegister.registerNode(e)}deregister(e,t){var r,o,s;t=ii.filterType(t),(r=this._node_register.get(e))==null||r.delete(t),(o=this._node_register_categories.get(e))==null||o.delete(t),(s=this._node_register_options.get(e))==null||s.delete(t)}isRegistered(e,t){let r=this._node_register.get(e);return r?(t=ii.filterType(t),r.get(t)!=null):!1}nodeOptions(e,t){var r;return t=ii.filterType(t),(r=this._node_register_options.get(e))==null?void 0:r.get(t)}registeredNodesForContextAndParentType(e,t){var r;if(this._node_register.get(e)){let s=[];return(r=this._node_register.get(e))==null||r.forEach((i,l)=>{s.push(i)}),s.filter(i=>{var l;let a=ii.type(i),c=(l=this._node_register_options.get(e))==null?void 0:l.get(a);if(c){let h=c.only,g=c.except,p=`${e}/${t}`;return h?h.includes(p):g?!g.includes(p):!0}else return!0})}else return[]}registeredNodes(e,t){let r={},o=this.registeredNodesForContextAndParentType(e,t);for(let s of o){let i=ii.type(s);r[i]=s}return r}registeredCategory(e,t){var r;return t=ii.filterType(t),(r=this._node_register_categories.get(e))==null?void 0:r.get(t)}map(){return this._node_register}},yl=class{constructor(e){this.poly=e,this._operation_register=new Map}static type(e){return this.filterType(e.type())}static filterType(e){return e.toLowerCase()}register(e){let t=e.context(),r=this._operation_register.get(t);r||(r=new Map,this._operation_register.set(t,r));let o=yl.type(e);if(r.get(o)){let i=`operation ${t}/${o} already registered`;console.error(i);return}r.set(o,e),this.poly.pluginsRegister.registerOperation(e)}registeredOperationsForContextAndParentType(e,t){var r;if(this._operation_register.get(e)){let s=[];return(r=this._operation_register.get(e))==null||r.forEach((i,l)=>{s.push(i)}),s}else return[]}registeredOperation(e,t){let r=this._operation_register.get(e);if(r)return t=yl.filterType(t),r.get(t)}};var e_=class{constructor(){this._methods_names=[],this._methods_by_name=new Map}register(e,t){this._methods_names.push(t),this._methods_by_name.set(t,e)}getMethod(e){return this._methods_by_name.get(e)}availableMethods(){return this._methods_names}};var t_=class extends e_{getMethod(e){return super.getMethod(e)}};var r_=class{constructor(){this._module_by_name=new Map}register(e,t){this._module_by_name.set(e,t)}moduleNames(){let e=[];return this._module_by_name.forEach((t,r)=>{e.push(r)}),e}module(e){return this._module_by_name.get(e)}};var n_=class extends r_{};var ou=(n=>(n.GL_MESH_BASIC="GL_MESH_BASIC",n.GL_MESH_LAMBERT="GL_MESH_LAMBERT",n.GL_MESH_STANDARD="GL_MESH_STANDARD",n.GL_MESH_PHONG="GL_MESH_PHONG",n.GL_MESH_PHYSICAL="GL_MESH_PHYSICAL",n.GL_PARTICLES="GL_PARTICLES",n.GL_POINTS="GL_POINTS",n.GL_LINE="GL_LINE",n.GL_TEXTURE="GL_TEXTURE",n.GL_VOLUME="GL_VOLUME",n))(ou||{}),o_=class{constructor(){this._controller_assembler_by_name=new Map}register(e,t,r){this._controller_assembler_by_name.set(e,{controller:t,assembler:r})}unregister(e){this._controller_assembler_by_name.delete(e)}};var i_=class extends o_{assembler(e,t){let r=this._controller_assembler_by_name.get(t);if(r){let o=r.controller,s=r.assembler;return new o(e,s)}return r}unregister(e){let t=this._controller_assembler_by_name.get(e);return super.unregister(e),t}};var s_=class{constructor(e){this.poly=e,this._plugins_by_name=new Map,this._plugin_name_by_node_context_by_type=new Map,this._plugin_name_by_operation_context_by_type=new Map}register(e){this._current_plugin=e,this._plugins_by_name.set(e.name(),e),e.init(this.poly),this._current_plugin=void 0}pluginByName(e){return this._plugins_by_name.get(e)}registerNode(e){if(!this._current_plugin)return;let t=e.context(),r=e.type(),o=this._plugin_name_by_node_context_by_type.get(t);o||(o=new Map,this._plugin_name_by_node_context_by_type.set(t,o)),o.set(r,this._current_plugin.name())}registerOperation(e){if(!this._current_plugin)return;let t=e.context(),r=e.type(),o=this._plugin_name_by_operation_context_by_type.get(t);o||(o=new Map,this._plugin_name_by_operation_context_by_type.set(t,o)),o.set(r,this._current_plugin.name())}toJson(){let e={plugins:{},nodes:{},operations:{}};return this._plugins_by_name.forEach((t,r)=>{e.plugins[r]=t.toJSON()}),this._plugin_name_by_node_context_by_type.forEach((t,r)=>{e.nodes[r]={},t.forEach((o,s)=>{e.nodes[r][s]=o})}),this._plugin_name_by_operation_context_by_type.forEach((t,r)=>{e.operations[r]={},t.forEach((o,s)=>{e.operations[r][s]=o})}),e}};var a_=class{constructor(e){this._camera_types=[]}register(e){let t=e.type();this._camera_types.includes(t)||this._camera_types.push(t)}registeredTypes(){return this._camera_types}};function kC(n){return(window.URL||window.webkitURL).createObjectURL(n)}var Ir=class{static arrayFromValues(e){let t=[];return e.forEach(r=>{t.push(r)}),t}static pushOnArrayAtEntry(e,t,r){e.has(t)?e.get(t).push(r):e.set(t,[r])}static addToSetAtEntry(e,t,r){if(e.has(t))e.get(t).add(r);else{let s=new Set;s.add(r),e.set(t,s)}}static popFromArrayAtEntry(e,t,r){if(e.has(t)){let s=e.get(t),i=s.indexOf(r);i>=0&&s.splice(i,1)}}static removeFromSetAtEntry(e,t,r){if(e.has(t)){let s=e.get(t);s.delete(r),s.size==0&&e.delete(t)}}static unshiftOnArrayAtEntry(e,t,r){e.has(t)?e.get(t).unshift(r):e.set(t,[r])}static concatOnArrayAtEntry(e,t,r){if(e.has(t)){let s=e.get(t);for(let i of r)s.push(i)}else e.set(t,r)}static async forEachSync(e,t){let r=[],o=[];e.forEach((s,i)=>{r.push(s),o.push(i)});for(let s=0;s<r.length;s++){let i=o[s],l=r[s];await t(l,i)}}};var l_=class{constructor(){this._blobUrlsByStoredUrl=new Map,this._blobsByStoredUrl=new Map,this._blobDataByNodeId=new Map,this._globalBlobsByStoredUrl=new Map}registerBlobUrl(e){!Fe.playerMode()||this._blobUrlsByStoredUrl.set(e.storedUrl,e.blobUrl)}deregisterUrl(e){this._blobUrlsByStoredUrl.delete(e)}blobUrl(e){return this._blobUrlsByStoredUrl.get(e)}clear(){this._blobUrlsByStoredUrl.clear(),this._blobsByStoredUrl.clear(),this._blobDataByNodeId.clear(),this._globalBlobsByStoredUrl.clear()}_clearBlobForNode(e){let t=this._blobDataByNodeId.get(e.graphNodeId());if(t){let r=t[0];r&&(this._blobsByStoredUrl.delete(r.storedUrl),this._blobUrlsByStoredUrl.delete(r.storedUrl))}this._blobDataByNodeId.delete(e.graphNodeId())}_assignBlobToNode(e,t,r={}){r.multiAssetsForNode!=!0&&this._clearBlobForNode(e),Ir.pushOnArrayAtEntry(this._blobDataByNodeId,e.graphNodeId(),{storedUrl:t.storedUrl,fullUrl:t.fullUrl})}async fetchBlobGlobal(e){if(Fe.playerMode())return{};try{if(this._blobUrlsByStoredUrl.get(e.storedUrl))return{};let r=Fe.assetUrls.remapedUrl(e.fullUrl),o=await fetch(r||e.fullUrl);if(o.ok){let s=await o.blob();return this._blobsByStoredUrl.set(e.storedUrl,s),this._blobUrlsByStoredUrl.set(e.storedUrl,this.createBlobUrl(s)),this._globalBlobsByStoredUrl.set(e.storedUrl,s),{blobData:{storedUrl:e.storedUrl,fullUrl:e.fullUrl}}}else return{error:`failed to fetch ${e.fullUrl}`}}catch{return{error:`failed to fetch ${e.fullUrl}`}}}async fetchBlobForNode(e){if(Fe.playerMode())return{};try{if(this._blobUrlsByStoredUrl.get(e.storedUrl))return{};let r=Fe.assetUrls.remapedUrl(e.fullUrl),o=await fetch(r||e.fullUrl);if(o.ok){let s=await o.blob();return this._blobsByStoredUrl.set(e.storedUrl,s),this._blobUrlsByStoredUrl.set(e.storedUrl,this.createBlobUrl(s)),this._scene=e.node.scene(),this._assignBlobToNode(e.node,{storedUrl:e.storedUrl,fullUrl:e.fullUrl},{multiAssetsForNode:e.multiAssetsForNode}),{blobData:{storedUrl:e.storedUrl,fullUrl:e.fullUrl}}}else return{error:`failed to fetch ${e.fullUrl}`}}catch{return{error:`failed to fetch ${e.fullUrl}`}}}forEachBlob(e){this._blobDataByNodeId.forEach((o,s)=>{if(this._scene&&this._scene.graph.nodeFromId(s))for(let l of o){let{storedUrl:a}=l,c=this._blobsByStoredUrl.get(a);c&&e(c,l)}});let t=[],r=new Map;this._globalBlobsByStoredUrl.forEach((o,s)=>{t.push(s),r.set(s,o)}),t=t.sort(),t.forEach(o=>{let s=this._globalBlobsByStoredUrl.get(o);s&&e(s,{storedUrl:o})})}createBlobUrl(e){return kC(e)}assetsManifestWithBlobsMap(){let e={},t=new Map,r=[],o=[],s=[];Fe.blobs.forEachBlob((i,l)=>{r.push(i);let a=l.fullUrl;a&&o.push(a),s.push(l.storedUrl)});for(let i=0;i<r.length;i++){let l=s[i],a=r[i],c=l.split("?")[0],h=l.split("."),g=h[h.length-1],p=`${i}.${g}`,u=`assets/${p}`;t.set(u,a),e[c]=p}return{manifest:e,blobsMap:t,fullUrls:o,storedUrls:s}}};var c_=class{setMap(e){this._map=e}remapedUrl(e){if(!this._map)return;let t=e.split("?"),r=t[0],o=t[1],s=this._map[r];if(s)return o?`${s}?${o}`:s}};var u_=class{static fadeOut(e){return new Promise(t=>{let r=setInterval(()=>{e.style.opacity||(e.style.opacity="1");let o=parseFloat(e.style.opacity);o>0?e.style.opacity=`${o-.05}`:(t(),clearInterval(r))},20)})}};var p_=class{markAsLoaded(e,t){this._sceneJsonImporterContructor=t,e()}load(e){if(!this._sceneJsonImporterContructor)return;let t=[];e.forEach((r,o)=>{t.push(o)});for(let r of t){let o=e.get(r);o&&(this._loadElement(r,o,this._sceneJsonImporterContructor),e.delete(r))}}async _loadElement(e,t,r){let{sceneData:o,assetsManifest:s,unzippedData:i}=t,l=Object.keys(s);for(let p of l){let u=s[p],d=i[`assets/${u}`];if(!d){console.error(p,d);return}let f=new Blob([d]),_=Fe.blobs.createBlobUrl(f),m={storedUrl:p,blobUrl:_};Fe.blobs.registerBlobUrl(m)}Fe.setPlayerMode(!0),Fe.libs.setRoot(null);let a=`${Math.random()}`.replace(".","_"),c={Poly:`___POLY_polyConfig_configurePolygonjs_${a}`,scriptElementId:`___POLY_polyConfig_scriptElement_${a}`,loadSceneArgs:`___POLY_polyConfig_loadSceneArgs_${a}`};window[c.Poly]=Fe;let g={method:this._loadScene.bind(this),element:e,sceneData:o,sceneJsonImporterContructor:r};window[c.loadSceneArgs]=g,this._loadScene(e,o,r)}async _loadScene(e,t,r,o){this._fadeOutPoster(e);let i=await new r(t).scene();o&&o(i);let l=i.mainCameraNode();if(!l){console.warn("no main camera found");return}let a=l.createViewer({element:e});i.play(),e.scene=i,e.viewer=a}_fadeOutPoster(e){let t=e.firstElementChild;t&&(t.style.pointerEvents="none",u_.fadeOut(t).then(()=>{var r;(r=t.parentElement)==null||r.removeChild(t)}))}};var d_=class{setPerformanceManager(e){this._performanceManager=e}performanceManager(){return this._performanceManager||window.performance}};var zd=class{constructor(){this.renderersController=new Z1,this.nodesRegister=new ii(this),this.operationsRegister=new yl(this),this.expressionsRegister=new t_,this.modulesRegister=new n_,this.assemblersRegister=new i_,this.pluginsRegister=new s_(this),this.camerasRegister=new a_(this),this.blobs=new l_,this.assetUrls=new c_,this.selfContainedScenesLoader=new p_,this.performance=new d_,this.scenesByUuid={},this._player_mode=!0,this._logger=null}static _instance_(){if(window.__POLYGONJS_POLY_INSTANCE__)return window.__POLYGONJS_POLY_INSTANCE__;{let e=new zd;return window.__POLYGONJS_POLY_INSTANCE__=e,window.__POLYGONJS_POLY_INSTANCE__}}setPlayerMode(e){this._player_mode=e}playerMode(){return this._player_mode}registerNode(e,t,r){this.nodesRegister.register(e,t,r)}registerOperation(e){this.operationsRegister.register(e)}registerCamera(e){this.camerasRegister.register(e)}registerPlugin(e){this.pluginsRegister.register(e)}registeredNodes(e,t){return this.nodesRegister.registeredNodes(e,t)}registeredOperation(e,t){return this.operationsRegister.registeredOperation(e,t)}registeredCameraTypes(){return this.camerasRegister.registeredTypes()}registerModule(e){this.modulesRegister.register(e.moduleName,e.module)}inWorkerThread(){return!1}get libs(){return this._libs_controller=this._libs_controller||new Q1}setEnv(e){this._env=e}env(){return this._env}setLogger(e){this._logger=e}log(e,...t){var r;(r=this._logger)==null||r.log(e,...t)}warn(e,...t){var r;(r=this._logger)==null||r.warn(e,...t)}error(e,...t){var r;(r=this._logger)==null||r.error(e,...t)}},Fe=zd._instance_();var f_=class{constructor(e){this.node=e,this._dirtyCount=0,this._dirty=!0}dispose(){this._cachedSuccessors=void 0,this._postDirtyHooks=void 0,this._postDirtyHookNames=void 0}isDirty(){return this._dirty===!0}dirtyTimestamp(){return this._dirtyTimestamp}dirtyCount(){return this._dirtyCount}addPostDirtyHook(e,t){this._postDirtyHookNames=this._postDirtyHookNames||[],this._postDirtyHooks=this._postDirtyHooks||[],this._postDirtyHookNames.includes(e)?console.warn(`hook with name ${e} already exists`,this.node):(this._postDirtyHookNames.push(e),this._postDirtyHooks.push(t))}removePostDirtyHook(e){if(this._postDirtyHookNames&&this._postDirtyHooks){let t=this._postDirtyHookNames.indexOf(e);t>=0&&(this._postDirtyHookNames.splice(t,1),this._postDirtyHooks.splice(t,1))}}hasHook(e){return this._postDirtyHookNames?this._postDirtyHookNames.includes(e):!1}removeDirtyState(){this._dirty=!1}setForbiddenTriggerNodes(e){this._forbiddenTriggerNodeIds?this._forbiddenTriggerNodeIds.clear():this._forbiddenTriggerNodeIds=new Set;for(let t of e)this._forbiddenTriggerNodeIds.add(t.graphNodeId()),t.dirtyController.clearSuccessorsCacheWithPredecessors()}isForbiddenTriggerNodeId(e){return this._forbiddenTriggerNodeIds!=null&&this._forbiddenTriggerNodeIds.has(e)}setDirty(e,t){t==null&&(t=!0),!(e&&this.isForbiddenTriggerNodeId(e.graphNodeId()))&&(e==null&&(e=this.node),this._dirty=!0,this._dirtyTimestamp=Fe.performance.performanceManager().now(),this._dirtyCount+=1,this.runPostDirtyHooks(e),t===!0&&this.setSuccessorsDirty(e))}runPostDirtyHooks(e){if(!this._postDirtyHooks)return;let t=this.node.scene().cooker;if(t.blocked())t.enqueue(this.node,e);else for(let r of this._postDirtyHooks)r(e)}setSuccessorsDirty(e){let t=!1;this._cachedSuccessors=this._cachedSuccessors||this.node.graphAllSuccessors();for(let r of this._cachedSuccessors)r.dirtyController.setDirty(e,t)}clearSuccessorsCache(){this._cachedSuccessors=void 0}clearSuccessorsCacheWithPredecessors(){this.clearSuccessorsCache();for(let e of this.node.graphAllPredecessors())e.dirtyController.clearSuccessorsCache()}};var zr=class{constructor(e,t){this._scene=e,this._name=t,this._dirtyController=new f_(this),this._graphNodeId=e.graph.nextId(),e.graph.addNode(this),this._graph=e.graph}dispose(){this._dirtyController.dispose(),this.graphRemove()}name(){return this._name}setName(e){this._name=e}scene(){return this._scene}graphNodeId(){return this._graphNodeId}get dirtyController(){return this._dirtyController}setDirty(e){e=e||this,this._dirtyController.setDirty(e)}setSuccessorsDirty(e){this._dirtyController.setSuccessorsDirty(e)}removeDirtyState(){this._dirtyController.removeDirtyState()}isDirty(){return this._dirtyController.isDirty()}addPostDirtyHook(e,t){this._dirtyController.addPostDirtyHook(e,t)}removePostDirtyHook(e){this._dirtyController.removePostDirtyHook(e)}graphRemove(){this._graph.removeNode(this)}addGraphInput(e,t=!0){return this._graph.connect(e,this,t)}removeGraphInput(e){this._graph.disconnect(e,this)}graphDisconnectPredecessors(){this._graph.disconnectPredecessors(this)}graphDisconnectSuccessors(){this._graph.disconnectSuccessors(this)}graphPredecessorIds(){return this._graph.predecessorIds(this._graphNodeId)||[]}graphPredecessors(){return this._graph.predecessors(this)}graphSuccessors(){return this._graph.successors(this)}graphAllPredecessors(){return this._graph.allPredecessors(this)}graphAllSuccessors(){return this._graph.allSuccessors(this)}};var z0=(n=>(n.MAX_FRAME_UPDATED="scene_maxFrameUpdated",n.REALTIME_STATUS_UPDATED="scene_realtime_status_updated",n.FRAME_UPDATED="scene_frame_updated",n.PLAY_STATE_UPDATED="scene_play_state_updated",n))(z0||{});var Hd=class extends Event{constructor(e){super(e)}get type(){return super.type}},FC={event:new Hd("sceneLoaded")},GC={event:new Hd("play")},UC={event:new Hd("pause")},m_=class{constructor(){this._observersByEventType=new Map}dispatch(e){let t=e.event;if(!t)return;let r=this._observersByEventType.get(t.type);!r||r.forEach(o=>{o.processEvent(e)})}removeObserverFromAllEventTypes(e){this._observersByEventType.forEach((t,r)=>{t.delete(e)})}addObserver(e,t){Ir.addToSetAtEntry(this._observersByEventType,t,e)}};var VC=60,iu=class{constructor(n){this.scene=n,this._frame=0,this._time=0,this._realtimeState=!0,this._maxFrame=600,this._maxFrameLocked=!1,this._playing=!1,this._delta=0,this._onBeforeTickCallbacks=[],this._onAfterTickCallbacks=[],this._graphNode=new zr(n,"timeController")}get graphNode(){return this._graphNode}frame(){return this._frame}time(){return this._time}maxFrame(){return this._maxFrame}maxFrameLocked(){return this._maxFrameLocked}realtimeState(){return this._realtimeState}setMaxFrame(n){this._maxFrame=Math.floor(n),this.scene.dispatchController.dispatch(this._graphNode,z0.MAX_FRAME_UPDATED)}setMaxFrameLocked(n){this._maxFrameLocked=n,this.scene.dispatchController.dispatch(this._graphNode,z0.MAX_FRAME_UPDATED)}setRealtimeState(n){this._realtimeState=n,this.scene.dispatchController.dispatch(this._graphNode,z0.REALTIME_STATUS_UPDATED)}setTime(n,e=!0){if(n==this._time)return;this._time=n,this.scene.cooker.block();let t=this._delta;for(let r of this._onBeforeTickCallbacks)r(t);if(e){let r=Math.floor(this._time*VC),o=this._ensureFrameWithinBounds(r);r!=o?this.setFrame(o,!0):this._frame=r}this.scene.dispatchController.dispatch(this._graphNode,z0.FRAME_UPDATED),this.scene.uniformsController.updateTimeDependentUniformOwners(),this.graphNode.setSuccessorsDirty(),this.scene.cooker.unblock();for(let r of this._onAfterTickCallbacks)r(t)}setFrame(n,e=!0){n!=this._frame&&(n=this._ensureFrameWithinBounds(n),n!=this._frame&&(this._frame=n,e&&this.setTime(this._frame/VC,!1)))}setFrameToStart(){this.setFrame(iu.START_FRAME,!0)}incrementTimeIfPlaying(n){this._playing&&(this.scene.root().areChildrenCooking()||this.incrementTime(n))}incrementTime(n){if(this._realtimeState){this._delta=n;let e=this._time+this._delta;this.setTime(e,!1),this.setFrame(this._frame+1,!1)}else this.setFrame(this.frame()+1)}_ensureFrameWithinBounds(n){if(this._playing){if(this._maxFrameLocked&&n>this._maxFrame)return iu.START_FRAME}else{if(this._maxFrameLocked&&n>this._maxFrame)return this._maxFrame;if(n<iu.START_FRAME)return iu.START_FRAME}return n}playing(){return this._playing===!0}pause(){this._playing!=!1&&(this._playing=!1,this.scene.dispatchController.dispatch(this._graphNode,z0.PLAY_STATE_UPDATED),this.scene.eventsDispatcher.sceneEventsController.dispatch(UC))}play(){this._playing!=!0&&(this._playing=!0,this.scene.dispatchController.dispatch(this._graphNode,z0.PLAY_STATE_UPDATED),this.scene.eventsDispatcher.sceneEventsController.dispatch(GC))}togglePlayPause(){this.playing()?this.pause():this.play()}registerOnBeforeTick(n,e){this._registerCallback(n,e,this.registeredBeforeTickCallbacks())}unRegisterOnBeforeTick(n){this._unregisterCallback(n,this._onBeforeTickCallbacksMap)}registeredBeforeTickCallbacks(){return this._onBeforeTickCallbacksMap=this._onBeforeTickCallbacksMap||new Map}registerOnAfterTick(n,e){this._registerCallback(n,e,this.registeredAfterTickCallbacks())}unRegisterOnAfterTick(n){this._unregisterCallback(n,this._onAfterTickCallbacksMap)}registeredAfterTickCallbacks(){return this._onAfterTickCallbacksMap=this._onAfterTickCallbacksMap||new Map}_registerCallback(n,e,t){if(t.has(n)){console.warn(`callback ${n} already registered`);return}t.set(n,e),this._updateCallbacks()}_unregisterCallback(n,e){!e||(e.delete(n),this._updateCallbacks())}_updateCallbacks(){var n,e;this._onBeforeTickCallbacks=[],(n=this._onBeforeTickCallbacksMap)==null||n.forEach(t=>{this._onBeforeTickCallbacks.push(t)}),this._onAfterTickCallbacks=[],(e=this._onAfterTickCallbacksMap)==null||e.forEach(t=>{this._onAfterTickCallbacks.push(t)})}},H0=iu;H0.START_FRAME=0;var h_=class{constructor(e){this.scene=e,this._mainCameraNodePath=null}setMainCameraNodePath(e){this._mainCameraNodePath=e}mainCameraNodePath(){return this._mainCameraNodePath}mainCameraNode(){if(this.mainCameraNodePath){let e=this.mainCameraNodePath();return e?this.scene.node(e):this._findAnyCamera()}else return console.warn("main cameraNode not found"),this._findAnyCamera()}_findAnyCamera(){let e=this.scene.root();return e.nodesByType("perspectiveCamera")[0]||e.nodesByType("orthographicCamera")[0]}};var __=class{constructor(e){this._scene=e,this._queue=new Map,this._blockLevel=0,this._blockLevel=0}block(){this._blockLevel+=1}unblock(){this._blockLevel-=1,this._blockLevel<0&&(this._blockLevel=0),this.process_queue()}blocked(){return this._blockLevel>0}enqueue(e,t){this._queue.set(e.graphNodeId(),t)}process_queue(){if(this.blocked())return;let e=[],t=[];this._queue.forEach((r,o)=>{e.push(r),t.push(o)}),this._queue.clear();for(let r=0;r<e.length;r++){let o=e[r],s=t[r];this._processItem(o,s)}}_processItem(e,t){let r=this._scene.graph.nodeFromId(t);r&&r.dirtyController.runPostDirtyHooks(e)}};var g_=class{constructor(){this._cooking_nodes_by_id=new Map,this._resolves=[]}addNode(e){this._cooking_nodes_by_id.set(e.graphNodeId(),e)}removeNode(e){this._cooking_nodes_by_id.delete(e.graphNodeId()),this._cooking_nodes_by_id.size==0&&this.flush()}cookingNodes(){let e=[];return this._cooking_nodes_by_id.forEach((t,r)=>{e.push(t)}),e}flush(){let e;for(;e=this._resolves.pop();)e()}async waitForCooksCompleted(){if(this._cooking_nodes_by_id.size!=0)return new Promise((e,t)=>{this._resolves.push(e)})}};var si=class{static toArray(e){let t=[];return e.forEach(r=>{t.push(r)}),t}static union(e,t){let r=new Set;return e.forEach(o=>r.add(o)),t.forEach(o=>r.add(o)),r}static intersection(e,t){let r=new Set;return e.forEach(o=>{t.has(o)&&r.add(o)}),t.forEach(o=>{e.has(o)&&r.add(o)}),r}static difference(e,t){let r=new Set;return e.forEach(o=>{t.has(o)||r.add(o)}),t.forEach(o=>{e.has(o)||r.add(o)}),r}};var v_=class{constructor(){this._next_id=0,this._successors=new Map,this._predecessors=new Map,this._nodes_by_id=new Map,this._nodesCount=0,this._debugging=!1,this._addedNodesDuringDebugging=new Map,this._boundPredecessorIds=this.predecessorIds.bind(this),this._boundSuccessorIds=this.successorIds.bind(this)}startDebugging(){this._debugging=!0}stopDebugging(){this._debugging=!1}printDebug(){this._addedNodesDuringDebugging.forEach((e,t)=>{console.log(t,e,e.graphPredecessors(),e.graphSuccessors())})}setScene(e){this._scene=e}scene(){return this._scene}nextId(){return this._next_id+=1,this._next_id}nodesFromIds(e){let t=[];for(let r of e){let o=this.nodeFromId(r);o&&t.push(o)}return t}nodeFromId(e){return this._nodes_by_id.get(e)}hasNode(e){return this._nodes_by_id.get(e.graphNodeId())!=null}addNode(e){this._nodes_by_id.set(e.graphNodeId(),e),this._nodesCount+=1,this._debugging&&this._addedNodesDuringDebugging.set(e.graphNodeId(),e)}removeNode(e){this._nodes_by_id.delete(e.graphNodeId()),this._successors.delete(e.graphNodeId()),this._predecessors.delete(e.graphNodeId()),this._nodesCount-=1,this._debugging&&this._addedNodesDuringDebugging.delete(e.graphNodeId())}nodesCount(){return this._nodesCount}connect(e,t,r=!0){let o=e.graphNodeId(),s=t.graphNodeId();if(this.hasNode(e)&&this.hasNode(t)){r&&(r=!(this._scene?this._scene.loadingController.isLoading():!0));let i=!1;return r&&(i=this._hasPredecessor(o,s)),i?!1:(this._createConnection(o,s),e.dirtyController.clearSuccessorsCacheWithPredecessors(),!0)}else return console.warn(`attempt to connect non existing node ${o} or ${s}`),!1}disconnect(e,t){this._remove_connection(e.graphNodeId(),t.graphNodeId()),e.dirtyController.clearSuccessorsCacheWithPredecessors()}disconnectPredecessors(e){let t=this.predecessors(e);for(let r of t)this.disconnect(r,e)}disconnectSuccessors(e){let t=this.successors(e);for(let r of t)this.disconnect(e,r)}predecessorIds(e){let t=this._predecessors.get(e);if(t){let r=[];return t.forEach((o,s)=>{r.push(s)}),r}return[]}predecessors(e){let t=this.predecessorIds(e.graphNodeId());return this.nodesFromIds(t)}successorIds(e){let t=this._successors.get(e);if(t){let r=[];return t.forEach((o,s)=>{r.push(s)}),r}return[]}successors(e){let t=this.successorIds(e.graphNodeId())||[];return this.nodesFromIds(t)}allPredecessorIds(e){let t=this._boundPredecessorIds,r=new Set,o=t(e.graphNodeId());for(;o.length>0;){let s=[];for(let i of o){r.add(i);for(let l of t(i))s.push(l)}o=s}return si.toArray(r)}allSuccessorIds(e){let t=this._boundSuccessorIds,r=new Set,o=t(e.graphNodeId());for(;o.length>0;){let s=[];for(let i of o){let l=this.nodeFromId(i);if(l&&!l.dirtyController.isForbiddenTriggerNodeId(e.graphNodeId())){r.add(i);for(let a of t(i))s.push(a)}}o=s}return si.toArray(r)}allPredecessors(e){let t=this.allPredecessorIds(e);return this.nodesFromIds(t)}allSuccessors(e){let t=this.allSuccessorIds(e);return this.nodesFromIds(t)}_createConnection(e,t){let r=this._successors.get(e);if(r||(r=new Set,this._successors.set(e,r)),r.has(t))return;r.add(t);let o=this._predecessors.get(t);o||(o=new Set,this._predecessors.set(t,o)),o.add(e)}_remove_connection(e,t){let r=this._successors.get(e);r&&(r.delete(t),r.size==0&&this._successors.delete(e));let o=this._predecessors.get(t);o&&(o.delete(e),o.size==0&&this._predecessors.delete(t))}_hasPredecessor(e,t){let r=this.predecessorIds(e);if(r){if(r.includes(t))return!0;for(let o of r)return this._hasPredecessor(o,t)}return!1}};var y_=class{constructor(e){this._node=e,this._cooks_count=0,this._total_cook_time=0,this._total_inputs_time=0,this._total_params_time=0}update_cook_data(e){this._cooks_count+=1,this._total_cook_time+=e.cookTime,this._total_inputs_time+=e.inputsTime,this._total_params_time+=e.paramsTime}total_time(){return this._total_cook_time+this._total_inputs_time+this._total_params_time}total_cook_time(){return this._total_cook_time}cook_time_per_iteration(){return this._cooks_count>0?this._total_cook_time/this._cooks_count:0}total_inputs_time(){return this._total_inputs_time}inputs_time_per_iteration(){return this._cooks_count>0?this._total_inputs_time/this._cooks_count:0}total_params_time2(){return this._total_params_time}params_time_per_iteration2(){return this._cooks_count>0?this._total_params_time/this._cooks_count:0}cooks_count(){return this._cooks_count}print_object(){return{fullPath:this._node.path(),cooks_count:this.cooks_count(),total_time:this.total_time(),total_cook_time:this.total_cook_time(),cook_time_per_iteration:this.cook_time_per_iteration(),inputs_time_per_iteration:this.inputs_time_per_iteration(),params_time_per_iteration:this.params_time_per_iteration2()}}};var xe=class{static isNumber(e){return typeof e=="number"}static isVector(e){return e instanceof re||e instanceof F||e instanceof kt}static isQuaternion(e){return e instanceof ao}static isString(e){return typeof e=="string"}static isBoolean(e){return e===!0||e===!1}static isNaN(e){return isNaN(e)}static isArray(e){return Array.isArray(e)}static isObject(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}};function Ie(n){return n}var lr=class{static shallowClone(e){return[...e]}static min(e){let t=e[0];for(let r of e)r<t&&(t=r);return t}static max(e){let t=e[0];for(let r of e)r>t&&(t=r);return t}static sum(e){let t=0;for(let r of e)t+=r;return t}static compact(e){let t=[];for(let r of e)r!=null&&t.push(r);return t}static uniq(e){let t=new Set;for(let s of e)t.add(s);let r=new Array(t.size),o=0;return t.forEach(s=>{r[o]=s,o++}),r}static chunk(e,t){let r=[],o=[];r.push(o);for(let s=0;s<e.length;s++)o.length==t&&(o=[],r.push(o)),o.push(e[s]);return r}static union(e,t){let r=[];return si.union(this.toSet(e),this.toSet(t)).forEach(s=>r.push(s)),r}static intersection(e,t){let r=[];return si.intersection(this.toSet(e),this.toSet(t)).forEach(s=>r.push(s)),r}static difference(e,t){let r=[];return si.difference(this.toSet(e),this.toSet(t)).forEach(s=>r.push(s)),r}static toSet(e){let t=new Set;for(let r of e)t.add(r);return t}static isEqual(e,t){if(e.length!=t.length)return!1;let r=e.length;for(let o=0;o<r;o++)if(e[o]!=t[o])return!1;return!0}static sortBy(e,t){if(e.length==0)return[];let r=new Map,o=new Set;for(let a of e){let c=t(a);o.add(c),Ir.pushOnArrayAtEntry(r,c,a)}let s=new Array(o.size),i=0;o.forEach(a=>{s[i]=a,i++}),xe.isString(s[0])?s.sort():s.sort((a,c)=>a-c);let l=new Array(e.length);i=0;for(let a of s){let c=r.get(a);if(c)for(let h of c)l[i]=h,i++}return l}static range(e,t,r=1){t==null&&(t=e,e=0);let o=Math.floor((t-e)/r),s=new Array(o);for(let i=0;i<s.length;i++)s[i]=e+i*r;return s}};var UM=Zi(j_()),VM=Zi(q_()),wn=class{static isEqual(e,t){if(xe.isObject(e)&&xe.isObject(t)){let r=Object.keys(e),o=Object.keys(t);return lr.isEqual(r,o)?JSON.stringify(e)==JSON.stringify(t):!1}return!1}static merge(e,t){return Object.assign(e,t)}static clone(e){return(0,VM.default)(e)}static cloneDeep(e){return(0,UM.default)(e)}};var W_=class{constructor(){this._started=!1,this._start_time=0,this._previous_timestamp=0,this._nodes_cook_data={},this._durations_by_name={},this._durations_count_by_name={}}profile(e,t){let r=Fe.performance.performanceManager(),o=r.now();t();let s=r.now()-o;console.log(`${e}: ${s}`)}start(){if(!this._started){this.reset(),this._started=!0;let e=Fe.performance.performanceManager();this._start_time=e.now(),this._nodes_cook_data={},this._previous_timestamp=this._start_time}}stop(){this.reset()}reset(){this._started=!1,this._start_time=null,this._durations_by_name={},this._durations_count_by_name={},this._nodes_cook_data={}}started(){return this._started}recordNodeCookData(e,t){let r=e.graphNodeId();this._nodes_cook_data[r]==null&&(this._nodes_cook_data[r]=new y_(e)),this._nodes_cook_data[r].update_cook_data(t)}record(e){this.started()||this.start();let t=performance.now();return this._durations_by_name[e]==null&&(this._durations_by_name[e]=0),this._durations_by_name[e]+=t-this._previous_timestamp,this._durations_count_by_name[e]==null&&(this._durations_count_by_name[e]=0),this._durations_count_by_name[e]+=1,this._previous_timestamp=t}print(){this.print_node_cook_data(),this.print_recordings()}print_node_cook_data(){let e=Object.values(this._nodes_cook_data);e=lr.sortBy(e,s=>s.total_cook_time());let t=e.map(s=>s.print_object());console.log("--------------- NODES COOK TIME -----------");let r=[],o=lr.sortBy(t,s=>-s.total_cook_time);for(let s of o)r.push(s);return console.table(r),t}print_recordings(){let e=wn.clone(this._durations_by_name),t=wn.clone(this._durations_count_by_name),r=[],o={};for(let l of Object.keys(e)){let a=e[l];r.push(a),o[a]==null&&(o[a]=[]),o[a].push(l)}r.sort((l,a)=>l-a);let s=lr.uniq(r);console.log("--------------- PERF RECORDINGS -----------");let i=[];for(let l of s){let a=o[l];for(let c of a){let h=t[c],g=l/h,p={duration:l,name:c,count:h,duration_per_iteration:g};i.push(p)}}return console.table(i),i}};var $_=class{constructor(e){this.scene=e}setListener(e){this._eventsListener?console.warn("scene already has a listener"):(this._eventsListener=e,this._runOnAddListenerCallbacks())}onAddListener(e){this._eventsListener?e():(this._onAddListenerCallbacks=this._onAddListenerCallbacks||[],this._onAddListenerCallbacks.push(e))}_runOnAddListenerCallbacks(){if(this._onAddListenerCallbacks){let e;for(;e=this._onAddListenerCallbacks.pop();)e();this._onAddListenerCallbacks=void 0}}dispatch(e,t,r){var o;(o=this._eventsListener)==null||o.process_events(e,t,r)}emitAllowed(){return this._eventsListener!=null&&this.scene.loadingController.loaded()&&this.scene.loadingController.autoUpdating()}};var Y_=class{constructor(){this._params_by_id=new Map}registerParam(e){this._params_by_id.set(e.graphNodeId(),e)}deregisterParam(e){this._params_by_id.delete(e.graphNodeId())}regenerateReferringExpressions(e){e.nameController.graph_node.setSuccessorsDirty(e)}};var X_=class{constructor(e){this.scene=e,this._lifecycleOnAfterCreatedAllowed=!0}onAfterCreatedCallbackAllowed(){return this.scene.loadingController.loaded()&&this._lifecycleOnAfterCreatedAllowed}onAfterCreatedPrevent(e){this._lifecycleOnAfterCreatedAllowed=!1,e(),this._lifecycleOnAfterCreatedAllowed=!0}};var J_=class{constructor(e){this.scene=e,this._loadingState=!1,this._autoUpdating=!0}markAsLoading(){this._setLoadingState(!0)}async markAsLoaded(){this.scene.missingExpressionReferencesController.resolveMissingReferences(),await this._setLoadingState(!1),this._triggerLoadedEvent()}_triggerLoadedEvent(){globalThis.Event&&this.scene.eventsDispatcher.sceneEventsController.dispatch(FC)}async _setLoadingState(e){this._loadingState=e,await this.setAutoUpdate(!this._loadingState)}isLoading(){return this._loadingState}loaded(){return!this._loadingState}autoUpdating(){return this._autoUpdating}async setAutoUpdate(e){if(this._autoUpdating!==e&&(this._autoUpdating=e,this._autoUpdating)){let t=this.scene.root();t&&await t.processQueue()}}};var li=class{constructor(e=""){this._path=e,this._node=null}set_path(e){this._path=e}set_node(e){this._node=e}path(){return this._path}node(){return this._node}resolve(e){this._node=hr.findNode(e,this._path)}clone(){let e=new li(this._path);return e.set_node(this._node),e}nodeWithContext(e,t){let r=this.node();if(!r){t==null||t.set(`no node found at ${this.path()}`);return}let o=r.context();if(o==e)return r;t==null||t.set(`expected ${e} node, but got a ${o}`)}},Is=class{constructor(e=""){this._path=e,this._param=null}set_path(e){this._path=e}set_param(e){this._param=e}path(){return this._path}param(){return this._param}resolve(e){this._param=hr.findParam(e,this._path)}clone(){let e=new Is(this._path);return e.set_param(this._param),e}paramWithType(e,t){let r=this.param();if(!r){t==null||t.set(`no param found at ${this.path()}`);return}if(r.type()==e)return r;t==null||t.set(`expected ${e} node, but got a ${r.type()}`)}},Fr=class{static splitParentChild(n){let e=n.split(Fr.SEPARATOR).filter(o=>o.length>0),t=e.pop();return{parent:e.join(Fr.SEPARATOR),child:t}}static findNode(n,e,t){if(!n)return null;let r=e.split(Fr.SEPARATOR).filter(i=>i.length>0),o=r[0],s=null;if(e[0]===Fr.SEPARATOR){let i=e.substr(1);s=this.findNode(n.root(),i,t)}else{switch(o){case Fr.PARENT:t==null||t.add_path_element(o),s=n.parent();break;case Fr.CURRENT:t==null||t.add_path_element(o),s=n;break;default:s=n.node(o),s&&(t==null||t.add_node(o,s))}if(s!=null&&r.length>1){let i=r.slice(1).join(Fr.SEPARATOR);s=this.findNode(s,i,t)}return s}return s}static findParam(n,e,t){if(!n)return null;let r=e.split(Fr.SEPARATOR);if(r.length===1)return n.params.get(r[0]);{let o=r.slice(0,+(r.length-2)+1||void 0).join(Fr.SEPARATOR),s=this.findNode(n,o,t);if(s!=null){let i=r[r.length-1],l=s.params.get(i);return t&&l&&t.add_node(i,l),l}else return null}}static relativePath(n,e){let t=this.closestCommonParent(n,e);if(t){let r=this.distanceToParent(n,t),o="";if(r>0){let h=0,g=[];for(;h++<r;)g.push(Fr.PARENT);o=g.join(Fr.SEPARATOR)+Fr.SEPARATOR}let s=t.path().split(Fr.SEPARATOR).filter(h=>h.length>0),i=e.path().split(Fr.SEPARATOR).filter(h=>h.length>0),l=[],a=0;for(let h of i)s[a]||l.push(h),a++;let c=l.join(Fr.SEPARATOR);return`${o}${c}`}else return e.path()}static closestCommonParent(n,e){let t=this.parents(n).reverse().concat([n]),r=this.parents(e).reverse().concat([e]),o=Math.min(t.length,r.length),s=null;for(let i=0;i<o;i++)t[i].graphNodeId()==r[i].graphNodeId()&&(s=t[i]);return s}static parents(n){let e=[],t=n.parent();for(;t;)e.push(t),t=t.parent();return e}static distanceToParent(n,e){let t=0,r=n,o=e.graphNodeId();for(;r&&r.graphNodeId()!=o;)t+=1,r=r.parent();return r&&r.graphNodeId()==o?t:-1}static makeAbsolutePath(n,e){if(e[0]==Fr.SEPARATOR)return e;let t=e.split(Fr.SEPARATOR),r=t.shift();if(r)switch(r){case"..":{let o=n.parent();return o?o==n.scene().root()?Fr.SEPARATOR+t.join(Fr.SEPARATOR):this.makeAbsolutePath(o,t.join(Fr.SEPARATOR)):null}case".":return this.makeAbsolutePath(n,t.join(Fr.SEPARATOR));default:return[n.path(),e].join(Fr.SEPARATOR)}else return n.path()}},hr=Fr;hr.SEPARATOR="/";hr.DOT=".";hr.CURRENT=Fr.DOT;hr.PARENT="..";hr.CURRENT_WITH_SLASH=`${Fr.CURRENT}/`;hr.PARENT_WITH_SLASH=`${Fr.PARENT}/`;hr.NON_LETTER_PREFIXES=[Fr.SEPARATOR,Fr.DOT];var K_=class{constructor(e,t){this.param=e,this.path=t}absolutePath(){return hr.makeAbsolutePath(this.param.node,this.path)}matchesPath(e){return this.absolutePath()==e}resolveMissingDependencies(){let e=this.param.rawInputSerialized();this.param.set(this.param.defaultValue()),this.param.set(e)}};var Z_=class{constructor(e){this.scene=e,this.references=new Map}register(e,t){let r=new K_(e,t);return Ir.addToSetAtEntry(this.references,e.graphNodeId(),r),r}deregisterParam(e){this.references.delete(e.graphNodeId())}resolveMissingReferences(){let e=[];this.references.forEach(t=>{for(let r of t)this._isReferenceResolvable(r)&&e.push(r)});for(let t of e)t.resolveMissingDependencies()}_isReferenceResolvable(e){let t=e.absolutePath();if(t){if(this.scene.node(t))return!0;{let o=hr.splitParentChild(t);if(o.child){let s=this.scene.node(o.parent);if(s&&s.params.get(o.child))return!0}}}}checkForMissingReferences(e){this._checkForMissingReferencesForNode(e);for(let t of e.params.all)this._checkForMissingReferencesForParam(t)}_checkForMissingReferencesForNode(e){let t=e.graphNodeId(),r=Ir.arrayFromValues(this.references);for(let o of r){let s=!1,i=si.toArray(o);for(let l of i)l.matchesPath(e.path())&&(s=!0,l.resolveMissingDependencies());s&&this.references.delete(t)}}_checkForMissingReferencesForParam(e){let t=e.graphNodeId(),r=Ir.arrayFromValues(this.references);for(let o of r){let s=!1,i=si.toArray(o);for(let l of i)l.matchesPath(e.path())&&(s=!0,l.resolveMissingDependencies());s&&this.references.delete(t)}}};var Sr=(n=>(n.CREATED="node_created",n.DELETED="node_deleted",n.NAME_UPDATED="node_name_update",n.OVERRIDE_CLONABLE_STATE_UPDATE="node_override_clonable_state_update",n.NAMED_OUTPUTS_UPDATED="node_named_outputs_updated",n.NAMED_INPUTS_UPDATED="node_named_inputs_updated",n.INPUTS_UPDATED="node_inputs_updated",n.PARAMS_UPDATED="node_params_updated",n.UI_DATA_POSITION_UPDATED="node_ui_data_position_updated",n.UI_DATA_COMMENT_UPDATED="node_ui_data_comment_updated",n.ERROR_UPDATED="node_error_updated",n.FLAG_BYPASS_UPDATED="bypass_flag_updated",n.FLAG_DISPLAY_UPDATED="display_flag_updated",n.FLAG_OPTIMIZE_UPDATED="optimize_flag_updated",n.SELECTION_UPDATED="selection_updated",n))(Sr||{});var Q_=class{constructor(e,t=0,r=0){this.node=e,this._position=new re,this._width=50,this._color=new Ke(.75,.75,.75),this._layoutVertical=!0,this._json={x:0,y:0},this._position.x=t,this._position.y=r}dispose(){this._comment=void 0}setComment(e){this._comment=e,this.node.emit(Sr.UI_DATA_COMMENT_UPDATED)}comment(){return this._comment}setColor(e){this._color=e}color(){return this._color}setLayoutHorizontal(){this._layoutVertical=!1}isLayoutVertical(){return this._layoutVertical}copy(e){this._position.copy(e.position()),this._color.copy(e.color())}position(){return this._position}setPosition(e,t=0){if(xe.isNumber(e)){let r=e;this._position.set(r,t)}else this._position.copy(e);this.node.emit(Sr.UI_DATA_POSITION_UPDATED)}translate(e,t=!1){this._position.add(e),t&&(this._position.x=Math.round(this._position.x),this._position.y=Math.round(this._position.y)),this.node.emit(Sr.UI_DATA_POSITION_UPDATED)}toJSON(){return this._json.x=this._position.x,this._json.y=this._position.y,this._json.comment=this._comment,this._json}};var Ds=class{constructor(e){this.node=e,this._state=!0,this._hooks=null}onUpdate(e){this._hooks=this._hooks||[],this._hooks.push(e)}_on_update(){}set(e){this._state!=e&&(this._state=e,this._on_update(),this.runHooks())}active(){return this._state}toggle(){this.set(!this._state)}runHooks(){if(this._hooks)for(let e of this._hooks)e()}};var e9=class extends Ds{constructor(){super(...arguments);this._state=!1}_on_update(){this.node.emit(Sr.FLAG_BYPASS_UPDATED),this.node.setDirty()}};var t9=class extends Ds{_on_update(){this.node.emit(Sr.FLAG_DISPLAY_UPDATED)}};var r9=class extends Ds{constructor(){super(...arguments);this._state=!1}_on_update(){this.node.emit(Sr.FLAG_OPTIMIZE_UPDATED)}};var q0=class{constructor(e){this.node=e}hasDisplay(){return!1}hasBypass(){return!1}hasOptimize(){return!1}};function n9(n){return class extends n{constructor(){super(...arguments);this.display=new t9(this.node)}hasDisplay(){return!0}}}function rf(n){return class extends n{constructor(){super(...arguments);this.bypass=new e9(this.node)}hasBypass(){return!0}}}function zM(n){return class extends n{constructor(){super(...arguments);this.optimize=new r9(this.node)}hasOptimize(){return!0}}}var Ko=class extends n9(q0){},iq=class extends rf(q0){},sq=class extends rf(n9(q0)){},aq=class extends zM(rf(q0)){},o9=class extends zM(rf(n9(q0))){};var gu=class{constructor(e){this.node=e}};var i9=class extends gu{active(){return this.paramsTimeDependent()||this.inputsTimeDependent()}paramsTimeDependent(){let e=this.node.params.names;for(let t of e){let r=this.node.params.get(t);if(r&&r.states.timeDependent.active())return!0}return!1}inputsTimeDependent(){let e=this.node.io.inputs.inputs();for(let t of e)if(t&&t.states.timeDependent.active())return!0;return!1}forceTimeDependent(){let e=this.node.graphPredecessors().map(r=>r.graphNodeId()),t=this.node.scene().timeController.graphNode;e.includes(t.graphNodeId())||this.node.addGraphInput(t,!1)}unforceTimeDependent(){let e=this.node.scene().timeController.graphNode;this.node.removeGraphInput(e)}};var s9=class extends gu{set(e){this._message!=e&&(e?Fe.error(`[${this.node.path()}] error: '${e}'`):Fe.warn(`[${this.node.path()}] clear error`),this._message=e,this.onUpdate())}message(){return this._message}clear(){this.set(void 0)}active(){return this._message!=null}onUpdate(){this._message!=null&&this.node._setContainer(null,`from error '${this._message}'`),this.node.emit(Sr.ERROR_UPDATED)}};var a9=class{constructor(e){this.node=e,this.timeDependent=new i9(this.node),this.error=new s9(this.node)}};var l9=class{constructor(e){this.node=e,this._parent=null}parent(){return this._parent}setParent(e){e!=this.node.parentController.parent()&&(this._parent=e,this._parent&&this.node.nameController.requestNameToParent(this.node.name()))}firstAncestorWithContext(e){return this._parent?this._parent.context()==e?this._parent:this._parent.parentController.firstAncestorWithContext(e):null}path(e){let t=hr.SEPARATOR;if(this._parent!=null){if(this._parent==e)return this.node.name();{let r=this._parent.path(e);return r===t?r+this.node.name():r+t+this.node.name()}}else return t}onSetParent(){if(this._on_set_parent_hooks)for(let e of this._on_set_parent_hooks)e()}findNode(e){if(e==null)return null;if(e==hr.CURRENT||e==hr.CURRENT_WITH_SLASH)return this.node;if(e==hr.PARENT||e==hr.PARENT_WITH_SLASH)return this.node.parent();let t=hr.SEPARATOR;if(e===t)return this.node.scene().root();if(e[0]===t)return e=e.substring(1,e.length),this.node.scene().root().node(e);if(e.split){let r=e.split(t);if(r.length===1){let o=r[0];return this.node.childrenController?this.node.childrenController.childByName(o):null}else return hr.findNode(this.node,e)}else return console.error("unexpected path given:",e),null}};var lq=/[, ]/,HM=/\d+$/,cq=/^0+/,uq=/,| /,pq="0",dq=" ",fq=/^-?\d+\.?\d*$/;var Rt=class{static isBoolean(e){return e=="true"||e=="false"}static toBoolean(e){return e=="true"}static isNumber(e){return fq.test(e)}static tailDigits(e){let t=e.match(HM);return t?parseInt(t[0]):0}static increment(e){let t=e.match(HM);if(t){let r=t[0],o="",s=r.match(cq);s&&(o=s[0]);let i=parseInt(r);return i==0&&o.length>0&&o[o.length-1]==pq&&(o=o.slice(0,-1)),`${e.substring(0,e.length-t[0].length)}${o}${i+1}`}else return`${e}1`}static pluralize(e){return e[e.length-1]!=="s"?`${e}s`:e}static camelCase(e){let t=e.replace(/_/g," ").split(" "),r="";for(let o=0;o<t.length;o++){let s=t[o].toLowerCase();o>0&&(s=this.upperFirst(s)),r+=s}return r}static upperFirst(e){return e[0].toUpperCase()+e.substr(1)}static titleize(e){return e.split(/\s|_/g).map(o=>this.upperFirst(o)).join(" ")}static precision(e,t=2){t=Math.max(t,0);let r=`${e}`.split(".");if(t<=0)return r[0];let o=r[1];if(o!==void 0)return o.length>t&&(o=o.substring(0,t)),o=o.padEnd(t,"0"),`${r[0]}.${o}`;{let s=`${e}.`,i=s.length+t;return s.padEnd(i,"0")}}static ensureFloat(e){let t=`${e}`;return t.indexOf(".")>=0?t:`${t}.0`}static ensureInteger(e){let t=`${e}`;return t.indexOf(".")>=0?t.split(".")[0]:t}static matchMask(e,t){if(t==="*"||e==t)return!0;let r=t.split(dq);if(r.length>1){for(let s of r)if(this.matchMask(e,s))return!0;return!1}return t=t.split("*").join(".*"),t=`^${t}$`,new RegExp(t).test(e)}static matchesOneMask(e,t){let r=!1;for(let o of t)Rt.matchMask(e,o)&&(r=!0);return r}static attribNames(e){let t=e.split(lq),r=new Set;for(let i of t)i=i.trim(),i.length>0&&r.add(i);let o=new Array(r.size),s=0;return r.forEach(i=>{o[s]=i,s++}),o}static indices(e){let t=e.split(uq);if(t.length>1){let r=t.flatMap(o=>this.indices(o));return lr.uniq(r).sort((o,s)=>o-s)}else{let r=t[0];if(r){let o="-";if(r.indexOf(o)>0){let s=r.split(o);return lr.range(parseInt(s[0]),parseInt(s[1])+1)}else{let s=parseInt(r);return xe.isNumber(s)?[s]:[]}}else return[]}}static escapeLineBreaks(e){return e.replace(/(\r\n|\n|\r)/gm,"\\n")}static sanitizeName(e){return e=e.replace(/[^A-Za-z0-9]/g,"_"),e=e.replace(/^[0-9]/,"_"),e}};var c9=class{constructor(e){this._node=e,this._node_ids=[],this._json=[]}node(){return this._node}nodes(){return this._node.scene().graph.nodesFromIds(this._node_ids)}contains(e){return this._node_ids.includes(e.graphNodeId())}equals(e){let t=e.map(r=>r.graphNodeId()).sort();return lr.isEqual(t,this._node_ids)}clear(){this._node_ids=[],this.send_update_event()}set(e){this._node_ids=[],this.add(e)}add(e){let t=e.map(r=>r.graphNodeId());this._node_ids=lr.union(this._node_ids,t),this.send_update_event()}remove(e){let t=e.map(r=>r.graphNodeId());this._node_ids=lr.difference(this._node_ids,t),this.send_update_event()}send_update_event(){this._node.emit(Sr.SELECTION_UPDATED)}toJSON(){return this._json=this._json||[],this._json=this._node_ids.map(e=>e),this._json}};var yr=(n=>(n.ALWAYS="always",n.NEVER="never",n.FROM_NODE="from_node",n))(yr||{});var qr=class{static unreachable(e){throw new Error("Didn't expect to get here")}};var u9=class{constructor(e){this.inputs_controller=e,this._clone_required_states=[],this._overridden=!1}initInputsClonedState(e){xe.isArray(e)?this._cloned_states=e:this._cloned_state=e,this._update_clone_required_state()}override_cloned_state_allowed(){if(this._cloned_states){for(let e of this._cloned_states)if(e==yr.FROM_NODE)return!0}return this._cloned_state?this._cloned_state==yr.FROM_NODE:!1}clone_required_state(e){return this._clone_required_states[e]}clone_required_states(){return this._clone_required_states}_get_clone_required_state(e){let t=this._cloned_states;if(t){let r=t[e];if(r!=null)return this.clone_required_from_state(r)}return this._cloned_state?this.clone_required_from_state(this._cloned_state):!0}clone_required_from_state(e){switch(e){case yr.ALWAYS:return!0;case yr.NEVER:return!1;case yr.FROM_NODE:return!this._overridden}return qr.unreachable(e)}override_cloned_state(e){this._overridden=e,this._update_clone_required_state()}overriden(){return this._overridden}_update_clone_required_state(){if(this._cloned_states){let e=[];for(let t=0;t<this._cloned_states.length;t++)e[t]=this._get_clone_required_state(t);this._clone_required_states=e;return}if(this._cloned_state){let e=this.inputs_controller.inputsCount(),t=[];for(let r=0;r<e;r++)t[r]=this._get_clone_required_state(r);this._clone_required_states=t;return}}};var p9=class{constructor(e){this.operationContainer=e}inputsCount(){return this.operationContainer.inputsCount()}initInputsClonedState(e){this._clonedStatesController||(this._clonedStatesController=new u9(this),this._clonedStatesController.initInputsClonedState(e))}cloneRequired(e){var t;let r=(t=this._clonedStatesController)==null?void 0:t.clone_required_state(e);return r??!0}override_cloned_state(e){var t;(t=this._clonedStatesController)==null||t.override_cloned_state(e)}};var d9=class{constructor(e,t,r){this.operation=e,this.name=t,this.params={},this._applyDefaultParams(),this._applyInitParams(r),this._initClonedStates()}pathParamResolveRequired(){return this._path_params!=null}resolvePathParams(e){if(!!this._path_params)for(let t of this._path_params)t.resolve(e)}_applyDefaultParams(){let e=this.operation.constructor.DEFAULT_PARAMS,t=Object.keys(e);for(let r of t){let o=e[r],s=this._convertParamData(r,o);s!=null&&(this.params[r]=s)}}_applyInitParams(e){let t=Object.keys(e);for(let r of t){let o=e[r];if(o.simple_data!=null){let s=o.simple_data,i=this.operation.convertExportParamData({paramName:r,paramData:s,params:this.params});i!=null&&(this.params[r]=i)}}}_convertParamData(e,t){if(xe.isNumber(t)||xe.isBoolean(t)||xe.isString(t))return t;if(t instanceof li){let r=t.clone();return this._path_params||(this._path_params=[]),this._path_params.push(r),r}if(t instanceof Ke||t instanceof re||t instanceof F||t instanceof kt)return t.clone()}setInput(e,t){this._inputs=this._inputs||[],this._inputs[e]=t}inputsCount(){return this._inputs?this._inputs.length:0}inputsController(){return this._inputsController=this._inputsController||new p9(this)}_initClonedStates(){let e=this.operation.constructor.INPUT_CLONED_STATE;this.inputsController().initInputsClonedState(e)}inputCloneRequired(e){return this._inputsController?this._inputsController.cloneRequired(e):!0}overrideInputCloneState(e){this.inputsController().override_cloned_state(e)}cook(e){return this.operation.cook(e,this.params)}};var f9=class extends d9{constructor(e,t,r){super(e,t,r);this.operation=e,this.name=t,this.init_params=r,this._inputs=[],this._currentInputIndex=0,this._dirty=!0}operationType(){return this.operation.type()}addInput(e){super.setInput(this._currentInputIndex,e),this.incrementInputIndex()}incrementInputIndex(){this._currentInputIndex++}currentInputIndex(){return this._currentInputIndex}setDirty(){if(!this._dirty){this._computeResult=void 0;for(let e=0;e<this._inputs.length;e++)this._inputs[e].setDirty()}}async compute(e,t){if(this._computeResult)return this._computeResult;let r=[],o=t.get(this);o&&o.forEach((i,l)=>{r[l]=e[i]});for(let i=0;i<this._inputs.length;i++){let a=await this._inputs[i].compute(e,t);a&&(this.inputCloneRequired(i)&&(a=a.clone()),r[i]=a)}let s=this.operation.cook(r,this.params);return s?s instanceof Promise?this._computeResult=await s:this._computeResult=s:this._computeResult=void 0,this._dirty=!1,this._computeResult}};var vu=class{constructor(e){this.node=e,this._graph_node=new zr(e.scene(),"nodeNameController")}dispose(){this._graph_node.dispose(),this._on_set_name_hooks=void 0,this._on_set_fullPath_hooks=void 0}get graph_node(){return this._graph_node}static baseName(e){let t=e.type(),r=t[t.length-1];return xe.isNaN(parseInt(r))||(t+="_"),`${t}1`}requestNameToParent(e){let t=this.node.parent();t&&t.childrenAllowed()&&t.childrenController?t.childrenController.setChildName(this.node,e):console.warn("requestNameToParent failed, no parent found")}setName(e){e!=this.node.name()&&this.requestNameToParent(e)}updateNameFromParent(e){var t;if(this.node._setCoreName(e),this._postSetName(),this.runPostSetFullPathHooks(),this.node.childrenAllowed()){let r=(t=this.node.childrenController)==null?void 0:t.children();if(r)for(let o of r)o.nameController.runPostSetFullPathHooks()}this.node.lifecycle.creationCompleted()&&this.node.scene().loadingController.loaded()&&(this.node.scene().missingExpressionReferencesController.checkForMissingReferences(this.node),this.node.scene().expressionsController.regenerateReferringExpressions(this.node)),this.node.scene().referencesController.notifyNameUpdated(this.node),this.node.emit(Sr.NAME_UPDATED)}add_post_set_name_hook(e){this._on_set_name_hooks=this._on_set_name_hooks||[],this._on_set_name_hooks.push(e)}add_post_set_fullPath_hook(e){this._on_set_fullPath_hooks=this._on_set_fullPath_hooks||[],this._on_set_fullPath_hooks.push(e)}_postSetName(){if(this._on_set_name_hooks)for(let e of this._on_set_name_hooks)e()}runPostSetFullPathHooks(){if(this._on_set_fullPath_hooks)for(let e of this._on_set_fullPath_hooks)e()}};var m9=class{constructor(e,t){this.node=e,this._context=t,this._childrenByName=new Map,this._childrenByType=new Map,this._childrenAndGrandchildrenByContext=new Map}get selection(){return this._selection=this._selection||new c9(this.node)}dispose(){let e=this.children();for(let t of e)this.node.removeNode(t);this._selection=void 0}get context(){return this._context}set_output_node_find_method(e){this._output_node_find_method=e}output_node(){if(this._output_node_find_method)return this._output_node_find_method()}setChildName(e,t){let r;if(t=Rt.sanitizeName(t),(r=this._childrenByName.get(t))!=null)return e.name()===t&&r.graphNodeId()===e.graphNodeId()?void 0:(t=Rt.increment(t),this.setChildName(e,t));{let o=e.name();this._childrenByName.get(o)&&this._childrenByName.delete(o),this._childrenByName.set(t,e),e.nameController.updateNameFromParent(t),this._addToNodesByType(e),this.node.scene().nodesController.addToInstanciatedNode(e)}}_nextAvailableChildName(e){return e=Rt.sanitizeName(e),this._childrenByName.get(e)?this._nextAvailableChildName(Rt.increment(e)):e}node_context_signature(){return`${this.node.context()}/${this.node.type()}`}availableChildrenClasses(){return Fe.registeredNodes(this._context,this.node.type())}isValidChildType(e){return this.availableChildrenClasses()[e]!=null}createNode(e,t){if(typeof e=="string"){let r=this._findNodeClass(e);return this._createAndInitNode(r,t)}else return this._createAndInitNode(e,t)}_createAndInitNode(e,t){let r=(t==null?void 0:t.nodeName)||vu.baseName(e),o=this._nextAvailableChildName(r),s=new e(this.node.scene(),o,t);return s.initializeBaseAndNode(),this._addNode(s),s.lifecycle.setCreationCompleted(),s}_findNodeClass(e){let t=this.availableChildrenClasses()[e.toLowerCase()];if(t==null){let r=`child node type '${e}' not found for node '${this.node.path()}'. Available types are: ${Object.keys(this.availableChildrenClasses()).join(", ")}, ${this._context}, ${this.node.type()}`;throw console.error(r),r}return t}createOperationContainer(e,t,r){let o=Fe.registeredOperation(this._context,e);if(o==null){let s=`no operation found with context ${this._context}/${e}`;throw console.error(s),s}else{let s=new o(this.node.scene());return new f9(s,t,(r==null?void 0:r.paramsInitValueOverrides)||{})}}_addNode(e){if(e.setParent(this.node),e.params.init(),e.parentController.onSetParent(),e.nameController.runPostSetFullPathHooks(),e.childrenAllowed()&&e.childrenController)for(let t of e.childrenController.children())t.nameController.runPostSetFullPathHooks();return this.node.emit(Sr.CREATED,{child_node_json:e.toJSON()}),this.node.scene().lifecycleController.onAfterCreatedCallbackAllowed()&&e.lifecycle.runOnAfterCreatedCallbacks(),e.lifecycle.runOnAfterAddedCallbacks(),this.node.lifecycle.runOnChildAddCallbacks(e),e.require_webgl2()&&this.node.scene().webgl_controller.set_require_webgl2(),this.node.scene().missingExpressionReferencesController.checkForMissingReferences(e),e}removeNode(e){if(e.parent()!=this.node)return console.warn(`node ${e.name()} not under parent ${this.node.path()}`);{e.lifecycle.runOnBeforeDeleteCallbacks(),this.selection.contains(e)&&this.selection.remove([e]);let t=e.io.connections.firstInputConnection(),r=e.io.connections.inputConnections(),o=e.io.connections.outputConnections();if(r)for(let s of r)s&&s.disconnect({setInput:!0});if(o){for(let s of o)if(s&&(s.disconnect({setInput:!0}),t)){let i=t.node_src,l=s.output_index,a=s.node_dest,c=s.input_index;a.io.inputs.setInput(c,i,l)}}e.setParent(null),this._childrenByName.delete(e.name()),this._removeFromNodesByType(e),this.node.scene().nodesController.removeFromInstanciatedNode(e),e.setSuccessorsDirty(this.node),e.graphDisconnectSuccessors(),this.node.lifecycle.runOnChildRemoveCallbacks(e),e.lifecycle.runOnDeleteCallbacks(),e.dispose(),e.emit(Sr.DELETED,{parent_id:this.node.graphNodeId()})}}_addToNodesByType(e){let t=e.graphNodeId(),r=e.type();Ir.addToSetAtEntry(this._childrenByType,r,t),this._addToChildrenAndGrandchildrenByContext(e)}_removeFromNodesByType(e){let t=e.graphNodeId(),r=e.type();Ir.removeFromSetAtEntry(this._childrenByType,r,t),this._removeFromChildrenAndGrandchildrenByContext(e)}_addToChildrenAndGrandchildrenByContext(e){var t;let r=e.graphNodeId(),o=e.context();Ir.addToSetAtEntry(this._childrenAndGrandchildrenByContext,o,r);let s=this.node.parent();s&&s.childrenAllowed()&&((t=s.childrenController)==null||t._addToChildrenAndGrandchildrenByContext(e))}_removeFromChildrenAndGrandchildrenByContext(e){var t;let r=e.graphNodeId(),o=e.context();Ir.removeFromSetAtEntry(this._childrenAndGrandchildrenByContext,o,r);let s=this.node.parent();s&&s.childrenAllowed()&&((t=s.childrenController)==null||t._removeFromChildrenAndGrandchildrenByContext(e))}nodesByType(e){let t=this._childrenByType.get(e);if(!t)return[];let r=this.node.scene().graph,o=[];for(let s of t){let i=r.nodeFromId(s);i&&o.push(i)}return o}childByName(e){return this._childrenByName.get(e)||null}hasChildrenAndGrandchildrenWithContext(e){return this._childrenAndGrandchildrenByContext.get(e)!=null}children(){let e=[];return this._childrenByName.forEach(t=>{e.push(t)}),e}childrenNames(){let e=[];return this._childrenByName.forEach((t,r)=>{e.push(r)}),e}traverseChildren(e){this._childrenByName.forEach(t=>{var r;e(t),(r=t.childrenController)==null||r.traverseChildren(e)})}};var h9=class{constructor(e){this.node=e,this._creationCompleted=!1}dispose(){this._onChildAddCallbacks=void 0,this._onChildRemoveCallbacks=void 0,this._onAfterCreatedCallbacks=void 0,this._onAfterAddedCallbacks=void 0,this._onBeforeDeletedCallbacks=void 0,this._onAfterDeletedCallbacks=void 0}setCreationCompleted(){this._creationCompleted||(this._creationCompleted=!0)}creationCompleted(){return this.node.scene().loadingController.loaded()&&this._creationCompleted}onChildAdd(e){this._onChildAddCallbacks=this._onChildAddCallbacks||[],this._onChildAddCallbacks.push(e)}runOnChildAddCallbacks(e){this._runCallbacksWithChildNode(this._onChildAddCallbacks,e)}onChildRemove(e){this._onChildRemoveCallbacks=this._onChildRemoveCallbacks||[],this._onChildRemoveCallbacks.push(e)}runOnChildRemoveCallbacks(e){this._runCallbacksWithChildNode(this._onChildRemoveCallbacks,e)}onAfterCreated(e){this._onAfterCreatedCallbacks=this._onAfterCreatedCallbacks||[],this._onAfterCreatedCallbacks.push(e)}runOnAfterCreatedCallbacks(){this._runCallbacks(this._onAfterCreatedCallbacks)}onAfterAdded(e){this._onAfterAddedCallbacks=this._onAfterAddedCallbacks||[],this._onAfterAddedCallbacks.push(e)}runOnAfterAddedCallbacks(){this._runCallbacks(this._onAfterAddedCallbacks)}onBeforeDeleted(e){this._onBeforeDeletedCallbacks=this._onBeforeDeletedCallbacks||[],this._onBeforeDeletedCallbacks.push(e)}runOnBeforeDeleteCallbacks(){this._runCallbacks(this._onBeforeDeletedCallbacks)}onAfterDeleted(e){this._onAfterDeletedCallbacks=this._onAfterDeletedCallbacks||[],this._onAfterDeletedCallbacks.push(e)}runOnDeleteCallbacks(){this._runCallbacks(this._onAfterDeletedCallbacks)}_runCallbacks(e){if(!e)return;let t;for(t of e)t()}_runCallbacksWithChildNode(e,t){if(!e)return;let r;for(r of e)r(t)}};var it=(n=>(n.ANIM="anim",n.AUDIO="audio",n.COP="cop",n.EVENT="event",n.GL="gl",n.JS="js",n.MANAGER="manager",n.MAT="mat",n.OBJ="obj",n.POST="post",n.ROP="rop",n.SOP="sop",n))(it||{}),W0=(n=>(n.ANIM="animationsNetwork",n.AUDIO="audioNetwork",n.COP="copNetwork",n.EVENT="eventsNetwork",n.MAT="materialsNetwork",n.POST="postProcessNetwork",n.ROP="renderersNetwork",n.SUBNET="subnet",n))(W0||{}),nf=(n=>(n.INPUT="subnetInput",n.OUTPUT="subnetOutput",n))(nf||{}),_9=(n=>(n.PERSPECTIVE="perspectiveCamera",n.ORTHOGRAPHIC="orthographicCamera",n))(_9||{});var g9=(n=>(n.ATTRIBUTE="attribute",n))(g9||{}),v9=(n=>(n.DEVICE_ORIENTATION="cameraDeviceOrientationControls",n.MAP="cameraMapControls",n.ORBIT="cameraOrbitControls",n.FIRST_PERSON="firstPersonControls",n.PLAYER="playerControls",n.MOBILE_JOYSTICK="mobileJoystickControls",n))(v9||{}),jM=["cameraDeviceOrientationControls","cameraMapControls","cameraOrbitControls","firstPersonControls","mobileJoystickControls"];var Wr=class{constructor(e){this._node=e}set_node(e){this._node=e}node(){return this._node}set_content(e){this._content=e,this._post_set_content()}has_content(){return this._content!=null}content(){return this._content}_post_set_content(){}coreContent(){return this._content}coreContentCloned(){return this._content}infos(){return[]}};var y9=class extends Wr{set_content(e){super.set_content(e)}setTimelineBuilder(e){return this.set_content(e)}timelineBuilder(){return this.content()}coreContentCloned(){if(this._content)return this._content.clone()}};var b9=class extends Wr{setContent(e){super.set_content(e)}setAudioBuilder(e){return this.set_content(e)}audioBuilder(){return this.content()}coreContentCloned(){if(this._content)return this._content.clone()}};var x9=class extends Wr{set_content(e){super.set_content(e)}};var Zo=class extends On{constructor(){super();this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),t}};Zo.prototype.isScene=!0;var of=new F,qM=new F,Ol=class extends On{constructor(){super();this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);let t=e.levels;for(let r=0,o=t.length;r<o;r++){let s=t[r];this.addLevel(s.object.clone(),s.distance)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0){t=Math.abs(t);let r=this.levels,o;for(o=0;o<r.length&&!(t<r[o].distance);o++);return r.splice(o,0,{distance:t,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){let t=this.levels;if(t.length>0){let r,o;for(r=1,o=t.length;r<o&&!(e<t[r].distance);r++);return t[r-1].object}return null}raycast(e,t){if(this.levels.length>0){of.setFromMatrixPosition(this.matrixWorld);let o=e.ray.origin.distanceTo(of);this.getObjectForDistance(o).raycast(e,t)}}update(e){let t=this.levels;if(t.length>1){of.setFromMatrixPosition(e.matrixWorld),qM.setFromMatrixPosition(this.matrixWorld);let r=of.distanceTo(qM)/e.zoom;t[0].object.visible=!0;let o,s;for(o=1,s=t.length;o<s&&r>=t[o].distance;o++)t[o-1].object.visible=!1,t[o].object.visible=!0;for(this._currentLevel=o-1;o<s;o++)t[o].object.visible=!1}}toJSON(e){let t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];let r=this.levels;for(let o=0,s=r.length;o<s;o++){let i=r[o];t.object.levels.push({object:i.object.uuid,distance:i.distance})}return t}};var Bo=(n=>(n.OBJECT3D="Object3D",n.GROUP="Group",n.MESH="Mesh",n.POINTS="Points",n.LINE_SEGMENTS="LineSegments",n.LOD="LOD",n))(Bo||{}),WM={Mesh:wr,Group:Tr,Points:Xo,LineSegments:$n,Object3D:On,LOD:Ol};function sf(n){switch(n){case On:return"Object3D";case Tr:return"Group";case wr:return"Mesh";case Xo:return"Points";case $n:return"LineSegments";case Ol:return"LOD";default:return Fe.warn("object type not supported",n),"Mesh"}}var af=["Mesh","Points","LineSegments"],Cue=[{name:"Mesh",value:af.indexOf("Mesh")},{name:"Points",value:af.indexOf("Points")},{name:"LineSegments",value:af.indexOf("LineSegments")}],mq={MeshStandard:new Oi({color:16777215,side:eo,metalness:.5,roughness:.9}),Mesh:new Oi({color:16777215,side:eo,metalness:0,roughness:.9}),Points:new D0({color:16777215,size:.1,depthTest:!0}),LineSegments:new Wn({color:16777215,linewidth:1})};var n0=(n=>(n[n.NUMERIC=0]="NUMERIC",n[n.STRING=1]="STRING",n))(n0||{});var wl=(n=>(n[n.FLOAT=1]="FLOAT",n[n.VECTOR2=2]="VECTOR2",n[n.VECTOR3=3]="VECTOR3",n[n.VECTOR4=4]="VECTOR4",n))(wl||{});var Bs={ATTRIB_CLASS:{VERTEX:0,OBJECT:1},OBJECT_TYPES:af,CONSTRUCTOR_NAMES_BY_CONSTRUCTOR_NAME:{[Zo.name]:"Scene",[Tr.name]:"Group",[On.name]:"Object3D",[wr.name]:"Mesh",[Xo.name]:"Points",[$n.name]:"LineSegments",[il.name]:"Bone",[ol.name]:"SkinnedMesh"},CONSTRUCTORS_BY_NAME:{Mesh:wr,Points:Xo,LineSegments:$n},MATERIALS:mq};var Tn=(n=>(n.POINT_INDEX="ptnum",n.OBJECT_INDEX="objnum",n.COLOR="color",n.NORMAL="normal",n.POSITION="position",n.PSCALE="pscale",n.UP="up",n.UV="uv",n.SCALE="scale",n.TANGENT="tangent",n))(Tn||{}),hq={P:"position",N:"normal",Cd:"color"},$r=class{static remapName(e){return hq[e]||e}static arrayToIndexedArrays(e){let t={},r=0,o=[],s=[],i=0;for(;i<e.length;){let l=e[i],a=t[l];a!=null?o.push(a):(s.push(l),o.push(r),t[l]=r,r+=1),i++}return{indices:o,values:s}}static default_value(e){switch(e){case 1:return 0;case 2:return new re(0,0);case 3:return new F(0,0,0);default:throw`size ${e} not yet implemented`}}static copy(e,t,r=!0){let o=e==null?void 0:e.array,s=t==null?void 0:t.array;if(o&&s){let i=Math.min(o.length,s.length);for(let l=0;l<i;l++)s[l]=o[l];r&&(t.needsUpdate=!0)}}static attribSizeFromValue(e){if(xe.isString(e)||xe.isNumber(e))return wl.FLOAT;if(xe.isArray(e))return e.length;switch(e.constructor){case re:return wl.VECTOR2;case F:return wl.VECTOR3;case kt:return wl.VECTOR4}return 0}};var yu=class{constructor(e){this._index=e}index(){return this._index}};var lf={POSITION:"position",NORMAL:"normal"};var _q={x:0,y:1,z:2,w:3,r:0,g:1,b:2},gq=".",o0=class extends yu{constructor(e,t){super(t);this._coreGeometry=e,this._geometry=this._coreGeometry.geometry()}applyMatrix4(e){this.position().applyMatrix4(e)}coreGeometry(){return this._coreGeometry}geometry(){return this._geometry=this._geometry||this._coreGeometry.geometry()}attribSize(e){return e=$r.remapName(e),this._geometry.getAttribute(e).itemSize}hasAttrib(e){let t=$r.remapName(e);return this._coreGeometry.hasAttrib(t)}attribValue(e,t){if(e===Tn.POINT_INDEX)return this.index();{let r=null,o=null;e[e.length-2]===gq&&(r=e[e.length-1],o=_q[r],e=e.substring(0,e.length-2));let s=$r.remapName(e),i=this._geometry.getAttribute(s);if(i){let{array:l}=i;if(this._coreGeometry.isAttribIndexed(s))return this.indexedAttribValue(s);{let a=i.itemSize,c=this._index*a;if(o==null)switch(a){case 1:return l[c];case 2:return t=t||new re,t.fromArray(l,c),t;break;case 3:return t=t||new F,t.fromArray(l,c),t;break;case 4:return t=t||new kt,t.fromArray(l,c),t;break;default:throw`size not valid (${a})`}else switch(a){case 1:return l[c];default:return l[c+o]}}}else{let l=`attrib ${e} not found. availables are: ${Object.keys(this._geometry.attributes||{}).join(",")}`;throw console.warn(l),l}}}attribValueNumber(e){let t=$r.remapName(e);return this._geometry.getAttribute(t).array[this._index]}attribValueVector2(e,t){let r=$r.remapName(e),o=this._geometry.getAttribute(r);return t.fromArray(o.array,this._index*2),t}attribValueVector3(e,t){let r=$r.remapName(e),o=this._geometry.getAttribute(r);return t.fromArray(o.array,this._index*3),t}attribValueVector4(e,t){let r=$r.remapName(e),o=this._geometry.getAttribute(r);return t.fromArray(o.array,this._index*4),t}indexedAttribValue(e){let t=this.attribValueIndex(e);return this._coreGeometry.userDataAttrib(e)[t]}stringAttribValue(e){return this.indexedAttribValue(e)}attribValueIndex(e){return this._coreGeometry.isAttribIndexed(e)?this._geometry.getAttribute(e).array[this._index]:-1}isAttribIndexed(e){return this._coreGeometry.isAttribIndexed(e)}position(){return this._position||(this._position=this.getPosition(new F))}getPosition(e){let{array:t}=this._geometry.getAttribute(lf.POSITION);return e.fromArray(t,this._index*3)}setPosition(e){this.setAttribValueVector3(lf.POSITION,e)}normal(){return this._normal=this._normal||this.getNormal(new F)}getNormal(e){let{array:t}=this._geometry.getAttribute(lf.NORMAL);return e.fromArray(t,this._index*3)}setNormal(e){return this.setAttribValueVector3(lf.NORMAL,e)}setAttribValue(e,t){let r=this._geometry.getAttribute(e),o=r.array,s=r.itemSize;if(xe.isArray(t)){for(let i=0;i<s;i++)o[this._index*s+i]=t[i];return}switch(s){case 1:o[this._index]=t;break;case 2:let i=t,l=this._index*2;o[l+0]=i.x,o[l+1]=i.y;break;case 3:let a=t.r!=null,c=this._index*3;if(a){let p=t;o[c+0]=p.r,o[c+1]=p.g,o[c+2]=p.b}else{let p=t;o[c+0]=p.x,o[c+1]=p.y,o[c+2]=p.z}break;case 4:let h=t,g=this._index*4;o[g+0]=h.x,o[g+1]=h.y,o[g+2]=h.z,o[g+3]=h.w;break;default:throw console.warn(`Point.set_attrib_value does not yet allow attrib size ${s}`),`attrib size ${s} not implemented`}}setAttribValueFromNumber(e,t){let o=this._geometry.getAttribute(e).array;o[this._index]=t}setAttribValueFromVector2(e,t){let r=this._geometry.getAttribute(e);t.toArray(r.array,this._index*2)}setAttribValueFromVector3(e,t){let r=this._geometry.getAttribute(e);t.toArray(r.array,this._index*3)}setAttribValueFromVector4(e,t){let r=this._geometry.getAttribute(e);t.toArray(r.array,this._index*4)}setAttribValueVector3(e,t){if(t==null)return;if(e==null)throw"Point.set_attrib_value requires a name";let o=this._geometry.getAttribute(e).array,s=this._index*3;o[s]=t.x,o[s+1]=t.y,o[s+2]=t.z}setAttribIndex(e,t){let r=this._geometry.getAttribute(e).array;return r[this._index]=t}};var cf=function(n){return function(e){return Math.pow(e,n)}},uf=function(n){return function(e){return 1-Math.abs(Math.pow(e-1,n))}},C9=function(n){return function(e){return e<.5?cf(n)(e*2)/2:uf(n)(e*2-1)/2+.5}},pf={ease_i2:cf(2),ease_o2:uf(2),ease_io2:C9(2),ease_i3:cf(3),ease_o3:uf(3),ease_io3:C9(3),ease_i4:cf(4),ease_o4:uf(4),ease_io4:C9(4),ease_i_sin:function(n){return 1+Math.sin(Math.PI/2*n-Math.PI/2)},ease_o_sin:function(n){return Math.sin(Math.PI/2*n)},ease_io_sin:function(n){return(1+Math.sin(Math.PI*n-Math.PI/2))/2},ease_i_elastic:function(n){return n==0?0:(.04-.04/n)*Math.sin(25*n)+1},ease_o_elastic:function(n){return n==1?1:.04*n/--n*Math.sin(25*n)},ease_io_elastic:function(n){return n==.5?0:(n-=.5)<0?(.02+.01/n)*Math.sin(50*n):(.02-.01/n)*Math.sin(50*n)+1}};var $M=Math.PI/180,vq=12.9898,yq=78.233,bq=43758.5453,ci=class{static clamp(e,t,r){return e<t?t:e>r?r:e}static fit01(e,t,r){return this.fit(e,0,1,t,r)}static fit(e,t,r,o,s){let i=r-t,l=s-o;return(e-t)/i*l+o}static blend(e,t,r){return(1-r)*e+r*t}static degrees_to_radians(e){return e*$M}static radians_to_degrees(e){return e/$M}static deg2rad(e){return this.degrees_to_radians(e)}static rad2deg(e){return this.radians_to_degrees(e)}static rand(e){return xe.isNumber(e)?this.randFloat(e):this.randVec2(e)}static round(e,t){let r=e/t;return(e<0?Math.ceil(r):Math.floor(r))*t}static highest_even(e){return 2*Math.ceil(e*.5)}static randFloat(e,t=136574){return this._vec.x=e,this._vec.y=t,this.randVec2(this._vec)}static randVec2(e){let r=(e.x*vq+e.y*yq)%Math.PI;return this.fract(Math.sin(r)*bq)}static geodesic_distance(e,t){var r=6371e3,o=this.deg2rad(e.lat),s=this.deg2rad(t.lat),i=this.deg2rad(t.lat-e.lat),l=this.deg2rad(t.lng-e.lng),a=Math.sin(i/2)*Math.sin(i/2)+Math.cos(o)*Math.cos(s)*Math.sin(l/2)*Math.sin(l/2),c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)),h=r*c;return h}static expand_triangle(e,t){e.getMidpoint(this._triangle_mid),this._triangle_mid_to_corner.copy(e.a).sub(this._triangle_mid),this._triangle_mid_to_corner.normalize().multiplyScalar(t),e.a.add(this._triangle_mid_to_corner),this._triangle_mid_to_corner.copy(e.b).sub(this._triangle_mid),this._triangle_mid_to_corner.normalize().multiplyScalar(t),e.b.add(this._triangle_mid_to_corner),this._triangle_mid_to_corner.copy(e.c).sub(this._triangle_mid),this._triangle_mid_to_corner.normalize().multiplyScalar(t),e.c.add(this._triangle_mid_to_corner)}static nearestPower2(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.log(2)))}};ci.Easing=pf;ci.fract=n=>n-Math.floor(n);ci._vec={x:0,y:136574};ci._triangle_mid=new F;ci._triangle_mid_to_corner=new F;var T9=class{constructor(e,t){this._coreGeometry=e,this._index=t,this._geometry=this._coreGeometry.geometry()}index(){return this._index}points(){return this._points=this._points||this._get_points()}applyMatrix4(e){for(let t of this.points())t.applyMatrix4(e)}_get_points(){var e;let t=((e=this._geometry.index)==null?void 0:e.array)||[],r=this._index*3;return[new o0(this._coreGeometry,t[r+0]),new o0(this._coreGeometry,t[r+1]),new o0(this._coreGeometry,t[r+2])]}positions(){return this._positions=this._positions||this._getPositions()}_getPositions(){let e=this.points();return[e[0].position(),e[1].position(),e[2].position()]}triangle(){return this._triangle=this._triangle||this._get_triangle()}_get_triangle(){let e=this.positions();return new I0(e[0],e[1],e[2])}deltas(){return this._deltas=this._deltas||this._getDeltas()}_getDeltas(){let e=this.positions();return[e[1].clone().sub(e[0]),e[2].clone().sub(e[0])]}area(){return this.triangle().getArea()}center(e){let t=this.positions();return e.x=(t[0].x+t[1].x+t[2].x)/3,e.y=(t[0].y+t[1].y+t[2].y)/3,e.z=(t[0].z+t[1].z+t[2].z)/3,e}randomPosition(e){let t=[ci.randFloat(e),ci.randFloat(e*6541)];return t[0]+t[1]>1&&(t[0]=1-t[0],t[1]=1-t[1]),this.positions()[0].clone().add(this.deltas()[0].clone().multiplyScalar(t[0])).add(this.deltas()[1].clone().multiplyScalar(t[1]))}attribValueAtPosition(e,t){let r=new F;this.triangle().getBarycoord(t,r);let o=r.toArray(),i=this._geometry.attributes[e].itemSize,l=this.points().map(g=>g.attribValue(e)),a,c,h=0;switch(i){case 1:{c=0;for(let g of l)c+=g*o[h],h++;a=c;break}default:{for(let g of l){let p=g.multiplyScalar(o[h]);c?c.add(p):c=p,h++}a=c}}return a}static interpolatedValue(e,t,r,o){let s=[t.a,t.b,t.c],l=e.getAttribute("position").array,a=s.map(m=>new F(l[m*3+0],l[m*3+1],l[m*3+2])),c=o.itemSize,h=o.array,g=[];switch(c){case 1:g=s.map(m=>h[m]);break;case 2:g=s.map(m=>new re(h[m*2+0],h[m*2+1]));break;case 3:g=s.map(m=>new F(h[m*3+0],h[m*3+1],h[m*3+2]));break}let p=s.map((m,v)=>r.distanceTo(a[v])),u=lr.sum([p[0]*p[1],p[0]*p[2],p[1]*p[2]]),d=[p[1]*p[2]/u,p[0]*p[2]/u,p[0]*p[1]/u],f;switch(c){case 1:f=lr.sum(s.map((m,v)=>d[v]*g[v]));break;default:var _=s.map((m,v)=>g[v].multiplyScalar(d[v]));f=null;for(let m of _)f?f.add(m):f=m}return f}};var ks=class{from_points(e){e=this._filter_points(e);let t=new Gt,r=new Yr(t),o=e[0];if(o!=null){let s=o.geometry(),i=o.coreGeometry(),l={};for(let h=0;h<e.length;h++)l[e[h].index()]=h;let a=this._indices_from_points(l,s);a&&t.setIndex(a);let{attributes:c}=s;for(let h of Object.keys(c))if(i.userDataAttribs()[h]!=null){let u=lr.uniq(e.map(_=>_.indexedAttribValue(h))),d={};u.forEach((_,m)=>d[_]=m),r.userDataAttribs()[h]=u;let f=[];for(let _ of e){let m=d[_.indexedAttribValue(h)];f.push(m)}t.setAttribute(h,new _t(f,1))}else{let u=c[h].itemSize,d=new Array(e.length*u);switch(u){case 1:for(let _=0;_<e.length;_++)d[_]=e[_].attribValue(h);break;default:let f;for(let _=0;_<e.length;_++)f=e[_].attribValue(h),f.toArray(d,_*u);break}t.setAttribute(h,new _t(d,u))}}return t}};var E9=class extends ks{_filter_points(e){return e}_indices_from_points(e,t){let r=t.index;if(r!=null){let o=r.array,s=[],i,l;for(let a=0;a<o.length;a++)i=o[a],l=e[i],l!=null&&s.push(l);return s}}};function YM(n,e=!1){let t=n[0].index!==null,r=new Set(Object.keys(n[0].attributes)),o=new Set(Object.keys(n[0].morphAttributes)),s={},i={},l=n[0].morphTargetsRelative,a=new Gt,c=0;for(let h=0;h<n.length;++h){let g=n[h],p=0;if(t!==(g.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let u in g.attributes){if(!r.has(u))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+'. All geometries must have compatible attributes; make sure "'+u+'" attribute exists among all geometries, or in none of them.'),null;s[u]===void 0&&(s[u]=[]),s[u].push(g.attributes[u]),p++}if(p!==r.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". Make sure all geometries have the same number of attributes."),null;if(l!==g.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let u in g.morphAttributes){if(!o.has(u))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+".  .morphAttributes must be consistent throughout all geometries."),null;i[u]===void 0&&(i[u]=[]),i[u].push(g.morphAttributes[u])}if(a.userData.mergedUserData=a.userData.mergedUserData||[],a.userData.mergedUserData.push(g.userData),e){let u;if(t)u=g.index.count;else if(g.attributes.position!==void 0)u=g.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". The geometry must have either an index or a position attribute"),null;a.addGroup(c,u,h),c+=u}}if(t){let h=0,g=[];for(let p=0;p<n.length;++p){let u=n[p].index;for(let d=0;d<u.count;++d)g.push(u.getX(d)+h);h+=n[p].attributes.position.count}a.setIndex(g)}for(let h in s){let g=XM(s[h]);if(!g)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+h+" attribute."),null;a.setAttribute(h,g)}for(let h in i){let g=i[h][0].length;if(g===0)break;a.morphAttributes=a.morphAttributes||{},a.morphAttributes[h]=[];for(let p=0;p<g;++p){let u=[];for(let f=0;f<i[h].length;++f)u.push(i[h][f][p]);let d=XM(u);if(!d)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+h+" morphAttribute."),null;a.morphAttributes[h].push(d)}}return a}function XM(n){let e,t,r,o=0;for(let l=0;l<n.length;++l){let a=n[l];if(a.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(e===void 0&&(e=a.array.constructor),e!==a.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(t===void 0&&(t=a.itemSize),t!==a.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(r===void 0&&(r=a.normalized),r!==a.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;o+=a.array.length}let s=new e(o),i=0;for(let l=0;l<n.length;++l)s.set(n[l].array,i),i+=n[l].array.length;return new lo(s,t,r)}var xq="position",bu=class{static createIndexIfNone(e){if(!e.index){let t=e.getAttribute(xq);if(t){let r=t.array;e.setIndex(lr.range(r.length/3))}}}};var df=class{static merge(e){if(e.length===0)return;for(let l of e)bu.createIndexIfNone(l);let t=e.map(l=>new Yr(l)),r=t[0].indexedAttributeNames(),o={};for(let l of r){let a={},c=[];for(let g of t){let p=g.points();for(let u of p){c.push(u);let d=u.indexedAttribValue(l);a[d]!=null?a[d]:a[d]=Object.keys(a).length}}let h=Object.keys(a);for(let g of c){let p=g.indexedAttribValue(l),u=a[p];g.setAttribIndex(l,u)}o[l]=h}let s=YM(e),i=new Yr(s);return Object.keys(o).forEach(l=>{let a=o[l];i.setIndexedAttributeValues(l,a)}),s&&delete s.userData.mergedUserData,s}};var A9=class extends ks{_filter_points(e){var t;let r=e[0];if(r){let s=(t=r.geometry().getIndex())==null?void 0:t.array;if(s){let i={};for(let p of e)i[p.index()]=p;let l=[],a=s.length,c,h,g;for(let p=0;p<a;p+=3)c=i[s[p+0]],h=i[s[p+1]],g=i[s[p+2]],c&&h&&g&&(l.push(c),l.push(h),l.push(g));return l}}return[]}_indices_from_points(e,t){let r=t.index;if(r!=null){let o=r.array,s=[],i,l,a,c,h,g;for(let p=0;p<o.length;p+=3)i=o[p+0],l=o[p+1],a=o[p+2],c=e[i],h=e[l],g=e[a],c!=null&&h!=null&&g!=null&&(s.push(c),s.push(h),s.push(g));return s}}};var M9=class extends ks{_filter_points(e){var t;let r=e[0];if(r){let s=(t=r.geometry().getIndex())==null?void 0:t.array;if(s){let i={};for(let g of e)i[g.index()]=g;let l=[],a=s.length,c,h;for(let g=0;g<a;g+=2)c=i[s[g+0]],h=i[s[g+1]],c&&h&&(l.push(c),l.push(h));return l}}return[]}_indices_from_points(e,t){let r=t.index;if(r!=null){let o=r.array,s=[],i,l,a,c;for(let h=0;h<o.length;h+=2)i=o[h],l=o[h+1],a=e[i],c=e[l],a!=null&&c!=null&&(s.push(a),s.push(c));return s}}};var JM="isInstance",KM="indexed_attrib_values",xu=class{constructor(n){this._geometry=n}dispose(){}geometry(){return this._geometry}uuid(){return this._geometry.uuid}boundingBox(){return this._bounding_box=this._bounding_box||this._create_bounding_box()}_create_bounding_box(){if(this._geometry.computeBoundingBox(),this._geometry.boundingBox)return this._geometry.boundingBox}markAsInstance(){this._geometry.userData[JM]=!0}static markedAsInstance(n){return n.userData[JM]===!0}markedAsInstance(){return xu.markedAsInstance(this._geometry)}positionAttribName(){let n="position";return this.markedAsInstance()&&(n="instancePosition"),n}computeVertexNormals(){this._geometry.computeVertexNormals()}userDataAttribs(){return this._geometry.userData[KM]=this._geometry.userData[KM]||{}}indexedAttributeNames(){return Object.keys(this.userDataAttribs()||{})}userDataAttrib(n){return n=$r.remapName(n),this.userDataAttribs()[n]}isAttribIndexed(n){return n=$r.remapName(n),this.userDataAttrib(n)!=null}hasAttrib(n){return n===Tn.POINT_INDEX?!0:(n=$r.remapName(n),this._geometry.attributes[n]!=null)}markAttribAsNeedsUpdate(n){n=$r.remapName(n);let e=this._geometry.attributes[n];e&&(e.needsUpdate=!0)}attribType(n){return this.isAttribIndexed(n)?n0.STRING:n0.NUMERIC}static attribNames(n){return Object.keys(n.attributes)}attribNames(){return xu.attribNames(this._geometry)}static attribNamesMatchingMask(n,e){let t=Rt.attribNames(e),r=[];for(let o of this.attribNames(n))for(let s of t)Rt.matchMask(o,s)&&r.push(o);return lr.uniq(r)}attribSizes(){let n={};for(let e of this.attribNames())n[e]=this._geometry.attributes[e].itemSize;return n}attribSize(n){let e;return n=$r.remapName(n),(e=this._geometry.attributes[n])!=null?e.itemSize:n===Tn.POINT_INDEX?1:0}setIndexedAttributeValues(n,e){this.userDataAttribs()[n]=e}setIndexedAttribute(n,e,t){this.setIndexedAttributeValues(n,e),this._geometry.setAttribute(n,new rl(t,1)),this._geometry.getAttribute(n).needsUpdate=!0}addNumericAttrib(n,e=1,t=0){let r=[],o=!1;if(xe.isNumber(t)){for(let s=0;s<this.pointsCount();s++)for(let i=0;i<e;i++)r.push(t);o=!0}else if(e>1)if(xe.isArray(t)){for(let s=0;s<this.pointsCount();s++)for(let i=0;i<e;i++)r.push(t[i]);o=!0}else{let s=t;if(e==2&&s.x!=null&&s.y!=null){for(let c=0;c<this.pointsCount();c++)r.push(s.x),r.push(s.y);o=!0}let i=t;if(e==3&&i.x!=null&&i.y!=null&&i.z!=null){for(let c=0;c<this.pointsCount();c++)r.push(i.x),r.push(i.y),r.push(i.z);o=!0}let l=t;if(e==3&&l.r!=null&&l.g!=null&&l.b!=null){for(let c=0;c<this.pointsCount();c++)r.push(l.r),r.push(l.g),r.push(l.b);o=!0}let a=t;if(e==4&&a.x!=null&&a.y!=null&&a.z!=null&&a.w!=null){for(let c=0;c<this.pointsCount();c++)r.push(a.x),r.push(a.y),r.push(a.z),r.push(a.w);o=!0}}if(o)this._geometry.setAttribute(n.trim(),new _t(r,e));else throw console.warn(t),`CoreGeometry.add_numeric_attrib error: no other default value allowed for now in add_numeric_attrib (default given: ${t})`}initPositionAttribute(n,e){let t=[];e==null&&(e=new F);for(let r=0;r<n;r++)t.push(e.x),t.push(e.y),t.push(e.z);return this._geometry.setAttribute("position",new _t(t,3))}addAttribute(n,e){switch(e.type()){case n0.STRING:return console.log("TODO: to implement");case n0.NUMERIC:return this.addNumericAttrib(n,e.size())}}renameAttrib(n,e){this.isAttribIndexed(n)&&(this.userDataAttribs()[e]=wn.clone(this.userDataAttribs()[n]),delete this.userDataAttribs()[n]);let t=this._geometry.getAttribute(n);return this._geometry.setAttribute(e.trim(),new _t(t.array,t.itemSize)),this._geometry.deleteAttribute(n)}deleteAttribute(n){return this.isAttribIndexed(n)&&delete this.userDataAttribs()[n],this._geometry.deleteAttribute(n)}clone(){return xu.clone(this._geometry)}static clone(n){let e,t=n.clone();return(e=n.userData)!=null&&(t.userData=wn.cloneDeep(e)),t}pointsCount(){return xu.pointsCount(this._geometry)}static pointsCount(n){let e,t=0,r=new this(n),o="position";if(r.markedAsInstance()&&(o="instancePosition"),(e=n.getAttribute(o))!=null){let s;(s=e.array)!=null&&(t=s.length/3)}return t}points(){return this.pointsFromGeometry()}pointsFromGeometry(){let n=[],e=this._geometry.getAttribute(this.positionAttribName());if(e!=null){let t=e.array.length/3;for(let r=0;r<t;r++){let o=new o0(this,r);n.push(o)}}return n}static geometryFromPoints(n,e){switch(e){case Bo.MESH:return this._mesh_builder.from_points(n);case Bo.POINTS:return this._points_builder.from_points(n);case Bo.LINE_SEGMENTS:return this._lines_segment_builder.from_points(n);case Bo.OBJECT3D:return null;case Bo.GROUP:return null;case Bo.LOD:return null}qr.unreachable(e)}static mergeGeometries(n){return df.merge(n)}static merge_geometries(n){return df.merge(n)}segments(){var n;let e=((n=this.geometry().index)==null?void 0:n.array)||[];return lr.chunk(e,2)}faces(){return this.facesFromGeometry()}facesFromGeometry(){var n;let t=(((n=this.geometry().index)==null?void 0:n.array)||[]).length/3;return lr.range(t).map(r=>new T9(this,r))}},Yr=xu;Yr._mesh_builder=new A9;Yr._points_builder=new E9;Yr._lines_segment_builder=new M9;var ZM="POLY_render_hook",Cq=(n,e,t,r,o,s)=>{},Fs=class{static node(e,t){return e.node(t.name)}static clone(e){let t=e.clone(),r=e.uniforms;return r&&(t.uniforms=ll.clone(r)),t}static add_user_data_render_hook(e,t){e.userData[ZM]=t}static apply_render_hook(e,t){if(t.userData){let r=t.userData[ZM];if(r){e.onBeforeRender=(o,s,i,l,a,c)=>{r(o,s,i,l,a,c,e)};return}}e.onBeforeRender=Cq}static applyCustomMaterials(e,t){let r=t;if(r.customMaterials)for(let o of Object.keys(r.customMaterials)){let s=o,i=r.customMaterials[s];i&&(e[s]=i,i.needsUpdate=!0)}}static assign_custom_uniforms(e,t,r){let o=e;if(o.customMaterials)for(let s of Object.keys(o.customMaterials)){let i=s,l=o.customMaterials[i];l&&(l.uniforms[t].value=r)}}static init_custom_material_uniforms(e,t,r){let o=e;if(o.customMaterials)for(let s of Object.keys(o.customMaterials)){let i=s,l=o.customMaterials[i];l&&(l.uniforms[t]=l.uniforms[t]||r)}}};var N9="name",i0="attributes",Dn=class extends yu{constructor(e,t){super(t);this._object=e,this._object.userData[i0]==null&&(this._object.userData[i0]={})}dispose(){}object(){return this._object}geometry(){return this._object.geometry}coreGeometry(){let e=this.geometry();return e?new Yr(e):null}points(){var e;return((e=this.coreGeometry())==null?void 0:e.points())||[]}pointsFromGroup(e){if(e){let t=Rt.indices(e);if(t){let r=this.points();return lr.compact(t.map(o=>r[o]))}else return[]}else return this.points()}static isInGroup(e,t){let r=e.trim();if(r.length==0)return!0;let o=r.split("="),s=o[0];if(s[0]=="@"){let i=s.substr(1),l=o[1],a=this.attribValue(t,i);return l==a}return!1}computeVertexNormals(){var e;(e=this.coreGeometry())==null||e.computeVertexNormals()}static _convert_array_to_vector(e){switch(e.length){case 1:return e[0];case 2:return new re(e[0],e[1]);case 3:return new F(e[0],e[1],e[2]);case 4:return new kt(e[0],e[1],e[2],e[3])}}static addAttribute(e,t,r){if(xe.isArray(r)&&!this._convert_array_to_vector(r)){let l="attribute_value invalid";throw console.error(l,r),new Error(l)}let o=r,s=e.userData;s[i0]=s[i0]||{},s[i0][t]=o}addAttribute(e,t){Dn.addAttribute(this._object,e,t)}addNumericAttrib(e,t){this.addAttribute(e,t)}setAttribValue(e,t){this.addAttribute(e,t)}addNumericVertexAttrib(e,t,r){var o;r==null&&(r=$r.default_value(t)),(o=this.coreGeometry())==null||o.addNumericAttrib(e,t,r)}attributeNames(){return Object.keys(this._object.userData[i0])}attribNames(){return this.attributeNames()}hasAttrib(e){return this.attributeNames().includes(e)}renameAttrib(e,t){let r=this.attribValue(e);r!=null?(this.addAttribute(t,r),this.deleteAttribute(e)):console.warn(`attribute ${e} not found`)}deleteAttribute(e){delete this._object.userData[i0][e]}static attribValue(e,t,r=0,o){if(t===Tn.OBJECT_INDEX)return r;if(e.userData&&e.userData[i0]){let s=e.userData[i0][t];if(s==null){if(t==N9)return e.name}else if(xe.isArray(s)&&o)return o.fromArray(s),o;return s}if(t==N9)return e.name}static stringAttribValue(e,t,r=0){let o=this.attribValue(e,t,r);if(o!=null)return xe.isString(o)?o:`${o}`}attribValue(e,t){return Dn.attribValue(this._object,e,this._index,t)}stringAttribValue(e){return Dn.stringAttribValue(this._object,e,this._index)}name(){return this.attribValue(N9)}humanType(){return Bs.CONSTRUCTOR_NAMES_BY_CONSTRUCTOR_NAME[this._object.constructor.name]}attribTypes(){let e={};for(let t of this.attribNames()){let r=this.attribType(t);r!=null&&(e[t]=r)}return e}attribType(e){let t=this.attribValue(e);return xe.isString(t)?n0.STRING:n0.NUMERIC}attribSizes(){let e={};for(let t of this.attribNames()){let r=this.attribSize(t);r!=null&&(e[t]=r)}return e}attribSize(e){let t=this.attribValue(e);return t==null?null:$r.attribSizeFromValue(t)}clone(){return Dn.clone(this._object)}static clone(e){let t=e.clone();var r=new Map,o=new Map;return Dn.parallelTraverse(e,t,function(s,i){r.set(i,s),o.set(s,i)}),t.traverse(function(s){let i=r.get(s),l=s;if(l.geometry&&i&&i.geometry){let g=i.geometry;l.geometry=Yr.clone(g);let p=l.geometry;p.userData&&(p.userData=wn.cloneDeep(g.userData))}if(l.material){Fs.applyCustomMaterials(s,l.material);let g=l.material;g.color==null&&(g.color=new Ke(1,1,1))}if(i){i.userData&&(s.userData=wn.cloneDeep(i.userData));let g=i;g.animations&&(s.animations=g.animations.map(u=>u.clone()));let p=s;if(p.isSkinnedMesh){var a=p,c=i,h=c.skeleton.bones;a.skeleton=c.skeleton.clone(),a.bindMatrix.copy(c.bindMatrix);let u=h.map(function(d){return o.get(d)});a.skeleton.bones=u,a.bind(a.skeleton,a.bindMatrix)}}}),t}static parallelTraverse(e,t,r){r(e,t);for(var o=0;o<e.children.length;o++)this.parallelTraverse(e.children[o],t.children[o],r)}};var S9=class extends Wr{coreContentCloned(){if(this._content)return this._content.clone()}set_content(e){super.set_content(e)}firstObject(){if(this._content)return this._content.objects()[0]}firstCoreObject(){let e=this.firstObject();if(e)return new Dn(e,0)}firstGeometry(){let e=this.firstObject();return e?e.geometry:null}objectsCount(){return this._content?this._content.objects().length:0}objectsVisibleCount(){let e=0;if(this._content){let t=this._content.objects();for(let r of t)r.visible&&e++}return e}objectsCountByType(){let e={},t=this._content;if(this._content&&t)for(let r of t.coreObjects()){let o=r.humanType();e[o]==null&&(e[o]=0),e[o]+=1}return e}objectsNamesByType(){let e={},t=this._content;if(this._content&&t)for(let r of t.coreObjects()){let o=r.humanType();e[o]=e[o]||[],e[o].push(r.name())}return e}pointAttributeNames(){let e=[],t=this.firstGeometry();return t&&(e=Object.keys(t.attributes)),e}pointAttributeSizesByName(){let e={},t=this.firstGeometry();return t&&Object.keys(t.attributes).forEach(r=>{let o=t.attributes[r];e[r]=o.itemSize}),e}objectAttributeSizesByName(){let e={},t=this.firstCoreObject();if(t){let r=t.attribNames();for(let o of r){let s=t.attribSize(o);s!=null&&(e[o]=s)}}return e}pointAttributeTypesByName(){let e={},t=this.firstGeometry();if(t){let r=new Yr(t);Object.keys(t.attributes).forEach(o=>{e[o]=r.attribType(o)})}return e}objectAttributeTypesByName(){let e={},t=this.firstCoreObject();if(t)for(let r of t.attribNames())e[r]=t.attribType(r);return e}objectAttributeNames(){let e=[],t=this.firstObject();return t&&(e=Object.keys(t.userData.attributes||{})),e}pointsCount(){return this._content?this._content.pointsCount():0}totalPointsCount(){return this._content?this._content.totalPointsCount():0}objectsData(){return this._content?this._content.objectsData():[]}boundingBox(e=!1){return this._content.boundingBox(e)}center(){return this._content.center()}size(){return this._content.size()}};var P9=class extends Wr{object(){return this._content}};var O9=class extends Wr{object(){return this._content}};var w9=class extends Wr{set_content(e){super.set_content(e)}};var R9=class extends Wr{set_content(e){super.set_content(e)}set_material(e){this._content!=null&&this._content.dispose(),this.set_content(e)}has_material(){return this.has_content()}material(){return this.content()}};var L9=class extends Wr{set_content(e){super.set_content(e)}set_object(e){return this.set_content(e)}has_object(){return this.has_content()}object(){return this.content()}};var I9=class extends Wr{set_content(e){super.set_content(e)}texture(){return this._content}coreContent(){return this._content}coreContentCloned(){var e;let t=(e=this._content)==null?void 0:e.clone();return t&&(t.needsUpdate=!0),t}object(){return this.texture()}infos(){if(this._content!=null)return[this._content]}resolution(){if(this._content){let e=this._content.image;if(e){if(e instanceof HTMLImageElement||e instanceof Image||e instanceof ImageData||e instanceof HTMLCanvasElement)return[e.width,e.height];if(e.data&&e.width!=null&&e.height!=null)return[e.width,e.height];let t=e;return[t.videoWidth,t.videoHeight]}}return[-1,-1]}};var D9=class extends Wr{set_content(e){super.set_content(e)}render_pass(){return this._content}object(e={}){return this.render_pass()}};var B9=class extends Wr{set_content(e){super.set_content(e)}renderer(){return this._content}};var QM={[it.ANIM]:y9,[it.AUDIO]:b9,[it.COP]:I9,[it.EVENT]:x9,[it.GL]:P9,[it.JS]:O9,[it.MANAGER]:w9,[it.MAT]:R9,[it.OBJ]:L9,[it.POST]:D9,[it.ROP]:B9,[it.SOP]:S9};var k9=class{constructor(e){this.node=e,this._callbacks=[],this._callbacks_tmp=[];let t=QM[e.context()];this._container=new t(this.node)}container(){return this._container}containerUnlessBypassed(){var e,t;if((t=(e=this.node.flags)==null?void 0:e.bypass)==null?void 0:t.active()){let r=this.node.io.inputs.input(0);if(r)return r.containerController.containerUnlessBypassed()}else return this.container()}async compute(){var e,t;if((t=(e=this.node.flags)==null?void 0:e.bypass)==null?void 0:t.active()){let r=await this.requestInputContainer(0)||this._container;return this.node.cookController.endCook(),r}return this.node.isDirty()?new Promise((r,o)=>{var s,i;if(this._callbacks.push(r),(i=(s=this.node.flags)==null?void 0:s.bypass)==null?void 0:i.active())throw"we should not be here";this.node.cookController.cookMain()}):this._container}async requestInputContainer(e){let t=this.node.io.inputs.input(e);return t?await t.compute():(this.node.states.error.set(`input ${e} required`),this.notifyRequesters(),null)}notifyRequesters(e){this._callbacks_tmp=this._callbacks.slice(),this._callbacks.splice(0,this._callbacks.length),e||(e=this.node.containerController.container());let t;for(;t=this._callbacks_tmp.pop();)t(e);this.node.scene().cookController.removeNode(this.node)}};var Rl=Fe.performance.performanceManager(),F9=class{constructor(e){this.cookController=e,this._inputsStart=0,this._inputsTime=0,this._paramsStart=0,this._paramsTime=0,this._cookStart=0,this._cookTime=0,this._cooksCount=0,this._data={inputsTime:0,paramsTime:0,cookTime:0}}cooksCount(){return this._cooksCount}data(){return this._data.inputsTime=this._inputsTime,this._data.paramsTime=this._paramsTime,this._data.cookTime=this._cookTime,this._data}active(){return this.cookController.performanceRecordStarted()}recordInputsStart(){this.active()&&(this._inputsStart=Rl.now())}recordInputsEnd(){this.active()&&(this._inputsTime=Rl.now()-this._inputsStart)}recordParamsStart(){this.active()&&(this._paramsStart=Rl.now())}recordParamsEnd(){this.active()&&(this._paramsTime=Rl.now()-this._paramsStart)}recordCookStart(){this.active()&&(this._cookStart=Rl.now())}recordCookEnd(){this.active()&&(this._cookTime=Rl.now()-this._cookStart,this._cooksCount+=1)}};var G9=class{constructor(e){this.node=e,this._cooking=!1,this._performanceController=new F9(this),this._inputsEvaluationRequired=!0,this._corePerformance=this.node.scene().performance}performanceRecordStarted(){return this._corePerformance.started()}dispose(){this._clearHooks()}disallowInputsEvaluation(){this._inputsEvaluationRequired=!1}isCooking(){return this._cooking===!0}_startCookIfNoErrors(e){if(this.node.states.error.active())this.endCook();else try{this._performanceController.recordCookStart(),this.node.cook(e||[])}catch(t){this.node.states.error.set(`node internal error: '${t}'.`),Fe.warn(t),this.endCook()}}async cookMain(){if(this.isCooking())return;this._initCookingState(),this.node.states.error.clear(),this.node.scene().cookController.addNode(this.node);let e=this._inputsEvaluationRequired?await this._evaluateInputs():void 0;this.node.params.paramsEvalRequired()&&await this._evaluateParams(),this._startCookIfNoErrors(e)}async cookMainWithoutInputs(){if(this.node.scene().cookController.addNode(this.node),this.isCooking()){Fe.warn("cook_main_without_inputs already cooking",this.node.path());return}this._initCookingState(),this.node.states.error.clear(),this.node.params.paramsEvalRequired()&&await this._evaluateParams(),this._startCookIfNoErrors(void 0)}endCook(e){var t,r;this._finalizeCookPerformance();let o=this.node.dirtyController.dirtyTimestamp();if(o==null||o===this._cookingDirtyTimestamp)this.node.removeDirtyState(),this._terminateCookProcess();else{if((r=(t=this.node.flags)==null?void 0:t.bypass)==null?void 0:r.active())return;Fe.log("COOK AGAIN",o,this._cookingDirtyTimestamp,this.node.path()),this._cooking=!1,this.cookMain()}}_initCookingState(){this._cooking=!0,this._cookingDirtyTimestamp=this.node.dirtyController.dirtyTimestamp()}_terminateCookProcess(){this.isCooking()&&(this._cooking=!1,this.node.containerController.notifyRequesters(),this._run_on_cook_complete_hooks())}async _evaluateInputs(){this._performanceController.recordInputsStart();let e=this.node.io.inputs,t=this._inputsEvaluationRequired?e.isAnyInputDirty()?await e.evalRequiredInputs():e.containersWithoutEvaluation():[],r=e.inputs(),o=[],s;for(let i=0;i<r.length;i++)s=t[i],s&&(e.cloneRequired(i)?o[i]=s.coreContentCloned():o[i]=s.coreContent());return this._performanceController.recordInputsEnd(),o}async _evaluateParams(){this._performanceController.recordParamsStart(),await this.node.params.evalAll(),this._performanceController.recordParamsEnd()}cooksCount(){return this._performanceController.cooksCount()}cookTime(){return this._performanceController.data().cookTime}_finalizeCookPerformance(){!this._corePerformance.started()||(this._performanceController.recordCookEnd(),this._corePerformance.recordNodeCookData(this.node,this._performanceController.data()))}registerOnCookEnd(e,t){this._on_cook_complete_hook_names=this._on_cook_complete_hook_names||[],this._on_cook_complete_hooks=this._on_cook_complete_hooks||[],this._on_cook_complete_hook_names.push(e),this._on_cook_complete_hooks.push(t)}_clearHooks(){if(!(!this._on_cook_complete_hook_names||!this._on_cook_complete_hooks))for(let e of this._on_cook_complete_hook_names)this.deregisterOnCookEnd(e)}deregisterOnCookEnd(e){var t;if(!this._on_cook_complete_hook_names||!this._on_cook_complete_hooks)return;let r=(t=this._on_cook_complete_hook_names)==null?void 0:t.indexOf(e);this._on_cook_complete_hook_names.splice(r,1),this._on_cook_complete_hooks.splice(r,1),this._on_cook_complete_hook_names.length==0&&(this._on_cook_complete_hook_names=void 0),this._on_cook_complete_hooks.length==0&&(this._on_cook_complete_hooks=void 0)}_run_on_cook_complete_hooks(){if(this._on_cook_complete_hooks)for(let e of this._on_cook_complete_hooks)e()}onCookEndCallbackNames(){return this._on_cook_complete_hook_names}};var Cu=class{constructor(e){this.node=e}dispose(){}toJSON(e=!1){var t,r,o,s,i,l;let a={name:this.node.name(),type:this.node.type(),graph_node_id:this.node.graphNodeId(),is_dirty:this.node.isDirty(),ui_data_json:this.node.uiData.toJSON(),error_message:this.node.states.error.message(),children:this.childrenIds(),maxInputsCount:this.maxInputsCount(),inputs:this.inputIds(),input_connection_output_indices:this.inputConnectionOutputIndices(),named_input_connection_points:this.namedInputConnectionPoints(),named_output_connection_points:this.namedOutputConnectionPoints(),param_ids:this.to_json_params(e),override_cloned_state_allowed:this.node.io.inputs.overrideClonedStateAllowed(),inputs_clone_required_states:this.node.io.inputs.cloneRequiredStates(),flags:{display:(r=(t=this.node.flags)==null?void 0:t.display)==null?void 0:r.active(),bypass:(s=(o=this.node.flags)==null?void 0:o.bypass)==null?void 0:s.active(),optimize:(l=(i=this.node.flags)==null?void 0:i.optimize)==null?void 0:l.active()},selection:void 0};return this.node.childrenAllowed()&&this.node.childrenController&&(a.selection=this.node.childrenController.selection.toJSON()),a}childrenIds(){return this.node.children().map(e=>e.graphNodeId())}maxInputsCount(){return this.node.io.inputs.maxInputsCount()}inputIds(){return this.node.io.inputs.inputs().map(e=>e!=null?e.graphNodeId():void 0)}inputConnectionOutputIndices(){var e;return(e=this.node.io.connections.inputConnections())==null?void 0:e.map(t=>t!=null?t.output_index:void 0)}namedInputConnectionPoints(){return this.node.io.inputs.namedInputConnectionPoints().map(e=>e.toJSON())}namedOutputConnectionPoints(){return this.node.io.outputs.namedOutputConnectionPoints().map(e=>e.toJSON())}to_json_params_from_names(e,t=!1){return e.map(r=>this.node.params.get(r).graphNodeId())}to_json_params(e=!1){return this.to_json_params_from_names(this.node.params.names,e)}};var Te=(n=>(n.BOOLEAN="boolean",n.BUTTON="button",n.COLOR="color",n.FLOAT="float",n.FOLDER="folder",n.INTEGER="integer",n.PARAM_PATH="param_path",n.NODE_PATH="node_path",n.RAMP="ramp",n.STRING="string",n.VECTOR2="vector2",n.VECTOR3="vector3",n.VECTOR4="vector4",n))(Te||{});var Xr=(n=>(n.VISIBLE_UPDATED="param_visible_updated",n.RAW_INPUT_UPDATED="raw_input_updated",n.VALUE_UPDATED="param_value_updated",n.EXPRESSION_UPDATED="param_expression_update",n.ERROR_UPDATED="param_error_updated",n.DELETED="param_deleted",n))(Xr||{});var ff="callback",U9="callbackString",Tq="computeOnDirty",Eq="cook",Aq="fileBrowse",Mq="type",Nq="expression",Sq="forEntities",Pq="label",Oq="level",wq="menu",Rq="menuString",Lq="entries",Iq="multiline",Dq="language",Bq="nodeSelection",kq="context",Fq="types",eN="dependentOnFoundNode",Gq="range",Uq="rangeLocked",Vq="step",zq="spare",Hq="texture",jq="env",tN="hidden",qq="field",V9="visibleIf",Wq="conversion",$q="separatorBefore",Yq="separatorAfter",Xq="joinToPreviousParam",Jq="editable";var z9=(n=>(n.AUDIO="audio",n.TEXTURE_IMAGE="texture_image",n.TEXTURE_VIDEO="texture_video",n.GEOMETRY="geometry",n.FONT="font",n.SVG="svg",n.JSON="json",n))(z9||{}),mf=class{constructor(e){this._param=e,this._programatic_visible_state=!0,this._callbackAllowed=!1,this._updateVisibilityAndRemoveDirtyBound=this.updateVisibilityAndRemoveDirty.bind(this),this._ui_data_dependency_set=!1}dispose(){var e;try{this._options[ff]=void 0,this._options[U9]=void 0}catch{}(e=this._visibility_graph_node)==null||e.dispose()}set(e){this._default_options=e,this._options=wn.cloneDeep(this._default_options),this.post_set_options()}copy(e){this._default_options=wn.cloneDeep(e.default()),this._options=wn.cloneDeep(e.current()),this.post_set_options()}setOption(e,t){if(this._options[e]=t,this._param.components)for(let r of this._param.components)r.options.setOption(e,t)}post_set_options(){this._handleComputeOnDirty()}param(){return this._param}node(){return this._param.node}default(){return this._default_options}current(){return this._options}hasOptionsOverridden(){return!wn.isEqual(this._options,this._default_options)}overriddenOptions(){let e={},t=Object.keys(this._options);for(let r of t)if(!wn.isEqual(this._options[r],this._default_options[r])){let o=wn.cloneDeep(this._options[r]);Object.assign(e,{[r]:o})}return e}overriddenOptionNames(){return Object.keys(this.overriddenOptions())}computeOnDirty(){return this._options[Tq]||!1}_handleComputeOnDirty(){this.computeOnDirty()&&(this._computeOnDirty_callback_added||(this.param().addPostDirtyHook("computeOnDirty",this._computeParam.bind(this)),this._computeOnDirty_callback_added=!0))}async _computeParam(){await this.param().compute()}hasCallback(){return this._options[ff]!=null||this._options[U9]!=null}allowCallback(){this._callbackAllowed=!0}executeCallback(){if(!this._callbackAllowed||!this.node())return;let e=this.getCallback();if(!e||!this.node().scene().loadingController.loaded())return;let t=this.param().parentParam();t?t.options.executeCallback():e(this.node(),this.param())}getCallback(){if(this.hasCallback())return this._options[ff]=this._options[ff]||this.createCallbackFromString()}createCallbackFromString(){let e=this._options[U9];if(e){let t=new Function("node","scene","window","location",e);return()=>{t(this.node(),this.node().scene(),null,null)}}}colorConversion(){return this._options[Wq]}makesNodeDirtyWhenDirty(){if(this.param().parentParam()!=null)return!1;let e=this._options[Eq];return e??!0}fileBrowseOption(){return this._options[Aq]}fileBrowseAllowed(){return this.fileBrowseOption()!=null}fileBrowseType(){let e=this.fileBrowseOption();return e?e[Mq]:null}separatorBefore(){return this._options[$q]}separatorAfter(){return this._options[Yq]}joinToPreviousParam(){return this._options[Xq]}editable(){let e=this._options[Jq];return e??!0}isExpressionForEntities(){let e=this._options[Nq];return e&&e[Sq]||!1}level(){return this._options[Oq]||0}hasMenu(){return this.menuOptions()!=null||this.menuStringOptions()!=null}menuOptions(){return this._options[wq]}menuStringOptions(){return this._options[Rq]}menuEntries(){let e=this.menuOptions()||this.menuStringOptions();return e?e[Lq]:[]}isMultiline(){return this._options[Iq]===!0}language(){return this._options[Dq]}isCode(){return this.language()!=null}nodeSelectionOptions(){return this._options[Bq]}nodeSelectionContext(){let e=this.nodeSelectionOptions();if(e)return e[kq]}nodeSelectionTypes(){let e=this.nodeSelectionOptions();if(e)return e[Fq]}dependentOnFoundNode(){return eN in this._options?this._options[eN]:!0}isSelectingParam(){return this.param().type()==Te.PARAM_PATH}range(){return this._options[Gq]||[0,1]}step(){return this._options[Vq]}rangeLocked(){return this._options[Uq]||[!1,!1]}ensureInRange(e){let t=this.range();return e>=t[0]&&e<=t[1]?e:e<t[0]?this.rangeLocked()[0]===!0?t[0]:e:this.rangeLocked()[1]===!0?t[1]:e}isSpare(){return this._options[zq]||!1}textureOptions(){return this._options[Hq]}textureAsEnv(){let e=this.textureOptions();return e!=null?e[jq]===!0:!1}isHidden(){return this._options[tN]===!0||this._programatic_visible_state===!1}isVisible(){return!this.isHidden()}setVisibleState(e){this._options[tN]=!e,this.param().emit(Xr.VISIBLE_UPDATED)}label(){return this._options[Pq]}isLabelHidden(){let e=this.param().type();return e===Te.BUTTON||e===Te.BOOLEAN&&this.isFieldHidden()}isFieldHidden(){return this._options[qq]===!1}uiDataDependsOnOtherParams(){return V9 in this._options}visibilityPredecessors(){let e=this._options[V9];if(!e)return[];let t=[];xe.isArray(e)?t=lr.uniq(e.map(o=>Object.keys(o)).flat()):t=Object.keys(e);let r=this.param().node;return lr.compact(t.map(o=>{let s=r.params.get(o);if(s)return s;console.error(`param ${o} not found as visibility condition for ${this.param().name()} in node ${this.param().node.type()}`)}))}setUiDataDependency(){if(this._ui_data_dependency_set)return;this._ui_data_dependency_set=!0;let e=this.visibilityPredecessors();if(e.length>0){this._visibility_graph_node=new zr(this.param().scene(),"param_visibility");for(let t of e)this._visibility_graph_node.addGraphInput(t);this._visibility_graph_node.addPostDirtyHook("_update_visibility_and_remove_dirty",this._updateVisibilityAndRemoveDirtyBound)}}updateVisibilityAndRemoveDirty(){this.updateVisibility(),this.param().removeDirtyState()}async updateVisibility(){let e=this._options[V9];if(e){let t=this.visibilityPredecessors(),r=t.map(o=>{if(o.isDirty())return o.compute()});if(this._programatic_visible_state=!1,await Promise.all(r),xe.isArray(e))for(let o of e)t.filter(i=>i.value==o[i.name()]).length==t.length&&(this._programatic_visible_state=!0);else{let o=t.filter(s=>s.value==e[s.name()]);this._programatic_visible_state=o.length==t.length}this.param().emit(Xr.VISIBLE_UPDATED)}}};var hf=class{constructor(e){this.param=e,this._blockedEmit=!1,this._blockedParentEmit=!1,this._countByEventName=new Map}emitAllowed(){return this._blockedEmit===!0||this.param.scene().loadingController.isLoading()?!1:this.param.scene().dispatchController.emitAllowed()}blockEmit(){if(this._blockedEmit=!0,this.param.isMultiple()&&this.param.components)for(let e of this.param.components)e.emitController.blockEmit();return!0}unblockEmit(){if(this._blockedEmit=!1,this.param.isMultiple()&&this.param.components)for(let e of this.param.components)e.emitController.unblockEmit();return!0}blockParentEmit(){return this._blockedParentEmit=!0,!0}unblockParentEmit(){return this._blockedParentEmit=!1,!0}incrementCount(e){let t=(this._countByEventName.get(e)||0)+1;this._countByEventName.set(e,t)}eventsCount(e){return this._countByEventName.get(e)||0}emit(e){if(this.emitAllowed()){this.param.emit(e);let t=this.param.parentParam();t!=null&&this._blockedParentEmit!==!0&&t.emit(e)}}};var H9=class{constructor(e){this.param=e}toJSON(){let e={name:this.param.name(),type:this.param.type(),raw_input:this.rawInput(),value:this.value(),value_pre_conversion:this.value_pre_conversion(),expression:this.expression(),graph_node_id:this.param.graphNodeId(),error_message:this.error_message(),is_visible:this.is_visible(),components:void 0};return this.param.isMultiple()&&this.param.components&&(e.components=this.param.components.map(t=>t.graphNodeId())),e}rawInput(){return this.param.rawInputSerialized()}value(){return this.param.valueSerialized()}value_pre_conversion(){return this.param.valuePreConversionSerialized()}expression(){var e;return this.param.hasExpression()?(e=this.param.expressionController)==null?void 0:e.expression():void 0}error_message(){return this.param.states.error.message()}is_visible(){return this.param.options.isVisible()}};var j9=class{constructor(e){this.param=e}active(){let e=this.param.scene().timeController.graphNode.graphNodeId();return this.param.graphPredecessorIds().includes(e)}};var q9=class{constructor(e){this.param=e}set(e){this._message!=e&&(this._message=e,this._message&&Fe.warn(this.param.path(),this._message),this.param.emitController.emit(Xr.ERROR_UPDATED))}message(){return this._message}clear(){this.set(void 0)}active(){return this._message!=null}};var W9=class{constructor(e){this.param=e,this.timeDependent=new j9(this.param),this.error=new q9(this.param)}};var Gs=class extends zr{constructor(e,t,r){super(e.scene(),"MethodDependency");this.param=e,this.path_argument=t,this.decomposed_path=r,this._update_from_name_change_bound=this._update_from_name_change.bind(this);var o;(o=e.expressionController)==null||o.registerMethodDependency(this),this.addPostDirtyHook("_update_from_name_change",this._update_from_name_change_bound)}_update_from_name_change(e){if(e&&this.decomposed_path){let t=e;this.decomposed_path.update_from_name_change(t);let r=this.decomposed_path.to_path(),o=this.jsep_node;o&&(o.value=`${o.value}`.replace(`${this.path_argument}`,r),o.raw=o.raw.replace(`${this.path_argument}`,r)),this.param.expressionController&&this.param.expressionController.updateFromMethodDependencyNameChange()}}reset(){this.graphDisconnectPredecessors()}listen_for_name_changes(){if(this.jsep_node&&this.decomposed_path){for(let e of this.decomposed_path.named_nodes())if(e){let t=e;t.nameController&&this.addGraphInput(t.nameController.graph_node)}}}set_jsep_node(e){this.jsep_node=e}set_resolved_graph_node(e){this.resolved_graph_node=e}set_unresolved_path(e){this.unresolved_path=e}static create(e,t,r,o){let s=xe.isNumber(t),i=new Gs(e,t,o);if(r)i.set_resolved_graph_node(r);else if(!s){let l=t;i.set_unresolved_path(l)}return i}};var Kq=[],ro=class extends zr{constructor(e,t){super(e,"BaseParam");this._options=new mf(this),this._emit_controller=new hf(this),this._isComputing=!1,this._node=t,this._initializeParam()}get options(){return this._options=this._options||new mf(this)}get emitController(){return this._emit_controller=this._emit_controller||new hf(this)}get expressionController(){return this._expression_controller}get serializer(){return this._serializer=this._serializer||new H9(this)}get states(){return this._states=this._states||new W9(this)}dispose(){var e,t;let r=this.graphPredecessors();for(let s of r)s instanceof Gs&&s.dispose();let o=this.graphSuccessors();for(let s of o)if(s instanceof ro){let i=s.rawInputSerialized();s.set(s.defaultValue()),s.set(i)}else s.setDirty();this.scene().missingExpressionReferencesController.deregisterParam(this),(e=this._expression_controller)==null||e.dispose(),super.dispose(),(t=this._options)==null||t.dispose()}_initializeParam(){}static type(){return Te.FLOAT}type(){return this.constructor.type()}isNumeric(){return!1}setName(e){super.setName(e)}get value(){return this._value}copyValue(e){e.type()==this.type()?this._copyValue(e):console.warn(`cannot copy value from ${e.type()} to ${this.type()}`)}_copyValue(e){throw"abstract method param._copy_value"}valuePreConversionSerialized(){}convert(e){return null}static areRawInputEqual(e,t){return!1}isRawInputEqual(e){return this.constructor.areRawInputEqual(this._raw_input,e)}static areValuesEqual(e,t){return!1}isValueEqual(e){return this.constructor.areValuesEqual(this.value,e)}_cloneRawInput(e){return e}set(e){this._raw_input=this._cloneRawInput(this._prefilterInvalidRawInput(e)),this.emitController.emit(Xr.RAW_INPUT_UPDATED),this.processRawInput()}_prefilterInvalidRawInput(e){return e}defaultValue(){return this._default_value}isDefault(){return this._raw_input==this._default_value}rawInput(){return this._raw_input}processRawInput(){}async compute(){if(this.scene().loadingController.isLoading()&&Fe.warn(`param attempt to compute ${this.path()} while scene is loading`),this.isDirty()){if(this._isComputing)return new Promise((e,t)=>{this._computeResolves=this._computeResolves||[],this._computeResolves.push(e)});if(this._isComputing=!0,await this.processComputation(),this._isComputing=!1,this._computeResolves){let e=[...this._computeResolves];this._computeResolves=[];for(let t of e)t()}}}async processComputation(){}setInitValue(e){this._default_value=this._cloneRawInput(this._prefilterInvalidRawInput(e))}_setupNodeDependencies(e){var t,r;if(e?(this.options.allowCallback(),this.parentParam()||(this.options.makesNodeDirtyWhenDirty()?(r=e.params.params_node)==null||r.addGraphInput(this,!1):this.dirtyController.addPostDirtyHook("run callback",async()=>{await this.compute(),this.options.executeCallback()}))):this._node&&((t=this._node.params.params_node)==null||t.removeGraphInput(this)),this.components)for(let o of this.components)o._setupNodeDependencies(e)}get node(){return this._node}parent(){return this.node}set_parent_param(e){e.addGraphInput(this,!1),this._parent_param=e}parentParam(){return this._parent_param}has_parent_param(){return this._parent_param!=null}path(){var e;return((e=this.node)==null?void 0:e.path())+"/"+this.name()}pathRelativeTo(e){let t=hr.relativePath(e,this.node);return t.length>0?`${t}${hr.SEPARATOR}${this.name()}`:this.name()}emit(e){this.emitController.emitAllowed()&&(this.emitController.incrementCount(e),this.scene().dispatchController.dispatch(this,e))}get components(){return this._components}componentNames(){return Kq}isMultiple(){return this.componentNames().length>0}initComponents(){}hasExpression(){return this.expressionController!=null&&this.expressionController.active()}toJSON(){return this.serializer.toJSON()}};var Eu=Zi($9());Eu.default.addUnaryOp("@");var Zq=10;Eu.default.addBinaryOp("**",Zq);var Qq="Identifier",eW="Literal",tW="CallExpression",rW="`",$0=class{constructor(){}parse_expression(e){try{this.reset(),this.node=(0,Eu.default)(e)}catch(t){let r=`could not parse the expression '${e}' (error: ${t})`;this.error_message=r}}parse_expression_for_string_param(e){try{this.reset();let t=$0.string_value_elements(e),r=[];for(let o=0;o<t.length;o++){let s=t[o],i;if(o%2==1)i=(0,Eu.default)(s);else{let l=s.replace(/\'/g,"\\'");i={type:eW,value:`'${l}'`,raw:`'${l}'`}}r.push(i)}this.node={type:tW,arguments:r,callee:{type:Qq,name:"strConcat"}}}catch(t){let r=`could not parse the expression '${e}' (error: ${t})`;this.error_message=r}}static string_value_elements(e){return e!=null?xe.isString(e)?e.split(rW):[]:[]}reset(){this.node=void 0,this.error_message=void 0}};var Y9=class{static if(e){let t=e[0],r=e[1],o=e[2];return`(${t}) ? (${r}) : (${o})`}};var X9="$",Au=class{constructor(e){this.param=e,this._set_error_from_error_bound=this._set_error_from_error.bind(this)}clear_error(){this._error_message=void 0}set_error(e){this._error_message=this._error_message||e}_set_error_from_error(e){xe.isString(e)?this._error_message=e:this._error_message=e.message}is_errored(){return this._error_message!=null}error_message(){return this._error_message}reset(){this._error_message=void 0}traverse_node(e){let t=`traverse_${e.type}`;if(this[t])return this[t](e);this.set_error(`expression unknown node type: ${e.type}`)}traverse_BinaryExpression(e){return`${this.traverse_node(e.left)} ${e.operator} ${this.traverse_node(e.right)}`}traverse_LogicalExpression(e){return`${this.traverse_node(e.left)} ${e.operator} ${this.traverse_node(e.right)}`}traverse_MemberExpression(e){return`${this.traverse_node(e.object)}.${this.traverse_node(e.property)}`}traverse_ConditionalExpression(e){return`(${this.traverse_node(e.test)}) ? (${this.traverse_node(e.consequent)}) : (${this.traverse_node(e.alternate)})`}traverse_Compound(e){let t=e.body,r=[];for(let o=0;o<t.length;o++){let s=t[o];s.type=="Identifier"?s.name[0]==X9?r.push("`${"+this.traverse_node(s)+"}`"):r.push(`'${s.name}'`):r.push("`${"+this.traverse_node(s)+"}`")}return r.join(" + ")}traverse_Literal(e){return`${e.raw}`}};var rN="coreGeometry",ui=class{constructor(){}reset(){this._attributeNames&&this._attributeNames.clear()}assignAttributesLines(){if(this._attributeNames){let e=[];for(let t of this._attributeNames)e.push(ui.assignAttributeLine(t));return e.join(`;
`)}else return""}assignArraysLines(){if(this._attributeNames){let e=[];if(this._attributeNames.size>0){let t=`const ${rN} = entities[0].coreGeometry();`;e.push(t)}for(let t of this._attributeNames)e.push(ui.assignItemSizeLine(t)),e.push(ui.assignArrayLine(t));return e.join(`;
`)}else return""}attributePresenceCheckLine(){if(this._attributeNames){let e=[];for(let t of this._attributeNames){let r=ui._varAttribute(t);e.push(r)}if(e.length>0)return e.join(" && ")}return"true"}add(e){this._attributeNames=this._attributeNames||new Set,this._attributeNames.add(e)}static assignAttributeLine(e){return`const ${this._varAttribute(e)} = getEntitiesAttribute(entities,'${e}')`}static assignItemSizeLine(e){let t=this._varAttribute(e);return`const ${this._varAttribSize(e)} = ${t}.itemSize`}static assignArrayLine(e){let t=this._varAttribute(e),r=this._varArray(e),o=`${rN}.isAttribIndexed('${e}')`,s=`entities.map(e=>e.indexedAttribValue('${e}'))`,i=`${t}.array`;return`const ${r} = ${o} ? ${s} : ${i}`}static _varAttribute(e){return`attrib_${e}`}static _varAttribSize(e){return`attrib_size_${e}`}static _varArray(e){return`array_${e}`}varAttributeSize(e){return ui._varAttribSize(e)}varArray(e){return ui._varArray(e)}};var nW=["abs","acos","acosh","asin","asinh","atan","atan2","atanh","ceil","cos","cosh","exp","expm1","floor","log","log1p","log2","log10","max","min","pow","round","sign","sin","sinh","sqrt","tan","tanh"],oW=["cbrt","hypot","log10","trunc"],nN={math_random:"random"},iW=["fit","fit01","fract","deg2rad","rad2deg","rand","clamp"],sW=Object.keys(pf),aW=["precision"],lW=["E","LN2","LN10","LOG10E","LOG2E","PI","SQRT1_2","SQRT2"],Us={};nW.forEach(n=>{Us[n]=`Math.${n}`});oW.forEach(n=>{Us[n]=`Math.${n}`});Object.keys(nN).forEach(n=>{let e=nN[n];Us[n]=`Math.${e}`});iW.forEach(n=>{Us[n]=`Core.Math.${n}`});sW.forEach(n=>{Us[n]=`Core.Math.Easing.${n}`});aW.forEach(n=>{Us[n]=`Core.String.${n}`});var cW={if:Y9.if},oN={};lW.forEach(n=>{oN[n]=`Math.${n}`});var Ll="'",iN=", ",uW="@",pW={x:0,y:1,z:2,w:3,r:0,g:1,b:2},dW={Math:ci,String:Rt},J9=class extends Au{constructor(e){super(e);this.param=e,this._attribute_requirements_controller=new ui,this.methods=[],this.method_index=-1,this.methodDependencies=[],this.immutableDependencies=[]}parse_tree(e){if(this.reset(),e.error_message==null){try{if(this._attribute_requirements_controller=new ui,e.node){let t=this.traverse_node(e.node);t&&!this.is_errored()&&(this.function_main_string=t)}else console.warn("no parsed_tree.node")}catch(t){console.warn(`error in expression for param ${this.param.path()}`),console.warn(t)}if(this.function_main_string)try{let t=this._functionBody();this.function=new Function("CorePoint","Core","param","methods","_set_error_from_error",`
					try {
						${t}
					} catch(e) {
						_set_error_from_error(e)
						return null;
					}`)}catch(t){console.warn(t),this.set_error("cannot generate function")}else this.set_error("cannot generate function body")}else this.set_error("cannot parse expression")}reset(){super.reset(),this.function_main_string=void 0,this.methods=[],this.method_index=-1,this.function=void 0,this.methodDependencies=[],this.immutableDependencies=[]}_functionBody(){return this.param.options.isExpressionForEntities()?`
			const entities = param.expressionController.entities();
			function getEntitiesAttribute(entities, attribName){
				const firstEntity = entities[0];
				if(firstEntity instanceof CorePoint){
					return firstEntity.geometry().attributes[attribName];
				} else {
					return entities.map(e=>e.attribValue(attribName));
				}
			}
			function getCorePointAttribValue(entity, attribName, array, attributeSize, propertyOffset){
				return array[entity.index()*attributeSize+propertyOffset];
			}
			function getCoreObjectAttribValue(entity, attribName, array, attributeSize, propertyOffset){
				return entity.attribValue(attribName)
			}
			if(entities){
				return new Promise( async (resolve, reject)=>{
					let entity;
					const entityCallback = param.expressionController.entityCallback();
					// assign_attributes_lines
					${this._attribute_requirements_controller.assignAttributesLines()}
					// check if attributes are present
					if( ${this._attribute_requirements_controller.attributePresenceCheckLine()} ){
						// assign function
						const getEntityAttribValue = (entities[0] instanceof CorePoint) ? getCorePointAttribValue : getCoreObjectAttribValue;
						// assign_arrays_lines
						${this._attribute_requirements_controller.assignArraysLines()}
						for(let index=0; index < entities.length; index++){
							entity = entities[index];
							result = ${this.function_main_string};
							entityCallback(entity, result);
						}
						resolve()
					} else {
						const error = new Error('attribute not found')
						_set_error_from_error(error)
						reject(error)
					}
				})
			}
			return []`:`
			return new Promise( async (resolve, reject)=>{
				try {
					const value = ${this.function_main_string}
					resolve(value)
				} catch(e) {
					_set_error_from_error(e)
					reject()
				}
			})
			`}evalAllowed(){return this.function!=null}evalFunction(){if(this.function)return this.clear_error(),this.function(o0,dW,this.param,this.methods,this._set_error_from_error_bound)}traverse_CallExpression(e){let t=e.arguments.map(s=>this.traverse_node(s)),o=e.callee.name;if(o){let s=cW[o];if(s)return s(t);let i=`${t.join(iN)}`,l=Us[o];if(l)return`${l}(${i})`;let a=Fe.expressionsRegister;if(a.getMethod(o)){let h=e.arguments[0],g=`return ${t[0]}`,p,u;try{p=new Function(g),u=p()}catch{}return this._createMethodAndDependencies(o,u,h),`(await methods[${this.method_index}].processArguments([${i}]))`}else{let h=a.availableMethods().join(", "),g=`method not found (${o}), available methods are: ${h}`;Fe.warn(g)}}this.set_error(`unknown method: ${o}`)}traverse_BinaryExpression(e){return`(${this.traverse_node(e.left)} ${e.operator} ${this.traverse_node(e.right)})`}traverse_LogicalExpression(e){return`(${this.traverse_node(e.left)} ${e.operator} ${this.traverse_node(e.right)})`}traverse_MemberExpression(e){return`${this.traverse_node(e.object)}.${this.traverse_node(e.property)}`}traverse_UnaryExpression(e){if(e.operator===uW){let t=e.argument,r,o;switch(t.type){case"Identifier":{r=t.name;break}case"MemberExpression":{let s=t,i=s.object,l=s.property;r=i.name,o=l.name;break}}if(r){if(r=$r.remapName(r),r==Tn.POINT_INDEX||r==Tn.OBJECT_INDEX)return"((entity != null) ? entity.index() : 0)";{let s=this._attribute_requirements_controller.varAttributeSize(r),i=this._attribute_requirements_controller.varArray(r);this._attribute_requirements_controller.add(r);let l=o?pW[o]:0;return l==null&&(l=0),`getEntityAttribValue(entity, '${r}', ${i}, ${s}, ${l})`}}else return console.warn("attribute not found"),""}else return`${e.operator}${this.traverse_node(e.argument)}`}traverse_Literal(e){return`${e.raw}`}traverse_Identifier(e){if(e.name[0]==X9){let r=e.name.substr(1),o=oN[r];if(o)return o;let s=`traverse_Identifier_${r}`;if(this[s])return this[s]();this.set_error(`identifier unknown: ${e.name}`)}else return e.name}traverse_Identifier_F(){return this.immutableDependencies.push(this.param.scene().timeController.graphNode),"param.scene().timeController.frame()"}traverse_Identifier_T(){return this.immutableDependencies.push(this.param.scene().timeController.graphNode),"param.scene().timeController.time()"}traverse_Identifier_OS(){return`${Ll}${this.param.node.name()}${Ll}`}traverse_Identifier_CH(){return`${Ll}${this.param.name()}${Ll}`}traverse_Identifier_CEX(){return this._method_centroid("x")}traverse_Identifier_CEY(){return this._method_centroid("y")}traverse_Identifier_CEZ(){return this._method_centroid("z")}_method_centroid(e){let r=[0,`${Ll}${e}${Ll}`].join(iN);return this._createMethodAndDependencies("centroid",0),`(await methods[${this.method_index}].processArguments([${r}]))`}_createMethodAndDependencies(e,t,r){let o=Fe.expressionsRegister,s=o.getMethod(e);if(!s){let l=o.availableMethods(),a=`method not found (${e}), available methods are: ${l.join(", ")}`;this.set_error(a),Fe.warn(a);return}let i=new s(this.param);if(this.method_index+=1,this.methods[this.method_index]=i,i.requireDependency()&&t!=null){let l=i.findDependency(t);l?(r&&l.set_jsep_node(r),this.methodDependencies.push(l)):r&&xe.isString(t)&&this.param.scene().missingExpressionReferencesController.register(this.param,t)}}};var fW=", ",K9=class extends Au{constructor(e){super(e);this.param=e}parse_tree(e){if(e.error_message==null&&e.node)try{return this.traverse_node(e.node)}catch{this.set_error("could not traverse tree")}else this.set_error("cannot parse tree")}traverse_CallExpression(e){let r=`${e.arguments.map(s=>this.traverse_node(s)).join(fW)}`;return`${e.callee.name}(${r})`}traverse_UnaryExpression(e){return`${e.operator}${this.traverse_node(e.argument)}`}traverse_Identifier(e){return`${e.name}`}};var Z9=class{constructor(e){this.param=e,this._cyclicGraphDetected=!1,this.methodDependencies=[]}set_error(e){this.error_message=this.error_message||e}reset(){this.param.graphDisconnectPredecessors(),this.methodDependencies.forEach(e=>{e.reset()}),this.methodDependencies=[]}update(e){this._cyclicGraphDetected=!1,this._connectImmutableDependencies(e),this.methodDependencies=e.methodDependencies,this._handleMethodDependencies(),this._listenForNameChanges()}_connectImmutableDependencies(e){e.immutableDependencies.forEach(t=>{if(this._cyclicGraphDetected==!1&&this.param.addGraphInput(t)==!1){this._cyclicGraphDetected=!0,this.set_error("cannot create expression, infinite graph detected"),this.reset();return}})}_handleMethodDependencies(){this.methodDependencies.forEach(e=>{this._cyclicGraphDetected==!1&&this._handleMethodDependency(e)})}_handleMethodDependency(e){let t=e.resolved_graph_node;if(t&&!this.param.addGraphInput(t)){this._cyclicGraphDetected=!0,this.set_error("cannot create expression, infinite graph detected"),this.reset();return}}_listenForNameChanges(){this.methodDependencies.forEach(e=>{e.listen_for_name_changes()})}};var Q9=class{constructor(e){this.param=e,this.parse_completed=!1,this.parse_started=!1,this.parsed_tree=new $0,this._functionGenerator=new J9(this.param),this.dependencies_controller=new Z9(this.param)}parseExpression(e){if(this.parse_started)throw new Error(`parse in progress for param ${this.param.path()}`);this.parse_started=!0,this.parse_completed=!1,this.parsed_tree=this.parsed_tree||new $0,this.reset(),this.param.type()==Te.STRING?this.parsed_tree.parse_expression_for_string_param(e):this.parsed_tree.parse_expression(e),this._functionGenerator.parse_tree(this.parsed_tree),this._functionGenerator.error_message()==null&&(this.dependencies_controller.update(this._functionGenerator),this.dependencies_controller.error_message?this.param.states.error.set(this.dependencies_controller.error_message):(this.parse_completed=!0,this.parse_started=!1))}async computeFunction(){if(this._computeAllowed())try{return await this._functionGenerator.evalFunction()}catch{}}reset(){this.parse_completed=!1,this.parse_started=!1,this.dependencies_controller.reset(),this._functionGenerator.reset()}is_errored(){return this._functionGenerator.is_errored()}error_message(){return this._functionGenerator.error_message()}_computeAllowed(){return this._functionGenerator.evalAllowed()}updateFromMethodDependencyNameChange(){this.expression_string_generator=this.expression_string_generator||new K9(this.param);let e=this.expression_string_generator.parse_tree(this.parsed_tree);e?this.param.set(e):console.warn("failed to regenerate expression")}};var Mu=class{constructor(e){this.param=e}dispose(){this.param.scene().expressionsController.deregisterParam(this.param),this._resetMethodDependencies()}_resetMethodDependencies(){var e,t;(e=this._method_dependencies_by_graph_node_id)==null||e.forEach(r=>{r.dispose()}),(t=this._method_dependencies_by_graph_node_id)==null||t.clear()}registerMethodDependency(e){this._method_dependencies_by_graph_node_id=this._method_dependencies_by_graph_node_id||new Map,this._method_dependencies_by_graph_node_id.set(e.graphNodeId(),e)}active(){return this._expression!=null}expression(){return this._expression}is_errored(){return this._manager?this._manager.is_errored():!1}error_message(){return this._manager?this._manager.error_message():null}requires_entities(){return this.param.options.isExpressionForEntities()}set_expression(e,t=!0){var r;this.param.scene().missingExpressionReferencesController.deregisterParam(this.param),this.param.scene().expressionsController.deregisterParam(this.param),this._expression!=e&&(this._resetMethodDependencies(),this._expression=e,this._expression?(this._manager=this._manager||new Q9(this.param),this._manager.parseExpression(this._expression)):(r=this._manager)==null||r.reset(),t&&this.param.setDirty())}updateFromMethodDependencyNameChange(){this._manager&&this.active()&&this._manager.updateFromMethodDependencyNameChange()}computeExpression(){if(this._manager&&this.active())return this._manager.computeFunction()}async computeExpressionForEntities(e,t){var r,o;this._setEntities(e,t),await this.computeExpression(),((r=this._manager)==null?void 0:r.error_message())&&this.param.node.states.error.set(`expression evalution error: ${(o=this._manager)==null?void 0:o.error_message()}`),this._resetEntities()}computeExpressionForPoints(e,t){return this.computeExpressionForEntities(e,t)}computeExpressionForObjects(e,t){return this.computeExpressionForEntities(e,t)}entities(){return this._entities}entityCallback(){return this._entityCallback}_setEntities(e,t){this._entities=e,this._entityCallback=t}_resetEntities(){this._entities=void 0,this._entityCallback=void 0}};var Y0=class extends ro{isNumeric(){return!0}isDefault(){return this._raw_input==this._default_value}_prefilterInvalidRawInput(e){return xe.isArray(e)?e[0]:e}processRawInput(){this.states.error.clear();let e=this.convert(this._raw_input);e!=null?(this._expression_controller&&(this._expression_controller.set_expression(void 0,!1),this.emitController.emit(Xr.EXPRESSION_UPDATED)),e!=this._value&&(this._update_value(e),this.setSuccessorsDirty(this))):xe.isString(this._raw_input)?(this._expression_controller=this._expression_controller||new Mu(this),this._raw_input!=this._expression_controller.expression()&&(this._expression_controller.set_expression(this._raw_input),this.emitController.emit(Xr.EXPRESSION_UPDATED))):this.states.error.set(`param input is invalid (${this.path()})`)}async processComputation(){var e;if(((e=this.expressionController)==null?void 0:e.active())&&!this.expressionController.requires_entities()){let t=await this.expressionController.computeExpression();if(this.expressionController.is_errored())this.states.error.set(`expression error: "${this.expressionController.expression()}" (${this.expressionController.error_message()})`);else{let r=this.convert(t);r!=null?(this.states.error.active()&&this.states.error.clear(),this._update_value(r)):this.states.error.set(`expression returns an invalid type (${t}) (${this.expressionController.expression()})`)}}}_update_value(e){this._value=e;let t=this.parentParam();t&&t.set_value_from_components(),this.options.executeCallback(),this.emitController.emit(Xr.VALUE_UPDATED),this.removeDirtyState()}};var e2=class extends Y0{static type(){return Te.BOOLEAN}defaultValueSerialized(){return xe.isString(this._default_value)?this._default_value:this.convert(this._default_value)||!1}rawInputSerialized(){return this._raw_input}valueSerialized(){return this.value}_copyValue(e){this.set(e.value)}static areRawInputEqual(e,t){return e==t}static areValuesEqual(e,t){return e==t}convert(e){if(xe.isBoolean(e))return e;if(xe.isNumber(e))return e>=1;if(xe.isString(e)){if(Rt.isBoolean(e))return Rt.toBoolean(e);if(Rt.isNumber(e))return parseFloat(e)>=1}return null}};var t2=class extends ro{static type(){return Te.BUTTON}defaultValueSerialized(){return this._default_value}rawInputSerialized(){return this._raw_input}valueSerialized(){return this.value}_copyValue(e){}static areRawInputEqual(e,t){return!0}static areValuesEqual(e,t){return!0}async pressButton(){(this.node.isDirty()||this.node.cookController.isCooking())&&await this.node.compute(),this.options.executeCallback()}};var Vs=class extends Y0{static type(){return Te.FLOAT}defaultValueSerialized(){return this._default_value}rawInputSerialized(){return this._raw_input}valueSerialized(){return this.value}_copyValue(e){this.set(e.valueSerialized())}_prefilterInvalidRawInput(e){return xe.isArray(e)?e[0]:xe.isString(e)&&Rt.isNumber(e)?parseFloat(e):e}static areRawInputEqual(e,t){return e==t}static areValuesEqual(e,t){return e==t}static convert(e){if(xe.isNumber(e))return e;if(xe.isBoolean(e))return e?1:0;if(Rt.isNumber(e)){let t=parseFloat(e);if(xe.isNumber(t))return t}return null}convert(e){let t=Vs.convert(e);return t&&this.options.ensureInRange(t)}};var pi=class extends ro{constructor(){super(...arguments);this._components_contructor=Vs}get components(){return this._components}isNumeric(){return!0}isDefault(){for(let e of this.components)if(!e.isDefault())return!1;return!0}rawInput(){return this._components.map(e=>e.rawInput())}rawInputSerialized(){return this._components.map(e=>e.rawInputSerialized())}_copyValue(e){for(let t=0;t<this.components.length;t++){let r=this.components[t],o=e.components[t];r.copyValue(o)}}initComponents(){if(this._components!=null)return;let e=0;this._components=new Array(this.componentNames().length);for(let t of this.componentNames()){let r=new this._components_contructor(this.scene(),this._node),o;xe.isArray(this._default_value)?o=this._default_value[e]:o=this._default_value[t],r.options.copy(this.options),r.setInitValue(o),r.setName(`${this.name()}${t}`),r.set_parent_param(this),this._components[e]=r,e++}}async processComputation(){await this.compute_components(),this.set_value_from_components()}set_value_from_components(){}hasExpression(){var e;for(let t of this.components)if((e=t.expressionController)==null?void 0:e.active())return!0;return!1}async compute_components(){let e=this.components,t=[];for(let r of e)r.isDirty()&&t.push(r.compute());await Promise.all(t),this.removeDirtyState()}_prefilterInvalidRawInput(e){if(xe.isArray(e))return e;{let t=e;return this.componentNames().map(()=>t)}}processRawInput(){let e=this.scene().cooker;e.block();let t=this.components;for(let s of t)s.emitController.blockParentEmit();let r=this._raw_input,o=0;if(xe.isArray(r))for(let s=0;s<t.length;s++){let i=r[s];i==null&&(i=o),t[s].set(i),o=i}else for(let s=0;s<t.length;s++){let i=this.componentNames()[s],l=r[i];l==null&&(l=o),t[s].set(l),o=l}e.unblock();for(let s=0;s<t.length;s++)t[s].emitController.unblockParentEmit();this.emitController.emit(Xr.VALUE_UPDATED)}};var Eo=(n=>(n.NONE="no conversion",n.GAMMA_TO_LINEAR="gamma -> linear",n.LINEAR_TO_GAMMA="linear -> gamma",n.SRGB_TO_LINEAR="sRGB -> linear",n.LINEAR_TO_SRGB="linear -> sRGB",n))(Eo||{});var mW=["r","g","b"],r2=class extends pi{constructor(){super(...arguments);this._value=new Ke,this._value_pre_conversion=new Ke,this._value_serialized_dirty=!1,this._value_serialized=[0,0,0],this._value_pre_conversion_serialized=[0,0,0],this._copied_value=[0,0,0]}static type(){return Te.COLOR}componentNames(){return mW}defaultValueSerialized(){return xe.isArray(this._default_value)?this._default_value:this._default_value.toArray()}valueSerialized(){return this._update_value_serialized_if_required(),this._value_serialized}valuePreConversionSerialized(){return this._update_value_serialized_if_required(),this._value_pre_conversion_serialized}_copyValue(e){e.value.toArray(this._copied_value),this.set(this._copied_value)}_cloneRawInput(e){if(e instanceof Ke)return e.clone();{let t=[e[0],e[1],e[2]];return t[0]==null&&(t[0]=t[0]||0),t[1]==null&&(t[1]=t[1]||t[0]),t[2]==null&&(t[2]=t[2]||t[1]),t}}static areRawInputEqual(e,t){return e instanceof Ke?t instanceof Ke?e.equals(t):e.r==t[0]&&e.g==t[1]&&e.b==t[2]:t instanceof Ke?e[0]==t.r&&e[1]==t.g&&e[2]==t.b:e[0]==t[0]&&e[1]==t[1]&&e[2]==t[2]}static areValuesEqual(e,t){return e.equals(t)}initComponents(){super.initComponents(),this.r=this.components[0],this.g=this.components[1],this.b=this.components[2],this._value_serialized_dirty=!0}_update_value_serialized_if_required(){!this._value_serialized_dirty||(this._value_serialized[0]=this._value.r,this._value_serialized[1]=this._value.g,this._value_serialized[2]=this._value.b,this._value_pre_conversion_serialized[0]=this._value_pre_conversion.r,this._value_pre_conversion_serialized[1]=this._value_pre_conversion.g,this._value_pre_conversion_serialized[2]=this._value_pre_conversion.b)}valuePreConversion(){return this._value_pre_conversion}set_value_from_components(){this._value_pre_conversion.r=this.r.value,this._value_pre_conversion.g=this.g.value,this._value_pre_conversion.b=this.b.value,this._value.copy(this._value_pre_conversion);let e=this.options.colorConversion();if(e!=null&&e!=Eo.NONE){switch(e){case Eo.GAMMA_TO_LINEAR:{this._value.convertGammaToLinear();return}case Eo.LINEAR_TO_GAMMA:{this._value.convertLinearToGamma();return}case Eo.SRGB_TO_LINEAR:{this._value.convertSRGBToLinear();return}case Eo.LINEAR_TO_SRGB:{this._value.convertLinearToSRGB();return}}qr.unreachable(e)}this._value_serialized_dirty=!0}};var n2=class extends ro{static type(){return Te.FOLDER}defaultValueSerialized(){return this._default_value}rawInputSerialized(){return this._raw_input}valueSerialized(){return this.value}_copyValue(e){}static areRawInputEqual(e,t){return!0}static areValuesEqual(e,t){return!0}};var Nu=class extends Y0{static type(){return Te.INTEGER}defaultValueSerialized(){return this._default_value}rawInputSerialized(){return this._raw_input}valueSerialized(){return this.value}_copyValue(e){this.set(e.valueSerialized())}_prefilterInvalidRawInput(e){return xe.isArray(e)?e[0]:xe.isString(e)&&Rt.isNumber(e)?parseInt(e):e}static areRawInputEqual(e,t){return e==t}static areValuesEqual(e,t){return e==t}static convert(e){if(xe.isNumber(e))return Math.round(e);if(xe.isBoolean(e))return e?1:0;if(Rt.isNumber(e)){let t=parseInt(e);if(xe.isNumber(t))return t}return null}convert(e){let t=Nu.convert(e);return t&&this.options.ensureInRange(t)}};var zs=class{constructor(){this._index=-1,this._path_elements=[],this._named_nodes=[],this._graph_node_ids=[],this._node_element_by_graph_node_id=new Map}reset(){this._index=-1,this._path_elements=[],this._named_nodes=[],this._graph_node_ids=[],this._node_element_by_graph_node_id.clear()}add_node(e,t){this._index+=1,e==t.name()&&(this._named_nodes[this._index]=t),this._graph_node_ids[this._index]=t.graphNodeId(),this._node_element_by_graph_node_id.set(t.graphNodeId(),e)}add_path_element(e){this._index+=1,this._path_elements[this._index]=e}named_graph_nodes(){return this._named_nodes}named_nodes(){let e=[];for(let t of this._named_nodes)if(t){let r=t;r.nameController&&e.push(r)}return e}update_from_name_change(e){this._named_nodes.map(r=>r==null?void 0:r.graphNodeId()).includes(e.graphNodeId())&&this._node_element_by_graph_node_id.set(e.graphNodeId(),e.name())}to_path(){let e=new Array(this._index);for(let o=0;o<=this._index;o++){let s=this._named_nodes[o];if(s){let i=this._node_element_by_graph_node_id.get(s.graphNodeId());i&&(e[o]=i)}else{let i=this._path_elements[o];i&&(e[o]=i)}}let t=e.join(hr.SEPARATOR),r=t[0];return r&&(hr.NON_LETTER_PREFIXES.includes(r)||(t=`${hr.SEPARATOR}${t}`)),t}};var Su=class extends ro{constructor(){super(...arguments);this.decomposed_path=new zs}_handleReferences(e,t){this.scene().referencesController.setNamedNodesFromParam(this),e?this.scene().referencesController.setReferenceFromParam(this,e):this.scene().missingExpressionReferencesController.register(this,t)}};var gf=class extends Su{static type(){return Te.PARAM_PATH}_initializeParam(){this._value=new Is}defaultValueSerialized(){return this._default_value}rawInputSerialized(){return`${this._raw_input}`}valueSerialized(){return`${this.value}`}_copyValue(e){this.set(e.valueSerialized())}static areRawInputEqual(e,t){return e==t}static areValuesEqual(e,t){return e==t}isDefault(){return this._raw_input==this._default_value}setParam(e){this.set(e.path())}processRawInput(){this._value.path()!=this._raw_input&&(this._value.set_path(this._raw_input),this.findTarget(),this.setDirty(),this.emitController.emit(Xr.VALUE_UPDATED))}async processComputation(){this.findTarget()}findTarget(){if(!this.node)return;let e=this._raw_input,t=null,r=e!=null&&e!=="";this.scene().referencesController.resetReferenceFromParam(this),this.decomposed_path.reset(),r&&(t=hr.findParam(this.node,e,this.decomposed_path));let o=this._value.param(),s=t;if(s&&s.graphNodeId()==this.graphNodeId()){this.states.error.set("param cannot refer to itself");return}if(this._handleReferences(t,e),(o==null?void 0:o.graphNodeId())!==(s==null?void 0:s.graphNodeId())){let i=this.options.dependentOnFoundNode(),l=this._value.param();l&&i&&this.removeGraphInput(l),t?this._assign_found_node(t):this._value.set_param(null),this.options.executeCallback()}this.removeDirtyState()}_assign_found_node(e){let t=this.options.dependentOnFoundNode();this._value.set_param(e),t&&this.addGraphInput(e)}notifyPathRebuildRequired(e){this.decomposed_path.update_from_name_change(e);let t=this.decomposed_path.to_path();this.set(t)}notifyTargetParamOwnerParamsUpdated(e){this.setDirty()}};var Il=class extends Su{static type(){return Te.NODE_PATH}_initializeParam(){this._value=new li}defaultValueSerialized(){return this._default_value}rawInputSerialized(){return`${this._raw_input}`}valueSerialized(){return`${this.value}`}_copyValue(e){this.set(e.valueSerialized())}static areRawInputEqual(e,t){return e==t}static areValuesEqual(e,t){return e==t}isDefault(){return this._raw_input==this._default_value}setNode(e,t){if((t==null?void 0:t.relative)==!0){let r=hr.relativePath(this.node,e);this.set(r)}else this.set(e.path())}processRawInput(){this._value.path()!=this._raw_input&&(this._value.set_path(this._raw_input),this._findTarget(),this.setDirty(),this.emitController.emit(Xr.VALUE_UPDATED))}async processComputation(){this._findTarget()}_findTarget(){if(!this.node)return;let e=this._raw_input,t=null,r=e!=null&&e!=="";this.scene().referencesController.resetReferenceFromParam(this),this.decomposed_path.reset(),r&&(t=hr.findNode(this.node,e,this.decomposed_path));let o=this._value.node(),s=t;if(s&&s.graphNodeId()==this.node.graphNodeId()){this.states.error.set("param cannot refer to its own node");return}if(this._handleReferences(t,e),(o==null?void 0:o.graphNodeId())!==(s==null?void 0:s.graphNodeId())){let i=this.options.dependentOnFoundNode(),l=this._value.node();l&&i&&this.removeGraphInput(l),t?this._assign_found_node(t):this._value.set_node(null),this.options.executeCallback()}r&&!t&&this.scene().loadingController.loaded()&&r&&this.states.error.set(`no node found at path '${e}'`),this.removeDirtyState()}_assign_found_node(e){let t=this.options.dependentOnFoundNode();this._isNodeExpectedContext(e)?this._is_node_expected_type(e)?(this.states.error.clear(),this._value.set_node(e),t&&this.addGraphInput(e)):this.states.error.set(`node type is ${e.type()} but the params expects one of ${(this._expected_node_types()||[]).join(", ")}`):this.states.error.set(`node context is ${e.context()} but the params expects a ${this._expectedContext()}`)}_expectedContext(){return this.options.nodeSelectionContext()}_isNodeExpectedContext(e){var t,r;let o=this._expectedContext();if(o==null)return!0;let s=(r=(t=e.parent())==null?void 0:t.childrenController)==null?void 0:r.context;return o==s}_expected_node_types(){return this.options.nodeSelectionTypes()}_is_node_expected_type(e){let t=this._expected_node_types();return t==null?!0:t==null?void 0:t.includes(e.type())}notifyPathRebuildRequired(e){this.decomposed_path.update_from_name_change(e);let t=this.decomposed_path.to_path();this.set(t)}notifyTargetParamOwnerParamsUpdated(e){this.setDirty()}};var Ii=class{constructor(e=0,t=0){this._position=e,this._value=t}toJSON(){return{position:this._position,value:this._value}}position(){return this._position}value(){return this._value}copy(e){this._position=e.position(),this._value=e.value()}clone(){let e=new Ii;return e.copy(this),e}isEqual(e){return this._position==e.position()&&this._value==e.value()}isEqualJSON(e){return this._position==e.position&&this._value==e.value}fromJSON(e){this._position=e.position,this._value=e.value}static areEqualJSON(e,t){return e.position==t.position&&e.value==t.value}static fromJSON(e){return new Ii(e.position,e.value)}},o2=(n=>(n.CUBIC="cubic",n))(o2||{});var Xn=class{constructor(e="cubic",t=[]){this._interpolation=e,this._points=t,this._uuid=el()}uuid(){return this._uuid}interpolation(){return this._interpolation}points(){return this._points}static fromJSON(e){let t=[];for(let o of e.points)t.push(Ii.fromJSON(o));let r=e.interpolation;return(r==null||r=="")&&(r="cubic"),new Xn(r,t)}toJSON(){return{interpolation:this._interpolation,points:this._points.map(e=>e.toJSON())}}clone(){let e=new Xn;return e.copy(this),e}copy(e){this._interpolation=e.interpolation();let t=0;this._points.length>e.points().length&&this._points.splice(0,e.points().length);for(let r of e.points()){let o=this._points[t];o?o.copy(r):this._points.push(r.clone()),t+=1}}isEqual(e){if(this._interpolation!=e.interpolation())return!1;let t=e.points();if(this._points.length!=t.length)return!1;let r=0;for(let o of this._points){let s=t[r];if(!o.isEqual(s))return!1;r+=1}return!0}isEqualJSON(e){if(this._interpolation!=e.interpolation||this._points.length!=e.points.length)return!1;let t=0;for(let r of this._points){let o=e.points[t];if(!r.isEqualJSON(o))return!1;t+=1}return!0}static are_json_equal(e,t){if(e.interpolation!=t.interpolation||e.points.length!=t.points.length)return!1;let r=0;for(let o of e.points){let s=t.points[r];if(!Ii.areEqualJSON(o,s))return!1;r+=1}return!0}from_json(e){this._interpolation=e.interpolation;let t=0;for(let r of e.points){let o=this._points[t];o?o.fromJSON(r):this._points.push(Ii.fromJSON(r)),t+=1}}};var i2=1024,sN=1,aN=i2*sN,Dl=255,s2=class extends ro{constructor(){super(...arguments);this._texture_data=new Uint8Array(3*aN),this._ramp_texture=new Do(this._texture_data,i2,sN,qo)}static type(){return Te.RAMP}defaultValueSerialized(){return this._default_value instanceof Xn?this._default_value.toJSON():this._default_value}_cloneRawInput(n){return n instanceof Xn?n.clone():Xn.fromJSON(n).toJSON()}rawInputSerialized(){return this._raw_input instanceof Xn?this._raw_input.toJSON():Xn.fromJSON(this._raw_input).toJSON()}valueSerialized(){return this.value.toJSON()}_copyValue(n){this.set(n.valueSerialized())}static areRawInputEqual(n,e){return n instanceof Xn?e instanceof Xn?n.isEqual(e):n.isEqualJSON(e):e instanceof Xn?e.isEqualJSON(n):Xn.are_json_equal(n,e)}static areValuesEqual(n,e){return n.isEqual(e)}isDefault(){return this._default_value instanceof Xn?this.value.isEqual(this._default_value):this.value.isEqualJSON(this._default_value)}processRawInput(){this._raw_input instanceof Xn?this._value?this._value.copy(this._raw_input):this._value=this._raw_input:this._value?this._value.from_json(this._raw_input):this._value=Xn.fromJSON(this._raw_input),this._resetRampInterpolant(),this._updateRampTexture(),this.options.executeCallback(),this.emitController.emit(Xr.VALUE_UPDATED),this.setSuccessorsDirty(this)}hasExpression(){return!1}_resetRampInterpolant(){this._ramp_interpolant=void 0}rampTexture(){return this._ramp_texture}_updateRampTexture(){this._updateRampTextureData(),this.rampTexture().needsUpdate=!0}_updateRampTextureData(){let n=0,e=0,t=0;for(var r=0;r<aN;r++)n=r*3,e=r/i2,t=this.valueAtPosition(e),t<=0?(this._texture_data[n+0]=(_o(t,-1,0)+1)*Dl,this._texture_data[n+1]=0,this._texture_data[n+2]=0):t<=1?(this._texture_data[n+0]=Dl,this._texture_data[n+1]=_o(t,0,1)*Dl,this._texture_data[n+2]=0):(this._texture_data[n+0]=Dl,this._texture_data[n+1]=Dl,this._texture_data[n+2]=(_o(t,1,2)-1)*Dl)}static createInterpolant(n,e){let t=1,r=new Float32Array(t);return new Rd(n,e,t,r)}interpolant(){return this._ramp_interpolant=this._ramp_interpolant||this._createInterpolant()}_createInterpolant(){let n=this.value.points(),e=lr.sortBy(n,s=>s.position()),t=new Float32Array(e.length),r=new Float32Array(e.length),o=0;for(let s of e)t[o]=s.position(),r[o]=s.value(),o++;return s2.createInterpolant(t,r)}valueAtPosition(n){return this.interpolant().evaluate(n)[0]}},di=s2;di.DEFAULT_VALUE=new Xn(o2.CUBIC,[new Ii(0,0),new Ii(1,1)]);di.DEFAULT_VALUE_JSON=s2.DEFAULT_VALUE.toJSON();var Bl=class extends ro{static type(){return Te.STRING}defaultValueSerialized(){return this._default_value}_cloneRawInput(e){return`${e}`}rawInputSerialized(){return`${this._raw_input}`}valueSerialized(){return`${this.value}`}_copyValue(e){this.set(e.value)}static areRawInputEqual(e,t){return e==t}static areValuesEqual(e,t){return e==t}isDefault(){return this._raw_input==this._default_value}convert(e){return xe.isString(e)?e:`${e}`}rawInput(){return this._raw_input}processRawInput(){this.states.error.clear(),this._value_elements(this._raw_input).length>=3?(this._expression_controller=this._expression_controller||new Mu(this),this._raw_input!=this._expression_controller.expression()&&(this._expression_controller.set_expression(this._raw_input),this.setDirty(),this.emitController.emit(Xr.EXPRESSION_UPDATED))):this._raw_input!=this._value&&(this._value=this._raw_input,this.removeDirtyState(),this.setSuccessorsDirty(this),this.emitController.emit(Xr.VALUE_UPDATED),this.options.executeCallback(),this._expression_controller&&(this._expression_controller.set_expression(void 0,!1),this.emitController.emit(Xr.EXPRESSION_UPDATED)))}async processComputation(){var e;if(((e=this.expressionController)==null?void 0:e.active())&&!this.expressionController.requires_entities()){let t=await this.expressionController.computeExpression();if(this.expressionController.is_errored())this.states.error.set(`expression error: ${this.expressionController.error_message()}`);else{let r=this.convert(t);r!=null?(this._value=r,this.emitController.emit(Xr.VALUE_UPDATED),this.options.executeCallback()):this.states.error.set(`expression returns an invalid type (${t})`),this.removeDirtyState()}}}_value_elements(e){return $0.string_value_elements(e)}};var hW=["x","y"],a2=class extends pi{constructor(){super(...arguments);this._value=new re,this._copied_value=[0,0]}static type(){return Te.VECTOR2}componentNames(){return hW}defaultValueSerialized(){return xe.isArray(this._default_value)?this._default_value:this._default_value.toArray()}valueSerialized(){return this.value.toArray()}_copyValue(e){e.value.toArray(this._copied_value),this.set(this._copied_value)}_cloneRawInput(e){if(e instanceof re)return e.clone();{let t=[e[0],e[1]];return t[0]==null&&(t[0]=t[0]||0),t[1]==null&&(t[1]=t[1]||t[0]),t}}static areRawInputEqual(e,t){return e instanceof re?t instanceof re?e.equals(t):e.x==t[0]&&e.y==t[1]:t instanceof re?e[0]==t.x&&e[1]==t.y:e[0]==t[0]&&e[1]==t[1]}static areValuesEqual(e,t){return e.equals(t)}initComponents(){super.initComponents(),this.x=this.components[0],this.y=this.components[1]}set_value_from_components(){this._value.x=this.x.value,this._value.y=this.y.value}};var _W=["x","y","z"],l2=class extends pi{constructor(){super(...arguments);this._value=new F,this._copied_value=[0,0,0]}static type(){return Te.VECTOR3}componentNames(){return _W}defaultValueSerialized(){return xe.isArray(this._default_value)?this._default_value:this._default_value.toArray()}valueSerialized(){return this.value.toArray()}_copyValue(e){e.value.toArray(this._copied_value),this.set(this._copied_value)}_cloneRawInput(e){if(e instanceof F)return e.clone();{let t=[e[0],e[1],e[2]];return t[0]==null&&(t[0]=t[0]||0),t[1]==null&&(t[1]=t[1]||t[0]),t[2]==null&&(t[2]=t[2]||t[1]),t}}static areRawInputEqual(e,t){return e instanceof F?t instanceof F?e.equals(t):e.x==t[0]&&e.y==t[1]&&e.z==t[2]:t instanceof F?e[0]==t.x&&e[1]==t.y&&e[2]==t.z:e[0]==t[0]&&e[1]==t[1]&&e[2]==t[2]}static areValuesEqual(e,t){return e.equals(t)}initComponents(){super.initComponents(),this.x=this.components[0],this.y=this.components[1],this.z=this.components[2]}set_value_from_components(){this._value.x=this.x.value,this._value.y=this.y.value,this._value.z=this.z.value}};var gW=["x","y","z","w"],c2=class extends pi{constructor(){super(...arguments);this._value=new kt,this._copied_value=[0,0,0,0]}static type(){return Te.VECTOR4}componentNames(){return gW}defaultValueSerialized(){return xe.isArray(this._default_value)?this._default_value:this._default_value.toArray()}valueSerialized(){return this.value.toArray()}_copyValue(e){e.value.toArray(this._copied_value),this.set(this._copied_value)}_cloneRawInput(e){if(e instanceof kt)return e.clone();{let t=[e[0],e[1],e[2],e[3]];return t[0]==null&&(t[0]=t[0]||0),t[1]==null&&(t[1]=t[1]||t[0]),t[2]==null&&(t[2]=t[2]||t[1]),t[3]==null&&(t[3]=t[3]||t[2]),t}}static areRawInputEqual(e,t){return e instanceof kt?t instanceof kt?e.equals(t):e.x==t[0]&&e.y==t[1]&&e.z==t[2]&&e.w==t[3]:t instanceof kt?e[0]==t.x&&e[1]==t.y&&e[2]==t.z&&e[3]==t.w:e[0]==t[0]&&e[1]==t[1]&&e[2]==t[2]&&e[3]==t[3]}static areValuesEqual(e,t){return e.equals(t)}initComponents(){super.initComponents(),this.x=this.components[0],this.y=this.components[1],this.z=this.components[2],this.w=this.components[3]}set_value_from_components(){this._value.x=this.x.value,this._value.y=this.y.value,this._value.z=this.z.value,this._value.w=this.w.value}};var lN={[Te.BOOLEAN]:e2,[Te.BUTTON]:t2,[Te.COLOR]:r2,[Te.FLOAT]:Vs,[Te.FOLDER]:n2,[Te.INTEGER]:Nu,[Te.PARAM_PATH]:gf,[Te.NODE_PATH]:Il,[Te.RAMP]:di,[Te.STRING]:Bl,[Te.VECTOR2]:a2,[Te.VECTOR3]:l2,[Te.VECTOR4]:c2};var vW="params",u2=class{constructor(e){this.node=e,this._param_create_mode=!1,this._params_created=!1,this._params_by_name={},this._params_list=[],this._param_names=[],this._non_spare_params=[],this._spare_params=[],this._non_spare_param_names=[],this._spare_param_names=[],this._params_added_since_last_params_eval=!1,this._promises=[]}dispose(){this._params_node&&this._params_node.dispose();for(let e of this.all)e.dispose();this._post_create_params_hook_names=void 0,this._post_create_params_hooks=void 0,this._on_scene_load_hooks=void 0,this._on_scene_load_hook_names=void 0}initDependencyNode(){this._params_node||(this._params_node=new zr(this.node.scene(),vW),this.node.addGraphInput(this._params_node,!1))}init(){this.initDependencyNode(),this._param_create_mode=!0,this._initFromParamsConfig(),this.node.createParams(),this._postCreateParams()}_postCreateParams(){this._updateCaches(),this._initParamAccessors(),this._param_create_mode=!1,this._params_created=!0,this._runPostCreateParamsHooks()}postCreateSpareParams(){this._updateCaches(),this._initParamAccessors(),this.node.scene().referencesController.notifyParamsUpdated(this.node),this.node.emit(Sr.PARAMS_UPDATED)}updateParams(e){let t=!1,r=!1;if(e.namesToDelete)for(let o of e.namesToDelete)this.has(o)&&(this._deleteParam(o),r=!0);if(e.toAdd)for(let o of e.toAdd){let s=this.addParam(o.type,o.name,o.init_value,o.options);s&&(o.raw_input!=null&&s.set(o.raw_input),t=!0)}(r||t)&&this.postCreateSpareParams()}_initFromParamsConfig(){var e;let t=this.node.paramsConfig,r=!1;if(t)for(let o of Object.keys(t)){let s=t[o],i,l=(e=this.node.createOptions)==null?void 0:e.paramsInitValueOverrides;l&&(i=l[o],r=!0),this.addParam(s.type,o,s.init_value,s.options,i)}r&&this.node.setDirty(),this.node.createOptions&&(this.node.createOptions.paramsInitValueOverrides=void 0)}_initParamAccessors(){let e=Object.getOwnPropertyNames(this.node.pv);this._removeUnneededAccessors(e),e=Object.getOwnPropertyNames(this.node.pv);for(let t of this.all){let r=t.options.isSpare();(!e.includes(t.name())||r)&&(Object.defineProperty(this.node.pv,t.name(),{get:()=>t.value,configurable:r}),Object.defineProperty(this.node.p,t.name(),{get:()=>t,configurable:r}))}}_removeUnneededAccessors(e){let t=this._param_names,r=[];for(let o of e)t.includes(o)||r.push(o);for(let o of r)Object.defineProperty(this.node.pv,o,{get:()=>{},configurable:!0}),Object.defineProperty(this.node.p,o,{get:()=>{},configurable:!0})}get params_node(){return this._params_node}get all(){return this._params_list}get non_spare(){return this._non_spare_params}get spare(){return this._spare_params}get names(){return this._param_names}get non_spare_names(){return this._non_spare_param_names}get spare_names(){return this._spare_param_names}set_with_type(e,t,r){let o=this.paramWithType(e,r);o?o.set(t):Fe.warn(`param ${e} not found with type ${r}`)}set_float(e,t){this.set_with_type(e,t,Te.FLOAT)}set_vector3(e,t){this.set_with_type(e,t,Te.VECTOR3)}has_param(e){return this._params_by_name[e]!=null}has(e){return this.has_param(e)}get(e){return this.param(e)}paramWithType(e,t){let r=this.param(e);if(r&&r.type()==t)return r}getFloat(e){return this.paramWithType(e,Te.FLOAT)}value(e){var t;return(t=this.param(e))==null?void 0:t.value}valueWithType(e,t){var r;return(r=this.paramWithType(e,t))==null?void 0:r.value}boolean(e){return this.valueWithType(e,Te.BOOLEAN)}float(e){return this.valueWithType(e,Te.FLOAT)}integer(e){return this.valueWithType(e,Te.INTEGER)}string(e){return this.valueWithType(e,Te.STRING)}vector2(e){return this.valueWithType(e,Te.VECTOR2)}vector3(e){return this.valueWithType(e,Te.VECTOR3)}color(e){return this.valueWithType(e,Te.COLOR)}param(e){let t=this._params_by_name[e];return t??(Fe.warn(`tried to access param '${e}' in node ${this.node.path()}, but existing params are: ${this.names} on node ${this.node.path()}`),null)}_deleteParam(e){let t=this._params_by_name[e];if(t){if(this._params_node&&this._params_node.removeGraphInput(this._params_by_name[e]),t._setupNodeDependencies(null),delete this._params_by_name[e],t.isMultiple()&&t.components)for(let r of t.components){let o=r.name();delete this._params_by_name[o]}}else throw new Error(`param '${e}' does not exist on node ${this.node.path()}`)}addParam(e,t,r,o={},s){let i=o.spare||!1;this._param_create_mode===!1&&!i&&Fe.warn(`node ${this.node.path()} (${this.node.type()}) param '${t}' cannot be created outside of create_params`),this.node.scene()==null&&Fe.warn(`node ${this.node.path()} (${this.node.type()}) has no scene assigned`);let l=lN[e];if(l!=null){let a=this._params_by_name[t];a&&(i?a.type()!=e&&this._deleteParam(a.name()):Fe.warn(`a param named ${t} already exists`,this.node));let c=new l(this.node.scene(),this.node);if(c.options.set(o),c.setName(t),c.setInitValue(r),c.initComponents(),s==null)c.set(r);else if(c.options.isExpressionForEntities()&&c.set(r),s.raw_input!=null)c.set(s.raw_input);else if(s.simple_data!=null)c.set(s.simple_data);else if(s.complex_data!=null){let h=s.complex_data.raw_input;h?c.set(h):c.set(r);let g=s.complex_data.overriden_options;if(g!=null){let p=Object.keys(g);for(let u of p)c.options.setOption(u,g[u])}}if(c._setupNodeDependencies(this.node),this._params_by_name[c.name()]=c,c.isMultiple()&&c.components)for(let h of c.components)this._params_by_name[h.name()]=h;return this._params_added_since_last_params_eval=!0,c}}_updateCaches(){this._params_list=Object.values(this._params_by_name),this._param_names=Object.keys(this._params_by_name),this._non_spare_params=Object.values(this._params_by_name).filter(e=>!e.options.isSpare()),this._spare_params=Object.values(this._params_by_name).filter(e=>e.options.isSpare()),this._non_spare_param_names=Object.values(this._params_by_name).filter(e=>!e.options.isSpare()).map(e=>e.name()),this._spare_param_names=Object.values(this._params_by_name).filter(e=>e.options.isSpare()).map(e=>e.name())}async _evalParam(e){e.isDirty()&&(await e.compute(),e.states.error.active()&&this.node.states.error.set(`param '${e.name()}' error: ${e.states.error.message()}`))}async evalParams(e){let t=0;for(let o of e)o.isDirty()&&(t+=1);this._promises.length=t;let r=0;for(let o of e)o.isDirty()&&(this._promises[r]=this._evalParam(o),r+=1);await Promise.all(this._promises),this.node.states.error.active()&&this.node._setContainer(null)}paramsEvalRequired(){return this._params_node!=null&&(this._params_node.isDirty()||this._params_added_since_last_params_eval)}async evalAll(){var e;this.paramsEvalRequired()&&(await this.evalParams(this._params_list),(e=this._params_node)==null||e.removeDirtyState(),this._params_added_since_last_params_eval=!1)}onParamsCreated(e,t){if(this._params_created)t();else{if(this._post_create_params_hook_names&&this._post_create_params_hook_names.includes(e)){Fe.error(`hook name ${e} already exists`);return}this._post_create_params_hook_names=this._post_create_params_hook_names||[],this._post_create_params_hook_names.push(e),this._post_create_params_hooks=this._post_create_params_hooks||[],this._post_create_params_hooks.push(t)}}addOnSceneLoadHook(e,t){this._on_scene_load_hook_names=this._on_scene_load_hook_names||[],this._on_scene_load_hooks=this._on_scene_load_hooks||[],this._on_scene_load_hook_names.includes(e)?Fe.warn(`hook with name ${e} already exists`,this.node):(this._on_scene_load_hook_names.push(e),this._on_scene_load_hooks.push(t))}_runPostCreateParamsHooks(){if(this._post_create_params_hooks)for(let e of this._post_create_params_hooks)e()}runOnSceneLoadHooks(){if(this._on_scene_load_hooks)for(let e of this._on_scene_load_hooks)e()}};var p2=class{constructor(){}};var cN=class{constructor(n,e,t=0,r=0){if(this._node_src=n,this._node_dest=e,this._output_index=t,this._input_index=r,this._output_index==null)throw"bad output index";if(this._input_index==null)throw"bad input index";this._id=cN._next_id++,this._node_src.io.connections&&this._node_dest.io.connections&&(this._node_src.io.connections.addOutputConnection(this),this._node_dest.io.connections.addInputConnection(this))}get id(){return this._id}get node_src(){return this._node_src}get node_dest(){return this._node_dest}get output_index(){return this._output_index}get input_index(){return this._input_index}src_connection_point(){let n=this._node_src,e=this._output_index;return n.io.outputs.namedOutputConnectionPoints()[e]}dest_connection_point(){let n=this._node_dest,e=this._input_index;return n.io.inputs.namedInputConnectionPoints()[e]}disconnect(n={}){this._node_src.io.connections&&this._node_dest.io.connections&&(this._node_src.io.connections.removeOutputConnection(this),this._node_dest.io.connections.removeInputConnection(this)),n.setInput===!0&&this._node_dest.io.inputs.setInput(this._input_index,null)}},d2=cN;d2._next_id=0;var f2=class{constructor(e){this.inputs_controller=e,this._cloneRequiredStates=[],this._overridden=!1,this.node=e.node}initInputsClonedState(e){xe.isArray(e)?this._clonedStates=e:this._clonedState=e,this._updateCloneRequiredState()}overrideClonedStateAllowed(){if(this._clonedStates){for(let e of this._clonedStates)if(e==yr.FROM_NODE)return!0}return this._clonedState?this._clonedState==yr.FROM_NODE:!1}cloneRequiredState(e){return this._cloneRequiredStates[e]}cloneRequiredStates(){return this._cloneRequiredStates}_getCloneRequiredState(e){let t=this._clonedStates;if(t){let r=t[e];if(r!=null)return this._cloneRequiredFromState(r)}return this._clonedState?this._cloneRequiredFromState(this._clonedState):!0}_cloneRequiredFromState(e){switch(e){case yr.ALWAYS:return!0;case yr.NEVER:return!1;case yr.FROM_NODE:return!this._overridden}return qr.unreachable(e)}overrideClonedState(e){this._overridden=e,this._updateCloneRequiredState(),this.node.emit(Sr.OVERRIDE_CLONABLE_STATE_UPDATE),this.node.setDirty()}overriden(){return this._overridden}_updateCloneRequiredState(){if(this._clonedStates){let e=[];for(let t=0;t<this._clonedStates.length;t++)e[t]=this._getCloneRequiredState(t);this._cloneRequiredStates=e}else if(this._clonedState){let e=this.inputs_controller.maxInputsCount(),t=[];for(let r=0;r<e;r++)t[r]=this._getCloneRequiredState(r);this._cloneRequiredStates=t}}};var m2=0,h2=class{constructor(e){this.node=e,this._graphNodeInputs=[],this._inputs=[],this._has_named_inputs=!1,this._minInputsCount=0,this._maxInputsCount=m2,this._maxInputsCountOnInput=m2,this._depends_on_inputs=!0}dispose(){this._graphNode&&this._graphNode.dispose();for(let e of this._graphNodeInputs)e&&e.dispose();this._on_update_hooks=void 0,this._on_update_hook_names=void 0}set_depends_on_inputs(e){this._depends_on_inputs=e}setMinCount(e){this._minInputsCount=e}minCount(){return this._minInputsCount}setMaxCount(e){this._maxInputsCount==m2&&(this._maxInputsCountOnInput=e),this._maxInputsCount=e,this._initGraphNodeInputs()}namedInputConnectionPointsByName(e){if(this._named_input_connection_points){for(let t of this._named_input_connection_points)if(t&&t.name()==e)return t}}setNamedInputConnectionPoints(e){this._has_named_inputs=!0;let t=this.node.io.connections.inputConnections();if(t)for(let r of t)r&&r.input_index>=e.length&&r.disconnect({setInput:!0});this._named_input_connection_points=e,this.setMinCount(0),this.setMaxCount(e.length),this._initGraphNodeInputs(),this.node.emit(Sr.NAMED_INPUTS_UPDATED)}hasNamedInputs(){return this._has_named_inputs}namedInputConnectionPoints(){return this._named_input_connection_points||[]}_initGraphNodeInputs(){for(let e=0;e<this._maxInputsCount;e++)this._graphNodeInputs[e]=this._graphNodeInputs[e]||this._createGraphNodeInput(e)}_createGraphNodeInput(e){let t=new zr(this.node.scene(),`input_${e}`);return this._graphNode||(this._graphNode=new zr(this.node.scene(),"inputs"),this.node.addGraphInput(this._graphNode,!1)),this._graphNode.addGraphInput(t,!1),t}maxInputsCount(){return this._maxInputsCount||0}maxInputsCountOverriden(){return this._maxInputsCount!=this._maxInputsCountOnInput}inputGraphNode(e){return this._graphNodeInputs[e]}setCount(e,t){t==null&&(t=e),this.setMinCount(e),this.setMaxCount(t),this._initConnectionControllerInputs()}_initConnectionControllerInputs(){this.node.io.connections.initInputs()}isAnyInputDirty(){var e;return((e=this._graphNode)==null?void 0:e.isDirty())||!1}containersWithoutEvaluation(){let e=[];for(let t=0;t<this._inputs.length;t++){let r=this._inputs[t],o;r&&(o=r.containerController.containerUnlessBypassed()),e.push(o)}return e}_existingInputIndices(){let e=[];if(this._maxInputsCount>0)for(let t=0;t<this._inputs.length;t++)this._inputs[t]&&e.push(t);return e}async evalRequiredInputs(){var e;let t=[];if(this._maxInputsCount>0){let r=this._existingInputIndices();if(r.length<this._minInputsCount)this.node.states.error.set("inputs are missing");else if(r.length>0){let o=[],s;for(let i=0;i<this._inputs.length;i++)s=this._inputs[i],s&&o.push(this.evalRequiredInput(i));t=await Promise.all(o),(e=this._graphNode)==null||e.removeDirtyState()}}return t}async evalRequiredInput(e){let t,r=this.input(e);if(r&&(t=await r.compute(),this._graphNodeInputs[e].removeDirtyState()),!(t&&t.coreContent())){let o=this.input(e);if(o){let s=o.states.error.message();s&&this.node.states.error.set(`input ${e} is invalid (error: ${s})`)}}return t}get_named_input_index(e){var t;if(this._named_input_connection_points){for(let r=0;r<this._named_input_connection_points.length;r++)if(((t=this._named_input_connection_points[r])==null?void 0:t.name())==e)return r}return-1}get_input_index(e){if(xe.isString(e)){if(this.hasNamedInputs())return this.get_named_input_index(e);throw new Error(`node ${this.node.path()} has no named inputs`)}else return e}setInput(e,t,r=0){let o=this.get_input_index(e)||0;if(o<0){let h=`invalid input (${e}) for node ${this.node.path()}`;throw console.warn(h),new Error(h)}let s=0;if(t&&t.io.outputs.hasNamedOutputs()&&(s=t.io.outputs.getOutputIndex(r),s==null||s<0)){let g=t.io.outputs.namedOutputConnectionPoints().map(p=>p.name());console.warn(`node ${t.path()} does not have an output named ${r}. inputs are: ${g.join(", ")}`);return}let i=this._graphNodeInputs[o];if(i==null){let h=`graph_input_node not found at index ${o}`;throw console.warn(h),new Error(h)}if(t&&this.node.parent()!=t.parent())return;let l=this._inputs[o],a=null,c;this.node.io.connections&&(c=this.node.io.connections.inputConnection(o)),c&&(a=c.output_index),(t!==l||s!=a)&&(l!=null&&this._depends_on_inputs&&i.removeGraphInput(l),t!=null?i.addGraphInput(t)?(this._depends_on_inputs||i.removeGraphInput(t),c&&c.disconnect({setInput:!1}),this._inputs[o]=t,new d2(t,this.node,s,o)):console.warn(`cannot connect ${t.path()} to ${this.node.path()}`):(this._inputs[o]=null,c&&c.disconnect({setInput:!1})),this._run_on_set_input_hooks(),i.setSuccessorsDirty(),this.node.emit(Sr.INPUTS_UPDATED))}remove_input(e){let t=this.inputs(),r;for(let o=0;o<t.length;o++)r=t[o],r!=null&&e!=null&&r.graphNodeId()===e.graphNodeId()&&this.setInput(o,null)}input(e){return this._inputs[e]}named_input(e){if(this.hasNamedInputs()){let t=this.get_input_index(e);return this._inputs[t]}else return null}named_input_connection_point(e){if(this.hasNamedInputs()&&this._named_input_connection_points){let t=this.get_input_index(e);return this._named_input_connection_points[t]}}has_named_input(e){return this.get_named_input_index(e)>=0}hasInput(e){return this._inputs[e]!=null}inputs(){return this._inputs}initInputsClonedState(e){this._clonedStatesController||(this._clonedStatesController=new f2(this),this._clonedStatesController.initInputsClonedState(e))}overrideClonedStateAllowed(){var e;return((e=this._clonedStatesController)==null?void 0:e.overrideClonedStateAllowed())||!1}overrideClonedState(e){var t;(t=this._clonedStatesController)==null||t.overrideClonedState(e)}clonedStateOverriden(){var e;return((e=this._clonedStatesController)==null?void 0:e.overriden())||!1}cloneRequired(e){var t;let r=(t=this._clonedStatesController)==null?void 0:t.cloneRequiredState(e);return r??!0}cloneRequiredStates(){var e;let t=(e=this._clonedStatesController)==null?void 0:e.cloneRequiredStates();return t??!0}add_on_set_input_hook(e,t){this._on_update_hooks=this._on_update_hooks||[],this._on_update_hook_names=this._on_update_hook_names||[],this._on_update_hook_names.includes(e)?console.warn(`hook with name ${e} already exists`,this.node):(this._on_update_hooks.push(t),this._on_update_hook_names.push(e))}_run_on_set_input_hooks(){if(this._on_update_hooks)for(let e of this._on_update_hooks)e()}};var _2=class{constructor(e){this.node=e,this._has_outputs=!1,this._has_named_outputs=!1}dispose(){this._named_output_connection_points&&this._named_output_connection_points.splice(0,this._named_output_connection_points.length)}setHasOneOutput(){this._has_outputs=!0}setHasNoOutput(){this._has_outputs=!1}hasOutputs(){return this._has_outputs}hasNamedOutputs(){return this._has_named_outputs}hasNamedOutput(e){return this.getNamedOutputIndex(e)>=0}namedOutputConnectionPoints(){return this._named_output_connection_points||[]}namedOutputConnection(e){if(this._named_output_connection_points)return this._named_output_connection_points[e]}getNamedOutputIndex(e){var t;if(this._named_output_connection_points){for(let r=0;r<this._named_output_connection_points.length;r++)if(((t=this._named_output_connection_points[r])==null?void 0:t.name())==e)return r}return-1}getOutputIndex(e){return e!=null?xe.isString(e)?this.hasNamedOutputs()?this.getNamedOutputIndex(e):(console.warn(`node ${this.node.path()} has no named outputs`),-1):e:-1}namedOutputConnectionPointsByName(e){if(this._named_output_connection_points){for(let t of this._named_output_connection_points)if((t==null?void 0:t.name())==e)return t}}setNamedOutputConnectionPoints(e,t=!0){this._has_named_outputs=!0;let r=this.node.io.connections.outputConnections();if(r)for(let o of r)o&&o.output_index>=e.length&&o.disconnect({setInput:!0});this._named_output_connection_points=e,t&&this.node.scene()&&this.node.setDirty(this.node),this.node.emit(Sr.NAMED_OUTPUTS_UPDATED)}used_output_names(){var e;let t=this.node.io.connections;if(t){let o=t.outputConnections().map(l=>l?l.output_index:null);o=lr.uniq(o);let s=[];o.forEach(l=>{xe.isNumber(l)&&s.push(l)});let i=[];for(let l of s){let a=(e=this.namedOutputConnectionPoints()[l])==null?void 0:e.name();a&&i.push(a)}return i}else return[]}};var g2=class{constructor(e){this._node=e,this._output_connections=new Map}initInputs(){let e=this._node.io.inputs.maxInputsCount();for(this._input_connections=this._input_connections||new Array(e);this._input_connections.length<e;)this._input_connections.push(void 0)}dispose(){this._input_connections&&this._input_connections.splice(0,this._input_connections.length),this._output_connections&&this._output_connections.clear()}addInputConnection(e){this._input_connections?this._input_connections[e.input_index]=e:console.warn("input connections array not initialized")}removeInputConnection(e){if(this._input_connections)if(e.input_index<this._input_connections.length){this._input_connections[e.input_index]=void 0;let t=!0;for(let r=e.input_index;r<this._input_connections.length;r++)this._input_connections[r]&&(t=!1);t&&(this._input_connections=this._input_connections.slice(0,e.input_index))}else console.warn(`attempt to remove an input connection at index ${e.input_index}`);else console.warn("input connections array not initialized")}inputConnection(e){if(this._input_connections)return this._input_connections[e]}firstInputConnection(){return this._input_connections?lr.compact(this._input_connections)[0]:null}inputConnections(){return this._input_connections}existingInputConnections(){let e=this._input_connections;if(e)for(;e.length>1&&e[e.length-1]===void 0;)e.pop();return e}addOutputConnection(e){let t=e.output_index,r=e.id,o=this._output_connections.get(t);o||(o=new Map,this._output_connections.set(t,o)),o.set(r,e)}removeOutputConnection(e){let t=e.output_index,r=e.id,o=this._output_connections.get(t);o&&o.delete(r)}outputConnections(){let e=[];return this._output_connections.forEach((t,r)=>{t.forEach((o,s)=>{o&&e.push(o)})}),e}};var v2=class{constructor(e){this._node=e}set_in(e){this._in=e}set_out(e){this._out=e}clear(){this._in=void 0,this._out=void 0}in(){return this._in}out(){return this._out}};var Hs=class{constructor(e,t,r){this._name=e,this._type=t,this._init_value=r}get init_value(){return this._init_value}name(){return this._name}type(){return this._type}are_types_matched(e,t){return!0}toJSON(){return this._json=this._json||this._create_json()}_create_json(){return{name:this._name,type:this._type}}};var s0=(n=>(n.BOOL="bool",n.INT="int",n.FLOAT="float",n.VEC2="vec2",n.VEC3="vec3",n.VEC4="vec4",n.SAMPLER_2D="sampler2D",n.SSS_MODEL="SSSModel",n))(s0||{});var yW={bool:Te.BOOLEAN,int:Te.INTEGER,float:Te.FLOAT,vec2:Te.VECTOR2,vec3:Te.VECTOR3,vec4:Te.VECTOR4,sampler2D:Te.RAMP,SSSModel:Te.STRING},uN={[Te.BOOLEAN]:"bool",[Te.COLOR]:"vec3",[Te.INTEGER]:"int",[Te.FLOAT]:"float",[Te.FOLDER]:void 0,[Te.VECTOR2]:"vec2",[Te.VECTOR3]:"vec3",[Te.VECTOR4]:"vec4",[Te.BUTTON]:void 0,[Te.PARAM_PATH]:void 0,[Te.NODE_PATH]:void 0,[Te.RAMP]:void 0,[Te.STRING]:void 0},bW={bool:!1,int:0,float:0,vec2:[0,0],vec3:[0,0,0],vec4:[0,0,0,0],sampler2D:di.DEFAULT_VALUE_JSON,SSSModel:"SSSModel()"};var y2=class extends Hs{constructor(e,t,r){super(e,t);this._name=e,this._type=t,this._init_value=r,this._init_value=this._init_value||bW[this._type]}type(){return this._type}are_types_matched(e,t){return e==t}get param_type(){return yW[this._type]}get init_value(){return this._init_value}toJSON(){return this._json=this._json||this._create_json()}_create_json(){return{name:this._name,type:this._type}}};var b2=(n=>(n.BOOL="bool",n.INT="int",n.FLOAT="float",n.VEC2="vec2",n.VEC3="vec3",n.VEC4="vec4",n))(b2||{});var xW={bool:Te.BOOLEAN,int:Te.INTEGER,float:Te.FLOAT,vec2:Te.VECTOR2,vec3:Te.VECTOR3,vec4:Te.VECTOR4},pN={[Te.BOOLEAN]:"bool",[Te.COLOR]:"vec3",[Te.INTEGER]:"int",[Te.FLOAT]:"float",[Te.FOLDER]:void 0,[Te.VECTOR2]:"vec2",[Te.VECTOR3]:"vec3",[Te.VECTOR4]:"vec4",[Te.BUTTON]:void 0,[Te.PARAM_PATH]:void 0,[Te.NODE_PATH]:void 0,[Te.RAMP]:void 0,[Te.STRING]:void 0},CW={bool:!1,int:0,float:0,vec2:[0,0],vec3:[0,0,0],vec4:[0,0,0,0]};var x2=class extends Hs{constructor(e,t){super(e,t);this._type=t,this._init_value=CW[this._type]}type(){return this._type}are_types_matched(e,t){return e==t}get param_type(){return xW[this._type]}get init_value(){return this._init_value}toJSON(){return this._json=this._json||this._create_json()}_create_json(){return{name:this._name,type:this._type}}};var Bn=(n=>(n.BASE="base",n.DRAG="drag",n.KEYBOARD="keyboard",n.MOUSE="mouse",n.POINTER="pointer",n))(Bn||{}),kn=class extends Hs{constructor(e,t,r){super(e,t);this._name=e,this._type=t,this._event_listener=r}type(){return this._type}get param_type(){return Te.FLOAT}are_types_matched(e,t){return t=="base"?!0:e==t}get event_listener(){return this._event_listener}toJSON(){return this._json=this._json||this._create_json()}_create_json(){return{name:this._name,type:this._type}}};var dN={[it.ANIM]:void 0,[it.AUDIO]:void 0,[it.COP]:void 0,[it.EVENT]:Bn.BASE,[it.GL]:s0.FLOAT,[it.JS]:b2.FLOAT,[it.MANAGER]:void 0,[it.MAT]:void 0,[it.OBJ]:void 0,[it.POST]:void 0,[it.ROP]:void 0,[it.SOP]:void 0};function vf(n,e,t){switch(n){case it.EVENT:return new kn(e,t);case it.GL:return new y2(e,t);case it.JS:return new x2(e,t);default:return}}function fN(n){switch(n){case it.EVENT:return;case it.GL:return uN;case it.JS:return pN;default:return}}var C2=class{constructor(e,t){this.node=e,this._context=t,this._raw_input_serialized_by_param_name=new Map,this._default_value_serialized_by_param_name=new Map,this._initialized=!1}initializeNode(){if(this._initialized){console.warn("already initialized",this.node);return}this._initialized=!0,this.node.params.onParamsCreated("create_inputs_from_params",this.create_inputs_from_params.bind(this))}initialized(){return this._initialized}create_inputs_from_params(){let e=fN(this._context);if(!e)return;let t=[];for(let r of this.node.params.names){let o=!0;if(this._inputless_param_names&&this._inputless_param_names.length>0&&this._inputless_param_names.includes(r)&&(o=!1),o&&this.node.params.has(r)){let s=this.node.params.get(r);if(s&&!s.parentParam()){let i=e[s.type()];if(i){let l=vf(this._context,s.name(),i);l&&t.push(l)}}}}this.node.io.inputs.setNamedInputConnectionPoints(t)}set_inputless_param_names(e){return this._inputless_param_names=e}createSpareParameters(){if(this.node.scene().loadingController.isLoading())return;let e=this.node.params.spare_names,t={};for(let r of e)if(this.node.params.has(r)){let o=this.node.params.get(r);o&&(this._raw_input_serialized_by_param_name.set(r,o.rawInputSerialized()),this._default_value_serialized_by_param_name.set(r,o.defaultValueSerialized()),t.namesToDelete=t.namesToDelete||[],t.namesToDelete.push(r))}for(let r of this.node.io.inputs.namedInputConnectionPoints())if(r){let o=r.name(),s=r.param_type,i=r.init_value,l=this._default_value_serialized_by_param_name.get(o),a=this.node.paramDefaultValue(o);if(a!=null?i=a:l!=null?i=l:i=r.init_value,xe.isArray(r.init_value))if(xe.isNumber(i)){let c=new Array(r.init_value.length);c.fill(i),i=c}else xe.isArray(i)&&i.length==r.init_value.length&&l!=null&&(i=r.init_value);i!=null&&(t.toAdd=t.toAdd||[],t.toAdd.push({name:o,type:s,init_value:wn.clone(i),raw_input:wn.clone(i),options:{spare:!0}}))}this.node.params.updateParams(t);for(let r of this.node.params.spare)if(!r.parentParam()){let o=this._raw_input_serialized_by_param_name.get(r.name());o&&r.set(o)}}};var T2=class{constructor(e,t){this.node=e,this._context=t,this._create_spare_params_from_inputs=!0,this._functions_overridden=!1,this._input_name_function=r=>`in${r}`,this._output_name_function=r=>r==0?"val":`val${r}`,this._expected_input_types_function=()=>{let r=this.first_input_connection_type()||this.default_connection_type();return[r,r]},this._expected_output_types_function=()=>[this._expected_input_types_function()[0]],this._update_signature_if_required_bound=this.update_signature_if_required.bind(this),this._initialized=!1,this._spare_params_controller=new C2(this.node,this._context)}default_connection_type(){return dN[this._context]}create_connection_point(e,t){return vf(this._context,e,t)}functions_overridden(){return this._functions_overridden}initialized(){return this._initialized}set_create_spare_params_from_inputs(e){this._create_spare_params_from_inputs=e}set_input_name_function(e){this._initialize_if_required(),this._input_name_function=e}set_output_name_function(e){this._initialize_if_required(),this._output_name_function=e}set_expected_input_types_function(e){this._initialize_if_required(),this._functions_overridden=!0,this._expected_input_types_function=e}set_expected_output_types_function(e){this._initialize_if_required(),this._functions_overridden=!0,this._expected_output_types_function=e}input_name(e){return this._wrapped_input_name_function(e)}output_name(e){return this._wrapped_output_name_function(e)}initializeNode(){if(this._initialized){console.warn("already initialized",this.node);return}this._initialized=!0,this.node.io.inputs.add_on_set_input_hook("_update_signature_if_required",this._update_signature_if_required_bound),this.node.params.addOnSceneLoadHook("_update_signature_if_required",this._update_signature_if_required_bound),this.node.params.onParamsCreated("_update_signature_if_required_bound",this._update_signature_if_required_bound),this.node.addPostDirtyHook("_update_signature_if_required",this._update_signature_if_required_bound),this._spare_params_controller.initialized()||this._spare_params_controller.initializeNode()}_initialize_if_required(){this._initialized||this.initializeNode()}get spare_params(){return this._spare_params_controller}update_signature_if_required(e){(!this.node.lifecycle.creationCompleted()||!this._connections_match_inputs())&&(this.update_connection_types(),this.node.removeDirtyState(),this.node.scene().loadingController.isLoading()||this.make_successors_update_signatures())}make_successors_update_signatures(){let e=this.node.graphAllSuccessors();if(this.node.childrenAllowed()){let t=this.node.nodesByType(nf.INPUT),r=this.node.nodesByType(nf.OUTPUT);for(let o of t)e.push(o);for(let o of r)e.push(o)}for(let t of e){let r=t;r.io&&r.io.has_connection_points_controller&&r.io.connection_points.initialized()&&r.io.connection_points.update_signature_if_required(this.node)}}update_connection_types(){let e=!1,t=this._wrapped_expected_input_types_function(),r=this._wrapped_expected_output_types_function(),o=[];for(let i=0;i<t.length;i++){let l=t[i],a=this.create_connection_point(this._wrapped_input_name_function(i),l);o.push(a)}let s=[];for(let i=0;i<r.length;i++){let l=r[i],a=this.create_connection_point(this._wrapped_output_name_function(i),l);s.push(a)}this.node.io.inputs.setNamedInputConnectionPoints(o),this.node.io.outputs.setNamedOutputConnectionPoints(s,e),this._create_spare_params_from_inputs&&this._spare_params_controller.createSpareParameters()}_connections_match_inputs(){let e=this.node.io.inputs.namedInputConnectionPoints().map(s=>s==null?void 0:s.type()),t=this.node.io.outputs.namedOutputConnectionPoints().map(s=>s==null?void 0:s.type()),r=this._wrapped_expected_input_types_function(),o=this._wrapped_expected_output_types_function();if(r.length!=e.length||o.length!=t.length)return!1;for(let s=0;s<e.length;s++)if(e[s]!=r[s])return!1;for(let s=0;s<t.length;s++)if(t[s]!=o[s])return!1;return!0}_wrapped_expected_input_types_function(){if(this.node.scene().loadingController.isLoading()){let e=this.node.io.saved_connection_points_data.in();if(e)return e.map(t=>t.type)}return this._expected_input_types_function()}_wrapped_expected_output_types_function(){if(this.node.scene().loadingController.isLoading()){let e=this.node.io.saved_connection_points_data.out();if(e)return e.map(t=>t.type)}return this._expected_output_types_function()}_wrapped_input_name_function(e){if(this.node.scene().loadingController.isLoading()){let t=this.node.io.saved_connection_points_data.in();if(t)return t[e].name}return this._input_name_function(e)}_wrapped_output_name_function(e){if(this.node.scene().loadingController.isLoading()){let t=this.node.io.saved_connection_points_data.out();if(t)return t[e].name}return this._output_name_function(e)}first_input_connection_type(){return this.input_connection_type(0)}input_connection_type(e){let t=this.node.io.connections.inputConnections();if(t){let r=t[e];if(r)return r.src_connection_point().type()}}};var E2=class{constructor(e){this.node=e,this._connections=new g2(this.node)}dispose(){this.inputs.dispose(),this.outputs.dispose(),this.connections.dispose()}get connections(){return this._connections}get inputs(){return this._inputs=this._inputs||new h2(this.node)}hasInputs(){return this._inputs!=null}get outputs(){return this._outputs=this._outputs||new _2(this.node)}has_outputs(){return this._outputs!=null}get connection_points(){return this._connection_points=this._connection_points||new T2(this.node,this.node.context())}get has_connection_points_controller(){return this._connection_points!=null}get saved_connection_points_data(){return this._saved_connection_points_data=this._saved_connection_points_data||new v2(this.node)}clear_saved_connection_points_data(){this._saved_connection_points_data&&(this._saved_connection_points_data.clear(),this._saved_connection_points_data=void 0)}};var A2=class{constructor(){}};var no=class extends zr{constructor(e,t="BaseNode",r){super(e,t);this.createOptions=r,this.containerController=new k9(this),this.pv=new p2,this.p=new A2,this._initialized=!1}copy_param_values(e){let t=this.params.non_spare;for(let r of t){let o=e.params.get(r.name());o&&r.copyValue(o)}}get parentController(){return this._parent_controller=this._parent_controller||new l9(this)}static displayedInputNames(){return[]}childrenControllerContext(){return this._childrenControllerContext}_create_childrenController(){if(this._childrenControllerContext)return new m9(this,this._childrenControllerContext)}get childrenController(){return this._childrenController=this._childrenController||this._create_childrenController()}childrenAllowed(){return this._childrenControllerContext!=null}get uiData(){return this._uiData=this._uiData||new Q_(this)}get states(){return this._states=this._states||new a9(this)}get lifecycle(){return this._lifecycle=this._lifecycle||new h9(this)}get serializer(){return this._serializer=this._serializer||new Cu(this)}get cookController(){return this._cookController=this._cookController||new G9(this)}get io(){return this._io=this._io||new E2(this)}get nameController(){return this._nameController=this._nameController||new vu(this)}setName(e){this.nameController.setName(e)}_setCoreName(e){this._name=e}get params(){return this._paramsController=this._paramsController||new u2(this)}initializeBaseAndNode(){var e;this._initialized?console.warn("node already initialized"):(this._initialized=!0,(e=this.displayNodeController)==null||e.initializeNode(),this.initializeBaseNode(),this.initializeNode(),this.polyNodeController&&this.polyNodeController.initializeNode())}initializeBaseNode(){}initializeNode(){}static type(){throw"type to be overriden"}type(){return this.constructor.type()}static context(){throw console.error("node has no node_context",this),"context requires override"}context(){return this.constructor.context()}static require_webgl2(){return!1}require_webgl2(){return this.constructor.require_webgl2()}setParent(e){this.parentController.setParent(e)}parent(){return this.parentController.parent()}firstAncestorWithContext(e){return this.parentController.firstAncestorWithContext(e)}root(){return this._scene.root()}path(e){return this.parentController.path(e)}createParams(){}addParam(e,t,r,o){var s;return(s=this._paramsController)==null?void 0:s.addParam(e,t,r,o)}paramDefaultValue(e){return null}cook(e){return null}onCookEnd(e,t){this.cookController.registerOnCookEnd(e,t)}async compute(){var e,t;return this.isDirty()||((t=(e=this.flags)==null?void 0:e.bypass)==null?void 0:t.active())?await this.containerController.compute():this.containerController.container()}_setContainer(e,t=null){this.containerController.container().set_content(e),e!=null&&(e.name||(e.name=this.path()),e.node||(e.node=this)),this.cookController.endCook(t)}createNode(e,t){var r;return(r=this.childrenController)==null?void 0:r.createNode(e,t)}createOperationContainer(e,t,r){var o;return(o=this.childrenController)==null?void 0:o.createOperationContainer(e,t,r)}removeNode(e){var t;(t=this.childrenController)==null||t.removeNode(e)}dispose(){super.dispose(),this.setParent(null),this._nameController&&(this._nameController.dispose(),this._nameController=void 0),this._io&&(this._io.dispose(),this._io=void 0),this._lifecycle&&(this._lifecycle.dispose(),this._lifecycle=void 0),this.displayNodeController&&this.displayNodeController.dispose(),this._childrenController&&(this._childrenController.dispose(),this._childrenController=void 0),this._paramsController&&(this._paramsController.dispose(),this._paramsController=void 0),this._cookController&&(this._cookController.dispose(),this._cookController=void 0),this._serializer&&(this._serializer.dispose(),this._serializer=void 0),this._uiData&&(this._uiData.dispose(),this._uiData=void 0)}children(){var e;return((e=this.childrenController)==null?void 0:e.children())||[]}node(e){var t;return((t=this.parentController)==null?void 0:t.findNode(e))||null}nodeSibling(e){var t;let r=this.parent();if(r){let o=(t=r.childrenController)==null?void 0:t.childByName(e);if(o)return o}return null}nodesByType(e){var t;return((t=this.childrenController)==null?void 0:t.nodesByType(e))||[]}setInput(e,t,r=0){this.io.inputs.setInput(e,t,r)}emit(e,t=null){this.scene().dispatchController.dispatch(this,e,t)}toJSON(e=!1){return this.serializer.toJSON(e)}async requiredModules(){}usedAssembler(){}integrationData(){}};var M2=class extends no{static context(){return it.MANAGER}};var Ao=class{constructor(e,t,r){this.type=e,this.init_value=t,this.options=r}},N=class{static BUTTON(e,t){return new Ao(Te.BUTTON,e,t)}static BOOLEAN(e,t){return new Ao(Te.BOOLEAN,e,t)}static COLOR(e,t){return e instanceof Ke&&(e=e.toArray()),new Ao(Te.COLOR,e,t)}static FLOAT(e,t){return new Ao(Te.FLOAT,e,t)}static FOLDER(e=null,t){return new Ao(Te.FOLDER,e,t)}static INTEGER(e,t){return new Ao(Te.INTEGER,e,t)}static RAMP(e=di.DEFAULT_VALUE,t){return new Ao(Te.RAMP,e,t)}static STRING(e="",t){return new Ao(Te.STRING,e,t)}static VECTOR2(e,t){return e instanceof re&&(e=e.toArray()),new Ao(Te.VECTOR2,e,t)}static VECTOR3(e,t){return e instanceof F&&(e=e.toArray()),new Ao(Te.VECTOR3,e,t)}static VECTOR4(e,t){return e instanceof kt&&(e=e.toArray()),new Ao(Te.VECTOR4,e,t)}static NODE_PATH(e,t){return new Ao(Te.NODE_PATH,e,t)}static PARAM_PATH(e,t){return new Ao(Te.PARAM_PATH,e,t)}},je=class{};var mN="/",N2=class{constructor(e){this.scene=e}findObjectByMask(e){return this.findObjectByMaskInObject(e,this.scene.threejsScene())}findObjectByMaskInObject(e,t,r=""){for(let o of t.children){let s=this._removeTrailingOrHeadingSlash(o.name);r=this._removeTrailingOrHeadingSlash(r);let i=`${r}/${s}`;if(Rt.matchMask(i,e))return o;let l=this.findObjectByMaskInObject(e,o,i);if(l)return l}}objectsByMask(e){let t=[];return this.traverseObjectsWithMask(e,r=>{t.push(r)}),t}objectsByMaskInObject(e,t,r=[],o=""){return this.traverseObjectsWithMask(e,s=>{r.push(s)}),r}traverseObjectsWithMask(e,t,r=!1){this.traverseObjectsWithMaskInObject(e,this.scene.threejsScene(),t,r)}traverseObjectsWithMaskInObject(e,t,r,o,s=""){for(let i of t.children){let l=this._removeTrailingOrHeadingSlash(i.name);s=this._removeTrailingOrHeadingSlash(s);let a=`${s}/${l}`,c=Rt.matchMask(a,e);o&&(c=!c),c&&r(i),this.traverseObjectsWithMaskInObject(e,i,r,o,a)}}_removeTrailingOrHeadingSlash(e){return e[0]=="/"&&(e=e.substr(1)),e[e.length-1]=="/"&&(e=e.substr(0,e.length-1)),e}};var hN={computeOnDirty:!1,callback:n=>{yf.update(n)}};function _N(n){return class extends n{constructor(){super(...arguments);this.displayAudioIcon=N.BOOLEAN(0,{...hN}),this.audioIconColor=N.COLOR([0,0,0],{...hN,visibleIf:{displayAudioIcon:1}})}}}var yf=class{constructor(e){this.node=e,this._callbacksByName=new Map}async toggleSound(){this.audioListeners().forEach(e=>{e.toggleSound()}),this.update(),this._runOnToggleSoundCallbacks()}soundOn(){let e=this.audioListeners()[0];return e&&Ie(e.pv.soundOn)||!1}update(){this._updateViewers()}audioListeners(){return this.node.nodesByType("audioListener")}_updateViewers(){this.node.scene().viewersRegister.traverseViewers(e=>{e.audioController().update()})}static update(e){e.audioController.update()}onToggleSound(e,t){if(this._callbacksByName.get(e)){console.warn(`callback already registered ith name '${e}'`);return}this._callbacksByName.set(e,t)}_runOnToggleSoundCallbacks(){let e=this.soundOn();this._callbacksByName.forEach(t=>{t(e)})}};var TW={computeOnDirty:!1,callback:n=>{kl.update(n)}};function bf(n){return class extends n{constructor(){super(...arguments);this.autoUpdate=N.BOOLEAN(1,TW)}}}var kl=class{constructor(e){this.node=e}async update(){let e=this.node.object,t=this.node.pv;Ie(t.autoUpdate)!=e.autoUpdate&&(e.autoUpdate=Ie(t.autoUpdate))}static async update(e){e.sceneAutoUpdateController.update()}};var Fl=["none","color","texture"],S2={computeOnDirty:!1,callback:n=>{Gl.update(n)}};function xf(n){return class extends n{constructor(){super(...arguments);this.backgroundMode=N.INTEGER(Fl.indexOf("none"),{menu:{entries:Fl.map((t,r)=>({name:t,value:r}))},...S2}),this.bgColor=N.COLOR([0,0,0],{visibleIf:{backgroundMode:Fl.indexOf("color")},...S2}),this.bgTexture=N.NODE_PATH("",{visibleIf:{backgroundMode:Fl.indexOf("texture")},nodeSelection:{context:it.COP},dependentOnFoundNode:!1,...S2})}}}var Gl=class{constructor(e){this.node=e}update(){let e=this.node.object,t=this.node.pv;if(t.backgroundMode==Fl.indexOf("none"))e.background=null;else if(t.backgroundMode==Fl.indexOf("color"))e.background=t.bgColor;else{let r=t.bgTexture.nodeWithContext(it.COP);r?r.compute().then(o=>{e.background=o.texture()}):this.node.states.error.set("bgTexture node not found")}}static update(e){e.sceneBackgroundController.update()}};var gN={computeOnDirty:!1,callback:n=>{Ul.update(n)}};function Cf(n){return class extends n{constructor(){super(...arguments);this.useEnvironment=N.BOOLEAN(0,gN),this.environment=N.NODE_PATH("",{visibleIf:{useEnvironment:1},nodeSelection:{context:it.COP},dependentOnFoundNode:!1,...gN})}}}var Ul=class{constructor(e){this.node=e}async update(){let e=this.node.object,t=this.node.pv;if(Ie(t.useEnvironment)){let r=t.environment.nodeWithContext(it.COP);r?r.compute().then(o=>{e.environment=o.texture()}):this.node.states.error.set("bgTexture node not found")}else e.environment=null}static async update(e){e.sceneEnvController.update()}};var Di=class{constructor(e,t=1,r=1e3){this.name="",this.color=new Ke(e),this.near=t,this.far=r}clone(){return new Di(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}};Di.prototype.isFog=!0;var Bi=class{constructor(e,t=25e-5){this.name="",this.color=new Ke(e),this.density=t}clone(){return new Bi(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}};Bi.prototype.isFogExp2=!0;var Vl={computeOnDirty:!1,callback:n=>{Hl.update(n)}};var zl=["linear","exponential"];function Pu(n){return class extends n{constructor(){super(...arguments);this.useFog=N.BOOLEAN(0,Vl),this.fogType=N.INTEGER(zl.indexOf("exponential"),{visibleIf:{useFog:1},menu:{entries:zl.map((t,r)=>({name:t,value:r}))},...Vl}),this.fogColor=N.COLOR([1,1,1],{visibleIf:{useFog:1},...Vl}),this.fogNear=N.FLOAT(1,{range:[0,100],rangeLocked:[!0,!1],visibleIf:{useFog:1,fogType:zl.indexOf("linear")},...Vl}),this.fogFar=N.FLOAT(100,{range:[0,100],rangeLocked:[!0,!1],visibleIf:{useFog:1,fogType:zl.indexOf("linear")},...Vl}),this.fogDensity=N.FLOAT(25e-5,{visibleIf:{useFog:1,fogType:zl.indexOf("exponential")},...Vl})}}}var EW=class extends Pu(je){},Hl=class{constructor(e){this.node=e}async update(){let e=this.node.object,t=this.node.pv;if(Ie(t.useFog))if(t.fogType==zl.indexOf("linear")){let r=this.fog2(t);e.fog=r,r.color=t.fogColor,r.near=t.fogNear,r.far=t.fogFar}else{let r=this.fogExp2(t);e.fog=this.fogExp2(t),r.color=t.fogColor,r.density=t.fogDensity}else e.fog&&(e.fog=null)}fog2(e){return this._fog=this._fog||new Di(16777215,e.fogNear,e.fogFar)}fogExp2(e){return this._fogExp2=this._fogExp2||new Bi(16777215,e.fogDensity)}static async update(e){e.sceneFogController.update()}};function vN(n){return class extends n{constructor(){super(...arguments);this.nodesMask=N.STRING("*/file* */image* */envMap*",{cook:!1}),this.printNodes=N.BUTTON(null,{cook:!1,callback:t=>{Tf.PARAM_CALLBACK_printResolve(t)}})}}}var Tf=class{constructor(e){this.node=e}static async PARAM_CALLBACK_printResolve(e){let t=await e.loadProgress.resolvedNodes();console.log(t);let r=t.map(o=>o.path()).sort();console.log(r)}async resolvedNodes(){let e=this.node.p.nodesMask;e.isDirty()&&await e.compute();let t=e.value;return this.node.scene().nodesController.nodesFromMask(t||"")}};var yN={computeOnDirty:!1,callback:n=>{jl.update(n)}};function Ef(n){return class extends n{constructor(){super(...arguments);this.useOverrideMaterial=N.BOOLEAN(0,yN),this.overrideMaterial=N.NODE_PATH("",{visibleIf:{useOverrideMaterial:1},nodeSelection:{context:it.MAT},dependentOnFoundNode:!1,...yN})}}}var jl=class{constructor(e){this.node=e}async update(){let e=this.node.object,t=this.node.pv;if(Ie(t.useOverrideMaterial)){let r=t.overrideMaterial.nodeWithContext(it.MAT);if(r){let o=await r.compute();e.overrideMaterial=o.material()}else e.overrideMaterial=null,this.node.states.error.set("overrideMaterial node not found")}else e.overrideMaterial=null}static async update(e){e.sceneMaterialOverrideController.update()}};var bN="RootNode",xN=class extends vN(_N(Ef(Cf(Pu(xf(bf(je))))))){},AW=new xN,P2=class extends M2{constructor(){super(...arguments);this.paramsConfig=AW,this._object=this._createScene(),this._queued_nodes_by_id=new Map,this.audioController=new yf(this),this.sceneAutoUpdateController=new kl(this),this.sceneBackgroundController=new Gl(this),this.sceneEnvController=new Ul(this),this.sceneFogController=new Hl(this),this.loadProgress=new Tf(this),this.sceneMaterialOverrideController=new jl(this),this._childrenControllerContext=it.OBJ}static type(){return"root"}cook(){this.cookController.endCook()}initializeNode(){this._object.matrixAutoUpdate=!1,this.lifecycle.onChildAdd(this._on_child_add.bind(this)),this.lifecycle.onChildRemove(this._on_child_remove.bind(this))}_createScene(){let e=new Zo;return e.name=mN,e.matrixAutoUpdate=!1,e}get object(){return this._object}createNode(e,t){return super.createNode(e,t)}children(){return super.children()}nodesByType(e){return super.nodesByType(e)}_updateScene(){this.sceneAutoUpdateController.update(),this.sceneBackgroundController.update(),this.sceneEnvController.update(),this.sceneFogController.update(),this.sceneMaterialOverrideController.update()}_addToQueue(e){let t=e.graphNodeId();return this._queued_nodes_by_id.has(t)||this._queued_nodes_by_id.set(t,e),e}async processQueue(){this._updateScene();let e=new Map,t=[];this._queued_nodes_by_id.forEach((r,o)=>{let s=`_____${r.renderOrder}__${r.path()}`;t.push(s),e.set(s,r)}),this._queued_nodes_by_id.clear();for(let r of t){let o=e.get(r);o&&(e.delete(r),this._addToScene(o))}}_update_object(e){return this.scene().loadingController.autoUpdating()?(e.isDisplayed()&&!e.cookController.isCooking()&&e.compute(),this._addToScene(e)):this._addToQueue(e)}getParentForNode(e){if(e.attachableToHierarchy()){let t=e.io.inputs.input(0);return t?t.childrenGroup():this._object}else return null}_addToScene(e){var t;if(e.attachableToHierarchy()){let r=this.getParentForNode(e);r&&(e.usedInScene()?((t=e.childrenDisplayController)==null||t.request_display_node_container(),e.addObjectToParent(r)):e.removeObjectFromParent())}}_removeFromScene(e){e.removeObjectFromParent()}areChildrenCooking(){let e=this.children();for(let t of e)if(t.cookController.isCooking()||t.isDisplayNodeCooking())return!0;return!1}addToParentTransform(e){this._update_object(e)}removeFromParentTransform(e){this._update_object(e)}_on_child_add(e){e&&this._update_object(e)}_on_child_remove(e){e&&this._removeFromScene(e)}};var O2=class{constructor(e){this.scene=e,this._node_context_signatures={},this._instanciated_nodes_by_context_and_type={}}init(){this._root=new P2(this.scene,bN),this._root.initializeBaseAndNode(),this._root.params.init()}root(){return this._root}_traverseNode(e,t){let r=e.children();if(!(!r||r.length==0))for(let o of r)t(o),o.childrenController&&this._traverseNode(o,t)}clear(){var e;let t=this.root().children();for(let r of t)(e=this.root().childrenController)==null||e.removeNode(r)}node(e){return e==="/"?this.root():this.root().node(e)}allNodes(){let e=[this.root()],t=[this.root()],r=0;for(;t.length>0&&r<10;){let o=t.map(s=>s.childrenAllowed()?s.children():[]).flat();e=e.concat(o),t=o,r+=1}return e.flat()}nodesFromMask(e){let t=this.allNodes(),r=[];for(let o of t){let s=o.path();Rt.matchMask(s,e)&&r.push(o)}return r}reset_node_context_signatures(){this._node_context_signatures={}}register_node_context_signature(e){e.childrenAllowed()&&e.childrenController&&(this._node_context_signatures[e.childrenController.node_context_signature()]=!0)}node_context_signatures(){return Object.keys(this._node_context_signatures).sort().map(e=>e.toLowerCase())}addToInstanciatedNode(e){let t=e.context(),r=e.type();this._instanciated_nodes_by_context_and_type[t]=this._instanciated_nodes_by_context_and_type[t]||{},this._instanciated_nodes_by_context_and_type[t][r]=this._instanciated_nodes_by_context_and_type[t][r]||{},this._instanciated_nodes_by_context_and_type[t][r][e.graphNodeId()]=e}removeFromInstanciatedNode(e){let t=e.context(),r=e.type();delete this._instanciated_nodes_by_context_and_type[t][r][e.graphNodeId()]}nodesByType(e){let t=[];return this._traverseNode(this.scene.root(),r=>{r.type()==e&&t.push(r)}),t}nodesByContextAndType(e,t){let r=[],o=this._instanciated_nodes_by_context_and_type[e];if(o){let s=o[t];if(s)for(let i of Object.keys(s))r.push(s[i])}return r}};var w2=class{constructor(e){this.scene=e}toJSON(e=!1){let t={},r={};for(let o of this.scene.nodesController.allNodes()){let s=new Cu(o);t[o.graphNodeId()]=s.toJSON(e);let i=o.params.all;for(let l of i)r[l.graphNodeId()]=l.toJSON()}return{nodes_by_graph_node_id:t,params_by_graph_node_id:r}}};var ko=class{constructor(e){this.dispatcher=e,this._nodesByGraphNodeId=new Map,this._requireCanvasEventListeners=!1,this._activeEventDatas=[],this._activeEventDataTypes=new Set}registerNode(e){this._nodesByGraphNodeId.set(e.graphNodeId(),e),this.updateViewerEventListeners()}unregisterNode(e){this._nodesByGraphNodeId.delete(e.graphNodeId()),this.updateViewerEventListeners()}processEvent(e){var t;if(this._activeEventDatas.length==0)return;let r=(t=e.event)==null?void 0:t.type;r&&!this._activeEventDataTypes.has(r)||this._nodesByGraphNodeId.forEach(o=>{o.processEvent(e)})}updateViewerEventListeners(){this._updateActiveEventTypes(),this._requireCanvasEventListeners&&this.dispatcher.scene.viewersRegister.traverseViewers(e=>{e.eventsController().updateEvents(this)})}activeEventDatas(){return this._activeEventDatas}_updateActiveEventTypes(){let e=new Map;this._activeEventDataTypes.clear(),this._nodesByGraphNodeId.forEach(t=>{if(t.parent()){let r=t.activeEventDatas();for(let o of r)e.set(o,!0)}}),this._activeEventDatas=[],e.forEach((t,r)=>{this._activeEventDatas.push(r),this._activeEventDataTypes.add(r.type)})}};var Af=["auxclick","click","contextmenu","dblclick","mousedown","mouseenter","mouseleave","mousemove","mouseover","mouseout","mouseup","pointerlockchange","pointerlockerror","select","wheel"],R2=class extends ko{constructor(){super(...arguments);this._requireCanvasEventListeners=!0}type(){return"mouse"}acceptedEventTypes(){return new Set(Af.map(e=>`${e}`))}};var Ou=class extends no{constructor(){super(...arguments);this._cook_without_inputs_bound=this._cook_without_inputs.bind(this)}static context(){return it.EVENT}initializeBaseNode(){this.uiData.setLayoutHorizontal(),this.addPostDirtyHook("cook_without_inputs_on_dirty",this._cook_without_inputs_bound),this.io.inputs.set_depends_on_inputs(!1),this.io.connections.initInputs(),this.io.connection_points.spare_params.initializeNode()}_cook_without_inputs(){this.cookController.cookMainWithoutInputs()}cook(){this.cookController.endCook()}processEventViaConnectionPoint(e,t){t.event_listener?t.event_listener(e):this.processEvent(e)}processEvent(e){}async dispatchEventToOutput(e,t){this.run_on_dispatch_hook(e,t);let r=this.io.outputs.getOutputIndex(e);if(r>=0){let s=this.io.connections.outputConnections().filter(l=>l.output_index==r),i;for(let l of s){i=l.node_dest;let a=i.io.inputs.namedInputConnectionPoints()[l.input_index];i.processEventViaConnectionPoint(t,a)}}else console.warn(`requested output '${e}' does not exist on node '${this.path()}'`)}onDispatch(e,t){this._on_dispatch_hooks_by_output_name=this._on_dispatch_hooks_by_output_name||new Map,Ir.pushOnArrayAtEntry(this._on_dispatch_hooks_by_output_name,e,t)}run_on_dispatch_hook(e,t){if(this._on_dispatch_hooks_by_output_name){let r=this._on_dispatch_hooks_by_output_name.get(e);if(r)for(let o of r)o(t)}}};var ql=["keydown","keypress","keyup"],L2=class extends ko{constructor(){super(...arguments);this._requireCanvasEventListeners=!0}type(){return"keyboard"}acceptedEventTypes(){return new Set(ql.map(e=>`${e}`))}};var fi=(n=>(n.CANVAS="canvas",n.DOCUMENT="document",n))(fi||{}),Fn=["canvas","document"];function MW(n,e){return n=="canvas"?e:document}var I2=class{constructor(e){this.viewer=e,this._bound_listener_map_by_event_controller_type=new Map}updateEvents(e){let t=this.canvas();if(!t){console.warn("no canvas found");return}let r=e.type(),o=this._bound_listener_map_by_event_controller_type.get(r);o||(o=new Map,this._bound_listener_map_by_event_controller_type.set(r,o)),o.forEach((i,l)=>{for(let a of Fn)this._eventOwner({emitter:a,type:l},t).removeEventListener(l,i.listener)}),o.clear();let s=i=>{this.processEvent(i,e,t)};for(let i of e.activeEventDatas()){let l=this._eventOwner(i,t);l.addEventListener(i.type,s),l!=document&&ql.includes(i.type)&&l.setAttribute("tabindex","0"),o.set(i.type,{listener:s,data:i})}}_eventOwner(e,t){return e.type=="resize"?window:MW(e.emitter,t)}cameraNode(){return this.viewer.camerasController().cameraNode()}canvas(){return this.viewer.canvas()}init(){if(!this.canvas()){console.warn("no canvas found for eventsController");return}this.viewer.scene().eventsDispatcher.traverseControllers(e=>{this.updateEvents(e)})}registeredEventTypes(){let e=[];return this._bound_listener_map_by_event_controller_type.forEach(t=>{t.forEach((r,o)=>{e.push(o)})}),e}dispose(){let e=this.canvas();this._bound_listener_map_by_event_controller_type.forEach(t=>{e&&t.forEach((r,o)=>{this._eventOwner(r.data,e).removeEventListener(o,r.listener)})})}processEvent(e,t,r){let o={viewer:this.viewer,event:e,cameraNode:this.cameraNode()};t.processEvent(o)}};var Jt={visibleIf:{active:1},callback:n=>{CN.PARAM_CALLBACK_updateRegister(n)}},Mo=class extends Ou{constructor(){super(...arguments);this._activeEventDatas=[]}initializeBaseNode(){super.initializeBaseNode();let e=()=>{this.scene().eventsDispatcher.registerEventNode(this)},t=()=>{this.scene().eventsDispatcher.unregisterEventNode(this)};this.lifecycle.onAfterAdded(e),this.lifecycle.onBeforeDeleted(t),this.params.onParamsCreated("update_register",()=>{this._updateRegister()})}processEvent(e){!this.pv.active||!e.event||this.dispatchEventToOutput(e.event.type,e)}static PARAM_CALLBACK_updateRegister(e){e._updateRegister()}_updateRegister(){this._updateActiveEventDatas(),this.scene().eventsDispatcher.updateViewerEventListeners(this)}_updateActiveEventDatas(){this._activeEventDatas=[],this.pv.active&&this.acceptedEventTypes().forEach(t=>{let r=this.params.get(t);r&&r.value&&this._activeEventDatas.push({type:t,emitter:Fn[this.pv.element]})})}activeEventDatas(){return this._activeEventDatas}};var CN=class extends Mo{acceptedEventTypes(){return new Set}};var TN=class extends je{constructor(){super(...arguments);this.active=N.BOOLEAN(!0,{callback:e=>{Mf.PARAM_CALLBACK_updateRegister(e)},separatorAfter:!0}),this.element=N.INTEGER(Fn.indexOf(fi.CANVAS),{menu:{entries:Fn.map((e,t)=>({name:e,value:t}))},separatorAfter:!0}),this.auxclick=N.BOOLEAN(0,Jt),this.click=N.BOOLEAN(0,Jt),this.contextmenu=N.BOOLEAN(0,Jt),this.dblclick=N.BOOLEAN(0,Jt),this.mousedown=N.BOOLEAN(1,Jt),this.mouseenter=N.BOOLEAN(0,Jt),this.mouseleave=N.BOOLEAN(0,Jt),this.mousemove=N.BOOLEAN(1,Jt),this.mouseover=N.BOOLEAN(0,Jt),this.mouseout=N.BOOLEAN(0,Jt),this.mouseup=N.BOOLEAN(1,Jt),this.pointerlockchange=N.BOOLEAN(0,Jt),this.pointerlockerror=N.BOOLEAN(0,Jt),this.select=N.BOOLEAN(0,Jt),this.wheel=N.BOOLEAN(0,Jt),this.ctrlKey=N.BOOLEAN(0,{...Jt,separatorBefore:!0}),this.altKey=N.BOOLEAN(0,Jt),this.shiftKey=N.BOOLEAN(0,Jt),this.metaKey=N.BOOLEAN(0,Jt)}},NW=new TN,Mf=class extends Mo{constructor(){super(...arguments);this.paramsConfig=NW}static type(){return"mouse"}acceptedEventTypes(){return new Set(Af.map(e=>`${e}`))}initializeNode(){this.io.outputs.setNamedOutputConnectionPoints(Af.map(e=>new kn(e,Bn.MOUSE)))}processEvent(e){if(!this.pv.active||!e.event)return;let t=e.event;t.ctrlKey==Ie(this.pv.ctrlKey)&&t.shiftKey==Ie(this.pv.shiftKey)&&t.altKey==Ie(this.pv.altKey)&&t.metaKey==Ie(this.pv.metaKey)&&this.dispatchEventToOutput(e.event.type,e)}};var Nf=["pointerdown","pointermove","pointerup"],D2=class extends ko{constructor(){super(...arguments);this._requireCanvasEventListeners=!0}type(){return"pointer"}acceptedEventTypes(){return new Set(Nf.map(e=>`${e}`))}};var EN=class extends je{constructor(){super(...arguments);this.active=N.BOOLEAN(!0,{callback:e=>{Sf.PARAM_CALLBACK_updateRegister(e)},separatorAfter:!0}),this.element=N.INTEGER(Fn.indexOf(fi.CANVAS),{menu:{entries:Fn.map((e,t)=>({name:e,value:t}))},separatorAfter:!0}),this.pointerdown=N.BOOLEAN(1,Jt),this.pointermove=N.BOOLEAN(0,Jt),this.pointerup=N.BOOLEAN(0,Jt),this.ctrlKey=N.BOOLEAN(0,{...Jt,separatorBefore:!0}),this.altKey=N.BOOLEAN(0,Jt),this.shiftKey=N.BOOLEAN(0,Jt),this.metaKey=N.BOOLEAN(0,Jt)}},SW=new EN,Sf=class extends Mo{constructor(){super(...arguments);this.paramsConfig=SW}static type(){return"pointer"}acceptedEventTypes(){return new Set(Nf.map(e=>`${e}`))}initializeNode(){this.io.outputs.setNamedOutputConnectionPoints(Nf.map(e=>new kn(e,Bn.POINTER)))}processEvent(e){if(!this.pv.active||!e.event)return;let t=e.event;t.ctrlKey==Ie(this.pv.ctrlKey)&&t.shiftKey==Ie(this.pv.shiftKey)&&t.altKey==Ie(this.pv.altKey)&&t.metaKey==Ie(this.pv.metaKey)&&this.dispatchEventToOutput(e.event.type,e)}};var AN=class extends je{constructor(){super(...arguments);this.active=N.BOOLEAN(!0,{callback:(e,t)=>{Pf.PARAM_CALLBACK_updateRegister(e)},separatorAfter:!0}),this.element=N.INTEGER(Fn.indexOf(fi.CANVAS),{menu:{entries:Fn.map((e,t)=>({name:e,value:t}))},separatorAfter:!0,...Jt}),this.keydown=N.BOOLEAN(1,Jt),this.keypress=N.BOOLEAN(0,Jt),this.keyup=N.BOOLEAN(0,Jt),this.keyCodes=N.STRING("Digit1 KeyE ArrowDown",Jt),this.ctrlKey=N.BOOLEAN(0,Jt),this.altKey=N.BOOLEAN(0,Jt),this.shiftKey=N.BOOLEAN(0,Jt),this.metaKey=N.BOOLEAN(0,Jt)}},PW=new AN,Pf=class extends Mo{constructor(){super(...arguments);this.paramsConfig=PW}static type(){return"keyboard"}acceptedEventTypes(){return new Set(ql.map(e=>`${e}`))}initializeNode(){this.io.outputs.setNamedOutputConnectionPoints(ql.map(e=>new kn(e,Bn.KEYBOARD)))}setElement(e){this.p.element.set(Fn.indexOf(e))}processEvent(e){if(!this.pv.active||!e.event)return;let t=e.event;t.ctrlKey==Ie(this.pv.ctrlKey)&&t.shiftKey==Ie(this.pv.shiftKey)&&t.altKey==Ie(this.pv.altKey)&&t.metaKey==Ie(this.pv.metaKey)&&(!Rt.matchMask(t.code,this.pv.keyCodes)||this.dispatchEventToOutput(e.event.type,e))}};var Of=["resize"],B2=class extends ko{constructor(){super(...arguments);this._requireCanvasEventListeners=!0}type(){return"window"}acceptedEventTypes(){return new Set(Of.map(e=>`${e}`))}};var MN=class extends je{constructor(){super(...arguments);this.active=N.BOOLEAN(!0,{callback:e=>{wf.PARAM_CALLBACK_updateRegister(e)},separatorAfter:!0}),this.element=N.INTEGER(0,{hidden:!0}),this.resize=N.BOOLEAN(1,Jt)}},OW=new MN,wf=class extends Mo{constructor(){super(...arguments);this.paramsConfig=OW}static type(){return"window"}acceptedEventTypes(){return new Set(Of.map(e=>`${e}`))}initializeNode(){this.io.outputs.setNamedOutputConnectionPoints(Of.map(e=>new kn(e,Bn.POINTER)))}processEvent(e){!this.pv.active||!e.event||this.dispatchEventToOutput(e.event.type,e)}};var Rf=["dragover"],k2=class extends ko{constructor(){super(...arguments);this._requireCanvasEventListeners=!0}type(){return"drag"}acceptedEventTypes(){return new Set(Rf.map(e=>`${e}`))}};var Lf=["touchstart","touchmove","touchend"],F2=class extends ko{constructor(){super(...arguments);this._requireCanvasEventListeners=!0}type(){return"touch"}acceptedEventTypes(){return new Set(Lf.map(e=>`${e}`))}};var NN=class extends je{constructor(){super(...arguments);this.active=N.BOOLEAN(!0,{callback:e=>{If.PARAM_CALLBACK_updateRegister(e)},separatorAfter:!0}),this.element=N.INTEGER(Fn.indexOf(fi.CANVAS),{menu:{entries:Fn.map((e,t)=>({name:e,value:t}))},separatorAfter:!0}),this.dragover=N.BOOLEAN(1,Jt),this.ctrlKey=N.BOOLEAN(0,{...Jt,separatorBefore:!0}),this.altKey=N.BOOLEAN(0,Jt),this.shiftKey=N.BOOLEAN(0,Jt),this.metaKey=N.BOOLEAN(0,Jt)}},wW=new NN,If=class extends Mo{constructor(){super(...arguments);this.paramsConfig=wW}static type(){return"drag"}acceptedEventTypes(){return new Set(Rf.map(e=>`${e}`))}initializeNode(){this.io.outputs.setNamedOutputConnectionPoints(Rf.map(e=>new kn(e,Bn.DRAG)))}processEvent(e){if(!this.pv.active||!e.event)return;let t=e.event;t.ctrlKey==Ie(this.pv.ctrlKey)&&t.shiftKey==Ie(this.pv.shiftKey)&&t.altKey==Ie(this.pv.altKey)&&t.metaKey==Ie(this.pv.metaKey)&&this.dispatchEventToOutput(e.event.type,e)}};var SN=class extends je{constructor(){super(...arguments);this.active=N.BOOLEAN(!0,{callback:e=>{Df.PARAM_CALLBACK_updateRegister(e)},separatorAfter:!0}),this.element=N.INTEGER(Fn.indexOf(fi.CANVAS),{menu:{entries:Fn.map((e,t)=>({name:e,value:t}))},separatorAfter:!0}),this.touchstart=N.BOOLEAN(1,Jt),this.touchmove=N.BOOLEAN(0,Jt),this.touchend=N.BOOLEAN(0,Jt)}},RW=new SN,Df=class extends Mo{constructor(){super(...arguments);this.paramsConfig=RW}static type(){return"touch"}acceptedEventTypes(){return new Set(Lf.map(e=>`${e}`))}initializeNode(){this.io.outputs.setNamedOutputConnectionPoints(Lf.map(e=>new kn(e,Bn.DRAG)))}processEvent(e){!this.pv.active||!e.event||this.dispatchEventToOutput(e.event.type,e)}};var G2=class{constructor(e){this.scene=e,this.sceneEventsController=new m_,this._controllers=[]}registerEventNode(e){let t=this._findOrCreateControllerForNode(e);t&&t.registerNode(e)}unregisterEventNode(e){let t=this._findOrCreateControllerForNode(e);t&&t.unregisterNode(e)}updateViewerEventListeners(e){let t=this._findOrCreateControllerForNode(e);t&&t.updateViewerEventListeners()}traverseControllers(e){for(let t of this._controllers)e(t)}_findOrCreateControllerForNode(e){switch(e.type()){case Pf.type():return this.keyboardEventsController;case Mf.type():return this.mouseEventsController;case If.type():return this.dragEventsController;case Sf.type():return this.pointerEventsController;case Df.type():return this.touchEventsController;case wf.type():return this.windowEventsController}}get keyboardEventsController(){return this._keyboardEventsController=this._keyboardEventsController||this._createController(L2)}get mouseEventsController(){return this._mouseEventsController=this._mouseEventsController||this._createController(R2)}get dragEventsController(){return this._dragEventsController=this._dragEventsController||this._createController(k2)}get pointerEventsController(){return this._pointerEventsController=this._pointerEventsController||this._createController(D2)}get windowEventsController(){return this._windowEventsController=this._windowEventsController||this._createController(B2)}get touchEventsController(){return this._touchEventsController=this._touchEventsController||this._createController(F2)}_createController(e){let t=new e(this);return this._controllers.includes(t)||this._controllers.push(t),t}};var U2=class{constructor(e){this.scene=e,this._referenced_nodes_by_src_param_id=new Map,this._referencing_params_by_referenced_node_id=new Map,this._referencing_params_by_all_named_node_ids=new Map}setReferenceFromParam(e,t){this._referenced_nodes_by_src_param_id.set(e.graphNodeId(),t),Ir.pushOnArrayAtEntry(this._referencing_params_by_referenced_node_id,t.graphNodeId(),e)}setNamedNodesFromParam(e){let t=e.decomposed_path.named_nodes();for(let r of t)Ir.pushOnArrayAtEntry(this._referencing_params_by_all_named_node_ids,r.graphNodeId(),e)}resetReferenceFromParam(e){let t=this._referenced_nodes_by_src_param_id.get(e.graphNodeId());if(t){Ir.popFromArrayAtEntry(this._referencing_params_by_referenced_node_id,t.graphNodeId(),e);let r=e.decomposed_path.named_nodes();for(let o of r)Ir.popFromArrayAtEntry(this._referencing_params_by_all_named_node_ids,o.graphNodeId(),e);this._referenced_nodes_by_src_param_id.delete(e.graphNodeId())}}referencing_params(e){return this._referencing_params_by_referenced_node_id.get(e.graphNodeId())}referencing_nodes(e){let t=this._referencing_params_by_referenced_node_id.get(e.graphNodeId());if(t){let r=new Map;for(let s of t){let i=s.node;r.set(i.graphNodeId(),i)}let o=[];return r.forEach(s=>{o.push(s)}),o}}nodes_referenced_by(e){let t=new Set([Te.NODE_PATH]),r=[];for(let l of e.params.all)t.has(l.type())&&r.push(l);let o=new Map,s=[];for(let l of r)this._check_param(l,o,s);for(let l of s)o.set(l.node.graphNodeId(),l.node);let i=[];return o.forEach(l=>{i.push(l)}),i}_check_param(e,t,r){if(e instanceof Il){let o=e.value.node();o&&t.set(o.graphNodeId(),o);return}}notifyNameUpdated(e){let t=this._referencing_params_by_all_named_node_ids.get(e.graphNodeId());if(t){let r=lr.shallowClone(t);for(let o of r)o.notifyPathRebuildRequired(e)}}notifyParamsUpdated(e){let t=this._referencing_params_by_all_named_node_ids.get(e.graphNodeId());if(t){let r=lr.shallowClone(t);for(let o of r)o.options.isSelectingParam()&&o.notifyTargetParamOwnerParamsUpdated(e)}}};var V2=class{constructor(e){this.scene=e,this._time_dependent_uniform_owners={},this._time_dependent_uniform_owners_ids=null,this._resolution=new re(1,1),this._resolution_dependent_uniform_owners={},this._resolution_dependent_uniform_owners_ids=[]}addTimeDependentUniformOwner(e,t){this._time_dependent_uniform_owners[e]=t,this._time_dependent_uniform_owners_ids||(this._time_dependent_uniform_owners_ids=[]),this._time_dependent_uniform_owners_ids.includes(e)||this._time_dependent_uniform_owners_ids.push(e)}removeTimeDependentUniformOwner(e){if(delete this._time_dependent_uniform_owners[e],this._time_dependent_uniform_owners_ids){let t=this._time_dependent_uniform_owners_ids.indexOf(e);t>=0&&this._time_dependent_uniform_owners_ids.splice(t,1)}}updateTimeDependentUniformOwners(){let e=this.scene.time();if(this._time_dependent_uniform_owners_ids)for(let t of this._time_dependent_uniform_owners_ids){let r=this._time_dependent_uniform_owners[t];r.time.value=e}}addResolutionDependentUniformOwner(e,t){this._resolution_dependent_uniform_owners[e]=t,this._resolution_dependent_uniform_owners_ids||(this._resolution_dependent_uniform_owners_ids=[]),this._resolution_dependent_uniform_owners_ids.includes(e)||this._resolution_dependent_uniform_owners_ids.push(e),this._resolution&&this.updateResolutionDependentUniforms(t)}removeResolutionDependentUniformOwner(e){if(delete this._resolution_dependent_uniform_owners[e],this._resolution_dependent_uniform_owners_ids){let t=this._resolution_dependent_uniform_owners_ids.indexOf(e);t>=0&&this._resolution_dependent_uniform_owners_ids.splice(t,1)}}updateResolutionDependentUniformOwners(e){this._resolution.copy(e);for(let t of this._resolution_dependent_uniform_owners_ids){let r=this._resolution_dependent_uniform_owners[t];this.updateResolutionDependentUniforms(r)}}updateResolutionDependentUniforms(e){e.resolution.value.x=this._resolution.x,e.resolution.value.y=this._resolution.y}};var z2=class{constructor(e){this.scene=e,this._viewersById=new Map,this._viewersByCamera=new Map}registerViewer(e){this._viewersById.set(e.id(),e),this._viewersByCamera.set(e.cameraNode(),e),this._updateCache()}unregisterViewer(e){this._viewersById.delete(e.id()),this._viewersByCamera.delete(e.cameraNode()),this._updateCache()}traverseViewers(e){this._viewersById.forEach(e)}viewerWithCamera(e){let t=this._viewersByCamera.get(e);return t||e.createViewer()}firstViewer(){return this._firstViewer}_updateCache(){this._firstViewer=void 0,this._viewersById.forEach(e=>{this._firstViewer=this._firstViewer||e})}};var H2=class{constructor(){this._require_webgl2=!1}require_webgl2(){return this._require_webgl2}set_require_webgl2(){this._require_webgl2||(this._require_webgl2=!0,Fe.renderersController.setRequireWebGL2())}};var j2=class{constructor(e){this._scene=e,this._onWindowResizeBound=this._onWindowResize.bind(this)}graphNode(){return this._coreGraphNode=this._coreGraphNode||this._createGraphNode()}_createGraphNode(){let e=new zr(this._scene,"SceneWindowController");return window.addEventListener("resize",this._onWindowResizeBound),e}_onWindowResize(){this.graphNode().setSuccessorsDirty()}dispose(){window.removeEventListener("resize",this._onWindowResizeBound)}};var q2=class{constructor(){this._params_by_id=new Map,this._assets_root=null}register_param(e){this._params_by_id.set(e.graphNodeId(),e)}deregister_param(e){this._params_by_id.delete(e.graphNodeId())}traverse_params(e){this._params_by_id.forEach((t,r)=>{e(t)})}root(){return this._assets_root}setRoot(e){e==""&&(e=null),this._assets_root=e}};var W2=class{constructor(){this._cameras_controller=new h_(this),this._cooker=new __(this),this.cookController=new g_,this._graph=new v_,this._missing_expression_references_controller=new Z_(this),this._expressions_controller=new Y_,this._nodes_controller=new O2(this),this._objects_controller=new N2(this),this._references_controller=new U2(this),this._time_controller=new H0(this),this._read_only=!1,this._graph.setScene(this),this.nodesController.init()}threejsScene(){return this.root().object}setUuid(e){return this._uuid=e}get uuid(){return this._uuid}setName(e){return e=Rt.sanitizeName(e),this._name=e}name(){return this._name}get camerasController(){return this._cameras_controller}mainCameraNode(){return this.camerasController.mainCameraNode()}get cooker(){return this._cooker}get assets(){return this._assets_controller=this._assets_controller||new q2}async waitForCooksCompleted(){return await this.cookController.waitForCooksCompleted()}get dispatchController(){return this._dispatch_controller=this._dispatch_controller||new $_(this)}get eventsDispatcher(){return this._events_dispatcher=this._events_dispatcher||new G2(this)}get graph(){return this._graph}get lifecycleController(){return this._lifecycle_controller=this._lifecycle_controller||new X_(this)}get loadingController(){return this._loading_controller=this._loading_controller||new J_(this)}get missingExpressionReferencesController(){return this._missing_expression_references_controller}get expressionsController(){return this._expressions_controller}get nodesController(){return this._nodes_controller}createNode(e,t){return this.root().createNode(e,t)}nodesByType(e){return this.nodesController.nodesByType(e)}get objectsController(){return this._objects_controller}findObjectByMask(e){return this._objects_controller.findObjectByMask(e)}objectsByMask(e){return this._objects_controller.objectsByMask(e)}get referencesController(){return this._references_controller}get performance(){return this._performance=this._performance||new W_}get viewersRegister(){return this._viewers_register=this._viewers_register||new z2(this)}get timeController(){return this._time_controller}setFrame(e){this.timeController.setFrame(e)}setFrameToStart(){this.timeController.setFrameToStart()}frame(){return this.timeController.frame()}time(){return this.timeController.time()}maxFrame(){return this.timeController.maxFrame()}play(){this.timeController.play()}pause(){this.timeController.pause()}get serializer(){return this._serializer=this._serializer||new w2(this)}toJSON(){return this.serializer.toJSON()}markAsReadOnly(e){this._read_only||(this._read_only_requester=e,this._read_only=!0)}readOnly(){return this._read_only}readOnlyRequester(){return this._read_only_requester}get uniformsController(){return this._uniformsController=this._uniformsController||new V2(this)}get webgl_controller(){return this._webgl_controller=this._webgl_controller||new H2}get windowController(){return this._windowController=this._windowController||new j2(this)}dispose(){var e;(e=this._windowController)==null||e.dispose()}async batchUpdates(e){this._cooker.block(),await e(),this._cooker.unblock()}node(e){return this.nodesController.node(e)}root(){return this.nodesController.root()}registerOnBeforeTick(e,t){this.timeController.registerOnBeforeTick(e,t)}unRegisterOnBeforeTick(e){this.timeController.unRegisterOnBeforeTick(e)}registeredBeforeTickCallbacks(){return this.timeController.registeredBeforeTickCallbacks()}registerOnAfterTick(e,t){this.timeController.registerOnAfterTick(e,t)}unRegisterOnAfterTick(e){this.timeController.unRegisterOnAfterTick(e)}registeredAfterTickCallbacks(){return this.timeController.registeredAfterTickCallbacks()}};var Fo=class{constructor(e){this._param=e}process_data(e){let t=e.raw_input;t!==void 0&&this._param.set(t),this.add_main(e)}add_main(e){}static spare_params_data(e){return this.params_data(!0,e)}static non_spare_params_data_value(e){return this.params_data_value(!1,e)}static params_data(e,t){let r;if(t){r={};let o=Object.keys(t),s;for(let i of o)s=t[i],s&&(r[i]=t)}return r}static params_data_value(e,t){let r;if(t){r={};let o=Object.keys(t),s;for(let i of o)if(s=t[i],s!=null){let l=s.options,a=s.overriden_options;if(l||a){let c=s;l&&l.spare==e?c.raw_input!=null&&(r[i]={complex_data:c}):a&&(r[i]={complex_data:c})}else{let c=s;(a||c!=null)&&(r[i]={simple_data:c})}}}return r}};var PN="operationsComposer",wu=class{constructor(e,t,r){this._scene=e,this.states=t,this._node=r}static type(){throw"type to be overriden"}type(){return this.constructor.type()}static context(){throw console.error("operation has no node_context",this),"context requires override"}context(){return this.constructor.context()}scene(){return this._scene}cook(e,t){}convertExportParamData(e){let{params:t,paramName:r,paramData:o}=e,s=t[r];if(xe.isBoolean(o))return o;if(xe.isNumber(o))return xe.isBoolean(s)?o>=1:o;if(xe.isString(o))return s&&(s instanceof li||s instanceof Is)?s.set_path(o):o;xe.isArray(o)&&t[r].fromArray(o)}};wu.DEFAULT_PARAMS={};wu.INPUT_CLONED_STATE=[];var ki=class{constructor(e){this._node=e,this._nodes=[],this._optimized_root_node_names=new Set,this._operation_containers_by_name=new Map,this._node_inputs=[]}nodes(){return this._nodes}process_data(e,t){var r,o,s;if(!t||!(this._node.childrenAllowed()&&this._node.childrenController))return;let{optimized_names:i}=ki.child_names_by_optimized_state(t);this._nodes=[],this._optimized_root_node_names=new Set;for(let l of i)ki.is_optimized_root_node(t,l)&&this._optimized_root_node_names.add(l);for(let l of this._optimized_root_node_names){let a=t[l],c={nodeName:l},h=this._node.createNode(PN,c);if(h){this._nodes.push(h),((r=a.flags)==null?void 0:r.display)&&((s=(o=h.flags)==null?void 0:o.display)==null||s.set(!0));let g=this._createOperationContainer(e,h,a,h.name());h.setOutputOperationContainer(g)}}for(let l of this._nodes){let a=l.outputOperationContainer();if(a){this._node_inputs=[],this._add_optimized_node_inputs(e,l,t,l.name(),a),l.io.inputs.setCount(this._node_inputs.length);for(let c=0;c<this._node_inputs.length;c++)l.setInput(c,this._node_inputs[c])}}}_add_optimized_node_inputs(e,t,r,o,s){var i;let l=r[o],a=l.inputs;if(!!a){for(let c of a)if(xe.isString(c)){let h=r[c];if(h)if(ki.is_node_optimized(h)&&!this._optimized_root_node_names.has(c)){let g=this._operation_containers_by_name.get(c);g||(g=this._createOperationContainer(e,t,h,c),g&&this._add_optimized_node_inputs(e,t,r,c,g)),s.addInput(g)}else{let g=(i=t.parent())==null?void 0:i.node(c);if(g){this._node_inputs.push(g);let p=this._node_inputs.length-1;t.addInputConfig(s,{operation_input_index:s.currentInputIndex(),node_input_index:p}),s.incrementInputIndex()}}}l.cloned_state_overriden==!0&&s.overrideInputCloneState(l.cloned_state_overriden)}}static child_names_by_optimized_state(e){let t=Object.keys(e),r=[],o=[];for(let s of t){let i=e[s];Fe.playerMode()&&this.is_node_optimized(i)?r.push(s):o.push(s)}return{optimized_names:r,non_optimized_names:o}}static is_optimized_root_node_generic(e){return e.outputs_count==0||e.non_optimized_count>0}static is_optimized_root_node(e,t){let r=this.node_outputs(e,t),o=0;return r.forEach(s=>{let i=e[s];this.is_node_optimized(i)||o++}),this.is_optimized_root_node_generic({outputs_count:r.size,non_optimized_count:o})}static is_optimized_root_node_from_node(e){var t,r,o,s;if(!((r=(t=e.flags)==null?void 0:t.optimize)==null?void 0:r.active()))return!1;let i=e.io.connections.outputConnections().map(a=>a.node_dest),l=0;for(let a of i)((s=(o=a.flags)==null?void 0:o.optimize)==null?void 0:s.active())||l++;return this.is_optimized_root_node_generic({outputs_count:i.length,non_optimized_count:l})}static node_outputs(e,t){let r=Object.keys(e),o=new Set;for(let s of r)if(s!=t){let l=e[s].inputs;if(l)for(let a of l)xe.isString(a)&&a==t&&o.add(s)}return o}_createOperationContainer(e,t,r,o){let s=Fo.non_spare_params_data_value(r.params),i=ki.operation_type(r),l={paramsInitValueOverrides:s},a=this._node.createOperationContainer(i,o,l);return a&&(this._operation_containers_by_name.set(o,a),a.pathParamResolveRequired()&&(t.addOperationContainerWithPathParamResolveRequired(a),e.add_operations_composer_node_with_path_param_resolve_required(t))),a}static operation_type(e){return ki.is_node_bypassed(e)?"null":e.type}static is_node_optimized(e){let t=e.flags;return!!(t&&t.optimize)}static is_node_bypassed(e){let t=e.flags;return!!(t&&t.bypass)}};var $2=class{constructor(e){this._node=e}process_data(e,t){var r;if(!t||!(this._node.childrenAllowed()&&this._node.childrenController))return;let{optimized_names:o,non_optimized_names:s}=ki.child_names_by_optimized_state(t),i=[];for(let a of s){let c=t[a],h=c.type.toLowerCase(),p={paramsInitValueOverrides:Fo.non_spare_params_data_value(c.params),nodeName:a};try{let u=this._node.createNode(h,p);u&&i.push(u)}catch(u){console.error(`error importing node: cannot create with type ${h}`,u);let d=Rt.camelCase(h);try{let f=this._node.createNode(d,p);f&&i.push(f)}catch{let _=`${h}Network`;try{let m=this._node.createNode(_,p);m&&i.push(m)}catch(m){let v=`failed to create node with type '${h}', '${d}' or '${_}'`;e.report.addWarning(v),Fe.warn(v,m)}}}}if(o.length>0){let a=new ki(this._node);if(a.process_data(e,t),this._node.childrenController.context==it.SOP){let c=Object.keys(t),h;for(let g of c)((r=t[g].flags)==null?void 0:r.display)&&(h=g);if(h){let g=i.map(u=>u.name()),p=a.nodes();for(let u of p)g.push(u.name());if(!g.includes(h)){let f=`node '${`${this._node.path()}/${h}`}' with display flag has been optimized and does not exist in player mode`;console.error(f)}}}}let l=new Map;for(let a of i)if(t[a.name()]){let h=X0.dispatch_node(a);l.set(a.name(),h),h.process_data(e,t[a.name()])}else Fe.warn(`possible import error for node ${a.name()}`),Fe.log("available names are",Object.keys(t).sort(),t);for(let a of i){let c=l.get(a.name());c&&c.process_inputs_data(t[a.name()])}}};var LW=["overriden_options","type"],Ru=class{constructor(e){this._node=e}process_data(e,t){if(this.set_connection_points(t.connection_points),this._node.childrenAllowed()&&this.create_nodes(e,t.nodes),this.set_selection(t.selection),this._node.io.inputs.overrideClonedStateAllowed()){let r=t.cloned_state_overriden;r&&this._node.io.inputs.overrideClonedState(r)}this.set_flags(t),this.set_params(t),t.persisted_config&&this.set_persisted_config(t.persisted_config),this.from_data_custom(t)}process_inputs_data(e){let t=e.maxInputsCount;if(t!=null){let r=this._node.io.inputs.minCount();this._node.io.inputs.setCount(r,t)}this.setInputs(e.inputs)}process_ui_data(e,t){if(!t||Fe.playerMode())return;let r=this._node.uiData,o=t.pos;if(o){let i=new re().fromArray(o);r.setPosition(i)}let s=t.comment;s&&r.setComment(s),this._node.childrenAllowed()&&this.process_nodes_ui_data(e,t.nodes)}create_nodes(e,t){if(!t)return;new $2(this._node).process_data(e,t)}set_selection(e){if(this._node.childrenAllowed()&&this._node.childrenController&&e&&e.length>0){let t=[];e.forEach(r=>{let o=this._node.node(r);o&&t.push(o)}),this._node.childrenController.selection.set(t)}}set_flags(e){var t,r,o,s,i,l;let a=e.flags;if(a){let c=a.bypass;c!=null&&((r=(t=this._node.flags)==null?void 0:t.bypass)==null||r.set(c));let h=a.display;h!=null&&((s=(o=this._node.flags)==null?void 0:o.display)==null||s.set(h));let g=a.optimize;g!=null&&((l=(i=this._node.flags)==null?void 0:i.optimize)==null||l.set(g))}}set_connection_points(e){!e||(e.in&&this._node.io.saved_connection_points_data.set_in(e.in),e.out&&this._node.io.saved_connection_points_data.set_out(e.out),this._node.io.has_connection_points_controller&&this._node.io.connection_points.update_signature_if_required())}setInputs(e){if(!e)return;let t;for(let r=0;r<e.length;r++)if(t=e[r],t&&this._node.parent())if(xe.isString(t)){let o=t,s=this._node.nodeSibling(o);this._node.setInput(r,s)}else{let o=this._node.nodeSibling(t.node),s=t.index;this._node.setInput(s,o,t.output)}}process_nodes_ui_data(e,t){if(!t||Fe.playerMode())return;let r=Object.keys(t);for(let o of r){let s=this._node.node(o);if(s){let i=t[o];X0.dispatch_node(s).process_ui_data(e,i)}}}set_params(e){let t=e.params;if(!t)return;let r=Object.keys(t),o={};for(let l of r){let a=t[l];if(a){let c=a.options,h=a.type;h=="operator_path"&&(h=Te.NODE_PATH);let g=this._node.params.has_param(l),p=!1,u;g&&(u=this._node.params.get(l),(u&&u.type()==h||h==null)&&(p=!0)),p?this._is_param_data_complex(a)?this._process_param_data_complex(l,a):this._process_param_data_simple(l,a):(o.namesToDelete=o.namesToDelete||[],o.namesToDelete.push(l),o.toAdd=o.toAdd||[],o.toAdd.push({name:l,type:h,init_value:a.default_value,raw_input:a.raw_input,options:c}))}}let s=o.namesToDelete&&o.namesToDelete.length>0,i=o.toAdd&&o.toAdd.length>0;if(s||i){this._node.params.updateParams(o);for(let l of this._node.params.spare){let a=t[l.name()];!l.parentParam()&&a&&(this._is_param_data_complex(a)?this._process_param_data_complex(l.name(),a):this._process_param_data_simple(l.name(),a))}}this._node.params.runOnSceneLoadHooks()}_process_param_data_simple(e,t){var r;(r=this._node.params.get(e))==null||r.set(t)}_process_param_data_complex(e,t){let r=this._node.params.get(e);r&&X0.dispatch_param(r).process_data(t)}_is_param_data_complex(e){if(xe.isString(e)||xe.isNumber(e)||xe.isArray(e)||xe.isBoolean(e))return!1;if(xe.isObject(e)){let t=Object.keys(e);for(let r of LW)if(t.includes(r))return!0}return!1}set_persisted_config(e){this._node.persisted_config&&this._node.persisted_config.load(e)}from_data_custom(e){}};var Y2=class extends Fo{add_main(e){}};var IW=/\\n+/g,X2=class extends Fo{add_main(e){let t=e.raw_input;t!==void 0&&(t=t.replace(IW,`
`),this._param.set(t))}};var J2=class extends Fo{add_main(e){let t=e.raw_input;t&&this._param.set(t)}};var K2=class extends Ru{create_nodes(e,t){let o=this._node.polyNodeController;o&&o.createChildNodesFromDefinition()}};var X0=class{static dispatch_node(e){return e.polyNodeController?new K2(e):new Ru(e)}static dispatch_param(e){return e instanceof pi?new Y2(e):e instanceof Bl?new X2(e):e instanceof di?new J2(e):new Fo(e)}};var Z2=class{constructor(e){this._warnings=[]}warnings(){return this._warnings}reset(){this._warnings=[]}addWarning(e){this._warnings.push(e)}};var Lu=class{constructor(e){this._data=e,this.report=new Z2(this)}static async loadData(e){return await new Lu(e).scene()}async scene(){let e=new W2;e.loadingController.markAsLoading();let t=this._data.properties;if(t){let o=t.maxFrame||600;e.timeController.setMaxFrame(o);let s=t.maxFrameLocked;s&&e.timeController.setMaxFrameLocked(s);let i=t.realtimeState;i!=null&&e.timeController.setRealtimeState(i),e.setFrame(t.frame||H0.START_FRAME),t.mainCameraNodePath&&e.camerasController.setMainCameraNodePath(t.mainCameraNodePath)}e.cooker.block(),this._base_operations_composer_nodes_with_resolve_required=void 0;let r=X0.dispatch_node(e.root());return this._data.root&&r.process_data(this,this._data.root),this._data.ui&&r.process_ui_data(this,this._data.ui),this._resolve_operation_containers_with_path_param_resolve(),await e.loadingController.markAsLoaded(),e.cooker.unblock(),e}add_operations_composer_node_with_path_param_resolve_required(e){this._base_operations_composer_nodes_with_resolve_required||(this._base_operations_composer_nodes_with_resolve_required=[]),this._base_operations_composer_nodes_with_resolve_required.push(e)}_resolve_operation_containers_with_path_param_resolve(){if(!!this._base_operations_composer_nodes_with_resolve_required)for(let e of this._base_operations_composer_nodes_with_resolve_required)e.resolveOperationContainersPathParams()}};var Wl=class{constructor(e){this.options=e,this._onLoadCompleteCalled=!1}static async loadSceneData(e){let t=new Wl(e),r=await t.loadScene(),o=t._viewer;return{scene:r,viewer:o}}static async loadManifest(e,t){let r=[this._fetchSceneData(e)],s=(await Promise.all(r))[1];return await this._loadSceneData(e,{sceneData:s,assetsRoot:t})}static async _fetchSceneData(e){return await x1.importSceneData({urlPrefix:e.manifest.urlPrefix,manifest:e.manifest.content,onProgress:e.onProgress})}static async _loadSceneData(e,t){return await Wl.loadSceneData({domElement:e.domElement,sceneName:e.sceneName,onProgress:e.onProgress,configureScene:e.configureScene,sceneData:t.sceneData,assetsRoot:t.assetsRoot})}async _onLoadComplete(){if(this._onLoadCompleteCalled!=!0){if(this._onLoadCompleteCalled=!0,this._viewer){let e=this._viewer;e.preCompile(),e.setAutoRender&&e.setAutoRender(!0)}this._scene&&(await this._scene.cookController.waitForCooksCompleted(),this._scene.setFrame(H0.START_FRAME),this._scene.play())}}_onNodesCookProgress(e){let t=o=>{this.options.onProgress&&this.options.onProgress(r.start+r.mult*o)},r=xg.nodes;t(e),e>=1&&this._onLoadComplete()}async _watchNodesProgress(e){let t=await e.root().loadProgress.resolvedNodes(),r=t.length;r==0&&this._onNodesCookProgress(1);let o="ScenePlayerImporter",s=new Set;for(let i of t){let l=i.graphNodeId();i.compute(),i.cookController.registerOnCookEnd(o,()=>{if(!s.has(l)){s.add(l);let a=s.size/r;this._onNodesCookProgress(a),i.cookController.deregisterOnCookEnd(o)}})}}async loadScene(){let e=new Lu(this.options.sceneData);this._scene=await e.scene(),this._scene.setName(this.options.sceneName);let t=this.options.configureScene;t&&t(this._scene);let r=this._scene.mainCameraNode();return r?this._viewer=r.createViewer({element:this.options.domElement,viewerProperties:{autoRender:!1}}):console.warn("no main camera found, viewer is not mounted"),this._watchNodesProgress(this._scene),this._scene}};var DW="networks";var ON={ADVANCED:"advanced",ANIMATION:"animation",ATTRIBUTE:"attributes",AUDIO:"audio",DYNAMICS:"dynamics",HELPERS:"helpers",INPUT:"inputs",LIGHTS:"lights",MAP:"maps",MISC:"misc",MODIFIER:"modifiers",NETWORK:DW,PHYSICS:"physics",PRIMITIVES:"primitives",RENDER:"render",SUBNET:"subnet"};var mi=class{constructor(){this._objects=[],this._objects_with_geo=[],this.touch()}dispose(){if(this._objects=[],this._objects_with_geo=[],this._core_objects){for(let e of this._core_objects)e.dispose();this._core_objects=void 0}if(this._core_geometries){for(let e of this._core_geometries)e.dispose();this._core_geometries=void 0}}timestamp(){return this._timestamp}touch(){let e=Fe.performance.performanceManager();this._timestamp=e.now(),this.reset()}reset(){this._bounding_box=void 0,this._core_geometries=void 0,this._core_objects=void 0}clone(){let e=new mi;if(this._objects){let t=[];for(let r of this._objects)t.push(Dn.clone(r));e.setObjects(t)}return e}setObjects(e){this._objects=e,this._objects_with_geo=e.filter(t=>t.geometry!=null),this.touch()}objects(){return this._objects}objectsWithGeo(){return this._objects_with_geo}coreObjects(){return this._core_objects=this._core_objects||this._create_core_objects()}_create_core_objects(){return this._objects?this._objects.map((e,t)=>new Dn(e,t)):[]}objectsData(){return this._objects?this._objects.map(e=>this._objectData(e)):[]}_objectData(e){let t=0;return e.geometry&&(t=Yr.pointsCount(e.geometry)),{type:sf(e.constructor),name:e.name,children_count:e.children.length,points_count:t}}geometries(){let e=[];for(let t of this.coreObjects()){let r=t.object().geometry;r&&e.push(r)}return e}coreGeometries(){return this._core_geometries=this._core_geometries||this._createCoreGeometries()}_createCoreGeometries(){let e=[];for(let t of this.geometries())e.push(new Yr(t));return e}static geometryFromObject(e){return e.isMesh||e.isLine||e.isPoints?e.geometry:null}faces(){let e=[];for(let t of this.objectsWithGeo())if(t.geometry){let o=new Yr(t.geometry).faces();for(let s of o)s.applyMatrix4(t.matrix),e.push(s)}return e}points(){return this.coreGeometries().map(e=>e.points()).flat()}pointsCount(){return lr.sum(this.coreGeometries().map(e=>e.pointsCount()))}totalPointsCount(){if(this._objects){let e=0;for(let t of this._objects)t.traverse(r=>{let o=r.geometry;o&&(e+=Yr.pointsCount(o))});return e}else return 0}pointsFromGroup(e){if(e){let t=Rt.indices(e),r=this.points();return lr.compact(t.map(o=>r[o]))}else return this.points()}static _fromObjects(e){let t=new mi;return t.setObjects(e),t}objectsFromGroup(e){return this.coreObjectsFromGroup(e).map(t=>t.object())}coreObjectsFromGroup(e){if(e=e.trim(),e!==""){let t=parseInt(e);return xe.isNaN(t)?this.coreObjects().filter(r=>Rt.matchMask(e,r.name())):lr.compact([this.coreObjects()[t]])}else return this.coreObjects()}boundingBox(e=!1){return e?this._bounding_box=this._computeBoundingBox():this._bounding_box=this._bounding_box||this._computeBoundingBox()}center(){let e=new F;return this.boundingBox().getCenter(e),e}size(){let e=new F;return this.boundingBox().getSize(e),e}_computeBoundingBox(){let e;if(this._objects)for(let t of this._objects){let r=t.geometry;r&&(r.computeBoundingBox(),e?e.expandByObject(t):r.boundingBox&&(e=r.boundingBox.clone()))}return e=e||new zv(new F(-1,-1,-1),new F(1,1,1)),e}computeVertexNormals(){for(let e of this.coreObjects())e.computeVertexNormals()}hasAttrib(e){let t;return(t=this.coreGeometries()[0])!=null?t.hasAttrib(e):!1}attribType(e){let t=this.coreGeometries()[0];return t!=null?t.attribType(e):null}objectAttribType(e){let t=this.coreObjects()[0];return t!=null?t.attribType(e):null}renameAttrib(e,t,r){switch(r){case Bs.ATTRIB_CLASS.VERTEX:if(this.hasAttrib(e)&&this._objects)for(let o of this._objects)o.traverse(s=>{let i=mi.geometryFromObject(s);i&&new Yr(i).renameAttrib(e,t)});break;case Bs.ATTRIB_CLASS.OBJECT:if(this.hasAttrib(e)&&this._objects)for(let o of this._objects)o.traverse(s=>{new Dn(s,0).renameAttrib(e,t)});break}}attribNames(){let e;return(e=this.coreGeometries()[0])!=null?e.attribNames():[]}objectAttribNames(){let e;return(e=this.coreObjects()[0])!=null?e.attribNames():[]}attribNamesMatchingMask(e){let t=Rt.attribNames(e),r=[];for(let o of this.attribNames())for(let s of t)if(Rt.matchMask(o,s))r.push(o);else{let i=$r.remapName(s);o==i&&r.push(o)}return lr.uniq(r)}attribSizes(){let e;return(e=this.coreGeometries()[0])!=null?e.attribSizes():{}}objectAttribSizes(){let e;return(e=this.coreObjects()[0])!=null?e.attribSizes():{}}attribSize(e){let t;return(t=this.coreGeometries()[0])!=null?t.attribSize(e):0}addNumericVertexAttrib(e,t,r){r==null&&(r=$r.default_value(t));for(let o of this.coreGeometries())o.addNumericAttrib(e,t,r)}static clone(e){let t=new Tr;return e.children.forEach(r=>{let o=Dn.clone(r);t.add(o)}),t}};var Rr=class extends wu{static context(){return it.SOP}cook(e,t){}createCoreGroupFromObjects(e){let t=new mi;return t.setObjects(e),t}createCoreGroupFromGeometry(e,t=Bo.MESH){let r=Rr.createObject(e,t);return this.createCoreGroupFromObjects([r])}createObject(e,t,r){return Rr.createObject(e,t,r)}static createObject(e,t,r){this.createIndexIfNone(e);let o=WM[t];r=r||Bs.MATERIALS[t].clone();let s=new o(e,r);return s.castShadow=!0,s.receiveShadow=!0,s.frustumCulled=!1,s.matrixAutoUpdate=!1,s}createIndexIfNone(e){Rr.createIndexIfNone(e)}static createIndexIfNone(e){bu.createIndexIfNone(e)}};var XO=Zi(YO());var a0=class extends Rr{static type(){return"occlusion"}cook(e,t){let r=e[0],o=r.coreObjects();for(let s of o)this._process_occlusion_on_object(s,t);return r}_process_occlusion_on_object(e,t){var r,o;let s=(r=e.coreGeometry())==null?void 0:r.geometry();if(!s)return;let i=s.attributes.position.array,l=s.attributes.normal.array,a=(o=s.getIndex())==null?void 0:o.array,c=(0,XO.default)(i,{cells:a,normals:l,resolution:t.bufferResolution,bias:t.bias});for(let g=0;g<t.samples;g++)c.sample();let h=c.report();s.setAttribute(t.attribName,new _t(h,1)),c.dispose()}};a0.DEFAULT_PARAMS={attribName:"occlusion",samples:256,bufferResolution:512,bias:.01};a0.INPUT_CLONED_STATE=yr.FROM_NODE;var Uf="input geometry",PY=[Uf,Uf,Uf,Uf],on=class extends no{constructor(){super(...arguments);this.flags=new o9(this)}static context(){return it.SOP}static displayedInputNames(){return PY}initializeBaseNode(){this.flags.display.set(!1),this.flags.display.onUpdate(()=>{if(this.flags.display.active()){let e=this.parent();e&&e.displayNodeController&&e.displayNodeController.setDisplayNode(this)}}),this.io.outputs.setHasOneOutput()}setCoreGroup(e){this._setContainer(e,"from set_core_group")}setObject(e){this._setContainerObjects([e],"from set_object")}setObjects(e){this._setContainerObjects(e,"from set_objects")}setGeometry(e,t=Bo.MESH){let r=this.createObject(e,t);this._setContainerObjects([r],"from set_geometry")}setGeometries(e,t=Bo.MESH){let r=[],o;for(let s of e)o=this.createObject(s,t),r.push(o);this._setContainerObjects(r,"from set_geometries")}_setContainerObjects(e,t){let r=this.containerController.container().coreContent()||new mi;r.setObjects(e),r.touch(),this._setContainer(r)}static createObject(e,t,r){return Rr.createObject(e,t,r)}createObject(e,t,r){return on.createObject(e,t,r)}static createIndexIfNone(e){Rr.createIndexIfNone(e)}_createIndexIfNone(e){on.createIndexIfNone(e)}};var Vf=a0.DEFAULT_PARAMS,JO=class extends je{constructor(){super(...arguments);this.attribName=N.STRING(Vf.attribName),this.samples=N.INTEGER(Vf.samples,{range:[1,256],rangeLocked:[!0,!1],separatorAfter:!0}),this.bufferResolution=N.INTEGER(Vf.bufferResolution),this.bias=N.FLOAT(Vf.bias)}},OY=new JO,x3=class extends on{constructor(){super(...arguments);this.paramsConfig=OY}static type(){return"occlusion"}initializeNode(){this.io.inputs.setCount(1),this.io.inputs.initInputsClonedState(a0.INPUT_CLONED_STATE)}cook(e){this._operation=this._operation||new a0(this._scene,this.states);let t=this._operation.cook(e,this.pv);this.setCoreGroup(t)}};var C3=class{constructor(e,t,r){this._name=e,this._callback=t,this._options=r}name(){return this._name}libraryName(){return this._options.libraryName}init(e){this._callback(e)}toJSON(){return{name:this._name,libraryName:this._options.libraryName,libraryImportPath:this._options.libraryImportPath}}};function wY(n){n.registerOperation(a0),n.registerNode(x3,ON.RENDER)}var KO=new C3("occlusion",wY,{libraryName:"@polygonjs/plugin-occlusion",libraryImportPath:"@polygonjs/plugin-occlusion/dist"});function ZO(n){n.registerPlugin(KO)}function QO(n){}var sr=class{constructor(e){this.param=e,this._requireDependency=!1}requireDependency(){return this._requireDependency}node(){return this._node=this._node||this.param.node}static requiredArguments(){return console.warn("Expression.Method._Base.required_arguments virtual method call. Please override"),[]}static optionalArguments(){return[]}static minAllowedArgumentsCount(){return this.requiredArguments().length}static maxAllowedArgumentsCount(){return this.minAllowedArgumentsCount()+this.optionalArguments().length}static allowedArgumentsCount(e){return e>=this.minAllowedArgumentsCount()&&e<=this.maxAllowedArgumentsCount()}processArguments(e){throw"Expression.Method._Base.process_arguments virtual method call. Please override"}async getReferencedNodeContainer(e){let t=this.getReferencedNode(e);if(t){let r;if(t.isDirty()?r=await t.compute():r=t.containerController.container(),r&&r.coreContent())return r;throw`referenced node invalid: ${t.path()}`}else throw`invalid input (${e})`}getReferencedParam(e,t){let r=this.node();return r?hr.findParam(r,e,t):null}findReferencedGraphNode(e,t){if(xe.isNumber(e)){let o=e,s=this.node();if(s)return s.io.inputs.inputGraphNode(o)}else{let o=e;return this.getReferencedNode(o,t)}return null}getReferencedNode(e,t){let r=null,o=this.node();if(xe.isString(e)){if(o){let s=e;r=hr.findNode(o,s,t)}}else if(o){let s=e;r=o.io.inputs.input(s)}return r||null}findDependency(e){return null}createDependencyFromIndexOrPath(e){let t=new zs,r=this.findReferencedGraphNode(e,t);return r?this.createDependency(r,e,t):(Fe.warn("node not found for path",e),null)}createDependency(e,t,r){return Gs.create(this.param,t,e,r)}};var T3=class extends sr{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[["string","arguments list"],["number","index"]]}processArguments(e){return new Promise((t,r)=>{if(e.length==2){let o=e[0],s=e[1],i=o.split(" ")[s];t(i)}else t(0)})}};var E3=class extends sr{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[["string","arguments list"]]}processArguments(e){return new Promise((t,r)=>{if(e.length==1){let s=e[0].split(" ").length;t(s)}else t(0)})}};var RY=["min","max","size","center"],LY=["x","y","z"],A3=class extends sr{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[["string","path to node"],["string","vector name, min, max, size or center"],["string","component_name, x,y or z"]]}findDependency(e){return this.createDependencyFromIndexOrPath(e)}processArguments(e){let t=0;return new Promise(async(r,o)=>{if(e.length>=1){let s=e[0],i=e[1],l=e[2],a=null;try{a=await this.getReferencedNodeContainer(s)}catch(c){o(c)}a&&(t=this._get_value_from_container(a,i,l),r(t))}else r(0)})}_get_value_from_container(e,t,r){let o=e.boundingBox();if(!t)return o;if(RY.indexOf(t)>=0){let s=new F;switch(t){case"size":o.getSize(s);break;case"center":o.getCenter(s);break;default:s=o[t]}return r?LY.indexOf(r)>=0?s[r]:-1:s}else return-1}};var M3=class extends sr{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[["string","path to node"],["string","component_name, x,y or z"]]}findDependency(e){return this.createDependencyFromIndexOrPath(e)}processArguments(e){return new Promise(async(t,r)=>{if(e.length>=1){let o=e[0],s=e[1],i=null;try{i=await this.getReferencedNodeContainer(o)}catch(l){r(l)}if(i){let l=i.boundingBox(),a=l.min.clone().add(l.max).multiplyScalar(.5);if(s){let c=a[s];c!=null?t(c):t(0)}else t(a)}}else t(0)})}};var N3=class extends sr{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[["string","path to param"]]}findDependency(e){let t=new zs,r=this.getReferencedParam(e,t);return r?(this._referencedParam=r,this.createDependency(r,e,t)):null}async processArguments(e){return new Promise(async(t,r)=>{let o=0;if(e.length==1){let s=e[0],i=this._referencedParam||this.getReferencedParam(s);if(i){i.isDirty()&&await i.compute();let l=i.value;l!=null&&(o=l,t(o))}else r(0)}})}};var $l=class extends Gt{constructor(){super();this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}clone(){return new this.constructor().copy(this)}toJSON(){let e=super.toJSON(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}};$l.prototype.isInstancedBufferGeometry=!0;var oo=class extends lo{constructor(e,t,r,o=1){typeof r=="number"&&(o=r,r=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument."));super(e,t,r);this.meshPerAttribute=o}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}};oo.prototype.isInstancedBufferAttribute=!0;var zf={SCALE:new F(1,1,1),PSCALE:1,EYE:new F(0,0,0),UP:new F(0,1,0)},IY="scale",DY="pscale",BY="normal",kY="up",FY=new F(1,1,1),GY=new re(0,0),ew="uv",tw="color";var UY={P:"instancePosition",N:"instanceOrientation",up:"instanceOrientation",Cd:"instanceColor",[Tn.COLOR]:"instanceColor",[Tn.NORMAL]:"instanceOrientation",[Tn.POSITION]:"instancePosition",[Tn.PSCALE]:"instanceScale",[Tn.SCALE]:"instanceScale"},rw=class{constructor(n){this._coreGroup=n,this._is_pscale_present=!1,this._is_scale_present=!1,this._is_normal_present=!1,this._is_up_present=!1,this._do_rotate_matrices=!1,this._matrixT=new vr,this._matrixR=new vr,this._matrixS=new vr,this._pointScale=new F,this._pointNormal=new F,this._pointUp=new F,n&&this.setCoreGroup(n)}static remapName(n){return UY[n]||n}setCoreGroup(n){this._coreGroup=n,this._is_pscale_present=this._coreGroup.hasAttrib(Tn.PSCALE),this._is_scale_present=this._coreGroup.hasAttrib(Tn.SCALE),this._is_normal_present=this._coreGroup.hasAttrib(Tn.NORMAL),this._is_up_present=this._coreGroup.hasAttrib(Tn.UP),this._do_rotate_matrices=this._is_normal_present}matrixFromPoint(n,e){e.identity();let t=n.position();this._is_scale_present?n.attribValue(IY,this._pointScale):this._pointScale.copy(zf.SCALE);let r=this._is_pscale_present?n.attribValue(DY):zf.PSCALE;this._pointScale.multiplyScalar(r);let o=this._matrixS;o.makeScale(this._pointScale.x,this._pointScale.y,this._pointScale.z);let s=this._matrixT;if(s.makeTranslation(t.x,t.y,t.z),e.multiply(s),this._do_rotate_matrices){let i=this._matrixR,l=zf.EYE;n.attribValue(BY,this._pointNormal),this._pointNormal.multiplyScalar(-1),this._is_up_present?n.attribValue(kY,this._pointUp):this._pointUp.copy(zf.UP),this._pointUp.normalize(),i.lookAt(l,this._pointNormal,this._pointUp),e.multiply(i)}e.multiply(o)}static updateTransformInstanceAttributes(n,e,t){let r=n.length,o=new Float32Array(r*3),s=new Float32Array(r*3),i=new Float32Array(r*4),l=new rw(e),a=0;for(let c of n){l.matrixFromPoint(c,this._tmpMatrix);let h=a*3,g=a*4;this._tmpMatrix.decompose(this._position,this._quaternion,this._scale),this._position.toArray(o,h),this._quaternion.toArray(i,g),this._scale.toArray(s,h),a++}t.setAttribute("instancePosition",new oo(o,3)),t.setAttribute("instanceScale",new oo(s,3)),t.setAttribute("instanceOrientation",new oo(i,4))}static updateColorInstanceAttribute(n,e,t){let r=n.length,o=new Float32Array(r*3),s=e.hasAttrib(tw),i=0;for(let l of n)(s?l.attribValue(tw,this._point_color):FY).toArray(o,i*3),i++;t.setAttribute("instanceColor",new oo(o,3))}static createInstanceBufferGeometry(n,e,t){let r=e.points(),o=new $l;o.copy(n),o.instanceCount=1/0;let s=r.length,i=e.hasAttrib(ew);if(i){let c=new Float32Array(s*2),h=0;for(let g of r){let p=h*2;(i?g.attribValue(ew,this._point_uv):GY).toArray(c,p),h++}o.setAttribute("instanceUv",new oo(c,2))}return this.updateTransformInstanceAttributes(r,e,o),this.updateColorInstanceAttribute(r,e,o),e.attribNamesMatchingMask(t).forEach(c=>{let h=e.attribSize(c),g=new Float32Array(s*h);r.forEach((p,u)=>{let d=p.attribValue(c);xe.isNumber(d)?g[u]=d:d.toArray(g,u*h)}),o.setAttribute(c,new oo(g,h))}),new Yr(o).markAsInstance(),o}},l0=rw;l0.transformAttributeNames=["instancePosition","instanceOrientation","instanceScale"];l0._point_color=new F;l0._point_uv=new re;l0._position=new F(0,0,0);l0._quaternion=new ao;l0._scale=new F(1,1,1);l0._tmpMatrix=new vr;var S3=class extends zr{constructor(e){super(e,"CopyStamp");this._globalIndex=0}reset(){this.setGlobalIndex(0)}setGlobalIndex(e){let t=this._globalIndex;this._globalIndex=e,t!=this._globalIndex&&(this.setDirty(),this.removeDirtyState())}value(e){return this._globalIndex}};var P3=class extends S3{reset(){super.reset(),this.setPoint(void 0)}setPoint(e){let t=this._point;this._point=e,t!=this._point&&(this.setDirty(),this.removeDirtyState())}value(e){return this._point?e?this._point.attribValue(e):this._point.index():this._globalIndex}};var c0=(n=>(n.OBJECTS="objects",n.GEOMETRIES="geometries",n))(c0||{}),u0=["geometries","objects"],qs=(n=>(n.XYZ="XYZ",n.XZY="XZY",n.YXZ="YXZ",n.YZX="YZX",n.ZYX="ZYX",n.ZXY="ZXY",n))(qs||{}),Fi=["XYZ","XZY","YXZ","YZX","ZXY","ZYX"];var Jr=class{constructor(){this._translation_matrix=new vr,this._translation_matrix_q=new ao,this._translation_matrix_s=new F(1,1,1),this._matrix=new vr().identity(),this._matrix_q=new ao,this._matrix_euler=new G1,this._matrix_s=new F,this._m=new vr,this._q=new ao,this._rotateDirOrigin=new F,this._rotateDirDest=new F}static setParamsFromMatrix(e,t,r={}){let o=r.scale;o==null&&(o=!0),e.decompose(this.set_params_from_matrix_position,this.set_params_from_matrix_quaternion,this.set_params_from_matrix_scale),this.set_params_from_matrix_euler.setFromQuaternion(this.set_params_from_matrix_quaternion),this.set_params_from_matrix_euler.toVector3(this.set_params_from_matrix_rotation),this.set_params_from_matrix_rotation.divideScalar(Math.PI/180),this.set_params_from_matrix_position.toArray(this.set_params_from_matrix_t),this.set_params_from_matrix_rotation.toArray(this.set_params_from_matrix_r),this.set_params_from_matrix_scale.toArray(this.set_params_from_matrix_s),t.scene().batchUpdates(()=>{t.params.set_vector3("t",this.set_params_from_matrix_t),t.params.set_vector3("r",this.set_params_from_matrix_r),t.params.set_vector3("s",this.set_params_from_matrix_s),o&&t.params.set_float("scale",1)})}static setParamsFromObject(e,t){e.position.toArray(this.set_params_from_object_position_array),e.rotation.toArray(this.set_params_from_object_rotation_array),this.set_params_from_object_rotation_deg.fromArray(this.set_params_from_object_rotation_array),this.set_params_from_object_rotation_deg.multiplyScalar(180/Math.PI),this.set_params_from_object_rotation_deg.toArray(this.set_params_from_object_rotation_array),t.scene().batchUpdates(()=>{t.params.set_vector3("t",this.set_params_from_object_position_array),t.params.set_vector3("r",this.set_params_from_object_rotation_array)})}translationMatrix(e){return this._translation_matrix.compose(e,this._translation_matrix_q,this._translation_matrix_s),this._translation_matrix}matrix(e,t,r,o,s){return this._matrix_euler.set(Pi(t.x),Pi(t.y),Pi(t.z),s),this._matrix_q.setFromEuler(this._matrix_euler),this._matrix_s.copy(r).multiplyScalar(o),this._matrix.compose(e,this._matrix_q,this._matrix_s),this._matrix}rotateGeometry(e,t,r){this._rotateDirDest.copy(r).normalize(),this._rotateDirOrigin.copy(t).normalize(),this._q.setFromUnitVectors(this._rotateDirOrigin,this._rotateDirDest),this._m.makeRotationFromQuaternion(this._q),e.applyMatrix4(this._m)}rotateObject(e,t,r){this._rotateDirDest.copy(r).normalize(),this._rotateDirOrigin.copy(t).normalize(),this._q.setFromUnitVectors(this._rotateDirOrigin,this._rotateDirDest),this._m.makeRotationFromQuaternion(this._q),e.applyMatrix4(this._m),e.updateMatrix()}static decomposeMatrix(e){e.matrix.decompose(e.position,e.quaternion,e.scale)}};Jr.set_params_from_matrix_position=new F;Jr.set_params_from_matrix_quaternion=new ao;Jr.set_params_from_matrix_scale=new F;Jr.set_params_from_matrix_euler=new G1;Jr.set_params_from_matrix_rotation=new F;Jr.set_params_from_matrix_t=[0,0,0];Jr.set_params_from_matrix_r=[0,0,0];Jr.set_params_from_matrix_s=[0,0,0];Jr.set_params_from_object_position_array=[0,0,0];Jr.set_params_from_object_rotation_deg=new F;Jr.set_params_from_object_rotation_array=[0,0,0];var VY=[0,1],zY=[{name:"object",value:0},{name:"geometry",value:1}],nw=class extends je{constructor(){super(...arguments);this.count=N.INTEGER(1,{range:[1,20],rangeLocked:[!0,!1]}),this.t=N.VECTOR3([0,0,0]),this.r=N.VECTOR3([0,0,0]),this.s=N.VECTOR3([1,1,1]),this.scale=N.FLOAT(1),this.transformOnly=N.BOOLEAN(0),this.transformMode=N.INTEGER(0,{menu:{entries:zY}}),this.copyAttributes=N.BOOLEAN(0),this.attributesToCopy=N.STRING("",{visibleIf:{copyAttributes:!0}}),this.useCopyExpr=N.BOOLEAN(1)}},HY=new nw,Du=class extends on{constructor(){super(...arguments);this.paramsConfig=HY,this._attribNamesToCopy=[],this._objects=[],this._instancer=new l0,this._instanceMatrix=new vr,this._coreTransform=new Jr,this._transformAccumulatedMatrix=new vr,this._transformMatrix=new vr}static type(){return"copy"}static displayedInputNames(){return["geometry to be copied","points to copy to"]}initializeNode(){this.io.inputs.setCount(1,2),this.io.inputs.initInputsClonedState([yr.FROM_NODE,yr.NEVER])}async cook(e){Ie(this.pv.useCopyExpr)||this.stampNode().reset();let t=e[0];if(!this.io.inputs.hasInput(1)){await this.cookWithoutTemplate(t);return}let r=e[1];if(!r){this.states.error.set("second input invalid");return}await this.cookWithTemplate(t,r)}async cookWithTemplate(e,t){this._objects=[];let r=t.points();this._instancer.setCoreGroup(t),this._attribNamesToCopy=Rt.attribNames(this.pv.attributesToCopy).map(o=>$r.remapName(o)),this._attribNamesToCopy=this._attribNamesToCopy.filter(o=>t.hasAttrib(o)),await this._copyMovedObjectsOnTemplatePoints(e,r),this.setObjects(this._objects)}async _copyMovedObjectsOnTemplatePoints(e,t){this._initAccumulatedTransform();for(let r=0;r<t.length;r++)await this._copyMovedObjectOnTemplatePoint(e,t,r),this._accumulateTransform()}async _copyMovedObjectOnTemplatePoint(e,t,r){this._instancer.matrixFromPoint(t[r],this._instanceMatrix);let o=t[r];Ie(this.pv.useCopyExpr)&&this.stampNode().setPoint(o);let s=await this._getMovedObjectsForTemplatePoint(e,r);for(let i of s)Ie(this.pv.copyAttributes)&&this._copyAttributes_from_template(i,o),Ie(this.pv.transformOnly)?i.applyMatrix4(this._instanceMatrix):this._applyMatrixToObjectOrGeometry(i,this._instanceMatrix),this._applyAccumulatedTransform(i),this._objects.push(i)}async _getMovedObjectsForTemplatePoint(e,t){let r=await this._stampInstanceGroupIfRequired(e);if(r){let o=()=>{let i=r.objects()[t];return i?[i.clone()]:[]};return Ie(this.pv.transformOnly)?o():r.clone().objects()}else return[]}async _stampInstanceGroupIfRequired(e){let t=await this.containerController.requestInputContainer(0);if(t){let r=t.coreContent();return r||void 0}else{this.states.error.set(`input failed for index ${this.stampValue()}`);return}}async _copyMovedObjectsForEachInstance(e){this._initAccumulatedTransform();for(let t=0;t<this.pv.count;t++)await this._copyMovedObjectsForInstance(e,t),this._accumulateTransform()}async _copyMovedObjectsForInstance(e,t){Ie(this.pv.useCopyExpr)&&this.stampNode().setGlobalIndex(t);let r=await this._stampInstanceGroupIfRequired(e);r&&r.objects().forEach(o=>{let s=Dn.clone(o);this._applyAccumulatedTransform(s),this._objects.push(s)})}async cookWithoutTemplate(e){this._objects=[],await this._copyMovedObjectsForEachInstance(e),this.setObjects(this._objects)}_copyAttributes_from_template(e,t){this._attribNamesToCopy.forEach((r,o)=>{let s=t.attribValue(r);new Dn(e,o).addAttribute(r,s)})}stampValue(e){return this.stampNode().value(e)}stampNode(){return this._stampNode=this._stampNode||this._createStampNode()}_createStampNode(){let e=new P3(this.scene());return this.dirtyController.setForbiddenTriggerNodes([e]),e}dispose(){super.dispose(),this._stampNode&&this._stampNode.dispose()}_initAccumulatedTransform(){let e=this.pv;this._transformMatrix=this._coreTransform.matrix(e.t,e.r,e.s,e.scale,qs.XYZ),this._transformAccumulatedMatrix.identity()}_accumulateTransform(){this._transformAccumulatedMatrix.multiply(this._transformMatrix)}_applyAccumulatedTransform(e){this._applyMatrixToObjectOrGeometry(e,this._transformAccumulatedMatrix)}_applyMatrixToObjectOrGeometry(e,t){let r=VY[this.pv.transformMode];switch(r){case 0:{this._applyMatrixToObject(e,t);return}case 1:{let o=e.geometry;o&&o.applyMatrix4(t);return}}qr.unreachable(r)}_applyMatrixToObject(e,t){e.matrix.multiply(t),e.matrix.decompose(e.position,e.quaternion,e.scale)}};var O3=class extends sr{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[["string","path to copy"],["integer","default value"]]}static optionalArguments(){return[["string","attribute name (optional)"]]}findDependency(e){let t=this.findReferencedGraphNode(e);if(t&&t.type()=="copy"){let r=t.stampNode();return this.createDependency(r,e)}return null}processArguments(e){return new Promise((t,r)=>{if(e.length>=1){let o=e[0],s=e[1]||0,i=e[2],l=this.node(),a=l?hr.findNode(l,o):null,c;a&&a.type()==Du.type()&&(c=a.stampValue(i)),c==null&&(c=s),t(c)}else t(0)})}};var w3=class extends sr{constructor(){super(...arguments);this._requireDependency=!0,this._resolution=new re}static requiredArguments(){return[["string","path to node"],["string","component_name: x or y"]]}findDependency(e){return this.createDependencyFromIndexOrPath(e)}async processArguments(e){if(e.length==1||e.length==2){let t=e[0],r=e[1],o=await this.getReferencedNodeContainer(t);if(o){let s=o.resolution();if(r){if([0,"0","x"].includes(r))return s[0];if([1,"1","y"].includes(r))return s[1]}else return this._resolution.set(s[0],s[1]),this._resolution}}return-1}};var Gi=class{static isChrome(){return navigator&&navigator.userAgent!=null&&navigator.userAgent.indexOf("Chrome")!=-1}static isMobile(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}static isiOS(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)}static isAndroid(){return/(Android)/g.test(navigator.userAgent)}static isTouchDevice(){var e=document.createElement("div");return e.setAttribute("ongesturestart","return;"),typeof e.ongesturestart=="function"}};var R3=class extends sr{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[]}async processArguments(e){return new Promise(async(t,r)=>{t(Gi.isMobile())})}};var L3=class extends sr{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[]}async processArguments(e){return new Promise(async(t,r)=>{t(Gi.isTouchDevice())})}};var I3=class extends sr{static requiredArguments(){return[["string","javascript expression"]]}async processArguments(e){let t=0;if(e.length==1){let r=e[0];if(this._function=this._function||this._create_function(r),this._function)try{t=this._function(this.param.scene(),this.param.node,this.param)}catch(o){console.warn("expression error"),console.warn(o)}}return t}_create_function(e){return new Function("scene","node","param",`return ${e}`)}};var ow=3,D3=class extends sr{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[["string","path to node"],["string","attribute name"],["index","object index"]]}findDependency(e){return this.createDependencyFromIndexOrPath(e)}processArguments(e){return new Promise(async(t,r)=>{if(e.length==ow){let o=e[0],s=e[1],i=e[2],l=null;try{l=await this.getReferencedNodeContainer(o)}catch(a){r(a)}if(l){let a=this._get_value_from_container(l,s,i);t(a)}}else console.warn(`${e.length} given when expected ${ow}`),t(0)})}_get_value_from_container(e,t,r){let o=e.coreContent();if(o){let s=o.coreObjects()[r];return s?s.attribValue(t):0}else return null}};var B3=class extends sr{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[["string","path to node"]]}findDependency(e){return this.createDependencyFromIndexOrPath(e)}processArguments(e){return new Promise(async(t,r)=>{if(e.length==1){let o=e[0],s;try{s=await this.getReferencedNodeContainer(o)}catch(i){r(i);return}if(s){let i=s.objectsCount();t(i)}}else t(0)})}};var k3=class extends sr{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[["string","path to node"]]}findDependency(e){let t=this.findReferencedGraphNode(e);if(t){let r=t;if(r.nameController){let o=r.nameController.graph_node;return this.createDependency(o,e)}}return null}processArguments(e){return new Promise((t,r)=>{if(e.length==1){let o=e[0],s=this.getReferencedNode(o);if(s){let i=s.name(),l=Rt.tailDigits(i);t(l)}else t(0)}else t(0)})}};var F3=class extends sr{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[["string","path to node"]]}findDependency(e){let t=this.findReferencedGraphNode(e);if(t){let r=t;if(r.nameController){let o=r.nameController.graph_node;return this.createDependency(o,e)}}return null}processArguments(e){return new Promise((t,r)=>{if(e.length==1){let o=e[0],s=this.getReferencedNode(o);if(s){let i=s.name();t(i)}else t(0)}else t(0)})}};var G3=class extends sr{static requiredArguments(){return[["string","number"]]}processArguments(e){return new Promise(t=>{let r=e[0]||2,i=`${e[1]||0}`.padStart(r,"0");t(i)})}};var iw=3,U3=class extends sr{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[["string","path to node"],["string","attribute name"],["index","point index"]]}findDependency(e){return this.createDependencyFromIndexOrPath(e)}processArguments(e){return new Promise(async(t,r)=>{if(e.length==iw){let o=e[0],s=e[1],i=e[2],l=null;try{l=await this.getReferencedNodeContainer(o)}catch(a){r(a)}if(l){let a=this._get_value_from_container(l,s,i);t(a)}}else console.warn(`${e.length} given when expected ${iw}`),t(0)})}_get_value_from_container(e,t,r){let o=e.coreContent();if(o){let s=o.points()[r];return s?s.attribValue(t):0}else return null}};var V3=class extends sr{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[["string","path to node"]]}findDependency(e){return this.createDependencyFromIndexOrPath(e)}processArguments(e){return new Promise(async(t,r)=>{if(e.length==1){let o=e[0],s;try{s=await this.getReferencedNodeContainer(o)}catch(i){r(i);return}if(s){let i=s.pointsCount();t(i)}}else t(0)})}};var z3=class extends sr{static requiredArguments(){return[["string","string to count characters of"]]}async processArguments(e){let t=0;return e.length==1&&(t=e[0].length),t}};var H3=class extends sr{static requiredArguments(){return[]}async processArguments(e){let t="";for(let r of e)r==null&&(r=""),t+=`${r}`;return t}};var j3=class extends sr{static requiredArguments(){return[["string","string to get index from"],["string","char to find index of"]]}async processArguments(e){let t=-1;if(e.length==2){let r=e[0],o=e[1];t=r.indexOf(o)}return t}};function jY(n){return n==null?"":xe.isString(n)?n:`${n}`}function sw(n,e){return n==null?e:xe.isNumber(n)?n:parseInt(n)}var q3=class extends sr{static requiredArguments(){return[["string","string to get range from"],["integer","range start"],["integer","range size"]]}async processArguments(e){let t="",r=jY(e[0]),o=sw(e[1],0),s=sw(e[2],1);return r&&(t=r.substr(o,s)),t}};var W3=class extends sr{constructor(){super(...arguments);this._requireDependency=!0,this._windowSize=new re}static requiredArguments(){return[[]]}findDependency(e){return this.param.addGraphInput(this.param.scene().windowController.graphNode()),null}processArguments(e){return new Promise(t=>{this._windowSize.set(window.innerWidth,window.innerHeight),t(this._windowSize)})}};var $3=class{static run(e){e.expressionsRegister.register(T3,"arg"),e.expressionsRegister.register(E3,"argc"),e.expressionsRegister.register(A3,"bbox"),e.expressionsRegister.register(M3,"centroid"),e.expressionsRegister.register(N3,"ch"),e.expressionsRegister.register(O3,"copy"),e.expressionsRegister.register(w3,"copRes"),e.expressionsRegister.register(R3,"isDeviceMobile"),e.expressionsRegister.register(L3,"isDeviceTouch"),e.expressionsRegister.register(I3,"js"),e.expressionsRegister.register(D3,"object"),e.expressionsRegister.register(B3,"objectsCount"),e.expressionsRegister.register(k3,"opdigits"),e.expressionsRegister.register(F3,"opname"),e.expressionsRegister.register(G3,"padzero"),e.expressionsRegister.register(U3,"point"),e.expressionsRegister.register(V3,"pointsCount"),e.expressionsRegister.register(z3,"strCharsCount"),e.expressionsRegister.register(H3,"strConcat"),e.expressionsRegister.register(j3,"strIndex"),e.expressionsRegister.register(q3,"strSub"),e.expressionsRegister.register(W3,"windowSize")}};var Y3=class extends Ou{constructor(){super(...arguments);this._controls_by_viewer=new Map}async apply_controls(e,t){var r;(r=t.controlsController())==null||r.dispose_controls();let o=t.canvas();if(!o)return;let s=await this.createControlsInstance(e,o),i=this._controls_by_viewer.get(t);i&&i.dispose(),this._controls_by_viewer.set(t,s);let a=Fe.performance.performanceManager().now();return s.name=`${this.path()}:${e.name}:${a}:${this.controls_id()}`,await this.params.evalAll(),this.setupControls(s),s}controls_id(){return JSON.stringify(this.params.all.map(e=>e.valueSerialized()))}};var Hf=class{constructor(e=1,t=0,r=0){return this.radius=e,this.phi=t,this.theta=r,this}set(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){let e=1e-6;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(_o(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}};var aw={type:"change"},X3={type:"start"},jf={type:"end"},J3=class extends tl{constructor(e,t){super();t===void 0&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),t===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new F,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keyMode="pan",this.keyRotateSpeedVertical=1,this.keyRotateSpeedHorizontal=1,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:Cs.ROTATE,MIDDLE:Cs.DOLLY,RIGHT:Cs.PAN},this.touches={ONE:Ts.ROTATE,TWO:Ts.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return l.phi},this.getAzimuthalAngle=function(){return l.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(ne){ne.addEventListener("keydown",Dt),this._domElementKeyEvents=ne},this.saveState=function(){r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=function(){r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(aw),r.update(),s=o.NONE},this.update=function(){let ne=new F,Et=new ao().setFromUnitVectors(e.up,new F(0,1,0)),Or=Et.clone().invert(),cr=new F,an=new ao,Vn=2*Math.PI,Oo=!1;return function(){let A0=r.object.position;if(ne.copy(A0).sub(r.target),ne.applyQuaternion(Et),l.setFromVector3(ne),r.autoRotate&&s===o.NONE&&D(T()),r.enableDamping){let ls=a.theta*r.dampingFactor,Mn=a.phi*r.dampingFactor;ls<i&&Mn<i?Oo||(r.dispatchEvent(jf),Oo=!0):Oo=!1,l.theta+=ls,l.phi+=Mn}else l.theta+=a.theta,l.phi+=a.phi;let po=r.minAzimuthAngle,Ln=r.maxAzimuthAngle;return isFinite(po)&&isFinite(Ln)&&(po<-Math.PI?po+=Vn:po>Math.PI&&(po-=Vn),Ln<-Math.PI?Ln+=Vn:Ln>Math.PI&&(Ln-=Vn),po<Ln?l.theta=Math.max(po,Math.min(Ln,l.theta)):l.theta=l.theta>(po+Ln)/2?Math.max(po,l.theta):Math.min(Ln,l.theta)),l.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,l.phi)),l.makeSafe(),l.radius*=c,l.radius=Math.max(r.minDistance,Math.min(r.maxDistance,l.radius)),r.enableDamping===!0?r.target.addScaledVector(h,r.dampingFactor):r.target.add(h),ne.setFromSpherical(l),ne.applyQuaternion(Or),A0.copy(r.target).add(ne),r.object.lookAt(r.target),r.enableDamping===!0?(a.theta*=1-r.dampingFactor,a.phi*=1-r.dampingFactor,h.multiplyScalar(1-r.dampingFactor)):(a.set(0,0,0),h.set(0,0,0)),c=1,g||cr.distanceToSquared(r.object.position)>i||8*(1-an.dot(r.object.quaternion))>i?(r.dispatchEvent(aw),cr.copy(r.object.position),an.copy(r.object.quaternion),g=!1,!0):!1}}(),this.dispose=function(){r.domElement.removeEventListener("contextmenu",ot,!1),r.domElement.removeEventListener("pointerdown",pt,!1),r.domElement.removeEventListener("pointercancel",Pe),r.domElement.removeEventListener("wheel",Ut,!1),r.domElement.ownerDocument.removeEventListener("pointermove",V,!1),r.domElement.ownerDocument.removeEventListener("pointerup",B,!1),r._domElementKeyEvents!==null&&r._domElementKeyEvents.removeEventListener("keydown",Dt)};let r=this,o={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},s=o.NONE,i=1e-6,l=new Hf,a=new Hf,c=1,h=new F,g=!1,p=new re,u=new re,d=new re,f=new re,_=new re,m=new re,v=new re,y=new re,b=new re,x=[],E={};function T(){return 2*Math.PI/60/60*r.autoRotateSpeed}function M(){return Math.pow(.95,r.zoomSpeed)}function D(ne){a.theta-=ne}function U(ne){a.phi-=ne}let L=function(){let ne=new F;return function(Or,cr){ne.setFromMatrixColumn(cr,0),ne.multiplyScalar(-Or),h.add(ne)}}(),se=function(){let ne=new F;return function(Or,cr){r.screenSpacePanning===!0?ne.setFromMatrixColumn(cr,1):(ne.setFromMatrixColumn(cr,0),ne.crossVectors(r.object.up,ne)),ne.multiplyScalar(Or),h.add(ne)}}(),$=function(){let ne=new F;return function(Or,cr){let an=r.domElement;if(r.object.isPerspectiveCamera){let Vn=r.object.position;ne.copy(Vn).sub(r.target);let Oo=ne.length();Oo*=Math.tan(r.object.fov/2*Math.PI/180),L(2*Or*Oo/an.clientHeight,r.object.matrix),se(2*cr*Oo/an.clientHeight,r.object.matrix)}else r.object.isOrthographicCamera?(L(Or*(r.object.right-r.object.left)/r.object.zoom/an.clientWidth,r.object.matrix),se(cr*(r.object.top-r.object.bottom)/r.object.zoom/an.clientHeight,r.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}}();function H(ne){r.object.isPerspectiveCamera?c/=ne:r.object.isOrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom*ne)),r.object.updateProjectionMatrix(),g=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function ae(ne){r.object.isPerspectiveCamera?c*=ne:r.object.isOrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/ne)),r.object.updateProjectionMatrix(),g=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function ue(ne){p.set(ne.clientX,ne.clientY)}function me(ne){v.set(ne.clientX,ne.clientY)}function Ue(ne){f.set(ne.clientX,ne.clientY)}function st(ne){u.set(ne.clientX,ne.clientY),d.subVectors(u,p).multiplyScalar(r.rotateSpeed);var Et=r.domElement;D(2*Math.PI*d.x/Et.clientHeight),U(2*Math.PI*d.y/Et.clientHeight),p.copy(u),r.update()}function ft(ne){y.set(ne.clientX,ne.clientY),b.subVectors(y,v),b.y>0?H(M()):b.y<0&&ae(M()),v.copy(y),r.update()}function Ze(ne){_.set(ne.clientX,ne.clientY),m.subVectors(_,f).multiplyScalar(r.panSpeed),$(m.x,m.y),f.copy(_),r.update()}function gt(){}function ce(ne){ne.deltaY<0?ae(M()):ne.deltaY>0&&H(M()),r.update()}function oe(ne){let Et=!1;if(r.keyMode=="pan")switch(ne.code){case r.keys.UP:$(0,r.keyPanSpeed),Et=!0;break;case r.keys.BOTTOM:$(0,-r.keyPanSpeed),Et=!0;break;case r.keys.LEFT:$(r.keyPanSpeed,0),Et=!0;break;case r.keys.RIGHT:$(-r.keyPanSpeed,0),Et=!0;break}else switch(ne.code){case r.keys.UP:U(r.keyRotateSpeedVertical),Et=!0;break;case r.keys.BOTTOM:U(-r.keyRotateSpeedVertical),Et=!0;break;case r.keys.LEFT:D(r.keyRotateSpeedHorizontal),Et=!0;break;case r.keys.RIGHT:D(-r.keyRotateSpeedHorizontal),Et=!0;break}Et&&(ne.preventDefault(),r.update())}function yt(){if(x.length===1)p.set(x[0].pageX,x[0].pageY);else{let ne=.5*(x[0].pageX+x[1].pageX),Et=.5*(x[0].pageY+x[1].pageY);p.set(ne,Et)}}function X(){if(x.length===1)f.set(x[0].pageX,x[0].pageY);else{let ne=.5*(x[0].pageX+x[1].pageX),Et=.5*(x[0].pageY+x[1].pageY);f.set(ne,Et)}}function Tt(){let ne=x[0].pageX-x[1].pageX,Et=x[0].pageY-x[1].pageY,Or=Math.sqrt(ne*ne+Et*Et);v.set(0,Or)}function At(){r.enableZoom&&Tt(),r.enablePan&&X()}function Nt(){r.enableZoom&&Tt(),r.enableRotate&&yt()}function Mt(ne){if(x.length==1)u.set(ne.pageX,ne.pageY);else{let Or=Zt(ne),cr=.5*(ne.pageX+Or.x),an=.5*(ne.pageY+Or.y);u.set(cr,an)}d.subVectors(u,p).multiplyScalar(r.rotateSpeed);let Et=r.domElement;D(2*Math.PI*d.x/Et.clientHeight),U(2*Math.PI*d.y/Et.clientHeight),p.copy(u)}function Vt(ne){if(x.length===1)_.set(ne.pageX,ne.pageY);else{let Et=Zt(ne),Or=.5*(ne.pageX+Et.x),cr=.5*(ne.pageY+Et.y);_.set(Or,cr)}m.subVectors(_,f).multiplyScalar(r.panSpeed),$(m.x,m.y),f.copy(_)}function Re(ne){let Et=Zt(ne),Or=ne.pageX-Et.x,cr=ne.pageY-Et.y,an=Math.sqrt(Or*Or+cr*cr);y.set(0,an),b.set(0,Math.pow(y.y/v.y,r.zoomSpeed)),H(b.y),v.copy(y)}function tt(ne){r.enableZoom&&Re(ne),r.enablePan&&Vt(ne)}function ut(ne){r.enableZoom&&Re(ne),r.enableRotate&&Mt(ne)}function It(){}function pt(ne){r.enabled!==!1&&(x.length===0&&(r.domElement.setPointerCapture(ne.pointerId),r.domElement.ownerDocument.addEventListener("pointermove",V),r.domElement.ownerDocument.addEventListener("pointerup",B)),Oe(ne),ne.pointerType==="touch"?De(ne):lt(ne))}function V(ne){r.enabled!==!1&&(ne.pointerType==="touch"?Le(ne):A(ne))}function B(ne){r.enabled!==!1&&(ne.pointerType==="touch"?Y():St(ne),bt(ne),x.length===0&&(r.domElement.releasePointerCapture(ne.pointerId),r.domElement.ownerDocument.removeEventListener("pointermove",V),r.domElement.ownerDocument.removeEventListener("pointerup",B)))}function Pe(ne){bt(ne)}function lt(ne){let Et;switch(ne.button){case 0:Et=r.mouseButtons.LEFT;break;case 1:Et=r.mouseButtons.MIDDLE;break;case 2:Et=r.mouseButtons.RIGHT;break;default:Et=-1}switch(Et){case Cs.DOLLY:if(r.enableZoom===!1)return;me(ne),s=o.DOLLY;break;case Cs.ROTATE:if(ne.ctrlKey||ne.metaKey||ne.shiftKey){if(r.enablePan===!1)return;Ue(ne),s=o.PAN}else{if(r.enableRotate===!1)return;ue(ne),s=o.ROTATE}break;case Cs.PAN:if(ne.ctrlKey||ne.metaKey||ne.shiftKey){if(r.enableRotate===!1)return;ue(ne),s=o.ROTATE}else{if(r.enablePan===!1)return;Ue(ne),s=o.PAN}break;default:s=o.NONE}s!==o.NONE&&r.dispatchEvent(X3)}function A(ne){if(r.enabled!==!1)switch(s){case o.ROTATE:if(r.enableRotate===!1)return;st(ne);break;case o.DOLLY:if(r.enableZoom===!1)return;ft(ne);break;case o.PAN:if(r.enablePan===!1)return;Ze(ne);break}}function St(ne){gt(ne),r.dispatchEvent(jf),s=o.NONE}function Ut(ne){r.enabled===!1||r.enableZoom===!1||s!==o.NONE&&s!==o.ROTATE||(ne.preventDefault(),r.dispatchEvent(X3),ce(ne),r.dispatchEvent(jf))}function Dt(ne){r.enabled===!1||r.enablePan===!1||oe(ne)}function De(ne){switch(Pt(ne),x.length){case 1:switch(r.touches.ONE){case Ts.ROTATE:if(r.enableRotate===!1)return;yt(),s=o.TOUCH_ROTATE;break;case Ts.PAN:if(r.enablePan===!1)return;X(),s=o.TOUCH_PAN;break;default:s=o.NONE}break;case 2:switch(r.touches.TWO){case Ts.DOLLY_PAN:if(r.enableZoom===!1&&r.enablePan===!1)return;At(),s=o.TOUCH_DOLLY_PAN;break;case Ts.DOLLY_ROTATE:if(r.enableZoom===!1&&r.enableRotate===!1)return;Nt(),s=o.TOUCH_DOLLY_ROTATE;break;default:s=o.NONE}break;default:s=o.NONE}s!==o.NONE&&r.dispatchEvent(X3)}function Le(ne){switch(Pt(ne),s){case o.TOUCH_ROTATE:if(r.enableRotate===!1)return;Mt(ne),r.update();break;case o.TOUCH_PAN:if(r.enablePan===!1)return;Vt(ne),r.update();break;case o.TOUCH_DOLLY_PAN:if(r.enableZoom===!1&&r.enablePan===!1)return;tt(ne),r.update();break;case o.TOUCH_DOLLY_ROTATE:if(r.enableZoom===!1&&r.enableRotate===!1)return;ut(ne),r.update();break;default:s=o.NONE}}function Y(ne){It(ne),r.dispatchEvent(jf),s=o.NONE}function ot(ne){r.enabled!==!1&&ne.preventDefault()}function Oe(ne){x.push(ne)}function bt(ne){delete E[ne.pointerId];for(let Et=0;Et<x.length;Et++)if(x[Et].pointerId==ne.pointerId){x.splice(Et,1);return}}function Pt(ne){let Et=E[ne.pointerId];Et===void 0&&(Et=new re,E[ne.pointerId]=Et),Et.set(ne.pageX,ne.pageY)}function Zt(ne){let Et=ne.pointerId===x[0].pointerId?x[1]:x[0];return E[Et.pointerId]}r.domElement.addEventListener("contextmenu",ot),r.domElement.addEventListener("pointerdown",pt),r.domElement.addEventListener("pointercancel",Pe),r.domElement.addEventListener("wheel",Ut,{passive:!1}),this.update()}};var lw="start",cw="change",uw="end";var Yl=["pan","rotate"],pw=class extends je{constructor(){super(...arguments);this.enabled=N.BOOLEAN(1),this.allowPan=N.BOOLEAN(1),this.allowRotate=N.BOOLEAN(1),this.allowZoom=N.BOOLEAN(1),this.tdamping=N.BOOLEAN(1),this.damping=N.FLOAT(.1,{visibleIf:{tdamping:!0}}),this.screenSpacePanning=N.BOOLEAN(1),this.rotateSpeed=N.FLOAT(.5),this.minDistance=N.FLOAT(.1,{range:[.1,100],rangeLocked:[!0,!1]}),this.maxDistance=N.FLOAT(50,{range:[0,100],rangeLocked:[!0,!1]}),this.limitAzimuthAngle=N.BOOLEAN(0),this.azimuthAngleRange=N.VECTOR2(["-2*$PI","2*$PI"],{visibleIf:{limitAzimuthAngle:1}}),this.polarAngleRange=N.VECTOR2([0,"$PI"]),this.target=N.VECTOR3([0,0,0],{cook:!1,computeOnDirty:!0,callback:e=>{qf.PARAM_CALLBACK_update_target(e)}}),this.enableKeys=N.BOOLEAN(0),this.keysMode=N.INTEGER(Yl.indexOf("pan"),{visibleIf:{enableKeys:1},menu:{entries:Yl.map((e,t)=>({name:e,value:t}))}}),this.keysPanSpeed=N.FLOAT(7,{range:[0,10],rangeLocked:[!1,!1],visibleIf:{enableKeys:1,keysMode:Yl.indexOf("pan")}}),this.keysRotateSpeedVertical=N.FLOAT(1,{range:[0,1],rangeLocked:[!1,!1],visibleIf:{enableKeys:1,keysMode:Yl.indexOf("rotate")}}),this.keysRotateSpeedHorizontal=N.FLOAT(1,{range:[0,1],rangeLocked:[!1,!1],visibleIf:{enableKeys:1,keysMode:Yl.indexOf("rotate")}})}},qY=new pw,qf=class extends Y3{constructor(){super(...arguments);this.paramsConfig=qY,this._controls_by_element_id=new Map,this._target_array=[0,0,0]}static type(){return v9.ORBIT}endEventName(){return"end"}initializeNode(){this.io.outputs.setNamedOutputConnectionPoints([new kn(lw,Bn.BASE),new kn(cw,Bn.BASE),new kn(uw,Bn.BASE)])}async createControlsInstance(e,t){let r=new J3(e,t);return r.addEventListener("end",()=>{this._on_controls_end(r)}),this._controls_by_element_id.set(t.id,r),this._bind_listeners_to_controls_instance(r),r}_bind_listeners_to_controls_instance(e){e.addEventListener("start",()=>{this.dispatchEventToOutput(lw,{})}),e.addEventListener("change",()=>{this.dispatchEventToOutput(cw,{})}),e.addEventListener("end",()=>{this.dispatchEventToOutput(uw,{})})}setupControls(e){e.enabled=Ie(this.pv.enabled),e.enablePan=Ie(this.pv.allowPan),e.enableRotate=Ie(this.pv.allowRotate),e.enableZoom=Ie(this.pv.allowZoom),e.enableDamping=Ie(this.pv.tdamping),e.dampingFactor=this.pv.damping,e.rotateSpeed=this.pv.rotateSpeed,e.screenSpacePanning=Ie(this.pv.screenSpacePanning),e.minDistance=this.pv.minDistance,e.maxDistance=this.pv.maxDistance,this._set_azimuth_angle(e),e.minPolarAngle=this.pv.polarAngleRange.x,e.maxPolarAngle=this.pv.polarAngleRange.y,e.target.copy(this.pv.target),e.enabled&&e.update(),e.enableKeys=Ie(this.pv.enableKeys),e.enableKeys&&(e.keyMode=Yl[this.pv.keysMode],e.keyRotateSpeedVertical=this.pv.keysRotateSpeedVertical,e.keyRotateSpeedHorizontal=this.pv.keysRotateSpeedHorizontal,e.keyPanSpeed=this.pv.keysPanSpeed)}_set_azimuth_angle(e){Ie(this.pv.limitAzimuthAngle)?(e.minAzimuthAngle=this.pv.azimuthAngleRange.x,e.maxAzimuthAngle=this.pv.azimuthAngleRange.y):(e.minAzimuthAngle=1/0,e.maxAzimuthAngle=1/0)}updateRequired(){return Ie(this.pv.tdamping)}_on_controls_end(e){!Ie(this.pv.allowPan)||(e.target.toArray(this._target_array),this.p.target.set(this._target_array))}static PARAM_CALLBACK_update_target(e){e._update_target()}_update_target(){let e=this.pv.target;this._controls_by_element_id.forEach((t,r)=>{let o=t.target;o.equals(e)||(o.copy(e),t.update())})}disposeControlsForHtmlElementId(e){this._controls_by_element_id.get(e)&&this._controls_by_element_id.delete(e)}};var Gn=class{constructor(e){this.node=e}update(){}get material(){return this.node.material}};var sn=class extends no{constructor(){super(...arguments);this._cook_main_without_inputs_when_dirty_bound=this._cook_main_without_inputs_when_dirty.bind(this)}static context(){return it.MAT}initializeBaseNode(){super.initializeBaseNode(),this.nameController.add_post_set_fullPath_hook(this.set_material_name.bind(this)),this.addPostDirtyHook("_cook_main_without_inputs_when_dirty",()=>{setTimeout(this._cook_main_without_inputs_when_dirty_bound,0)})}async _cook_main_without_inputs_when_dirty(){await this.cookController.cookMainWithoutInputs()}set_material_name(){this._material&&(this._material.name=this.path())}get material(){return this._material=this._material||this.createMaterial()}setMaterial(e){this._setContainer(e)}};function Bu(n){return class extends n{constructor(){super(...arguments);this.transparent=N.BOOLEAN(0),this.opacity=N.FLOAT(1),this.alphaTest=N.FLOAT(0)}}}var WY=class extends Bu(je){};var ku=class extends Gn{constructor(e){super(e);this.node=e}static update(e){let t=e.material,r=e.pv;this._updateTransparency(t,r)}static _updateTransparency(e,t){e.transparent=Ie(t.transparent),this._updateCommon(e,t)}static _updateCommon(e,t){e.uniforms.opacity&&(e.uniforms.opacity.value=t.opacity),e.opacity=t.opacity,e.uniforms.alphaTest&&(e.uniforms.alphaTest.value=t.alphaTest),e.alphaTest=t.alphaTest;let r=e.customMaterials;if(r){let o=Object.keys(r);for(let s of o){let i=r[s];i&&this._updateCommon(i,t)}}}};var dw={NoBlending:To,NormalBlending:Es,AdditiveBlending:Wc,SubtractiveBlending:$c,MultiplyBlending:Yc},$Y=Object.keys(dw);function Ws(n){return class extends n{constructor(){super(...arguments);this.doubleSided=N.BOOLEAN(0),this.front=N.BOOLEAN(1,{visibleIf:{doubleSided:!1}}),this.overrideShadowSide=N.BOOLEAN(0),this.shadowDoubleSided=N.BOOLEAN(0,{visibleIf:{overrideShadowSide:!0}}),this.shadowFront=N.BOOLEAN(1,{visibleIf:{overrideShadowSide:!0,shadowDoubleSided:!1}}),this.colorWrite=N.BOOLEAN(1,{separatorBefore:!0,cook:!1,callback:(t,r)=>{Ui.update(t)}}),this.depthWrite=N.BOOLEAN(1,{cook:!1,callback:(t,r)=>{Ui.update(t)}}),this.depthTest=N.BOOLEAN(1,{cook:!1,callback:(t,r)=>{Ui.update(t)}}),this.premultipliedAlpha=N.BOOLEAN(!1,{separatorAfter:!0}),this.blending=N.INTEGER(Es,{menu:{entries:$Y.map(t=>({name:t,value:dw[t]}))}}),this.dithering=N.BOOLEAN(0),this.polygonOffset=N.BOOLEAN(!1,{separatorBefore:!0}),this.polygonOffsetFactor=N.INTEGER(0,{range:[0,1e3],visibleIf:{polygonOffset:1}}),this.polygonOffsetUnits=N.INTEGER(0,{range:[0,1e3],visibleIf:{polygonOffset:1}})}}}var YY=class extends Ws(je){};var Ui=class extends Gn{constructor(e){super(e);this.node=e}initializeNode(){}async update(){let e=this.node.material,t=this.node.pv;this._updateSides(e,t),e.colorWrite=t.colorWrite,e.depthWrite=t.depthWrite,e.depthTest=t.depthTest,e.blending=t.blending,e.premultipliedAlpha=t.premultipliedAlpha,e.dithering=t.dithering,e.polygonOffset=t.polygonOffset,e.polygonOffset&&(e.polygonOffsetFactor=t.polygonOffsetFactor,e.polygonOffsetUnits=t.polygonOffsetUnits,e.needsUpdate=!0)}_updateSides(e,t){let r=Ie(t.front)?eo:Nr,o=Ie(t.doubleSided)?Ho:r;if(o!=e.side&&(e.side=o,e.needsUpdate=!0),Ie(t.overrideShadowSide)){let i=Ie(t.shadowFront)?eo:Nr,l=Ie(t.shadowDoubleSided)?Ho:i,a=this.node.material;l!=a.shadowSide&&(a.shadowSide=l,a.needsUpdate=!0)}else e.shadowSide=null;let s=e.customMaterials;if(s){let i=Object.keys(s);for(let l of i){let a=s[l];a&&this._updateSides(a,t)}}}static async update(e){e.controllers.advancedCommon.update()}};function pn(n){return{cook:!1,callback:(e,t)=>{n.update(e)}}}function Vr(n,e,t){return{visibleIf:{[e]:1},nodeSelection:{context:it.COP,types:t==null?void 0:t.types},cook:!1,callback:(r,o)=>{n.update(r)}}}var dn=class extends Gn{constructor(e,t){super(e);this.node=e,this._update_options=t}add_hooks(e,t){e.addPostDirtyHook("TextureController",()=>{this.update()}),t.addPostDirtyHook("TextureController",()=>{this.update()})}static update(e){}async _update(e,t,r,o){if(this._update_options.uniforms){let s=e,i=t;await this._update_texture_on_uniforms(s,i,r,o)}if(this._update_options.directParams){let s=e,i=t;await this._update_texture_on_material(s,i,r,o)}}async _update_texture_on_uniforms(e,t,r,o){this._update_required_attribute(e,e.uniforms,t,r,o,this._apply_texture_on_uniforms.bind(this),this._remove_texture_from_uniforms.bind(this))}_apply_texture_on_uniforms(e,t,r,o){let s=t[r]!=null&&t[r].value!=null,i=!1;if(s&&t[r].value.uuid!=o.uuid&&(i=!0),!s||i){t[r]&&(t[r].value=o),this._apply_texture_on_material(e,e,r,o),e.needsUpdate=!0;let a=e.customMaterials;if(a){let c=Object.keys(a);for(let h of c){let g=a[h];g&&this._apply_texture_on_uniforms(g,g.uniforms,r,o)}}}}_remove_texture_from_uniforms(e,t,r){if(!t[r]){Fe.warn(`'${r}' uniform not found. existing uniforms are:`,Object.keys(t).sort());return}if(t[r].value){t[r].value=null,this._remove_texture_from_material(e,e,r),e.needsUpdate=!0;let o=e.customMaterials;if(o){let s=Object.keys(o);for(let i of s){let l=o[i];l&&this._remove_texture_from_uniforms(l,l.uniforms,r)}}}}async _update_texture_on_material(e,t,r,o){this._update_required_attribute(e,e,t,r,o,this._apply_texture_on_material.bind(this),this._remove_texture_from_material.bind(this))}_apply_texture_on_material(e,t,r,o){let s=t[r]!=null,i=!1;s&&t[r].uuid!=o.uuid&&(i=!0),(!s||i)&&(t[r]=o,e.needsUpdate=!0)}_remove_texture_from_material(e,t,r){t[r]&&(t[r]=null,e.needsUpdate=!0)}async _update_required_attribute(e,t,r,o,s,i,l){if(o.isDirty()&&await o.compute(),o.value){s.isDirty()&&await s.compute();let c=s.value.nodeWithContext(it.COP);if(c){let g=(await c.compute()).texture();if(g){i(e,t,r,g);return}}}l(e,t,r)}};function $s(n){return class extends n{constructor(){super(...arguments);this.useMap=N.BOOLEAN(0,pn(p0)),this.map=N.NODE_PATH("",Vr(p0,"useMap"))}}}var XY=class extends $s(je){};var p0=class extends dn{constructor(e,t){super(e,t);this.node=e}initializeNode(){this.add_hooks(this.node.p.useMap,this.node.p.map)}async update(){this._update(this.node.material,"map",this.node.p.useMap,this.node.p.map)}static async update(e){e.controllers.map.update()}};function Ys(n){return class extends n{constructor(){super(...arguments);this.useAlphaMap=N.BOOLEAN(0,{separatorBefore:!0,...pn(d0)}),this.alphaMap=N.NODE_PATH("",Vr(d0,"useAlphaMap"))}}}var JY=class extends Ys(je){};var d0=class extends dn{constructor(e,t){super(e,t);this.node=e}initializeNode(){this.add_hooks(this.node.p.useAlphaMap,this.node.p.alphaMap)}async update(){this._update(this.node.material,"alphaMap",this.node.p.useAlphaMap,this.node.p.alphaMap)}static async update(e){e.controllers.alphaMap.update()}};var K3={};b1(K3,{LineBasicMaterial:()=>Wn,LineDashedMaterial:()=>Kf,Material:()=>gn,MeshBasicMaterial:()=>nl,MeshDepthMaterial:()=>gl,MeshDistanceMaterial:()=>vl,MeshLambertMaterial:()=>Jl,MeshMatcapMaterial:()=>Jf,MeshNormalMaterial:()=>Xf,MeshPhongMaterial:()=>$f,MeshPhysicalMaterial:()=>Qv,MeshStandardMaterial:()=>Oi,MeshToonMaterial:()=>Yf,PointsMaterial:()=>D0,RawShaderMaterial:()=>F0,ShaderMaterial:()=>co,ShadowMaterial:()=>Wf,SpriteMaterial:()=>Xl});var Wf=class extends gn{constructor(e){super();this.type="ShadowMaterial",this.color=new Ke(0),this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this}};Wf.prototype.isShadowMaterial=!0;var Xl=class extends gn{constructor(e){super();this.type="SpriteMaterial",this.color=new Ke(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this}};Xl.prototype.isSpriteMaterial=!0;var $f=class extends gn{constructor(e){super();this.type="MeshPhongMaterial",this.color=new Ke(16777215),this.specular=new Ke(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ke(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=$o,this.normalScale=new re(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=w0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}};$f.prototype.isMeshPhongMaterial=!0;var Yf=class extends gn{constructor(e){super();this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Ke(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ke(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=$o,this.normalScale=new re(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}};Yf.prototype.isMeshToonMaterial=!0;var Xf=class extends gn{constructor(e){super();this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=$o,this.normalScale=new re(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}};Xf.prototype.isMeshNormalMaterial=!0;var Jl=class extends gn{constructor(e){super();this.type="MeshLambertMaterial",this.color=new Ke(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ke(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=w0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}};Jl.prototype.isMeshLambertMaterial=!0;var Jf=class extends gn{constructor(e){super();this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Ke(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=$o,this.normalScale=new re(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this}};Jf.prototype.isMeshMatcapMaterial=!0;var Kf=class extends Wn{constructor(e){super();this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}};Kf.prototype.isLineDashedMaterial=!0;var Fu=class extends al{constructor(e){super(e);this.textures={}}load(e,t,r,o){let s=this,i=new ws(s.manager);i.setPath(s.path),i.setRequestHeader(s.requestHeader),i.setWithCredentials(s.withCredentials),i.load(e,function(l){try{t(s.parse(JSON.parse(l)))}catch(a){o?o(a):console.error(a),s.manager.itemError(e)}},r,o)}parse(e){let t=this.textures;function r(s){return t[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),t[s]}let o=new K3[e.type];if(e.uuid!==void 0&&(o.uuid=e.uuid),e.name!==void 0&&(o.name=e.name),e.color!==void 0&&o.color!==void 0&&o.color.setHex(e.color),e.roughness!==void 0&&(o.roughness=e.roughness),e.metalness!==void 0&&(o.metalness=e.metalness),e.sheen!==void 0&&(o.sheen=e.sheen),e.sheenTint!==void 0&&(o.sheenTint=new Ke().setHex(e.sheenTint)),e.sheenRoughness!==void 0&&(o.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&o.emissive!==void 0&&o.emissive.setHex(e.emissive),e.specular!==void 0&&o.specular!==void 0&&o.specular.setHex(e.specular),e.specularIntensity!==void 0&&(o.specularIntensity=e.specularIntensity),e.specularTint!==void 0&&o.specularTint!==void 0&&o.specularTint.setHex(e.specularTint),e.shininess!==void 0&&(o.shininess=e.shininess),e.clearcoat!==void 0&&(o.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(o.clearcoatRoughness=e.clearcoatRoughness),e.transmission!==void 0&&(o.transmission=e.transmission),e.thickness!==void 0&&(o.thickness=e.thickness),e.attenuationDistance!==void 0&&(o.attenuationDistance=e.attenuationDistance),e.attenuationTint!==void 0&&o.attenuationTint!==void 0&&o.attenuationTint.setHex(e.attenuationTint),e.fog!==void 0&&(o.fog=e.fog),e.flatShading!==void 0&&(o.flatShading=e.flatShading),e.blending!==void 0&&(o.blending=e.blending),e.combine!==void 0&&(o.combine=e.combine),e.side!==void 0&&(o.side=e.side),e.shadowSide!==void 0&&(o.shadowSide=e.shadowSide),e.opacity!==void 0&&(o.opacity=e.opacity),e.format!==void 0&&(o.format=e.format),e.transparent!==void 0&&(o.transparent=e.transparent),e.alphaTest!==void 0&&(o.alphaTest=e.alphaTest),e.depthTest!==void 0&&(o.depthTest=e.depthTest),e.depthWrite!==void 0&&(o.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(o.colorWrite=e.colorWrite),e.stencilWrite!==void 0&&(o.stencilWrite=e.stencilWrite),e.stencilWriteMask!==void 0&&(o.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(o.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(o.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(o.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(o.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(o.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(o.stencilZPass=e.stencilZPass),e.wireframe!==void 0&&(o.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(o.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(o.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(o.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(o.rotation=e.rotation),e.linewidth!==1&&(o.linewidth=e.linewidth),e.dashSize!==void 0&&(o.dashSize=e.dashSize),e.gapSize!==void 0&&(o.gapSize=e.gapSize),e.scale!==void 0&&(o.scale=e.scale),e.polygonOffset!==void 0&&(o.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(o.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(o.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(o.dithering=e.dithering),e.alphaToCoverage!==void 0&&(o.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(o.premultipliedAlpha=e.premultipliedAlpha),e.visible!==void 0&&(o.visible=e.visible),e.toneMapped!==void 0&&(o.toneMapped=e.toneMapped),e.userData!==void 0&&(o.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?o.vertexColors=e.vertexColors>0:o.vertexColors=e.vertexColors),e.uniforms!==void 0)for(let s in e.uniforms){let i=e.uniforms[s];switch(o.uniforms[s]={},i.type){case"t":o.uniforms[s].value=r(i.value);break;case"c":o.uniforms[s].value=new Ke().setHex(i.value);break;case"v2":o.uniforms[s].value=new re().fromArray(i.value);break;case"v3":o.uniforms[s].value=new F().fromArray(i.value);break;case"v4":o.uniforms[s].value=new kt().fromArray(i.value);break;case"m3":o.uniforms[s].value=new Io().fromArray(i.value);break;case"m4":o.uniforms[s].value=new vr().fromArray(i.value);break;default:o.uniforms[s].value=i.value}}if(e.defines!==void 0&&(o.defines=e.defines),e.vertexShader!==void 0&&(o.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(o.fragmentShader=e.fragmentShader),e.extensions!==void 0)for(let s in e.extensions)o.extensions[s]=e.extensions[s];if(e.shading!==void 0&&(o.flatShading=e.shading===1),e.size!==void 0&&(o.size=e.size),e.sizeAttenuation!==void 0&&(o.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(o.map=r(e.map)),e.matcap!==void 0&&(o.matcap=r(e.matcap)),e.alphaMap!==void 0&&(o.alphaMap=r(e.alphaMap)),e.bumpMap!==void 0&&(o.bumpMap=r(e.bumpMap)),e.bumpScale!==void 0&&(o.bumpScale=e.bumpScale),e.normalMap!==void 0&&(o.normalMap=r(e.normalMap)),e.normalMapType!==void 0&&(o.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),o.normalScale=new re().fromArray(s)}return e.displacementMap!==void 0&&(o.displacementMap=r(e.displacementMap)),e.displacementScale!==void 0&&(o.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(o.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(o.roughnessMap=r(e.roughnessMap)),e.metalnessMap!==void 0&&(o.metalnessMap=r(e.metalnessMap)),e.emissiveMap!==void 0&&(o.emissiveMap=r(e.emissiveMap)),e.emissiveIntensity!==void 0&&(o.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(o.specularMap=r(e.specularMap)),e.specularIntensityMap!==void 0&&(o.specularIntensityMap=r(e.specularIntensityMap)),e.specularTintMap!==void 0&&(o.specularTintMap=r(e.specularTintMap)),e.envMap!==void 0&&(o.envMap=r(e.envMap)),e.envMapIntensity!==void 0&&(o.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(o.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(o.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(o.lightMap=r(e.lightMap)),e.lightMapIntensity!==void 0&&(o.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(o.aoMap=r(e.aoMap)),e.aoMapIntensity!==void 0&&(o.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(o.gradientMap=r(e.gradientMap)),e.clearcoatMap!==void 0&&(o.clearcoatMap=r(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(o.clearcoatRoughnessMap=r(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(o.clearcoatNormalMap=r(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(o.clearcoatNormalScale=new re().fromArray(e.clearcoatNormalScale)),e.transmissionMap!==void 0&&(o.transmissionMap=r(e.transmissionMap)),e.thicknessMap!==void 0&&(o.thicknessMap=r(e.thicknessMap)),o}setTextures(e){return this.textures=e,this}};var Z3=class{constructor(e){this.node=e,this._found_uniform_texture_by_id=new Map,this._found_uniform_textures_id_by_uniform_name=new Map,this._found_param_texture_by_id=new Map,this._found_param_textures_id_by_uniform_name=new Map}toJSON(){}load(e){}_materialToJson(e,t){this._unassignTextures(e);let r;try{r=e.toJSON({}),r&&(r.shadowSide=e.shadowSide,r.colorWrite=e.colorWrite)}catch{console.error("failed to save material data"),console.log(e)}return r&&e.lights!=null&&(r.lights=e.lights),r&&(r.uuid=`${t.node.path()}-${t.suffix}`),this._reassignTextures(e),r}_unassignTextures(e){this._found_uniform_texture_by_id.clear(),this._found_uniform_textures_id_by_uniform_name.clear(),this._found_param_texture_by_id.clear(),this._found_param_textures_id_by_uniform_name.clear();let t=e.uniforms,r=Object.keys(t);for(let s of r){let i=t[s].value;if(i&&i.uuid){let l=i;this._found_uniform_texture_by_id.set(l.uuid,i),this._found_uniform_textures_id_by_uniform_name.set(s,l.uuid),t[s].value=null}}let o=Object.keys(e);for(let s of o){let i=e[s];if(i&&i.uuid){let l=i;this._found_param_texture_by_id.set(l.uuid,l),this._found_param_textures_id_by_uniform_name.set(s,l.uuid),e[s]=null}}}_reassignTextures(e){let t=[],r=[];this._found_uniform_textures_id_by_uniform_name.forEach((s,i)=>{t.push(i)}),this._found_param_textures_id_by_uniform_name.forEach((s,i)=>{r.push(i)});let o=e.uniforms;for(let s of t){let i=this._found_uniform_textures_id_by_uniform_name.get(s);if(i){let l=this._found_uniform_texture_by_id.get(i);l&&(o[s].value=l)}}for(let s of r){let i=this._found_param_textures_id_by_uniform_name.get(s);if(i){let l=this._found_param_texture_by_id.get(i);l&&(e[s]=l)}}}_loadMaterial(e){e.color=void 0;let r=new Fu().parse(e);e.shadowSide&&(r.shadowSide=e.shadowSide),e.lights!=null&&(r.lights=e.lights);let o=r.uniforms.uv2Transform;o&&this.mat4ToMat3(o);let s=r.uniforms.uvTransform;return s&&this.mat4ToMat3(s),r}mat4ToMat3(e){let t=e.value;if(t.elements[t.elements.length-1]==null){let o=new Io;for(let s=0;s<o.elements.length;s++)o.elements[s]=t.elements[s];e.value=o}}};var Gu=class{constructor(e,t,r){this._type=e,this._name=t,this._default_value=r}static from_param(e){return new Gu(e.type(),e.name(),e.defaultValue())}type(){return this._type}name(){return this._name}get default_value(){return this._default_value}get param_options(){let e=this._callback.bind(this);switch(this._type){case Te.NODE_PATH:return{callback:e,nodeSelection:{context:it.COP}};default:return{callback:e}}}_callback(e,t){}};var K0=class extends Gu{constructor(e,t,r,o){super(e,t,r);this._uniform_name=o}get uniform_name(){return this._uniform_name}get uniform(){return this._uniform=this._uniform||this._create_uniform()}_create_uniform(){return K0.uniform_by_type(this._type)}execute_callback(e,t){this._callback(e,t)}_callback(e,t){K0.callback(t,this.uniform)}static callback(e,t){switch(e.type()){case Te.RAMP:t.value=e.rampTexture();return;case Te.NODE_PATH:K0.set_uniform_value_from_texture_from_node_path_param(e,t);return;default:t.value=e.value}}static uniform_by_type(e){switch(e){case Te.BOOLEAN:return{value:0};case Te.BUTTON:return{value:0};case Te.COLOR:return{value:new Ke(0,0,0)};case Te.FLOAT:return{value:0};case Te.FOLDER:return{value:0};case Te.INTEGER:return{value:0};case Te.NODE_PATH:return{value:0};case Te.PARAM_PATH:return{value:0};case Te.RAMP:return{value:null};case Te.STRING:return{value:null};case Te.VECTOR2:return{value:new re(0,0)};case Te.VECTOR3:return{value:new F(0,0,0)};case Te.VECTOR4:return{value:new kt(0,0,0,0)}}qr.unreachable(e)}static async set_uniform_value_from_texture_from_node_path_param(e,t){e.isDirty()&&await e.compute();let r=e.value.nodeWithContext(it.COP);if(r)if(r.isDirty())r.compute().then(o=>{let s=o.texture();t.value=s});else{let s=r.containerController.container().texture();t.value=s}else t.value=null}set_uniform_value_from_ramp(e,t){t.value=e.rampTexture()}};var Q3=class extends Z3{constructor(e){super(e);this.node=e}toJSON(){let e=this.node.assemblerController;if(!e)return;let t={},r=this.node.material.customMaterials;if(r){let a=Object.keys(r);for(let c of a){let h=r[c];if(h){let g=this._materialToJson(h,{node:this.node,suffix:c});g&&(t[c]=g)}}}let o=[],s=e.assembler.param_configs();for(let a of s)o.push([a.name(),a.uniform_name]);let i=this._materialToJson(this.node.material,{node:this.node,suffix:"main"});return i||console.warn("failed to save material from node",this.node.path()),{material:i||{},uniforms_time_dependent:e.assembler.uniformsTimeDependent(),uniforms_resolution_dependent:e.assembler.uniforms_resolution_dependent(),param_uniform_pairs:o,customMaterials:t}}load(e){if(this._material=this._loadMaterial(e.material),!!this._material){if(this._material.customMaterials=this._material.customMaterials||{},e.customMaterials){let t=Object.keys(e.customMaterials);for(let r of t){let o=e.customMaterials[r],s=this._loadMaterial(o);s&&(this._material.customMaterials[r]=s)}}if(e.uniforms_time_dependent&&this.node.scene().uniformsController.addTimeDependentUniformOwner(this._material.uuid,this._material.uniforms),e.uniforms_resolution_dependent&&this.node.scene().uniformsController.addResolutionDependentUniformOwner(this._material.uuid,this._material.uniforms),e.param_uniform_pairs)for(let t of e.param_uniform_pairs){let r=t[0],o=t[1],s=this.node.params.get(r),i=this._material.uniforms[o],l=Object.keys(this._material.customMaterials),a;for(let c of l){let h=this._material.customMaterials[c],g=h==null?void 0:h.uniforms[o];g&&(a=a||[],a.push(g))}if(s&&(i||a)){let c=()=>{if(i&&K0.callback(s,i),a)for(let h of a)K0.callback(s,h)};s.options.setOption("callback",c),c()}}}}material(){if(Fe.playerMode())return this._material}};function Uu(n){return class extends n{constructor(){super(...arguments);this.setBuilderNode=N.BOOLEAN(0,{callback:t=>{Xs.PARAM_CALLBACK_setCompileRequired(t)}}),this.builderNode=N.NODE_PATH("",{visibleIf:{setBuilderNode:!0},callback:t=>{Xs.PARAM_CALLBACK_setCompileRequired(t)}})}}}var KY=class extends Uu(je){},Xs=class extends sn{constructor(){super(...arguments);this._childrenControllerContext=it.GL,this.persisted_config=new Q3(this)}createMaterial(){var e;let t;return this.persisted_config&&(t=this.persisted_config.material()),t||(t=(e=this.assemblerController)==null?void 0:e.assembler.createMaterial()),t}get assemblerController(){return this._assembler_controller=this._assembler_controller||this._create_assembler_controller()}createNode(e,t){return super.createNode(e,t)}children(){return super.children()}nodesByType(e){return super.nodesByType(e)}childrenAllowed(){return this.assemblerController?super.childrenAllowed():(this.scene().markAsReadOnly(this),!1)}compileIfRequired(){var e;((e=this.assemblerController)==null?void 0:e.compileRequired())&&this._compile()}_compile(){let e=this.assemblerController;this.material&&e&&(e.assembler.setGlParentNode(this),this._setAssemblerGlParentNode(e),e.assembler.compileMaterial(this.material),e.post_compile())}_setAssemblerGlParentNode(e){if(!Ie(this.pv.setBuilderNode))return;let t=this.pv.builderNode.nodeWithContext(it.MAT);if(!t)return;let r=t;if(!r.assemblerController){this.states.error.set(`resolved node '${t.path()}' is not a builder node`);return}if(r.type()!=this.type()){this.states.error.set(`resolved node '${t.path()}' does not have the same type '${t.type()}' as current node '${this.type()}'`);return}e.assembler.setGlParentNode(r)}static PARAM_CALLBACK_setCompileRequired(e){e.PARAM_CALLBACK_setCompileRequired()}PARAM_CALLBACK_setCompileRequired(){var e;(e=this.assemblerController)==null||e.setCompilationRequired(!0)}};function Js(n){return class extends n{constructor(){super(...arguments);this.useAOMap=N.BOOLEAN(0,{separatorBefore:!0,...pn(f0)}),this.aoMap=N.NODE_PATH("",Vr(f0,"useAOMap")),this.aoMapIntensity=N.FLOAT(1,{range:[0,1],rangeLocked:[!1,!1],visibleIf:{useAOMap:1}})}}}var ZY=class extends Js(je){};var f0=class extends dn{constructor(e,t){super(e,t);this.node=e}initializeNode(){this.add_hooks(this.node.p.useAOMap,this.node.p.aoMap)}async update(){if(this._update(this.node.material,"aoMap",this.node.p.useAOMap,this.node.p.aoMap),this._update_options.uniforms){let e=this.node.material;e.uniforms.aoMapIntensity.value=this.node.pv.aoMapIntensity}if(this._update_options.directParams){let e=this.node.material;e.aoMapIntensity=this.node.pv.aoMapIntensity}}static async update(e){e.controllers.aoMap.update()}};function Vu(n){return class extends n{constructor(){super(...arguments);this.useFog=N.BOOLEAN(0)}}}var QY=class extends Vu(je){};var zu=class extends Gn{constructor(e){super(e);this.node=e}static update(e){let t=e.material,r=e.pv;t.fog=Ie(r.useFog)}};function Hu(n){return class extends n{constructor(){super(...arguments);this.wireframe=N.BOOLEAN(0)}}}var eX=class extends Hu(je){};var ju=class extends Gn{constructor(e){super(e);this.node=e}static update(e){let t=e.material,r=e.pv;t.wireframe=Ie(r.wireframe),t.needsUpdate=!0}};var e4=(n=>(n.CUBE_CAMERA="cubeCamera",n.VIDEO="video",n.WEB_CAM="webCam",n.SNAPSHOT="snapshot",n))(e4||{});var fw=["mult","add","mix"],tX={mult:w0,add:md,mix:fd};function t4(n){return class extends n{constructor(){super(...arguments);this.useEnvMap=N.BOOLEAN(0,pn(qu)),this.envMap=N.NODE_PATH("",Vr(qu,"useEnvMap",{types:[e4.CUBE_CAMERA]})),this.combine=N.INTEGER(0,{visibleIf:{useEnvMap:1},menu:{entries:fw.map((t,r)=>({name:t,value:r}))}}),this.reflectivity=N.FLOAT(1,{visibleIf:{useEnvMap:1}}),this.refractionRatio=N.FLOAT(.98,{range:[-1,1],rangeLocked:[!1,!1],visibleIf:{useEnvMap:1}})}}}var rX=class extends t4(je){};var qu=class extends dn{constructor(e,t){super(e,t);this.node=e}initializeNode(){this.add_hooks(this.node.p.useEnvMap,this.node.p.envMap)}async update(){this._update(this.node.material,"envMap",this.node.p.useEnvMap,this.node.p.envMap);let e=tX[fw[this.node.pv.combine]];if(this._update_options.uniforms){let t=this.node.material;t.uniforms.reflectivity.value=this.node.pv.reflectivity,t.uniforms.refractionRatio.value=this.node.pv.refractionRatio}if(this._update_options.directParams){let t=this.node.material;t.combine=e,t.reflectivity=this.node.pv.reflectivity,t.refractionRatio=this.node.pv.refractionRatio}}static async update(e){e.controllers.envMap.update()}};function Kl(n){return class extends n{constructor(){super(...arguments);this.default=N.FOLDER(null)}}}function Zl(n){return class extends n{constructor(){super(...arguments);this.textures=N.FOLDER(null)}}}function Ql(n){return class extends n{constructor(){super(...arguments);this.advanced=N.FOLDER(null)}}}var Zf={uniforms:!0},mw=class extends Vu(Hu(Ws(Uu(Ql(t4(Js(Ys($s(Zl(Bu(Kl(je)))))))))))){},nX=new mw,r4=class extends Xs{constructor(){super(...arguments);this.paramsConfig=nX,this.controllers={advancedCommon:new Ui(this),alphaMap:new d0(this,Zf),aoMap:new f0(this,Zf),envMap:new qu(this,Zf),map:new p0(this,Zf)},this.controllerNames=Object.keys(this.controllers)}static type(){return"meshBasicBuilder"}usedAssembler(){return ou.GL_MESH_BASIC}_create_assembler_controller(){return Fe.assemblersRegister.assembler(this,this.usedAssembler())}initializeNode(){this.params.onParamsCreated("init controllers",()=>{for(let e of this.controllerNames)this.controllers[e].initializeNode()})}async cook(){for(let e of this.controllerNames)this.controllers[e].update();ku.update(this),zu.update(this),ju.update(this),this.compileIfRequired(),this.setMaterial(this.material)}};function n4(n){return class extends n{constructor(){super(...arguments);this.color=N.COLOR([1,1,1],{conversion:Eo.SRGB_TO_LINEAR}),this.useVertexColors=N.BOOLEAN(0,{separatorAfter:!0}),this.transparent=N.BOOLEAN(0),this.opacity=N.FLOAT(1),this.alphaTest=N.FLOAT(0)}}}var oX=class extends n4(je){};var o4=class extends Gn{constructor(e){super(e);this.node=e}static update(e){let t=e.material,r=e.pv;t.color.copy(r.color);let o=Ie(r.useVertexColors);o!=t.vertexColors&&(t.vertexColors=o,t.needsUpdate=!0),t.opacity=r.opacity,t.transparent=r.transparent,t.alphaTest=r.alphaTest}};function Wu(n){return class extends n{constructor(){super(...arguments);this.useEnvMap=N.BOOLEAN(0,{separatorBefore:!0,...pn(Ks)}),this.envMap=N.NODE_PATH("",Vr(Ks,"useEnvMap")),this.envMapIntensity=N.FLOAT(1,{visibleIf:{useEnvMap:1}}),this.refractionRatio=N.FLOAT(.98,{range:[-1,1],rangeLocked:[!1,!1],visibleIf:{useEnvMap:1}})}}}var iX=class extends Wu(je){};var Ks=class extends dn{constructor(e,t){super(e,t);this.node=e}initializeNode(){this.add_hooks(this.node.p.useEnvMap,this.node.p.envMap)}async update(){if(this._update(this.node.material,"envMap",this.node.p.useEnvMap,this.node.p.envMap),this._update_options.uniforms){let e=this.node.material;e.uniforms.envMapIntensity.value=this.node.pv.envMapIntensity,e.uniforms.refractionRatio.value=this.node.pv.refractionRatio}if(this._update_options.directParams){let e=this.node.material;e.envMapIntensity=this.node.pv.envMapIntensity,e.refractionRatio=this.node.pv.refractionRatio}}static async update(e){e.controllers.envMap.update()}};function $u(n){return class extends n{constructor(){super(...arguments);this.useBumpMap=N.BOOLEAN(0,{separatorBefore:!0,...pn(m0)}),this.bumpMap=N.NODE_PATH("",Vr(m0,"useBumpMap")),this.bumpScale=N.FLOAT(1,{range:[0,1],rangeLocked:[!1,!1],...Vr(m0,"useBumpMap")}),this.bumpBias=N.FLOAT(0,{range:[0,1],rangeLocked:[!1,!1],...Vr(m0,"useBumpMap")})}}}var sX=class extends $u(je){};var m0=class extends dn{constructor(e,t){super(e,t);this.node=e}initializeNode(){this.add_hooks(this.node.p.useBumpMap,this.node.p.bumpMap)}async update(){if(this._update(this.node.material,"bumpMap",this.node.p.useBumpMap,this.node.p.bumpMap),this._update_options.uniforms){let e=this.node.material;e.uniforms.bumpScale.value=this.node.pv.bumpScale}if(this._update_options.directParams){let e=this.node.material;e.bumpScale=this.node.pv.bumpScale}}static async update(e){e.controllers.bumpMap.update()}};var hw=["tangent","object"],aX={tangent:$o,object:Td};function Yu(n){return class extends n{constructor(){super(...arguments);this.useNormalMap=N.BOOLEAN(0,{separatorBefore:!0,...pn(Zs)}),this.normalMap=N.NODE_PATH("",Vr(Zs,"useNormalMap")),this.normalMapType=N.INTEGER(0,{visibleIf:{useNormalMap:1},menu:{entries:hw.map((t,r)=>({name:t,value:r}))}}),this.normalScale=N.VECTOR2([1,1],{visibleIf:{useNormalMap:1}}),this.normalScaleMult=N.FLOAT(1,{range:[0,1],rangeLocked:[!1,!1],visibleIf:{useNormalMap:1}})}}}var lX=class extends Yu(je){};var Zs=class extends dn{constructor(e,t){super(e,t);this.node=e}initializeNode(){this.add_hooks(this.node.p.useNormalMap,this.node.p.normalMap)}async update(){let{p:e,pv:t,material:r}=this.node;this._update(this.node.material,"normalMap",e.useNormalMap,e.normalMap);let o=aX[hw[t.normalMapType]];this._update_options.uniforms&&r.uniforms.normalScale.value.copy(t.normalScale).multiplyScalar(t.normalScaleMult);let s=r;s.normalMapType=o,this._update_options.directParams&&s.normalScale.copy(t.normalScale).multiplyScalar(t.normalScaleMult)}static async update(e){e.controllers.normalMap.update()}};function Xu(n){return class extends n{constructor(){super(...arguments);this.emissive=N.COLOR([0,0,0],{separatorBefore:!0}),this.useEmissiveMap=N.BOOLEAN(0,pn(Qs)),this.emissiveMap=N.NODE_PATH("",Vr(Qs,"useEmissiveMap")),this.emissiveIntensity=N.FLOAT(1)}}}var cX=class extends Xu(je){};var Qs=class extends dn{constructor(e,t){super(e,t);this.node=e}initializeNode(){this.add_hooks(this.node.p.useEmissiveMap,this.node.p.emissiveMap)}async update(){if(this._update(this.node.material,"emissiveMap",this.node.p.useEmissiveMap,this.node.p.emissiveMap),this._update_options.uniforms&&this.node.material.uniforms.emissive.value.copy(this.node.pv.emissive),this._update_options.directParams){let e=this.node.material;e.emissive.copy(this.node.pv.emissive),e.emissiveIntensity=this.node.pv.emissiveIntensity}}static async update(e){e.controllers.emissiveMap.update()}};function Ju(n){return class extends n{constructor(){super(...arguments);this.useMetalnessMap=N.BOOLEAN(0,{separatorBefore:!0,...pn(h0)}),this.metalnessMap=N.NODE_PATH("",Vr(h0,"useMetalnessMap")),this.metalness=N.FLOAT(1),this.useRoughnessMap=N.BOOLEAN(0,{separatorBefore:!0,...pn(h0)}),this.roughnessMap=N.NODE_PATH("",Vr(h0,"useRoughnessMap")),this.roughness=N.FLOAT(.5)}}}var uX=class extends Ju(je){};var h0=class extends dn{constructor(e,t){super(e,t);this.node=e}initializeNode(){this.add_hooks(this.node.p.useMetalnessMap,this.node.p.metalnessMap)}async update(){if(this._update(this.node.material,"metalnessMap",this.node.p.useMetalnessMap,this.node.p.metalnessMap),this._update_options.uniforms){let e=this.node.material;e.uniforms.metalness.value=this.node.pv.metalness}if(this._update_options.directParams){let e=this.node.material;e.metalness=this.node.pv.metalness}if(this._update(this.node.material,"roughnessMap",this.node.p.useRoughnessMap,this.node.p.roughnessMap),this._update_options.uniforms){let e=this.node.material;e.uniforms.roughness.value=this.node.pv.roughness}if(this._update_options.directParams){let e=this.node.material;e.roughness=this.node.pv.roughness}}static async update(e){e.controllers.metalnessRoughnessMap.update()}};function Ku(n){return class extends n{constructor(){super(...arguments);this.useLightMap=N.BOOLEAN(0,{separatorBefore:!0,...pn(ea)}),this.lightMap=N.NODE_PATH("",Vr(ea,"useLightMap")),this.lightMapIntensity=N.FLOAT(1,{visibleIf:{useLightMap:1}})}}}var pX=class extends Ku(je){};var ea=class extends dn{constructor(e,t){super(e,t);this.node=e}initializeNode(){this.add_hooks(this.node.p.useLightMap,this.node.p.lightMap)}async update(){if(this._update(this.node.material,"lightMap",this.node.p.useLightMap,this.node.p.lightMap),this._update_options.uniforms){let e=this.node.material;e.uniforms.lightMapIntensity.value=this.node.pv.lightMapIntensity}if(this._update_options.directParams){let e=this.node.material;e.lightMapIntensity=this.node.pv.lightMapIntensity}}static async update(e){e.controllers.lightMap.update()}};function Zu(n){return class extends n{constructor(){super(...arguments);this.useDisplacementMap=N.BOOLEAN(0,{separatorBefore:!0,...pn(_0)}),this.displacementMap=N.NODE_PATH("",Vr(_0,"useDisplacementMap")),this.displacementScale=N.FLOAT(1,{range:[0,1],rangeLocked:[!1,!1],...Vr(_0,"useDisplacementMap")}),this.displacementBias=N.FLOAT(0,{range:[0,1],rangeLocked:[!1,!1],...Vr(_0,"useDisplacementMap")})}}}var dX=class extends Zu(je){};var _0=class extends dn{constructor(e,t){super(e,t);this.node=e}initializeNode(){this.add_hooks(this.node.p.useDisplacementMap,this.node.p.displacementMap)}async update(){if(this._update(this.node.material,"displacementMap",this.node.p.useDisplacementMap,this.node.p.displacementMap),this._update_options.uniforms){let e=this.node.material;e.uniforms.displacementScale.value=this.node.pv.displacementScale,e.uniforms.displacementBias.value=this.node.pv.displacementBias}if(this._update_options.directParams){let e=this.node.material;e.displacementScale=this.node.pv.displacementScale,e.displacementBias=this.node.pv.displacementBias}}static async update(e){e.controllers.displacementMap.update()}};var _w=["round","butt","square"];var gw=["round","bevel","miter"];function i4(n){return class extends n{constructor(){super(...arguments);this.wireframe=N.BOOLEAN(0,{separatorBefore:!0}),this.wireframeLinecap=N.INTEGER(0,{menu:{entries:_w.map((t,r)=>({name:t,value:r}))},visibleIf:{wireframe:1}}),this.wireframeLinejoin=N.INTEGER(0,{menu:{entries:gw.map((t,r)=>({name:t,value:r}))},visibleIf:{wireframe:1}})}}}var fX=class extends i4(je){};var s4=class extends Gn{constructor(e){super(e);this.node=e}static update(e){let t=e.material,r=e.pv;t.wireframe=Ie(r.wireframe),t.wireframeLinecap=_w[r.wireframeLinecap],t.wireframeLinejoin=gw[r.wireframeLinejoin],t.needsUpdate=!0}};function a4(n){return class extends n{constructor(){super(...arguments);this.useFog=N.BOOLEAN(0)}}}var mX=class extends a4(je){};var l4=class extends Gn{constructor(e){super(e);this.node=e}static update(e){let t=e.material,r=e.pv;t.fog=Ie(r.useFog)}};var Vi={directParams:!0},vw=class extends a4(i4(Ws(Ql(Ju(Yu(Ku(Wu(Xu(Zu($u(Js(Ys($s(Zl(n4(Kl(je))))))))))))))))){},hX=new vw,c4=class extends sn{constructor(){super(...arguments);this.paramsConfig=hX,this.controllers={advancedCommon:new Ui(this),alphaMap:new d0(this,Vi),aoMap:new f0(this,Vi),bumpMap:new m0(this,Vi),displacementMap:new _0(this,Vi),emissiveMap:new Qs(this,Vi),envMap:new Ks(this,Vi),lightMap:new ea(this,Vi),map:new p0(this,Vi),metalnessRoughnessMap:new h0(this,Vi),normalMap:new Zs(this,Vi)},this.controllerNames=Object.keys(this.controllers)}static type(){return"meshStandard"}createMaterial(){return new Oi({vertexColors:!1,side:eo,color:16777215,opacity:1,metalness:1,roughness:0})}initializeNode(){this.params.onParamsCreated("init controllers",()=>{for(let e of this.controllerNames)this.controllers[e].initializeNode()})}async cook(){for(let e of this.controllerNames)this.controllers[e].update();o4.update(this),l4.update(this),s4.update(this),this.setMaterial(this.material)}};var Tw=Zi(bw()),Ew=Zi(Cw());var ta=class{static any(e){return xe.isString(e)?e:xe.isBoolean(e)?`${e}`:xe.isNumber(e)?`${Rt.ensureFloat(e)}`:xe.isArray(e)?this.numeric_array(e):e instanceof re||e instanceof F||e instanceof kt||e instanceof Ke?this.numeric_array(e.toArray()):`ThreeToGl error: unknown value type '${e}'`}static numeric_array(e){let t=new Array(e.length);for(let o=0;o<e.length;o++)t[o]=`${Rt.ensureFloat(e[o])}`;return`${`vec${e.length}`}(${t.join(", ")})`}static vector4(e){return xe.isString(e)?e:`vec4(${e.toArray().map(r=>`${Rt.ensureFloat(r)}`).join(", ")})`}static vector3(e){return xe.isString(e)?e:`vec3(${e.toArray().map(r=>`${Rt.ensureFloat(r)}`).join(", ")})`}static vector2(e){return xe.isString(e)?e:`vec2(${e.toArray().map(r=>`${Rt.ensureFloat(r)}`).join(", ")})`}static vector3_float(e,t){return xe.isNumber(t)&&(t=Rt.ensureFloat(t)),`vec4(${this.vector3(e)}, ${t})`}static float4(e,t,r,o){return xe.isNumber(e)&&(e=Rt.ensureFloat(e)),xe.isNumber(t)&&(t=Rt.ensureFloat(t)),xe.isNumber(r)&&(r=Rt.ensureFloat(r)),xe.isNumber(o)&&(o=Rt.ensureFloat(o)),`vec4(${e}, ${t}, ${r}, ${o})`}static float3(e,t,r){return xe.isNumber(e)&&(e=Rt.ensureFloat(e)),xe.isNumber(t)&&(t=Rt.ensureFloat(t)),xe.isNumber(r)&&(r=Rt.ensureFloat(r)),`vec3(${e}, ${t}, ${r})`}static float2(e,t){return xe.isNumber(e)&&(e=Rt.ensureFloat(e)),xe.isNumber(t)&&(t=Rt.ensureFloat(t)),`vec2(${e}, ${t})`}static float(e){if(xe.isNumber(e))return Rt.ensureFloat(e);{let t=parseFloat(e);return xe.isNaN(t)?e:Rt.ensureFloat(t)}}static integer(e){if(xe.isNumber(e))return Rt.ensureInteger(e);{let t=parseInt(e);return xe.isNaN(t)?e:Rt.ensureInteger(t)}}static bool(e){return xe.isBoolean(e)?`${e}`:e}};function u4(n){return class extends n{constructor(){super(...arguments);this.shadowPCSS=N.BOOLEAN(0,{callback:t=>{ec.PARAM_CALLBACK_setRecompileRequired(t)},separatorBefore:!0}),this.shadowPCSSSamplesCount=N.INTEGER(16,{visibleIf:{shadowPCSS:1},range:[0,128],rangeLocked:[!0,!1]}),this.shadowPCSSFilterSize=N.FLOAT(1,{visibleIf:{shadowPCSS:1},range:[0,10],rangeLocked:[!0,!1]})}}}var _X=class extends u4(je){};var ec=class extends Gn{constructor(e){super(e);this.node=e}initializeNode(){}static filterFragmentShader(e,t){let r=`
#define NUM_SAMPLES ${ta.integer(e.pv.shadowPCSSSamplesCount)}
#define PCSS_FILTER_SIZE ${ta.float(e.pv.shadowPCSSFilterSize)}
${Tw.default}
`,o=Dd;return o=o.replace("#ifdef USE_SHADOWMAP",`#ifdef USE_SHADOWMAP
${r}
				`),o=o.replace("#if defined( SHADOWMAP_TYPE_PCF )",`
				${Ew.default}
				#if defined( SHADOWMAP_TYPE_PCF )`),t=t.replace("#include <shadowmap_pars_fragment>",o),t}async update(){let e=this.node;if(!e.assemblerController)return;let t="PCSS";Ie(this.node.pv.shadowPCSS)?e.assemblerController.addFilterFragmentShaderCallback(t,r=>ec.filterFragmentShader(this.node,r)):e.assemblerController.removeFilterFragmentShaderCallback(t)}static async update(e){e.controllers.PCSS.update()}static PARAM_CALLBACK_setRecompileRequired(e){e.controllers.PCSS.update()}};var zi={uniforms:!0},Aw=class extends u4(Vu(Hu(Ws(Uu(Ql(Ju(Yu(Ku(Wu(Xu(Zu($u(Js(Ys($s(Zl(Bu(Kl(je))))))))))))))))))){},gX=new Aw,p4=class extends Xs{constructor(){super(...arguments);this.paramsConfig=gX,this.controllers={advancedCommon:new Ui(this),alphaMap:new d0(this,zi),aoMap:new f0(this,zi),bumpMap:new m0(this,zi),displacementMap:new _0(this,zi),emissiveMap:new Qs(this,zi),envMap:new Ks(this,zi),lightMap:new ea(this,zi),map:new p0(this,zi),metalnessRoughnessMap:new h0(this,zi),normalMap:new Zs(this,zi),PCSS:new ec(this)},this.controllerNames=Object.keys(this.controllers)}static type(){return"meshStandardBuilder"}usedAssembler(){return ou.GL_MESH_STANDARD}_create_assembler_controller(){return Fe.assemblersRegister.assembler(this,this.usedAssembler())}initializeNode(){this.params.onParamsCreated("init controllers",()=>{for(let e of this.controllerNames)this.controllers[e].initializeNode()})}async cook(){for(let e of this.controllerNames)this.controllers[e].update();ku.update(this),zu.update(this),ju.update(this),this.compileIfRequired(),this.setMaterial(this.material)}};var Qf="parent object",vX=[Qf,Qf,Qf,Qf],ra=(n=>(n[n.MANAGER=0]="MANAGER",n[n.CAMERA=2]="CAMERA",n[n.LIGHT=3]="LIGHT",n))(ra||{}),vo=class extends no{constructor(){super(...arguments);this.renderOrder=0,this._children_group=this._create_children_group(),this._attachableToHierarchy=!0,this._used_in_scene=!0}static context(){return it.OBJ}static displayedInputNames(){return vX}_create_children_group(){let e=new Tr;return e.matrixAutoUpdate=!1,e}attachableToHierarchy(){return this._attachableToHierarchy}usedInScene(){return this._used_in_scene}addObjectToParent(e){this.attachableToHierarchy()&&e.add(this.object)}removeObjectFromParent(){if(this.attachableToHierarchy()){let e=this.object.parent;e&&e.remove(this.object)}}initializeBaseNode(){this._object=this._create_object_with_attributes(),this.nameController.add_post_set_fullPath_hook(this.set_object_name.bind(this)),this.set_object_name()}childrenGroup(){return this._children_group}get object(){return this._object}_create_object_with_attributes(){let e=this.createObject();return e.node=this,e.add(this._children_group),e}set_object_name(){this._object&&(this._object.name=this.path(),this._children_group.name=`${this.path()}:parentedOutputs`)}createObject(){let e=new On;return e.matrixAutoUpdate=!1,e}isDisplayNodeCooking(){if(this.displayNodeController){let e=this.displayNodeController.displayNode();if(e)return e.cookController.isCooking()}return!1}isDisplayed(){var e,t;return((t=(e=this.flags)==null?void 0:e.display)==null?void 0:t.active())||!1}};var Qu=class extends vo{constructor(){super(...arguments);this.flags=new Ko(this),this.renderOrder=ra.LIGHT,this._color_with_intensity=new Ke(0),this._used_in_scene=!0,this._cook_main_without_inputs_when_dirty_bound=this._cook_main_without_inputs_when_dirty.bind(this)}get light(){return this._light}initializeBaseNode(){super.initializeBaseNode(),this._light=this.createLight(),this.object.add(this._light),this.flags.display.onUpdate(()=>{this._updateLightAttachment()}),this.dirtyController.addPostDirtyHook("_cook_main_without_inputs_when_dirty",this._cook_main_without_inputs_when_dirty_bound)}async _cook_main_without_inputs_when_dirty(){await this.cookController.cookMainWithoutInputs()}set_object_name(){super.set_object_name(),this._light&&(this._light.name=`${this.path()}:light`)}_updateLightAttachment(){this.flags.display.active()?(this.object.add(this.light),this._cook_main_without_inputs_when_dirty()):this.object.remove(this.light)}cook(){this.updateLightParams(),this.updateShadowParams(),this.cookController.endCook()}updateLightParams(){}updateShadowParams(){}};function hi(n,e){let t=(e==null?void 0:e.matrixAutoUpdate)||!1;return class extends n{constructor(){super(...arguments);this.transform=N.FOLDER(),this.keepPosWhenParenting=N.BOOLEAN(0),this.rotationOrder=N.INTEGER(Fi.indexOf(qs.XYZ),{menu:{entries:Fi.map((o,s)=>({name:o,value:s}))}}),this.t=N.VECTOR3([0,0,0]),this.r=N.VECTOR3([0,0,0]),this.s=N.VECTOR3([1,1,1]),this.scale=N.FLOAT(1),this.matrixAutoUpdate=N.BOOLEAN(t?1:0),this.updateTransformFromObject=N.BUTTON(null,{callback:o=>{Hi.PARAM_CALLBACK_update_transform_from_object(o)}})}}}var yX=class extends hi(je){};var Mw="_cook_main_without_inputs_when_dirty",Hi=class{constructor(e){this.node=e,this._cook_main_without_inputs_when_dirty_bound=this._cook_main_without_inputs_when_dirty.bind(this),this._core_transform=new Jr,this._keep_pos_when_parenting_m_object=new vr,this._keep_pos_when_parenting_m_new_parent_inv=new vr}initializeNode(){this.node.dirtyController.hasHook(Mw)||this.node.dirtyController.addPostDirtyHook(Mw,this._cook_main_without_inputs_when_dirty_bound)}async _cook_main_without_inputs_when_dirty(){await this.node.cookController.cookMainWithoutInputs()}update(){this.update_transform_with_matrix();let e=this.node.object;e.matrixAutoUpdate=Ie(this.node.pv.matrixAutoUpdate)}update_transform_with_matrix(e){let t=this.node.object;e!=null&&!e.equals(t.matrix)?(t.matrix.copy(e),t.dispatchEvent({type:"change"})):this._update_matrix_from_params_with_core_transform()}_update_matrix_from_params_with_core_transform(){let e=this.node.object,t=e.matrixAutoUpdate;t&&(e.matrixAutoUpdate=!1);let r=this._core_transform.matrix(this.node.pv.t,this.node.pv.r,this.node.pv.s,this.node.pv.scale,Fi[this.node.pv.rotationOrder]);e.matrix.identity(),e.applyMatrix4(r),this._apply_look_at(),e.updateMatrix(),t&&(e.matrixAutoUpdate=!0),e.dispatchEvent({type:"change"})}_apply_look_at(){}set_params_from_matrix(e,t={}){Jr.setParamsFromMatrix(e,this.node,t)}static update_node_transform_params_if_required(e,t){e.transformController.update_node_transform_params_if_required(t)}update_node_transform_params_if_required(e){if(!Ie(this.node.pv.keepPosWhenParenting)||!this.node.scene().loadingController.loaded()||e==this.node.object.parent)return;let t=this.node.object;t.updateMatrixWorld(!0),e.updateMatrixWorld(!0),this._keep_pos_when_parenting_m_object.copy(t.matrixWorld),this._keep_pos_when_parenting_m_new_parent_inv.copy(e.matrixWorld),this._keep_pos_when_parenting_m_new_parent_inv.invert(),this._keep_pos_when_parenting_m_object.premultiply(this._keep_pos_when_parenting_m_new_parent_inv),Jr.setParamsFromMatrix(this._keep_pos_when_parenting_m_object,this.node,{scale:!0})}update_node_transform_params_from_object(e=!1){let t=this.node.object;e&&t.updateMatrix(),Jr.setParamsFromMatrix(t.matrix,this.node,{scale:!0})}static PARAM_CALLBACK_update_transform_from_object(e){e.transformController.update_node_transform_params_from_object()}};var Go=class{constructor(e){this.node=e}initializeNode(){this.node.io.inputs.setCount(0,1),this.node.io.inputs.set_depends_on_inputs(!1),this.node.io.outputs.setHasOneOutput(),this.node.io.inputs.add_on_set_input_hook("on_input_updated:update_parent",()=>{this.on_input_updated()})}static on_input_updated(e){let t=e.root().getParentForNode(e);e.transformController&&t&&Hi.update_node_transform_params_if_required(e,t),e.io.inputs.input(0)!=null?e.root().addToParentTransform(e):e.root().removeFromParentTransform(e)}on_input_updated(){Go.on_input_updated(this.node)}};var bX=class extends hi(je){},d4=class extends Qu{constructor(){super(...arguments);this.flags=new Ko(this),this.hierarchyController=new Go(this),this.transformController=new Hi(this)}initializeBaseNode(){super.initializeBaseNode(),this.hierarchyController.initializeNode(),this.transformController.initializeNode()}cook(){this.transformController.update(),this.updateLightParams(),this.updateShadowParams(),this.cookController.endCook()}};var f4={color:new Ke(1,1,1),intensity:1,width:1,height:1,showHelper:!1},ep=f4;function Nw(n){return class extends n{constructor(){super(...arguments);this.light=N.FOLDER(),this.color=N.COLOR(ep.color.toArray(),{conversion:Eo.SRGB_TO_LINEAR}),this.intensity=N.FLOAT(ep.intensity,{range:[0,10]}),this.width=N.FLOAT(ep.width,{range:[0,10]}),this.height=N.FLOAT(ep.height,{range:[0,10]}),this.showHelper=N.BOOLEAN(ep.showHelper)}}}function xX(){let n=new Gt,e=[1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0];return n.setAttribute("position",new _t(e,3)),n.computeBoundingSphere(),n}function CX(){let n=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],e=new Gt;return e.setAttribute("position",new _t(n,3)),e.computeBoundingSphere(),e}var na=class extends Od{constructor(e){super();this.light=e,this.geometry=xX(),this.material=new Wn({fog:!1}),this.type="RectAreaLightHelper",this._childMesh=new wr(CX(),new nl({side:Nr,fog:!1})),this.add(this._childMesh)}update(){this.scale.set(.5*this.light.width,.5*this.light.height,1),this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);let e=this.material.color,t=Math.max(e.r,e.g,e.b);t>1&&e.multiplyScalar(1/t),this._childMesh.material.color.copy(this.material.color),this.matrixWorld.extractRotation(this.light.matrixWorld).scale(this.scale).copyPosition(this.light.matrixWorld),this._childMesh.matrixWorld.copy(this.matrixWorld)}dispose(){this.geometry.dispose(),this.material.dispose(),this._childMesh.geometry.dispose(),this._childMesh.material.dispose()}clone(e){let t=new na(this.light);return t.updateMatrixWorld(),t}};var tc=class extends t0{constructor(e,t,r=10,o=10){super(e,t);this.type="RectAreaLight",this.width=r,this.height=o}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){let t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}};tc.prototype.isRectAreaLight=!0;var Sw=new Float32Array(1),TX=new Int32Array(Sw.buffer),em=class{static toHalfFloat(e){e>65504&&(console.warn("THREE.DataUtils.toHalfFloat(): value exceeds 65504."),e=65504),Sw[0]=e;let t=TX[0],r=t>>16&32768,o=t>>12&2047,s=t>>23&255;return s<103?r:s>142?(r|=31744,r|=(s==255?0:1)&&t&8388607,r):s<113?(o|=2048,r|=(o>>114-s)+(o>>113-s&1),r):(r|=s-112<<10|o>>1,r+=o&1,r)}};var tp=class{static init(){let e=[1,0,0,2e-5,1,0,0,503905e-9,1,0,0,.00201562,1,0,0,.00453516,1,0,0,.00806253,1,0,0,.0125978,1,0,0,.018141,1,0,0,.0246924,1,0,0,.0322525,1,0,0,.0408213,1,0,0,.0503999,1,0,0,.0609894,1,0,0,.0725906,1,0,0,.0852058,1,0,0,.0988363,1,0,0,.113484,1,0,0,.129153,1,0,0,.145839,1,0,0,.163548,1,0,0,.182266,1,0,0,.201942,1,0,0,.222314,1,0,0,.241906,1,0,0,.262314,1,0,0,.285754,1,0,0,.310159,1,0,0,.335426,1,0,0,.361341,1,0,0,.387445,1,0,0,.412784,1,0,0,.438197,1,0,0,.466966,1,0,0,.49559,1,0,0,.523448,1,0,0,.549938,1,0,0,.57979,1,0,0,.608746,1,0,0,.636185,1,0,0,.664748,1,0,0,.69313,1,0,0,.71966,1,0,0,.747662,1,0,0,.774023,1,0,0,.799775,1,0,0,.825274,1,0,0,.849156,1,0,0,.873248,1,0,0,.89532,1,0,0,.917565,1,0,0,.937863,1,0,0,.958139,1,0,0,.976563,1,0,0,.994658,1,0,0,1.0112,1,0,0,1.02712,1,0,0,1.04189,1,0,0,1.05568,1,0,0,1.06877,1,0,0,1.08058,1,0,0,1.09194,1,0,0,1.10191,1,0,0,1.11161,1,0,0,1.1199,1,0,0,1.12813,.999547,-448815e-12,.0224417,199902e-10,.999495,-113079e-10,.0224406,503651e-9,.999496,-452317e-10,.0224406,.00201461,.999496,-101772e-9,.0224406,.00453287,.999495,-180928e-9,.0224406,.00805845,.999497,-282702e-9,.0224406,.0125914,.999496,-407096e-9,.0224406,.0181319,.999498,-554114e-9,.0224406,.02468,.999499,-723768e-9,.0224406,.0322363,.999495,-916058e-9,.0224405,.0408009,.999499,-.00113101,.0224408,.050375,.999494,-.00136863,.0224405,.0609586,.999489,-.00162896,.0224401,.0725537,.999489,-.00191201,.0224414,.0851619,.999498,-.00221787,.0224413,.0987867,.999492,-.00254642,.0224409,.113426,.999507,-.00289779,.0224417,.129088,.999494,-.0032716,.0224386,.145767,.999546,-.0036673,.0224424,.163472,.999543,-.00408166,.0224387,.182182,.999499,-.00450056,.0224338,.201843,.999503,-.00483661,.0224203,.222198,.999546,-.00452928,.022315,.241714,.999508,-.00587403,.0224329,.262184,.999509,-.00638806,.0224271,.285609,.999501,-.00691028,.0224166,.309998,.999539,-.00741979,.0223989,.335262,.999454,-.00786282,.0223675,.361154,.999529,-.00811928,.0222828,.387224,.999503,-.00799941,.0221063,.41252,.999561,-.00952753,.0223057,.438006,.999557,-.0099134,.0222065,.466735,.999541,-.0100935,.0220402,.495332,.999562,-.00996821,.0218067,.523197,.999556,-.0105031,.0217096,.550223,.999561,-.0114191,.0217215,.579498,.999588,-.0111818,.0213357,.608416,.999633,-.0107725,.0208689,.635965,.999527,-.0121671,.0210149,.664476,.999508,-.0116005,.020431,.692786,.999568,-.0115604,.0199791,.719709,.999671,-.0121117,.0197415,.74737,.999688,-.0110769,.0188846,.773692,.99962,-.0122368,.0188452,.799534,.999823,-.0110325,.0178001,.825046,.999599,-.0114923,.0174221,.849075,.999619,-.0105923,.0164345,.872999,.999613,-.0105988,.0158227,.895371,.99964,-.00979861,.0148131,.917364,.99977,-.00967238,.0140721,.938002,.999726,-.00869175,.0129543,.957917,.99973,-.00866872,.0122329,.976557,.999773,-.00731956,.0108958,.994459,.999811,-.00756027,.0102715,1.01118,.999862,-.00583732,.00878781,1.02701,.999835,-.00631438,.00827529,1.04186,.999871,-.00450785,.00674583,1.05569,.999867,-.00486079,.00621041,1.06861,.999939,-.00322072,.00478301,1.08064,.999918,-.00318199,.00406395,1.09181,1.00003,-.00193348,.00280682,1.10207,.999928,-.00153729,.00198741,1.11152,.999933,-623666e-9,917714e-9,1.12009,1,-102387e-11,907581e-12,1.12813,.997866,-896716e-12,.0448334,199584e-10,.997987,-225945e-10,.0448389,502891e-9,.997987,-903781e-10,.0448388,.00201156,.997985,-203351e-9,.0448388,.00452602,.997986,-361514e-9,.0448388,.00804629,.997987,-56487e-8,.0448389,.0125724,.997988,-813423e-9,.0448389,.0181045,.997984,-.00110718,.0448387,.0246427,.997985,-.00144616,.0448388,.0321875,.997987,-.00183038,.044839,.0407392,.997983,-.00225987,.0448387,.0502986,.997991,-.00273467,.0448389,.0608667,.997984,-.00325481,.0448384,.0724444,.998002,-.00382043,.044839,.0850348,.997997,-.00443145,.0448396,.0986372,.998007,-.00508796,.0448397,.113255,.998008,-.00578985,.04484,.128891,.998003,-.00653683,.0448384,.145548,.997983,-.00732713,.0448358,.163221,.997985,-.00815454,.0448358,.181899,.998005,-.00898985,.0448286,.201533,.998026,-.00964404,.0447934,.221821,.998055,-.00922677,.044611,.241282,.99804,-.0117361,.0448245,.261791,.998048,-.0127628,.0448159,.285181,.998088,-.0138055,.0447996,.30954,.998058,-.0148206,.0447669,.334751,.998099,-.0156998,.044697,.36061,.998116,-.0161976,.0445122,.386603,.998195,-.015945,.0441711,.411844,.998168,-.0183947,.0444255,.43773,.998184,-.0197913,.0443809,.466009,.998251,-.0201426,.0440689,.494574,.998305,-.0198847,.0435632,.522405,.998273,-.0210577,.043414,.549967,.998254,-.0227901,.0433943,.578655,.998349,-.0223108,.0426529,.60758,.99843,-.0223088,.042,.635524,.998373,-.0241141,.0418987,.663621,.998425,-.0231446,.0408118,.691906,.998504,-.0233684,.0400565,.719339,.998443,-.0241652,.0394634,.74643,.99848,-.0228715,.0380002,.773086,.998569,-.023519,.0372322,.798988,.998619,-.0223108,.0356468,.824249,.998594,-.0223105,.034523,.848808,.998622,-.0213426,.0328887,.87227,.998669,-.0207912,.0314374,.895157,.998705,-.0198416,.0296925,.916769,.998786,-.0189168,.0279634,.937773,.998888,-.0178811,.0261597,.957431,.99906,-.0166845,.0242159,.976495,.999038,-.0155464,.0222638,.994169,.999237,-.0141349,.0201967,1.01112,.999378,-.0129324,.0181744,1.02692,.999433,-.0113192,.0159898,1.04174,.999439,-.0101244,.0140385,1.05559,.999614,-.00837456,.0117826,1.06852,.999722,-.00721769,.00983745,1.08069,.999817,-.00554067,.00769002,1.09176,.99983,-.00426961,.005782,1.10211,.999964,-.00273904,.00374503,1.11152,1.00001,-.00136739,.00187176,1.12031,.999946,393227e-10,-28919e-9,1.12804,.995847,-13435e-10,.0671785,19916e-9,.995464,-338387e-10,.0671527,501622e-9,.99547,-135355e-9,.0671531,.00200649,.995471,-30455e-8,.0671532,.00451461,.99547,-541423e-9,.0671531,.008026,.995471,-84598e-8,.0671531,.0125407,.99547,-.00121823,.0671531,.0180589,.99547,-.00165817,.0671531,.0245806,.995463,-.00216583,.0671526,.0321062,.995468,-.00274127,.0671527,.0406366,.995474,-.00338447,.0671534,.0501717,.995473,-.00409554,.0671533,.0607131,.995478,-.00487451,.0671531,.0722618,.995476,-.00572148,.0671532,.0848191,.995477,-.00663658,.0671539,.0983882,.995498,-.00761986,.0671541,.112972,.995509,-.00867094,.0671542,.128568,.995509,-.00978951,.0671531,.145183,.995503,-.0109725,.0671491,.162808,.995501,-.012211,.0671465,.181441,.99553,-.0134565,.0671371,.201015,.99555,-.014391,.0670831,.221206,.99558,-.014351,.0668883,.240813,.995577,-.0173997,.0671055,.261257,.995602,-.0191111,.0671178,.284467,.995623,-.0206705,.0670946,.308765,.995658,-.022184,.0670472,.333905,.995705,-.0234832,.0669417,.359677,.995719,-.0241933,.0666714,.385554,.995786,-.0243539,.066266,.410951,.995887,-.0271866,.0664367,.437163,.995944,-.0296012,.0664931,.464842,.996004,-.0301045,.0660105,.49332,.996128,-.0298311,.0652694,.521131,.996253,-.0316426,.0650739,.549167,.996244,-.0339043,.0649433,.57737,.996309,-.033329,.0638926,.606073,.996417,-.0338935,.0630849,.634527,.996372,-.0353104,.0625083,.66256,.996542,-.0348942,.0611986,.690516,.996568,-.0351614,.060069,.718317,.996711,-.0354317,.0588522,.74528,.996671,-.0349513,.0571902,.772061,.996865,-.0345622,.0555321,.798089,.996802,-.0342566,.0537816,.823178,.996992,-.0330862,.0516095,.847949,.996944,-.0324666,.0495537,.871431,.997146,-.0309544,.0470302,.894357,.997189,-.0299372,.0446043,.916142,.997471,-.0281389,.0418812,.937193,.997515,-.0268702,.0391823,.957,.997812,-.0247166,.0361338,.975936,.998027,-.0233525,.0333945,.99391,.998233,-.0209839,.0301917,1.01075,.998481,-.0194309,.027271,1.02669,.998859,-.0169728,.0240162,1.04173,.99894,-.0152322,.0210517,1.05551,.999132,-.0127497,.0178632,1.06856,.999369,-.0108282,.014787,1.08054,.999549,-.00845886,.0116185,1.09185,.999805,-.0063937,.00867209,1.10207,.99985,-.00414582,.00566823,1.1117,.999912,-.00207443,.00277562,1.12022,1.00001,870226e-10,-53766e-9,1.12832,.991943,-178672e-11,.0893382,198384e-10,.991952,-450183e-10,.089339,499849e-9,.991956,-180074e-9,.0893394,.0019994,.991955,-405167e-9,.0893393,.00449867,.991953,-720298e-9,.0893391,.00799764,.991955,-.00112548,.0893393,.0124964,.991957,-.0016207,.0893395,.0179951,.991958,-.00220601,.0893396,.0244939,.991947,-.00288137,.0893385,.0319929,.991962,-.00364693,.0893399,.0404933,.991965,-.00450264,.0893399,.049995,.99198,-.00544862,.0893411,.0604995,.99197,-.00648491,.0893397,.0720074,.991976,-.00761164,.089341,.0845207,.99198,-.00882891,.0893405,.0980413,.991982,-.0101367,.0893396,.112571,.992008,-.011535,.0893415,.128115,.992026,-.0130228,.0893414,.144672,.992064,-.0145966,.0893418,.162241,.992041,-.0162421,.0893359,.180801,.992086,-.0178888,.0893214,.200302,.992157,-.0190368,.0892401,.220332,.992181,-.0195584,.0890525,.240144,.992175,-.0227257,.0892153,.260728,.99221,-.0254195,.089304,.283473,.99222,-.0274883,.0892703,.307673,.992317,-.0294905,.0892027,.332729,.992374,-.0311861,.0890577,.358387,.992505,-.0320656,.0886994,.384102,.992568,-.0329715,.0883198,.409767,.992675,-.036006,.0883602,.436145,.992746,-.0392897,.0884591,.463217,.992873,-.0399337,.0878287,.491557,.992934,-.040231,.0870108,.519516,.993091,-.0422013,.0865857,.547741,.993259,-.0443503,.0861937,.575792,.993455,-.0446368,.0851187,.604233,.993497,-.0454299,.0840576,.632925,.993694,-.0463296,.0829671,.660985,.993718,-.0470619,.0817185,.688714,.993973,-.0468838,.0800294,.716743,.994207,-.046705,.0781286,.74377,.994168,-.0469698,.0763337,.77042,.9945,-.0456816,.0738184,.796659,.994356,-.0455518,.0715545,.821868,.994747,-.0439488,.0686085,.846572,.994937,-.0430056,.065869,.870435,.995142,-.0413414,.0626446,.893272,.995451,-.0396521,.05929,.915376,.995445,-.0378453,.0558503,.936196,.995967,-.0355219,.0520949,.956376,.996094,-.0335146,.048377,.975327,.996622,-.030682,.0442575,.993471,.996938,-.0285504,.0404693,1.01052,.997383,-.0253399,.0360903,1.02637,.997714,-.0231651,.0322176,1.04139,.998249,-.0198138,.0278433,1.05542,.998596,-.0174337,.0238759,1.06846,.998946,-.0141349,.0195944,1.08056,.99928,-.0115603,.0156279,1.09181,.999507,-.00839065,.0114607,1.10213,.999697,-.005666,.00763325,1.11169,.999869,-.00269902,.00364946,1.12042,1.00001,623836e-10,-319288e-10,1.12832,.987221,-222675e-11,.111332,197456e-10,.98739,-561116e-10,.111351,497563e-9,.987448,-224453e-9,.111357,.00199031,.987441,-505019e-9,.111357,.0044782,.987442,-897816e-9,.111357,.00796129,.987442,-.00140284,.111357,.0124396,.987444,-.00202012,.111357,.0179132,.987442,-.00274964,.111357,.0243824,.987446,-.00359147,.111357,.0318474,.987435,-.00454562,.111356,.0403086,.987461,-.00561225,.111358,.0497678,.987458,-.00679125,.111358,.0602239,.987443,-.0080828,.111356,.0716792,.987476,-.0094872,.111358,.0841364,.98749,-.0110044,.111361,.097597,.987508,-.0126344,.111362,.112062,.987494,-.0143767,.111357,.127533,.987526,-.0162307,.111359,.144015,.987558,-.0181912,.111361,.161502,.987602,-.0202393,.111355,.179979,.987692,-.022273,.111346,.199386,.987702,-.0235306,.111215,.219183,.987789,-.0247628,.111061,.239202,.987776,-.0280668,.111171,.259957,.987856,-.0316751,.111327,.282198,.987912,-.0342468,.111282,.306294,.988,-.0367205,.111198,.331219,.988055,-.0387766,.110994,.356708,.988241,-.0397722,.110547,.382234,.988399,-.0416076,.110198,.408227,.988539,-.0448192,.110137,.434662,.988661,-.0483793,.110143,.461442,.988967,-.0495895,.109453,.489318,.989073,-.0506797,.108628,.517516,.989274,-.0526953,.108003,.545844,.989528,-.054578,.107255,.573823,.989709,-.0561503,.106294,.601944,.989991,-.056866,.104896,.630855,.990392,-.0572914,.103336,.658925,.990374,-.0586224,.10189,.686661,.990747,-.0584764,.099783,.714548,.991041,-.0582662,.0974309,.74186,.991236,-.0584118,.0951678,.768422,.991585,-.0573055,.0921581,.794817,.991984,-.0564241,.0891167,.820336,.9921,-.0553608,.085805,.84493,.992749,-.0533816,.0820354,.868961,.99288,-.0518661,.0782181,.891931,.993511,-.0492492,.0738935,.914186,.993617,-.0471956,.0696402,.93532,.99411,-.044216,.0649659,.95543,.994595,-.0416654,.0603177,.974685,.994976,-.0384314,.0553493,.992807,.995579,-.0353491,.0503942,1.00996,.996069,-.0319787,.0452123,1.02606,.996718,-.028472,.0400112,1.04114,.997173,-.0250789,.0349456,1.05517,.997818,-.0213326,.029653,1.0683,.998318,-.0178509,.024549,1.0805,.998853,-.0141118,.0194197,1.09177,.999218,-.0105914,.0143869,1.1022,.999594,-.00693474,.00943517,1.11175,.99975,-.00340478,.00464051,1.12056,1.00001,109172e-9,-112821e-9,1.12853,.983383,-266524e-11,.133358,196534e-10,.981942,-671009e-10,.133162,494804e-9,.981946,-268405e-9,.133163,.00197923,.981944,-603912e-9,.133163,.00445326,.981941,-.00107362,.133162,.00791693,.981946,-.00167755,.133163,.0123703,.981944,-.00241569,.133162,.0178135,.981945,-.00328807,.133163,.0242466,.981945,-.00429472,.133162,.03167,.981955,-.00543573,.133164,.0400846,.981951,-.00671105,.133163,.0494901,.981968,-.00812092,.133165,.0598886,.981979,-.00966541,.133166,.0712811,.981996,-.0113446,.133168,.083669,.982014,-.0131585,.133169,.0970533,.982011,-.0151073,.133167,.111438,.982062,-.0171906,.133172,.126826,.9821,-.0194067,.133175,.143215,.982149,-.0217502,.133176,.160609,.982163,-.0241945,.133173,.178981,.982247,-.0265907,.133148,.198249,.982291,-.027916,.132974,.217795,.982396,-.0299663,.132868,.238042,.982456,-.0334544,.132934,.258901,.982499,-.0378636,.133137,.280639,.982617,-.0409274,.133085,.304604,.98274,-.0438523,.132985,.329376,.982944,-.0462288,.132728,.354697,.98308,-.0475995,.132228,.380102,.983391,-.0501901,.131924,.406256,.983514,-.0535899,.131737,.432735,.98373,-.0571858,.131567,.459359,.984056,-.0592353,.130932,.486637,.984234,-.0610488,.130092,.51509,.984748,-.0630758,.12923,.543461,.985073,-.0647398,.128174,.571376,.985195,-.0671941,.127133,.599414,.985734,-.0681345,.125576,.628134,.986241,-.0686089,.123639,.656399,.986356,-.0698511,.121834,.684258,.986894,-.0700931,.119454,.711818,.987382,-.0698321,.116718,.739511,.988109,-.0693975,.113699,.766267,.988363,-.0689584,.110454,.792456,.989112,-.0672353,.106602,.81813,.989241,-.0662034,.10267,.842889,.990333,-.0638938,.0981381,.867204,.990591,-.0618534,.0935388,.89038,.991106,-.0593117,.088553,.912576,.991919,-.0562676,.0832187,.934118,.992111,-.0534085,.0778302,.954254,.992997,-.0495459,.0720453,.973722,.993317,-.0463707,.0663458,.991949,.994133,-.0421245,.0601883,1.00936,.994705,-.0384977,.0542501,1.02559,.995495,-.0340956,.0479862,1.04083,.996206,-.030105,.041887,1.05497,.996971,-.0256095,.0355355,1.06824,.997796,-.0213932,.0293655,1.08056,.998272,-.0169612,.0232926,1.09182,.998857,-.0126756,.0172786,1.10219,.99939,-.00832486,.0113156,1.11192,.999752,-.00410826,.00557892,1.12075,1,150957e-9,-119101e-9,1.12885,.975169,-309397e-11,.154669,195073e-10,.975439,-779608e-10,.154712,491534e-9,.975464,-311847e-9,.154716,.00196617,.975464,-701656e-9,.154716,.00442387,.975462,-.0012474,.154715,.0078647,.975461,-.00194906,.154715,.0122886,.975464,-.00280667,.154715,.0176959,.975468,-.00382025,.154716,.0240867,.975471,-.00498985,.154716,.0314612,.975472,-.00631541,.154717,.0398199,.975486,-.00779719,.154718,.0491639,.975489,-.00943505,.154718,.0594932,.975509,-.0112295,.154721,.0708113,.97554,-.0131802,.154724,.0831176,.975557,-.0152876,.154726,.096415,.975585,-.0175512,.154728,.110705,.975605,-.0199713,.154729,.125992,.975645,-.0225447,.154729,.142272,.975711,-.0252649,.154735,.159549,.975788,-.0280986,.154736,.177805,.975872,-.0308232,.154704,.196911,.975968,-.0324841,.154525,.216324,.976063,-.0351281,.154432,.236628,.976157,-.0388618,.15446,.257539,.976204,-.0437704,.154665,.278975,.976358,-.047514,.154652,.302606,.976571,-.0508638,.154535,.327204,.976725,-.0534995,.154221,.352276,.977013,-.0555547,.153737,.377696,.977294,-.0586728,.153403,.403855,.977602,-.0622715,.15312,.430333,.977932,-.0658166,.152755,.456855,.978241,-.0689877,.152233,.483668,.978602,-.0712805,.15132,.512097,.979234,-.0732775,.150235,.540455,.97977,-.075163,.148978,.568486,.979995,-.0778026,.147755,.596524,.98078,-.0791854,.146019,.624825,.981628,-.0799666,.143906,.653403,.982067,-.0808532,.141561,.681445,.98271,-.0816024,.139025,.708918,.983734,-.0812511,.135764,.736594,.98431,-.0806201,.132152,.763576,.985071,-.0801605,.12846,.789797,.98618,-.0784208,.124084,.815804,.986886,-.0766643,.1193,.840869,.987485,-.0747744,.114236,.864952,.988431,-.0716701,.108654,.888431,.988886,-.0691609,.102994,.910963,.990024,-.0654048,.0967278,.932629,.990401,-.0619765,.090384,.95313,.991093,-.0579296,.0837885,.972587,.992018,-.0536576,.0770171,.991184,.992536,-.0493719,.0701486,1.00863,.993421,-.0444813,.062953,1.02494,.993928,-.040008,.0560455,1.04017,.994994,-.0347982,.04856,1.05463,.995866,-.0301017,.0416152,1.06807,.996916,-.0248225,.0342597,1.08039,.997766,-.0199229,.0271668,1.09177,.998479,-.0147422,.0201387,1.10235,.99921,-.00980173,.0131944,1.11206,.999652,-.0047426,.00640712,1.12104,.999998,891673e-10,-10379e-8,1.12906,.967868,-351885e-11,.175947,193569e-10,.968001,-886733e-10,.175972,487782e-9,.96801,-354697e-9,.175973,.00195115,.968012,-798063e-9,.175974,.00439006,.968011,-.00141879,.175973,.00780461,.968011,-.00221686,.175973,.0121948,.968016,-.00319231,.175974,.0175607,.968019,-.00434515,.175974,.0239027,.968018,-.00567538,.175974,.0312208,.968033,-.00718308,.175977,.0395158,.968049,-.00886836,.175979,.0487885,.968047,-.0107312,.175978,.0590394,.968072,-.0127719,.175981,.0702705,.968108,-.0149905,.175986,.0824836,.968112,-.0173866,.175985,.0956783,.968173,-.0199611,.175993,.109862,.96827,-.0227128,.176008,.125033,.968292,-.025639,.17601,.141193,.968339,-.0287299,.176007,.158336,.968389,-.0319399,.176001,.176441,.968501,-.034941,.175962,.195359,.968646,-.0370812,.175793,.214686,.968789,-.0402329,.175708,.234973,.96886,-.0442601,.1757,.255871,.969013,-.049398,.175876,.277238,.969242,-.0539932,.17594,.300326,.969419,-.0577299,.175781,.324702,.969763,-.0605643,.175432,.349527,.970093,-.0634488,.174992,.374976,.970361,-.0670589,.174611,.401097,.970825,-.0708246,.174226,.427496,.971214,-.0742871,.173684,.453858,.971622,-.0782608,.173186,.480637,.972175,-.0813151,.172288,.508655,.972944,-.0832678,.170979,.536973,.973595,-.0855964,.169573,.565138,.974345,-.0882163,.168152,.593222,.975233,-.0901671,.166314,.621201,.976239,-.0912111,.163931,.649919,.977289,-.0916959,.161106,.678011,.978076,-.0927061,.158272,.705717,.979533,-.0925562,.15475,.733228,.980335,-.0918159,.150638,.760454,.981808,-.0908508,.146201,.786918,.983061,-.0896172,.141386,.812953,.984148,-.0871588,.135837,.838281,.985047,-.0850624,.130135,.862594,.986219,-.0818541,.123882,.88633,.987043,-.0784523,.117126,.908952,.988107,-.0749601,.110341,.930744,.988955,-.0703548,.102885,.951728,.989426,-.0662798,.0954167,.971166,.990421,-.0610834,.0876331,.989984,.991032,-.0562936,.0797785,1.00765,.992041,-.0508154,.0718166,1.02434,.992794,-.0454045,.0637125,1.03976,.993691,-.0398194,.0555338,1.05418,.994778,-.0341482,.0473388,1.06772,.995915,-.028428,.0391016,1.08028,.997109,-.022642,.0309953,1.09185,.998095,-.0168738,.0230288,1.10247,.998985,-.0111274,.0150722,1.11229,.999581,-.00543881,.00740605,1.12131,1.00003,162239e-9,-105549e-9,1.12946,.959505,-393734e-11,.196876,191893e-10,.959599,-992157e-10,.196895,483544e-9,.959641,-396868e-9,.196903,.0019342,.959599,-892948e-9,.196895,.00435193,.959603,-.00158747,.196896,.0077368,.959604,-.00248042,.196896,.0120888,.959605,-.00357184,.196896,.0174082,.959605,-.00486169,.196896,.0236949,.959613,-.00635008,.196897,.0309497,.959619,-.00803696,.196898,.0391725,.959636,-.00992255,.196901,.0483649,.959634,-.0120067,.1969,.0585266,.959675,-.0142898,.196906,.0696609,.959712,-.0167717,.196911,.0817678,.959752,-.0194524,.196918,.0948494,.959807,-.0223321,.196925,.10891,.959828,-.0254091,.196924,.123947,.959906,-.0286815,.196934,.139968,.960005,-.0321371,.196944,.156968,.960071,-.0357114,.196936,.17491,.960237,-.0389064,.196882,.193597,.960367,-.041623,.196731,.21285,.960562,-.0452655,.196654,.233075,.960735,-.0496207,.196643,.253941,.960913,-.0549379,.196774,.275278,.961121,-.0603414,.196893,.297733,.96139,-.0644244,.196717,.321877,.961818,-.067556,.196314,.346476,.962175,-.0712709,.195917,.371907,.96255,-.0752848,.1955,.397916,.963164,-.0792073,.195026,.424229,.963782,-.0828225,.194424,.450637,.964306,-.0873119,.193831,.477288,.964923,-.0911051,.192973,.504716,.966048,-.093251,.19151,.533053,.967024,-.0958983,.190013,.561366,.968038,-.09835,.188253,.589464,.969152,-.100754,.186257,.617433,.970557,-.102239,.183775,.645801,.972104,-.102767,.180645,.674278,.973203,-.103492,.177242,.702004,.975123,-.103793,.17345,.729529,.97641,-.102839,.168886,.756712,.978313,-.101687,.163892,.783801,.980036,-.100314,.158439,.809671,.981339,-.097836,.152211,.835402,.982794,-.0950006,.145679,.860081,.984123,-.0920994,.138949,.883757,.984918,-.0878641,.131283,.90685,.985999,-.083939,.123464,.928786,.987151,-.0791234,.115324,.94983,.987827,-.0739332,.106854,.96962,.988806,-.0688088,.0982691,.98861,.989588,-.0628962,.0893456,1.00667,.990438,-.0573146,.0805392,1.02344,.991506,-.0509433,.0713725,1.03933,.992492,-.0448724,.0623732,1.05378,.993663,-.0383497,.0530838,1.06747,.994956,-.0319593,.0439512,1.08007,.99634,-.025401,.0347803,1.09182,.99761,-.0189687,.0257954,1.1025,.99863,-.0124441,.0169893,1.11247,.99947,-.00614003,.00829498,1.12151,1.00008,216624e-9,-146107e-9,1.12993,.950129,-434955e-11,.217413,190081e-10,.950264,-10957e-8,.217444,47884e-8,.9503,-438299e-9,.217451,.00191543,.950246,-986124e-9,.21744,.00430951,.950246,-.00175311,.21744,.00766137,.950245,-.00273923,.21744,.011971,.950253,-.00394453,.217441,.0172385,.950258,-.00536897,.217442,.0234641,.950267,-.00701262,.217444,.030648,.950277,-.00887551,.217446,.038791,.950284,-.0109576,.217446,.0478931,.950312,-.0132591,.217451,.0579568,.950334,-.01578,.217454,.0689821,.950378,-.0185204,.217462,.0809714,.950417,-.0214803,.217467,.0939265,.950488,-.0246594,.217479,.10785,.950534,-.0280565,.217483,.122743,.950633,-.0316685,.217498,.138611,.950698,-.0354787,.217499,.155442,.950844,-.0394003,.217507,.173208,.950999,-.0426812,.217419,.191605,.951221,-.0461302,.217317,.21084,.951412,-.0502131,.217238,.230945,.951623,-.0549183,.21722,.251745,.951867,-.0604493,.217306,.273001,.952069,-.0665189,.217466,.294874,.952459,-.0709179,.217266,.318732,.952996,-.0746112,.216891,.34318,.953425,-.0789252,.216503,.36849,.953885,-.0833293,.216042,.394373,.954617,-.087371,.215469,.420505,.955429,-.0914054,.214802,.446907,.956068,-.0961671,.214146,.473522,.957094,-.10048,.213286,.50052,.958372,-.103248,.211796,.528715,.959654,-.106033,.21016,.557065,.961305,-.108384,.208149,.585286,.962785,-.111122,.206024,.613334,.964848,-.112981,.203442,.641334,.966498,-.113717,.19996,.669955,.968678,-.114121,.196105,.698094,.970489,-.114524,.191906,.725643,.972903,-.113792,.186963,.752856,.974701,-.112406,.181343,.780013,.976718,-.110685,.175185,.806268,.978905,-.108468,.168535,.832073,.980267,-.105061,.161106,.857149,.981967,-.101675,.153387,.881145,.983063,-.0974492,.145199,.904255,.984432,-.0925815,.136527,.926686,.985734,-.0877983,.127584,.947901,.986228,-.081884,.118125,.968111,.98719,-.0761208,.108594,.98719,.988228,-.0698196,.0989996,1.00559,.989046,-.0632739,.0890074,1.02246,.990242,-.056522,.0790832,1.03841,.991252,-.0495272,.0689182,1.05347,.992542,-.0425373,.0588592,1.06724,.994096,-.0353198,.0486833,1.08009,.995593,-.028235,.0385977,1.09177,.99711,-.0209511,.0286457,1.10274,.998263,-.0139289,.0188497,1.11262,.999254,-.0067359,.009208,1.12191,.999967,141846e-9,-657764e-10,1.13024,.935608,-474692e-11,.236466,187817e-10,.93996,-11971e-8,.237568,473646e-9,.939959,-478845e-9,.237567,.0018946,.939954,-.0010774,.237566,.00426284,.939956,-.00191538,.237566,.00757842,.939954,-.00299277,.237566,.0118413,.93996,-.00430961,.237567,.0170518,.939969,-.00586589,.237569,.02321,.939982,-.00766166,.237572,.0303164,.939987,-.00969686,.237572,.0383711,.939997,-.0119715,.237574,.0473751,.940031,-.0144858,.237581,.0573298,.940073,-.0172399,.237589,.0682366,.94012,-.0202335,.237598,.080097,.940162,-.0234663,.237604,.0929116,.940237,-.0269387,.237615,.106686,.940328,-.0306489,.237632,.121421,.940419,-.0345917,.237645,.137115,.940522,-.0387481,.237654,.153766,.940702,-.0429906,.237661,.17133,.940871,-.0465089,.237561,.189502,.941103,-.050531,.23748,.208616,.941369,-.0550657,.237423,.228595,.941641,-.0601337,.237399,.249287,.941903,-.0658804,.237443,.270467,.942224,-.0722674,.237597,.292024,.942633,-.0771788,.237419,.315272,.943172,-.0815623,.237068,.339579,.943691,-.0863973,.236682,.364717,.944382,-.0911536,.236213,.390435,.945392,-.0952967,.235562,.416425,.946185,-.0998948,.234832,.442772,.947212,-.104796,.234114,.469347,.948778,-.10928,.233222,.496162,.950149,-.113081,.231845,.523978,.951989,-.115893,.230005,.552295,.953921,-.11846,.227862,.580569,.955624,-.12115,.225439,.608698,.958234,-.123373,.222635,.636696,.960593,-.124519,.219093,.665208,.963201,-.124736,.214749,.693557,.965642,-.125012,.210059,.721334,.968765,-.124661,.204935,.748613,.971753,-.122996,.198661,.776224,.973751,-.120998,.191823,.802461,.976709,-.118583,.184359,.828399,.977956,-.115102,.176437,.853693,.979672,-.111077,.167681,.877962,.981816,-.10688,.158872,.901564,.98238,-.101469,.149398,.924057,.983964,-.0960013,.139436,.945751,.984933,-.0899626,.12943,.966272,.985694,-.0832973,.11894,.985741,.986822,-.0767082,.108349,1.00407,.987725,-.0693614,.0976026,1.02154,.98877,-.06211,.086652,1.03757,.990129,-.0544143,.0756182,1.05296,.991337,-.046744,.0645753,1.06683,.992978,-.0387931,.0534683,1.0798,.994676,-.030973,.0424137,1.09181,.99645,-.0230311,.0314035,1.10286,.997967,-.0152065,.0206869,1.11291,.99922,-.00744837,.010155,1.12237,1.00002,240209e-9,-752767e-10,1.13089,.922948,-515351e-11,.255626,186069e-10,.928785,-129623e-9,.257244,468009e-9,.928761,-51849e-8,.257237,.00187202,.928751,-.0011666,.257235,.00421204,.928751,-.00207395,.257234,.0074881,.928754,-.00324055,.257235,.0117002,.92876,-.00466639,.257236,.0168486,.928763,-.00635149,.257237,.0229334,.928774,-.00829584,.257239,.029955,.928791,-.0104995,.257243,.0379139,.928804,-.0129623,.257245,.0468108,.928847,-.0156846,.257255,.0566473,.92889,-.0186661,.257263,.0674246,.928924,-.0219067,.257268,.0791433,.928989,-.0254066,.257282,.0918076,.92909,-.0291651,.257301,.105419,.92918,-.0331801,.257316,.119978,.92929,-.0374469,.257332,.135491,.929453,-.041939,.257357,.151948,.929586,-.0464612,.257347,.169275,.929858,-.0503426,.257269,.187257,.930125,-.0548409,.257199,.206204,.930403,-.0598063,.257149,.22601,.930726,-.0652437,.257122,.246561,.931098,-.0712376,.257153,.267618,.931396,-.0777506,.257237,.288993,.931947,-.0832374,.257124,.311527,.932579,-.0883955,.25683,.335697,.933194,-.0937037,.256444,.360634,.934013,-.0987292,.255939,.386126,.935307,-.103215,.255282,.412018,.936374,-.108234,.254538,.438292,.93776,-.113234,.253728,.464805,.939599,-.118013,.25275,.491464,.941036,-.122661,.251404,.518751,.94337,-.125477,.249435,.547133,.945318,-.128374,.247113,.575456,.947995,-.130996,.244441,.60372,.950818,-.133438,.241352,.63174,.954378,-.135004,.237849,.659971,.957151,-.135313,.233188,.688478,.960743,-.13521,.228001,.716767,.964352,-.135007,.222249,.744349,.967273,-.133523,.21542,.771786,.969767,-.131155,.208039,.798639,.973195,-.128492,.200076,.824774,.975557,-.125094,.191451,.850222,.977692,-.120578,.18184,.874761,.98026,-.115882,.172102,.898497,.981394,-.110372,.161859,.921636,.982386,-.10415,.15108,.943467,.983783,-.0978128,.140407,.964045,.98422,-.0906171,.129058,.98398,.985447,-.0832921,.117614,1.00276,.986682,-.0754412,.10585,1.02047,.987326,-.0673885,.0940943,1.03678,.988707,-.0592565,.0822093,1.05218,.990185,-.050717,.070192,1.06652,.991866,-.0423486,.0582081,1.07965,.993897,-.0336118,.0460985,1.09188,.995841,-.0252178,.0342737,1.10307,.997605,-.0164893,.0224829,1.11324,.999037,-.00817112,.0110647,1.12262,1.00003,291686e-9,-168673e-9,1.13139,.915304,-552675e-11,.275999,183285e-10,.91668,-139285e-9,.276414,461914e-9,.916664,-55713e-8,.276409,.00184763,.916653,-.00125354,.276406,.00415715,.916651,-.00222851,.276405,.00739053,.916655,-.00348205,.276406,.0115478,.916653,-.00501414,.276405,.0166291,.916667,-.00682478,.276409,.0226346,.91668,-.00891398,.276412,.0295648,.91669,-.0112817,.276413,.0374199,.916727,-.013928,.276422,.0462016,.916759,-.0168528,.276429,.0559101,.916793,-.0200558,.276436,.0665466,.916849,-.0235373,.276448,.0781139,.916964,-.0272973,.276474,.0906156,.917047,-.0313344,.276491,.104051,.917152,-.0356465,.276511,.118424,.917286,-.0402271,.276533,.133736,.917469,-.0450408,.276564,.149978,.917686,-.0497872,.276563,.167057,.917953,-.0540937,.276493,.184846,.918228,-.0590709,.276437,.203614,.918572,-.0644277,.276398,.223212,.918918,-.0702326,.276362,.243584,.919356,-.076484,.276383,.264465,.919842,-.0830808,.276434,.285701,.920451,-.0892972,.276407,.307559,.921113,-.095016,.276128,.331501,.921881,-.100771,.275754,.356207,.923027,-.106029,.275254,.381477,.924364,-.111029,.274595,.40722,.925818,-.116345,.273841,.433385,.92746,-.121424,.272913,.459848,.929167,-.12657,.271837,.486493,.931426,-.131581,.270575,.513432,.934001,-.135038,.268512,.541502,.936296,-.138039,.266135,.569658,.939985,-.140687,.263271,.598375,.943516,-.143247,.260058,.626563,.94782,-.145135,.256138,.654711,.951023,-.145733,.251154,.683285,.955338,-.145554,.245562,.711831,.959629,-.145008,.239265,.739573,.963123,-.144003,.232064,.767027,.966742,-.141289,.224036,.794359,.969991,-.138247,.215305,.820361,.973403,-.134786,.206051,.846548,.975317,-.129966,.195914,.871541,.977647,-.12471,.185184,.895313,.980137,-.119086,.174161,.918398,.981031,-.112297,.162792,.940679,.982037,-.105372,.150952,.961991,.983164,-.097821,.138921,.981913,.983757,-.0897245,.126611,1.00109,.985036,-.0815974,.114228,1.01902,.986289,-.0727725,.101389,1.03604,.987329,-.0639323,.0886476,1.05149,.989193,-.0548109,.0756837,1.06619,.990716,-.045687,.0627581,1.07948,.992769,-.0364315,.0498337,1.09172,.99524,-.0271761,.0370305,1.1033,.997154,-.0179609,.0243959,1.11353,.998845,-.00878063,.0119567,1.12319,1.00002,259038e-9,-108146e-9,1.13177,.903945,-591681e-11,.295126,181226e-10,.903668,-148672e-9,.295037,455367e-9,.903677,-594683e-9,.29504,.00182145,.903673,-.00133805,.295039,.00409831,.903666,-.00237872,.295036,.00728584,.903668,-.00371676,.295037,.0113842,.903679,-.00535212,.29504,.0163936,.903684,-.00728479,.295041,.0223141,.903698,-.00951473,.295044,.0291462,.903718,-.0120419,.295049,.0368904,.903754,-.0148664,.295058,.0455477,.903801,-.017988,.29507,.0551194,.903851,-.0214064,.295082,.0656058,.903921,-.0251219,.295097,.0770109,.904002,-.0291337,.295116,.0893354,.904111,-.033441,.29514,.102583,.904246,-.0380415,.295169,.116755,.904408,-.0429258,.295202,.131853,.904637,-.0480468,.295245,.147869,.904821,-.0529208,.295214,.164658,.905163,-.0577748,.295185,.182274,.905469,-.0631763,.295143,.200828,.905851,-.068917,.295112,.2202,.906322,-.0750861,.295104,.240372,.906761,-.0815855,.295086,.261082,.90735,-.0882138,.295095,.282123,.908087,-.095082,.295139,.303563,.908826,-.101488,.29492,.327028,.909832,-.107577,.294577,.351464,.911393,-.113033,.294115,.376497,.912804,-.118629,.293446,.402115,.914081,-.124232,.292581,.428111,.91637,-.129399,.29166,.454442,.91814,-.134892,.290422,.481024,.921179,-.140069,.289194,.507924,.924544,-.144431,.287421,.535557,.927995,-.147498,.284867,.563984,.931556,-.150197,.281722,.5923,.935777,-.152711,.278207,.620832,.940869,-.154836,.274148,.649069,.945994,-.155912,.269057,.677746,.949634,-.155641,.262799,.706293,.955032,-.154809,.256097,.734278,.95917,-.153678,.248618,.761751,.962931,-.151253,.239794,.789032,.966045,-.147625,.230281,.815422,.96971,-.143964,.220382,.841787,.972747,-.139464,.209846,.867446,.975545,-.133459,.198189,.892004,.978381,-.127424,.186362,.915458,.979935,-.120506,.173964,.937948,.980948,-.11282,.161429,.959732,.982234,-.104941,.148557,.980118,.982767,-.0962905,.135508,.999463,.983544,-.0873625,.122338,1.01756,.984965,-.0783447,.108669,1.03492,.986233,-.0684798,.0949911,1.05087,.987796,-.0590867,.0811386,1.0656,.989885,-.0489145,.0673099,1.0794,.991821,-.0391,.0535665,1.09174,.99448,-.029087,.0397529,1.10341,.996769,-.019114,.0261463,1.11383,.998641,-.00947007,.0128731,1.1237,.999978,446316e-9,-169093e-9,1.13253,.888362,-627064e-11,.312578,178215e-10,.889988,-157791e-9,.313148,448451e-9,.889825,-631076e-9,.313092,.00179356,.88984,-.00141994,.313097,.00403554,.889828,-.0025243,.313092,.00717429,.889831,-.00394421,.313093,.0112099,.889831,-.00567962,.313093,.0161425,.889844,-.00773051,.313096,.0219724,.889858,-.0100968,.3131,.0286999,.889882,-.0127786,.313106,.0363256,.889918,-.0157757,.313116,.0448509,.889967,-.0190878,.313129,.0542758,.89003,-.022715,.313145,.0646032,.890108,-.0266566,.313165,.0758339,.890218,-.0309131,.313193,.0879729,.890351,-.0354819,.313226,.101019,.89051,-.0403613,.313263,.114979,.890672,-.0455385,.313294,.129848,.890882,-.0509444,.313333,.145616,.891189,-.0559657,.313324,.162122,.891457,-.0613123,.313281,.179524,.891856,-.0671488,.313281,.197855,.892312,-.0732732,.313268,.216991,.892819,-.0797865,.313263,.236924,.893369,-.0865269,.313247,.257433,.894045,-.0931592,.313205,.278215,.894884,-.100532,.313276,.299467,.895832,-.107716,.313205,.322276,.897043,-.114099,.312873,.34642,.898515,-.119941,.312331,.371187,.900191,-.126044,.311731,.396656,.90188,-.131808,.310859,.422488,.904359,-.137289,.309857,.448744,.906923,-.142991,.308714,.475239,.910634,-.148253,.307465,.501983,.914502,-.153332,.305774,.529254,.919046,-.156646,.303156,.557709,.923194,-.159612,.299928,.586267,.928858,-.162027,.296245,.614925,.934464,-.164203,.291832,.643187,.939824,-.165602,.286565,.671601,.944582,-.165383,.280073,.700213,.949257,-.164439,.272891,.728432,.954389,-.162953,.264771,.756082,.958595,-.161007,.255927,.78369,.962138,-.157243,.245769,.810769,.966979,-.152872,.235127,.836999,.969566,-.148209,.22347,.862684,.972372,-.142211,.211147,.887847,.975916,-.135458,.198606,.911843,.978026,-.128398,.185498,.934795,.979686,-.120313,.17171,.956787,.980748,-.11166,.158159,.978046,.981622,-.103035,.144399,.997693,.982356,-.0930328,.13001,1.01642,.983308,-.0834627,.115778,1.03366,.985037,-.0732249,.101327,1.05014,.986493,-.0628145,.086554,1.06507,.988484,-.0526556,.0720413,1.07907,.991051,-.0415744,.0571151,1.09189,.993523,-.0314275,.0426643,1.10369,.99628,-.0203603,.0279325,1.11423,.998344,-.0102446,.0138182,1.12421,.999997,42612e-8,-193628e-9,1.1333,.871555,-660007e-11,.329176,174749e-10,.875255,-166579e-9,.330571,441051e-9,.875644,-666394e-9,.330718,.00176441,.875159,-.00149903,.330536,.00396899,.87516,-.00266493,.330536,.007056,.875158,-.00416393,.330535,.0110251,.87516,-.00599598,.330535,.0158764,.875163,-.00816108,.330536,.0216101,.875174,-.0106591,.330538,.0282266,.875199,-.0134899,.330545,.0357266,.875257,-.0166538,.330563,.0441117,.875304,-.0201501,.330575,.0533821,.875373,-.0239785,.330595,.0635395,.875464,-.0281389,.330619,.0745872,.875565,-.0326301,.330645,.0865255,.875691,-.0374516,.330676,.0993599,.875897,-.0425993,.330733,.113093,.876091,-.0480576,.330776,.127722,.876353,-.0537216,.330826,.143227,.876649,-.0589807,.330809,.159462,.877034,-.0647865,.330819,.176642,.877443,-.0709789,.330817,.194702,.877956,-.0774782,.330832,.213577,.878499,-.0843175,.330822,.233246,.879144,-.0912714,.330804,.253512,.879982,-.0980824,.330766,.274137,.88097,-.105823,.330864,.295209,.882051,-.113671,.330896,.317226,.883397,-.120303,.330545,.341068,.884987,-.12667,.330068,.365613,.886789,-.133118,.329418,.390807,.889311,-.139024,.328683,.416494,.891995,-.144971,.327729,.442618,.895106,-.150747,.326521,.469131,.899527,-.156283,.325229,.495921,.90504,-.161707,.32378,.523162,.909875,-.165661,.32122,.55092,.91561,-.168755,.317942,.579928,.921225,-.171193,.313983,.608539,.927308,-.17319,.309636,.636854,.933077,-.174819,.304262,.66523,.938766,-.175002,.297563,.693609,.943667,-.173946,.289613,.722157,.949033,-.172221,.281227,.750021,.953765,-.169869,.271545,.777466,.95804,-.166578,.261034,.804853,.962302,-.161761,.249434,.831569,.966544,-.156636,.237484,.857779,.969372,-.150784,.224395,.883051,.972486,-.143672,.210786,.907864,.975853,-.135772,.196556,.931223,.977975,-.127942,.182307,.954061,.979122,-.118347,.167607,.97531,.980719,-.109112,.152739,.995666,.981223,-.0991789,.137932,1.01475,.98216,-.0883553,.122692,1.03253,.983379,-.0780825,.107493,1.04917,.985434,-.0665646,.0917791,1.06464,.987332,-.0557714,.0764949,1.07896,.990004,-.0442805,.060721,1.09199,.992975,-.0331676,.0452284,1.10393,.995811,-.0219547,.0297934,1.11476,.9982,-.0107613,.0146415,1.12484,1.00002,248678e-9,-14555e-8,1.13413,.859519,-693595e-11,.347264,171673e-10,.859843,-17503e-8,.347394,433219e-9,.859656,-700076e-9,.347319,.00173277,.859671,-.00157517,.347325,.00389875,.859669,-.00280028,.347324,.00693112,.85967,-.0043754,.347324,.01083,.859665,-.00630049,.347321,.0155954,.859685,-.0085755,.347328,.0212278,.859694,-.0112003,.347329,.0277273,.859718,-.0141747,.347336,.0350946,.85976,-.0174988,.347348,.0433314,.85982,-.0211722,.347366,.0524384,.859892,-.0251941,.347387,.0624168,.860006,-.0295649,.347422,.0732708,.860122,-.0342825,.347453,.0849999,.860282,-.0393462,.347499,.0976102,.860482,-.0447513,.347554,.111104,.860719,-.0504775,.347614,.125479,.860998,-.0563577,.347666,.140703,.861322,-.0619473,.347662,.156681,.861724,-.0681277,.347684,.173597,.862198,-.0746567,.347709,.191371,.862733,-.0815234,.347727,.209976,.863371,-.0886643,.347744,.229351,.86414,-.0957908,.347734,.24934,.865138,-.102912,.34772,.269797,.866182,-.110924,.3478,.290654,.867436,-.119223,.347911,.312074,.869087,-.126197,.347649,.335438,.870859,-.133145,.347222,.359732,.872997,-.139869,.346645,.38467,.875939,-.146089,.345935,.41019,.879012,-.152334,.345012,.436218,.883353,-.15821,.343924,.462641,.888362,-.164097,.342636,.489449,.895026,-.169528,.341351,.516629,.900753,-.174408,.339115,.544109,.906814,-.17751,.335809,.572857,.912855,-.180101,.331597,.601554,.919438,-.182116,.32698,.630198,.925962,-.183494,.321449,.658404,.931734,-.184159,.314595,.686625,.93762,-.18304,.306462,.71531,.943858,-.181323,.297514,.744272,.948662,-.178683,.287447,.771462,.953299,-.175379,.276166,.798593,.957346,-.170395,.263758,.8256,.962565,-.165042,.251019,.852575,.966075,-.158655,.237011,.878316,.969048,-.151707,.222518,.90329,.972423,-.143271,.207848,.927745,.975833,-.134824,.192463,.950859,.977629,-.125444,.1768,.972947,.978995,-.114949,.161033,.993263,.980533,-.104936,.145523,1.01337,.980745,-.0935577,.129799,1.03128,.981814,-.0822956,.113486,1.04825,.983943,-.0710082,.0972925,1.06405,.986141,-.0587931,.0808138,1.0785,.988878,-.0472755,.0644915,1.09204,.992132,-.0349128,.0478128,1.10413,.9953,-.0232407,.031621,1.11527,.998117,-.0112713,.0154935,1.12551,1.00003,339743e-9,-195763e-9,1.13504,.845441,-729126e-11,.364305,169208e-10,.843588,-183164e-9,.363506,425067e-9,.843412,-73253e-8,.36343,.00169999,.843401,-.00164818,.363426,.00382495,.843399,-.00293008,.363425,.00679993,.843401,-.00457822,.363425,.010625,.843394,-.00659249,.363421,.0153002,.843398,-.00897282,.363421,.0208258,.843415,-.0117191,.363426,.0272024,.843438,-.0148312,.363432,.0344305,.843483,-.018309,.363447,.0425116,.84356,-.0221521,.363472,.0514471,.843646,-.0263597,.363499,.061238,.843743,-.0309315,.363527,.0718873,.84388,-.0358658,.363569,.0833969,.844079,-.0411624,.363631,.0957742,.844279,-.0468128,.363688,.109015,.844549,-.0527923,.363761,.123124,.844858,-.0588204,.363817,.138044,.84522,-.0647573,.36383,.153755,.845669,-.0713181,.363879,.170394,.846155,-.0781697,.363908,.187861,.846789,-.0853913,.363969,.206176,.847502,-.0928086,.363999,.225244,.8484,-.10005,.363997,.244926,.849461,-.107615,.364008,.265188,.850562,-.115814,.364055,.28587,.851962,-.124334,.364179,.306926,.854326,-.131995,.364233,.329605,.856295,-.139338,.363856,.35359,.858857,-.146346,.363347,.37831,.862428,-.152994,.362807,.403722,.866203,-.159463,.361963,.429537,.871629,-.165623,.36112,.456,.877365,-.171649,.359917,.482773,.883744,-.177151,.35848,.509705,.890693,-.182381,.356523,.537215,.897278,-.186076,.3533,.565493,.903958,-.188602,.349095,.594293,.910908,-.190755,.344215,.623165,.918117,-.192063,.338606,.651573,.924644,-.192758,.331544,.679869,.931054,-.192238,.323163,.708668,.937303,-.190035,.313529,.737201,.943387,-.187162,.303152,.764977,.948494,-.183876,.29146,.792683,.952546,-.178901,.277917,.819228,.958077,-.173173,.264753,.846559,.962462,-.16645,.25002,.872962,.966569,-.159452,.234873,.898729,.969108,-.15074,.218752,.923126,.973072,-.141523,.202673,.947278,.975452,-.132075,.186326,.969938,.977784,-.121257,.169396,.991325,.97899,-.110182,.153044,1.01123,.979777,-.0989634,.136485,1.0299,.980865,-.0865894,.119343,1.04727,.982432,-.0746115,.102452,1.06341,.984935,-.0621822,.0852423,1.07834,.987776,-.0495694,.0678546,1.092,.99103,-.0372386,.0506917,1.1043,.99474,-.0244353,.0333316,1.11576,.997768,-.0121448,.0164348,1.12617,1.00003,31774e-8,-169504e-9,1.13598,.825551,-756799e-11,.378425,165099e-10,.82664,-190922e-9,.378923,416504e-9,.826323,-763495e-9,.378779,.0016656,.826359,-.00171789,.378795,.00374768,.82636,-.00305402,.378795,.00666259,.826368,-.00477185,.378798,.0104104,.826364,-.00687131,.378795,.0149912,.826368,-.00935232,.378795,.0204054,.826376,-.0122146,.378797,.0266532,.826399,-.0154581,.378803,.0337355,.82646,-.0190825,.378824,.0416537,.826525,-.0230873,.378846,.0504091,.826614,-.0274719,.378876,.0600032,.82674,-.0322355,.378917,.0704393,.826888,-.0373766,.378964,.0817195,.827078,-.0428936,.379024,.0938492,.827318,-.0487778,.379099,.106828,.82764,-.0549935,.379199,.120659,.827926,-.0611058,.379227,.13526,.828325,-.0675054,.379275,.150713,.828801,-.0743455,.379332,.167034,.8294,-.0815523,.379415,.184209,.830094,-.0890779,.379495,.202203,.8309,-.096736,.379555,.220945,.831943,-.104135,.379577,.240306,.833037,-.112106,.379604,.260317,.834278,-.120554,.379668,.2808,.836192,-.129128,.3799,.301654,.838671,-.137541,.380109,.323502,.840939,-.14523,.379809,.347176,.844575,-.15248,.379593,.371706,.848379,-.159607,.37909,.39688,.853616,-.166267,.378617,.422702,.858921,-.172698,.377746,.448919,.865324,-.178823,.376749,.475661,.872207,-.184542,.375363,.502599,.880018,-.189836,.373657,.529914,.88694,-.194294,.370673,.557683,.894779,-.197022,.36662,.586848,.902242,-.199108,.36138,.615831,.909914,-.200398,.355434,.644478,.917088,-.20094,.348173,.672905,.923888,-.200671,.339482,.701327,.930495,-.198773,.32956,.730101,.937247,-.195394,.318363,.758383,.943108,-.191956,.306323,.786539,.948296,-.187227,.292576,.813637,.953472,-.181165,.278234,.840793,.958485,-.174119,.263054,.867712,.962714,-.166564,.246756,.893635,.966185,-.158181,.229945,.919028,.970146,-.148275,.212633,.943413,.973491,-.138157,.195229,.966627,.975741,-.127574,.178048,.988817,.977238,-.11554,.160312,1.00924,.978411,-.10364,.142857,1.02845,.979811,-.0913122,.125317,1.04648,.98116,-.0782558,.107627,1.06284,.983543,-.0655957,.0895862,1.07798,.986789,-.0520411,.0713756,1.092,.990292,-.0389727,.053228,1.10484,.994187,-.025808,.0351945,1.11642,.997499,-.0126071,.0173198,1.12703,.999999,275604e-9,-148602e-9,1.13674,.81075,-78735e-10,.394456,161829e-10,.808692,-198293e-9,.393453,407564e-9,.80846,-792877e-9,.39334,.00162965,.808595,-.00178416,.393407,.00366711,.808597,-.00317182,.393408,.00651934,.808598,-.00495589,.393408,.0101866,.808591,-.00713627,.393403,.0146689,.808592,-.00971285,.393402,.0199667,.80861,-.0126855,.393407,.0260803,.808633,-.0160538,.393413,.0330107,.80868,-.0198175,.393429,.0407589,.808748,-.0239758,.393453,.0493264,.808854,-.0285286,.39349,.0587161,.808992,-.0334748,.39354,.0689304,.809141,-.0388116,.393588,.0799707,.809352,-.0445375,.39366,.0918432,.809608,-.0506427,.393742,.104549,.809915,-.0570708,.393834,.118085,.810253,-.0633526,.393885,.132377,.810687,-.0700966,.393953,.147537,.811233,-.0772274,.394047,.163543,.811865,-.0847629,.394148,.180394,.812648,-.0925663,.394265,.198051,.813583,-.100416,.394363,.216443,.814683,-.108119,.394402,.235502,.815948,-.11644,.394489,.255242,.817278,-.125036,.394542,.275441,.819605,-.133655,.39486,.296094,.822256,-.142682,.395248,.317309,.825349,-.150756,.395241,.340516,.829605,-.158392,.395285,.364819,.83391,-.165801,.394922,.389736,.839808,-.172677,.394691,.415409,.845708,-.179448,.394006,.441546,.853025,-.185746,.393279,.46832,.859666,-.191684,.391655,.495302,.86789,-.197146,.390068,.52262,.875845,-.201904,.38727,.550336,.882634,-.205023,.382688,.578825,.891076,-.207098,.377543,.608103,.900589,-.208474,.371752,.63723,.90791,-.209068,.364016,.665769,.915971,-.208655,.355593,.694428,.923455,-.20729,.345439,.723224,.931514,-.203821,.334099,.751925,.937885,-.19986,.321069,.780249,.943136,-.194993,.306571,.8077,.948818,-.189132,.291556,.83497,.954433,-.181617,.275745,.86188,.959078,-.173595,.258695,.888562,.962705,-.164855,.240825,.914008,.966753,-.155129,.22268,.939145,.970704,-.144241,.204542,.963393,.973367,-.133188,.185927,.985983,.975984,-.121146,.167743,1.00704,.976994,-.108366,.149218,1.02715,.978485,-.0956746,.13131,1.0455,.980074,-.0820733,.112513,1.06221,.98225,-.0684061,.0938323,1.07782,.98553,-.0549503,.0749508,1.09199,.989529,-.0407857,.055848,1.10508,.993536,-.0271978,.0368581,1.11684,.997247,-.0132716,.0181845,1.12789,1,431817e-9,-198809e-9,1.13792,.785886,-812608e-11,.405036,157669e-10,.790388,-205278e-9,.407355,398297e-9,.790145,-820824e-9,.407231,.00159263,.790135,-.00184681,.407226,.00358336,.790119,-.00328316,.407218,.00637039,.790126,-.00512988,.40722,.0099539,.79013,-.00738684,.407221,.0143339,.790135,-.0100538,.407221,.0195107,.790134,-.0131306,.407217,.0254848,.79016,-.0166169,.407224,.0322572,.790197,-.020512,.407236,.0398284,.790273,-.0248157,.407263,.0482014,.790381,-.029527,.407304,.0573777,.790521,-.0346446,.407355,.0673602,.790704,-.0401665,.40742,.0781522,.790925,-.0460896,.407499,.0897582,.791195,-.0524017,.407589,.10218,.791522,-.0590121,.407691,.11541,.791878,-.0654876,.407748,.12939,.792361,-.0725207,.407849,.144237,.792942,-.0799844,.407963,.159924,.79362,-.0877896,.408087,.176425,.794529,-.0958451,.408259,.193733,.795521,-.103827,.408362,.211756,.796778,-.111937,.408482,.230524,.798027,-.120521,.408547,.249967,.799813,-.129242,.408721,.269926,.802387,-.138048,.409148,.290338,.805279,-.147301,.409641,.311193,.809251,-.155895,.410154,.333611,.813733,-.163942,.410297,.357615,.819081,-.171666,.410373,.382339,.825427,-.178905,.410348,.407828,.83172,-.185812,.409486,.434034,.83877,-.192318,.408776,.460493,.845817,-.198249,.407176,.487346,.854664,-.204034,.405719,.514832,.863495,-.208908,.403282,.542401,.871883,-.212765,.399293,.570683,.88065,-.214911,.393803,.599947,.89004,-.216214,.387536,.62932,.898476,-.216745,.379846,.658319,.906738,-.216387,.370625,.687138,.914844,-.215053,.360139,.71601,.923877,-.212007,.348849,.745124,.931925,-.207481,.335639,.773366,.938054,-.202418,.320798,.801636,.943895,-.196507,.304772,.829055,.949468,-.189009,.288033,.856097,.955152,-.180539,.270532,.88301,.959403,-.171437,.251639,.909296,.963309,-.161661,.232563,.934868,.967399,-.150425,.213231,.959662,.972009,-.138659,.194247,.98302,.97433,-.126595,.174718,1.00517,.975823,-.113205,.155518,1.02566,.976371,-.0996096,.136709,1.04418,.978705,-.0860754,.117571,1.06146,.981477,-.0714438,.0980046,1.07777,.984263,-.0572304,.0782181,1.09214,.988423,-.0428875,.0584052,1.10553,.993,-.0282442,.038522,1.11758,.99704,-.0140183,.0190148,1.12864,.999913,369494e-9,-145203e-9,1.13901,.777662,-84153e-10,.423844,154403e-10,.770458,-211714e-9,.419915,38845e-8,.770716,-846888e-9,.420055,.00155386,.770982,-.00190567,.420202,.00349653,.770981,-.00338782,.420201,.00621606,.77098,-.00529338,.4202,.00971274,.770983,-.00762223,.4202,.0139867,.770985,-.0103741,.420198,.0190381,.770996,-.0135489,.4202,.0248677,.771029,-.0171461,.420212,.0314764,.771052,-.0211647,.420215,.0388648,.771131,-.0256048,.420245,.047036,.771235,-.0304647,.420284,.0559911,.771383,-.0357436,.420341,.0657346,.771591,-.0414392,.420423,.0762694,.771819,-.0475462,.420506,.0875984,.772123,-.0540506,.420617,.099727,.772464,-.060797,.42072,.112637,.772855,-.0675393,.420799,.126313,.773317,-.0748323,.420893,.140824,.773981,-.0825681,.421058,.15617,.774746,-.0906307,.421226,.172322,.77566,-.0988982,.421397,.189253,.776837,-.106994,.421569,.206912,.778097,-.115528,.421704,.225359,.779588,-.124317,.421849,.24447,.781574,-.133139,.422097,.264156,.784451,-.142179,.422615,.284318,.787682,-.15165,.423269,.304902,.792433,-.160771,.424396,.3265,.797359,-.169166,.424772,.35014,.803986,-.177149,.425475,.374768,.809504,-.184745,.424996,.399928,.815885,-.19173,.424247,.425796,.823513,-.198525,.423515,.452287,.832549,-.204709,.422787,.479321,.841653,-.210447,.421187,.506718,.850401,-.215501,.418519,.53432,.859854,-.219752,.414715,.56242,.869364,-.222305,.409462,.591558,.878837,-.223744,.402926,.621074,.888636,-.224065,.395043,.650538,.898132,-.223742,.38564,.679538,.907181,-.222308,.375378,.708674,.915621,-.219837,.363212,.737714,.9239,-.215233,.349313,.767014,.931644,-.209592,.334162,.795133,.938887,-.203644,.317943,.823228,.945282,-.196349,.300581,.850822,.950758,-.18742,.282195,.877594,.956146,-.177879,.262481,.904564,.960355,-.167643,.242487,.930741,.965256,-.156671,.222668,.955868,.968029,-.144123,.201907,.979869,.97251,-.131305,.18202,1.00291,.974925,-.118335,.161909,1.02392,.975402,-.103714,.142129,1.0433,.976987,-.089415,.122447,1.06089,.979677,-.0748858,.102248,1.07713,.983184,-.0596086,.0814851,1.09218,.987466,-.0447671,.0609484,1.10585,.992348,-.0295217,.0401835,1.11829,.996674,-.0143917,.0198163,1.12966,1.00003,321364e-9,-149983e-9,1.1402,.757901,-869074e-11,.436176,151011e-10,.751195,-217848e-9,.432317,378533e-9,.751178,-871373e-9,.432307,.0015141,.751195,-.00196061,.432317,.0034068,.751198,-.00348552,.432318,.00605659,.751195,-.00544599,.432315,.00946353,.751207,-.00784203,.43232,.013628,.751213,-.0106732,.43232,.0185499,.751221,-.0139393,.432319,.0242302,.751244,-.0176398,.432325,.0306694,.7513,-.0217743,.432348,.0378698,.751358,-.0263412,.432367,.0458321,.751458,-.0313396,.432404,.0545587,.751608,-.0367682,.432464,.0640543,.7518,-.0426246,.43254,.0743222,.752065,-.0489031,.432645,.0853668,.752376,-.0555828,.432762,.0971911,.752715,-.0623861,.432859,.109768,.753137,-.069415,.432958,.123126,.753676,-.0770039,.433099,.137308,.754345,-.084971,.433272,.15229,.755235,-.0932681,.433504,.168075,.756186,-.10171,.433693,.184625,.757363,-.110019,.433857,.201897,.75884,-.11887,.434102,.220014,.760467,-.127881,.434306,.238778,.762969,-.136766,.434751,.258172,.765823,-.14612,.43529,.278062,.769676,-.15566,.436236,.298437,.774909,-.165177,.437754,.319532,.77994,-.17402,.438343,.342505,.785757,-.182201,.438609,.366693,.792487,-.190104,.438762,.391668,.80038,-.197438,.438795,.417494,.808494,-.204365,.438226,.443933,.817695,-.210714,.437283,.470929,.828111,-.216651,.436087,.498569,.837901,-.221804,.433717,.526165,.847813,-.226318,.430133,.554155,.858314,-.229297,.425213,.582822,.868891,-.230999,.418576,.612847,.878941,-.231155,.410405,.642445,.888809,-.230935,.400544,.672024,.898089,-.229343,.389613,.701366,.908081,-.226886,.377197,.730763,.916819,-.222676,.363397,.759642,.924968,-.216835,.347437,.788775,.932906,-.210245,.32995,.817135,.940025,-.202992,.312262,.844912,.946101,-.19436,.293313,.872164,.952835,-.184125,.273638,.899443,.957347,-.173657,.252385,.926389,.961434,-.162204,.231038,.951947,.965522,-.14979,.209834,.976751,.969412,-.136307,.188821,1.00022,.973902,-.122527,.168013,1.02229,.974045,-.108213,.147634,1.04199,.975775,-.0927397,.12705,1.06019,.978383,-.0778212,.106309,1.07711,.98211,-.0621216,.0849279,1.09245,.986517,-.0463847,.0633519,1.10651,.991696,-.0309353,.0419698,1.11903,.996349,-.0150914,.0206272,1.13073,1.00003,442449e-9,-231396e-9,1.14146,.727498,-885074e-11,.441528,145832e-10,.730897,-223525e-9,.443589,368298e-9,.730796,-893996e-9,.443528,.00147303,.730805,-.00201149,.443533,.00331433,.730814,-.00357596,.443538,.00589222,.730815,-.00558734,.443538,.00920678,.730822,-.00804544,.44354,.0132582,.730836,-.0109501,.443545,.0180468,.730848,-.0143008,.443546,.0235732,.730871,-.0180969,.443552,.0298382,.730915,-.022338,.443567,.0368438,.730982,-.0270225,.443591,.044591,.731076,-.0321491,.443627,.0530831,.731245,-.0377166,.443699,.0623243,.73144,-.0437216,.443777,.0723181,.7317,-.0501576,.443881,.0830691,.732034,-.0569942,.444014,.0945809,.732388,-.0638756,.444113,.106825,.732853,-.071203,.444247,.119859,.733473,-.0790076,.444442,.13369,.734195,-.0871937,.444645,.148304,.735069,-.095696,.444877,.163702,.736169,-.10426,.445133,.179861,.73747,-.112853,.44537,.196778,.738991,-.12199,.445651,.214496,.740865,-.131153,.445958,.232913,.743637,-.140245,.446548,.251977,.746797,-.149722,.447246,.271551,.751517,-.159341,.448656,.291774,.756156,-.169106,.449866,.312455,.761519,-.178436,.450919,.334552,.768295,-.186904,.451776,.358491,.776613,-.195117,.452832,.383446,.783966,-.202695,.45249,.408945,.793542,-.20985,.452587,.435364,.803192,-.216403,.451852,.462336,.813892,-.22251,.450708,.48987,.824968,-.227676,.4486,.517697,.835859,-.232443,.445156,.545975,.846825,-.235775,.440351,.574483,.858085,-.237897,.433641,.604246,.868825,-.238074,.425354,.634101,.879638,-.237661,.415383,.664201,.889966,-.236186,.404136,.693918,.899479,-.233599,.390917,.723481,.908769,-.229737,.376352,.75258,.917966,-.223836,.360372,.781764,.926304,-.217067,.342551,.811139,.934626,-.209309,.324238,.839585,.941841,-.20071,.304484,.867044,.94789,-.190602,.283607,.894579,.954196,-.179253,.262205,.921743,.958383,-.167646,.239847,.948026,.963119,-.155073,.218078,.973296,.966941,-.141426,.195899,.998135,.970836,-.126849,.174121,1.02021,.973301,-.112296,.153052,1.04085,.97448,-.0964965,.131733,1.05946,.977045,-.080489,.10997,1.07693,.980751,-.064844,.0881657,1.09254,.985475,-.0481938,.0657987,1.10697,.991089,-.0319185,.0435215,1.12004,.996122,-.0158088,.0214779,1.13173,1.00001,372455e-9,-200295e-9,1.14291,.708622,-907597e-11,.45304,141962e-10,.711162,-228911e-9,.454662,358052e-9,.709812,-914446e-9,.453797,.00143034,.709865,-.00205819,.453834,.00321935,.709864,-.00365894,.453833,.00572331,.709855,-.00571692,.453826,.00894278,.709862,-.00823201,.453828,.012878,.709875,-.011204,.453832,.0175295,.709896,-.0146323,.453839,.0228978,.709925,-.0185163,.453847,.0289839,.709974,-.0228551,.453866,.0357894,.710045,-.0276473,.453892,.0433161,.710133,-.032891,.453924,.0515665,.710292,-.0385851,.453992,.0605458,.710485,-.0447254,.45407,.0702574,.710769,-.0513051,.454192,.0807077,.711106,-.0582733,.454329,.091896,.711516,-.0652866,.45446,.103814,.712071,-.0728426,.454653,.116508,.712676,-.0808307,.45484,.129968,.713476,-.0892216,.455096,.144206,.714377,-.0979047,.455346,.159212,.715579,-.106531,.455647,.174973,.716977,-.115492,.455961,.191504,.71862,-.124821,.456315,.208835,.72084,-.134079,.4568,.226869,.723786,-.143427,.457521,.245582,.727464,-.153061,.458475,.264957,.732771,-.162768,.460239,.284948,.736515,-.172627,.460899,.30522,.743519,-.182487,.463225,.326717,.750041,-.191295,.464027,.350113,.758589,-.199746,.465227,.374782,.767703,-.207584,.465877,.400226,.777484,-.214973,.465996,.426442,.788792,-.221796,.466019,.453688,.800194,-.228038,.465083,.481246,.811234,-.233346,.462506,.509086,.822859,-.238073,.459257,.537338,.835082,-.241764,.454863,.566108,.846332,-.244241,.448163,.595126,.858355,-.244736,.439709,.625574,.87034,-.244278,.429837,.65617,.881027,-.24255,.418002,.686029,.891007,-.239912,.404325,.716039,.900874,-.236133,.389222,.745518,.911072,-.230672,.373269,.775026,.920359,-.22356,.355083,.804521,.928604,-.215591,.335533,.834045,.937175,-.206503,.315278,.861612,.942825,-.196684,.293653,.889131,.949805,-.185116,.271503,.916853,.955535,-.172703,.248821,.943541,.959843,-.159978,.225591,.970132,.964393,-.146375,.202719,.994709,.968008,-.131269,.179928,1.0186,.971013,-.11569,.158007,1.03928,.973334,-.1003,.13624,1.05887,.975775,-.0833352,.1138,1.07652,.979579,-.0668981,.0913141,1.09297,.984323,-.0500902,.0683051,1.10734,.990351,-.0332377,.0451771,1.12084,.995823,-.0161491,.0221705,1.13296,1.0001,234083e-9,-108712e-9,1.14441,.683895,-924677e-11,.46015,137429e-10,.68833,-233383e-9,.463134,346865e-9,.688368,-933547e-9,.463159,.00138748,.688367,-.00210049,.463159,.00312187,.688369,-.00373415,.463159,.00555004,.688377,-.00583449,.463163,.00867216,.688386,-.00840128,.463166,.0124884,.688398,-.0114343,.463169,.0169993,.688418,-.0149329,.463175,.0222054,.688453,-.0188964,.463188,.028108,.688515,-.0233239,.463214,.0347085,.68857,-.0282136,.463231,.0420091,.688679,-.033564,.463276,.0500132,.688854,-.0393733,.463356,.0587255,.689038,-.0456354,.46343,.0681476,.689321,-.0523433,.463553,.0782897,.689662,-.059412,.463693,.0891501,.690188,-.0665736,.4639,.100735,.690755,-.0743106,.464107,.113074,.691405,-.0824722,.464329,.126161,.692198,-.0910484,.464585,.140007,.693196,-.0998778,.464893,.154612,.69454,-.108651,.465285,.169984,.695921,-.117855,.465596,.186106,.697749,-.12734,.466056,.203034,.700375,-.136714,.466771,.220703,.703395,-.146386,.467579,.239062,.707904,-.156096,.469067,.258188,.711673,-.165904,.469851,.277759,.717489,-.175812,.471815,.297935,.724051,-.185931,.47389,.318916,.731965,-.195238,.47587,.341591,.741151,-.204021,.477523,.366062,.751416,-.212113,.478881,.391396,.761848,-.21979,.479226,.417599,.771886,-.2267,.478495,.444401,.783998,-.232991,.477622,.472084,.796523,-.238645,.475833,.500193,.808851,-.243396,.472568,.52865,.821191,-.247226,.467857,.557362,.834261,-.250102,.461871,.586768,.846762,-.251056,.453543,.617085,.859867,-.250604,.443494,.647659,.871948,-.248783,.431711,.678119,.882967,-.245855,.417911,.708399,.892826,-.242168,.401993,.738256,.90332,-.237062,.385371,.767999,.913633,-.22997,.366837,.798191,.922774,-.221687,.346372,.827756,.931371,-.212345,.325682,.856425,.938929,-.20206,.303665,.884299,.944821,-.190981,.280786,.912023,.951792,-.178065,.2573,.939669,.957712,-.164634,.233448,.96655,.961912,-.150863,.209504,.992366,.966382,-.13577,.18597,1.01633,.969588,-.119593,.162905,1.03843,.971777,-.103203,.14053,1.05841,.97433,-.0865888,.117909,1.07632,.978686,-.0690829,.0944101,1.09326,.983281,-.0516568,.0705671,1.10796,.989562,-.034558,.0468592,1.12182,.995465,-.0167808,.0229846,1.1342,.999991,373016e-9,-235606e-9,1.1459,.662251,-939016e-11,.468575,132714e-10,.666634,-237624e-9,.471675,335842e-9,.666411,-950385e-9,.471516,.00134321,.666399,-.00213833,.471509,.00302221,.666386,-.0038014,.471499,.00537283,.666405,-.00593958,.471511,.00839533,.666406,-.00855253,.471508,.0120898,.666428,-.0116401,.471519,.0164569,.666444,-.0152015,.471522,.0214971,.66649,-.0192362,.471543,.027212,.666537,-.0237428,.471558,.033603,.666617,-.0287198,.471591,.0406728,.666718,-.0341647,.471631,.0484238,.666889,-.0400759,.47171,.0568621,.667104,-.0464479,.471805,.0659915,.667374,-.0532677,.471923,.0758178,.667772,-.0603805,.472098,.0863425,.668371,-.0677392,.472363,.0975917,.668971,-.0756028,.472596,.109567,.669696,-.0839293,.472869,.122272,.670481,-.0926683,.473126,.135718,.6715,-.1016,.473442,.149914,.672911,-.110566,.47389,.164882,.674512,-.119984,.474354,.180602,.67651,-.129574,.474922,.19711,.679292,-.139106,.475764,.214371,.682798,-.148993,.476886,.232405,.686955,-.158737,.478179,.251153,.691406,-.168754,.479432,.270436,.697438,-.178703,.481481,.290374,.704761,-.188955,.484143,.311044,.713599,-.198814,.487007,.333003,.723194,-.207869,.488962,.357144,.732601,-.216189,.489815,.382169,.744193,-.22398,.490888,.408227,.754907,-.231156,.490355,.434928,.767403,-.23747,.489548,.462599,.78107,-.243503,.488274,.490908,.793893,-.248114,.484843,.519421,.807296,-.25222,.4803,.548561,.820529,-.255265,.474097,.577772,.833716,-.256741,.466041,.607782,.848403,-.25637,.456547,.638807,.860755,-.254804,.443946,.670058,.874012,-.251834,.430852,.700749,.885619,-.247867,.414903,.731446,.896069,-.242634,.397276,.761191,.906266,-.236093,.378535,.791053,.916759,-.227543,.358038,.821298,.92523,-.21783,.335705,.850747,.93436,-.207534,.313797,.879258,.941631,-.195983,.289671,.907734,.947564,-.183567,.265319,.935206,.953681,-.169345,.240815,.962739,.960008,-.154909,.216119,.989227,.964145,-.140161,.192096,1.01465,.968171,-.123411,.167855,1.03737,.969859,-.106525,.144817,1.05767,.972666,-.0891023,.12149,1.0761,.977055,-.0718094,.0975306,1.09336,.982527,-.0534213,.0730217,1.10878,.989001,-.0355579,.0483366,1.12285,.99512,-.0176383,.023938,1.13548,1.00007,368831e-9,-211581e-9,1.14744,.651047,-960845e-11,.484101,12922e-9,.644145,-241347e-9,.478968,324578e-9,.64396,-965142e-9,.478831,.00129798,.64396,-.00217154,.47883,.00292046,.643968,-.00386049,.478835,.00519202,.643974,-.00603186,.478838,.0081128,.643977,-.0086854,.478836,.011683,.643982,-.0118207,.478834,.0159031,.644024,-.0154374,.478856,.0207743,.644059,-.0195343,.478868,.0262975,.644122,-.0241103,.478896,.0324747,.644207,-.0291638,.478933,.039309,.64432,-.0346919,.478981,.0468029,.644481,-.0406919,.479053,.0549614,.644722,-.047159,.479169,.0637909,.645013,-.0540748,.479302,.0732974,.645503,-.0612001,.479541,.0834898,.646117,-.0687303,.479829,.0943873,.646707,-.0767846,.480061,.105991,.647431,-.0852465,.480343,.11831,.64831,-.0940719,.48066,.131348,.649486,-.103056,.481083,.14514,.650864,-.112261,.481528,.159676,.652604,-.121852,.482102,.174979,.654825,-.131505,.482813,.191079,.657876,-.141189,.483876,.207927,.661339,-.151239,.48499,.225586,.665463,-.161091,.486279,.243947,.670542,-.171235,.487968,.262957,.677361,-.181347,.49053,.282781,.685672,-.191679,.493862,.303311,.694551,-.201781,.49699,.324607,.703753,-.211164,.498884,.347916,.713703,-.219675,.500086,.372628,.725911,-.227836,.501554,.398694,.73862,-.23533,.502193,.425529,.752118,-.241786,.501811,.453209,.76579,-.247865,.500185,.481381,.779568,-.252696,.497159,.51011,.793991,-.256802,.492765,.539322,.808182,-.259942,.486827,.569078,.821698,-.261703,.478386,.598818,.836009,-.262006,.468772,.629762,.849824,-.260333,.456352,.661366,.863888,-.257398,.442533,.69295,.876585,-.253264,.426573,.723608,.888665,-.248026,.408964,.754378,.899537,-.241487,.389677,.784761,.9094,-.233463,.368516,.814688,.920166,-.223397,.346624,.845009,.928899,-.21255,.322717,.874431,.937156,-.200869,.298698,.902922,.943861,-.188387,.273491,.931356,.949557,-.174341,.247866,.958854,.955862,-.158994,.222496,.986098,.961721,-.143664,.197522,1.01229,.965976,-.127412,.17302,1.03571,.968652,-.109798,.148954,1.05699,.971084,-.0916787,.125044,1.07587,.975584,-.0739634,.100577,1.09372,.98122,-.055322,.0753666,1.10948,.988253,-.0366825,.0498899,1.12394,.99482,-.0180389,.024611,1.13694,1.00001,229839e-9,-188283e-9,1.14919,.613867,-964198e-11,.479449,123452e-10,.621485,-244534e-9,.485399,313091e-9,.621429,-978202e-9,.485353,.00125245,.62112,-.00220004,.485114,.00281687,.621119,-.0039111,.485112,.00500783,.621122,-.00611091,.485112,.00782498,.621133,-.00879922,.485117,.0112687,.621152,-.0119756,.485125,.0153394,.621183,-.0156396,.485139,.0200382,.621227,-.0197898,.485158,.0253663,.621298,-.0244253,.485192,.0313261,.621388,-.0295441,.485233,.0379204,.621507,-.0351432,.485286,.0451523,.621693,-.0412198,.485378,.0530277,.621933,-.0477673,.485495,.0615522,.622232,-.0547574,.485635,.0707316,.622809,-.0619417,.485943,.0805883,.623407,-.069625,.486232,.0911267,.62406,-.077796,.486516,.102354,.624835,-.0863731,.486838,.114279,.625758,-.095251,.487188,.126902,.627043,-.104299,.487695,.140285,.628438,-.113724,.488163,.154397,.630325,-.123417,.488858,.169267,.632801,-.133137,.489754,.184941,.635784,-.143052,.490815,.20136,.639406,-.153132,.492048,.218643,.643872,-.163143,.49363,.236615,.6499,-.17333,.496009,.255449,.657201,-.183622,.498994,.275006,.666221,-.194019,.502888,.295354,.674419,-.204192,.505459,.316244,.683729,-.21406,.507771,.33849,.695584,-.222854,.510245,.363166,.708583,-.231315,.512293,.389071,.721233,-.238911,.512747,.415737,.735134,-.245657,.512482,.443331,.750179,-.251879,.511526,.471891,.765073,-.256911,.508935,.500892,.779794,-.261144,.504341,.530294,.794801,-.264316,.498515,.560144,.810339,-.266276,.491015,.590213,.824818,-.266981,.481126,.620865,.839375,-.265778,.468685,.652687,.853043,-.262748,.453925,.684759,.867335,-.258474,.437912,.716209,.88037,-.253187,.419648,.747508,.891711,-.246476,.39982,.77797,.902896,-.238735,.37879,.808586,.913601,-.22885,.355891,.838843,.923019,-.217656,.331773,.869014,.933432,-.205539,.307356,.898512,.939691,-.192595,.281321,.9269,.946938,-.178945,.255441,.955297,.952372,-.163587,.229013,.983231,.95909,-.147214,.203179,1.00971,.963675,-.13064,.17792,1.03438,.968247,-.113121,.152898,1.05625,.97001,-.0945824,.128712,1.07598,.974458,-.0755648,.103349,1.094,.980168,-.0571998,.0776731,1.1104,.987295,-.0377994,.0514445,1.12491,.994432,-.0186417,.025429,1.13851,.999975,542714e-9,-282356e-9,1.15108,.592656,-980249e-11,.486018,119532e-10,.598467,-247275e-9,.490781,301531e-9,.597934,-988317e-9,.490343,.00120517,.597903,-.00222366,.490319,.0027116,.597913,-.00395315,.490327,.00482077,.597919,-.00617653,.490329,.00753264,.597936,-.00889375,.490339,.0108478,.597956,-.0121043,.490347,.0147668,.597992,-.0158073,.490365,.0192905,.598032,-.0200017,.490382,.0244204,.598109,-.0246865,.49042,.0301593,.598215,-.0298594,.490474,.03651,.59833,-.0355167,.490524,.0434757,.598525,-.0416559,.490624,.0510629,.598778,-.0482692,.490753,.0592781,.599135,-.0553114,.49094,.0681304,.599802,-.062542,.491328,.0776467,.600361,-.0703638,.491598,.0878184,.60101,-.0786256,.491882,.0986573,.601811,-.0872962,.492232,.11018,.602861,-.0962284,.492684,.1224,.604167,-.10538,.493213,.135354,.605693,-.114896,.493799,.149034,.607682,-.124654,.494576,.163469,.610672,-.13456,.4959,.178747,.613313,-.144581,.496713,.194723,.617603,-.154703,.498499,.211617,.622174,-.16489,.500188,.229183,.628855,-.175164,.503072,.247786,.636963,-.185565,.506798,.267116,.644866,-.195911,.509719,.28702,.653741,-.206104,.512776,.307763,.664942,-.216447,.516812,.329631,.67633,-.22552,.519181,.353515,.690012,-.234316,.521681,.379226,.704243,-.242032,.523129,.405901,.719396,-.249172,.523768,.433585,.734471,-.255543,.522541,.462085,.750539,-.260697,.520217,.491233,.766365,-.26501,.516293,.521094,.781677,-.268409,.509708,.551014,.797132,-.270399,.501944,.581463,.812655,-.271247,.492025,.612402,.828592,-.270708,.480424,.643798,.844044,-.268085,.465955,.67682,.857305,-.263459,.448425,.708496,.87114,-.258151,.430243,.74046,.884936,-.251171,.410578,.771583,.895772,-.243305,.38862,.802234,.906961,-.234037,.365214,.833179,.917775,-.222714,.34116,.86353,.927883,-.210175,.31572,.893557,.936617,-.196925,.289159,.922976,.943384,-.182788,.261996,.951606,.949713,-.167965,.235324,.979958,.955818,-.151109,.208408,1.00765,.961344,-.133834,.182591,1.03329,.965469,-.115987,.156958,1.0557,.968693,-.09746,.132239,1.07583,.973165,-.0778514,.106195,1.09451,.979387,-.0585067,.0797669,1.11137,.98671,-.0390409,.0530263,1.12643,.994093,-.019408,.0263163,1.14016,1.00002,540029e-9,-194487e-9,1.15299,.574483,-989066e-11,.494533,114896e-10,.574478,-249127e-9,.494528,289403e-9,.574607,-996811e-9,.494637,.00115797,.574396,-.00224241,.494458,.00260498,.574377,-.00398632,.49444,.00463102,.574386,-.00622836,.494445,.00723623,.574401,-.0089683,.494453,.010421,.574419,-.0122056,.49446,.0141859,.574459,-.0159396,.494481,.0185322,.574525,-.0201692,.49452,.0234617,.574587,-.0248924,.494547,.0289762,.574697,-.0301074,.494604,.0350797,.574853,-.0358114,.494688,.0417767,.575027,-.041999,.494772,.0490718,.575294,-.0486618,.494915,.0569728,.575733,-.0557148,.495173,.0654955,.576356,-.0630489,.495537,.0746612,.576944,-.0709285,.495836,.0844615,.57765,-.0792723,.496177,.0949142,.578491,-.0880167,.496563,.10603,.579639,-.0969462,.497096,.117841,.580989,-.10622,.497684,.130367,.582587,-.115861,.498337,.143609,.584951,-.125605,.499414,.157625,.587602,-.135608,.500518,.172413,.59076,-.145742,.501767,.187999,.594992,-.155934,.503542,.20445,.600656,-.166303,.506135,.221764,.607816,-.176681,.509542,.24002,.61522,-.187071,.51263,.258992,.623702,-.197465,.516021,.278773,.634192,-.207816,.520422,.299377,.644936,-.218183,.524073,.320802,.657888,-.2278,.528049,.34384,.670666,-.236747,.52986,.36916,.685626,-.24484,.531892,.395867,.701304,-.252071,.532727,.423488,.717727,-.258714,.532146,.452201,.733914,-.264211,.529883,.481579,.750529,-.26859,.5259,.511558,.76747,-.272046,.51999,.542042,.785189,-.274225,.513083,.572799,.800954,-.275189,.502936,.603816,.816962,-.274946,.490921,.635461,.83336,-.272695,.47684,.6676,.848143,-.268223,.459405,.70051,.861818,-.262768,.440319,.732902,.876828,-.255872,.420123,.765084,.889312,-.247703,.398379,.796391,.900412,-.238381,.374496,.827333,.912251,-.227783,.349874,.858385,.921792,-.214832,.323181,.888652,.931273,-.200949,.296624,.917763,.940295,-.186537,.269211,.947878,.946812,-.171538,.241447,.977016,.953588,-.155254,.213829,1.00501,.958841,-.137156,.186807,1.03179,.963746,-.118699,.160706,1.05502,.966468,-.0998358,.135504,1.07568,.971178,-.0805186,.109131,1.09479,.97831,-.0599348,.0818293,1.1123,.985886,-.0399661,.0545872,1.12771,.994021,-.0198682,.0269405,1.14186,1.00009,271022e-9,-12989e-8,1.15514,.538716,-990918e-11,.486732,109675e-10,.550656,-250642e-9,.497518,277412e-9,.55057,-.00100265,.497441,.00110974,.550903,-.00225672,.497733,.00249779,.550568,-.00401046,.497438,.00443906,.550574,-.00626613,.49744,.00693637,.550591,-.0090226,.497449,.00998921,.550623,-.0122795,.497469,.0135984,.550667,-.0160361,.497495,.0177654,.550724,-.0202908,.497526,.0224915,.550792,-.0250421,.497557,.0277795,.550918,-.0302878,.49763,.0336334,.551058,-.0360241,.497701,.0400573,.551276,-.0422473,.497824,.0470585,.551551,-.0489441,.497977,.0546433,.552074,-.0559596,.498312,.0628367,.552681,-.0633978,.498679,.071646,.553324,-.0713176,.499031,.0810746,.554011,-.0797268,.499365,.091129,.55488,-.0885238,.499779,.101837,.556171,-.0974417,.500444,.113239,.557498,-.106841,.501025,.125316,.559299,-.116533,.501864,.138128,.561647,-.126298,.502967,.151695,.564347,-.136388,.504129,.16604,.567863,-.146576,.505713,.181207,.572569,-.156832,.507953,.197259,.578919,-.167323,.511186,.214258,.585387,-.177712,.514042,.232038,.593134,-.188184,.517484,.250733,.603295,-.198717,.522345,.270454,.613854,-.209177,.526751,.290807,.626092,-.219644,.531595,.312202,.637868,-.229494,.534721,.334435,.652458,-.238718,.538304,.359184,.666985,-.247061,.539875,.385637,.683301,-.254652,.541042,.41328,.69998,-.261376,.540735,.441903,.717824,-.267085,.539139,.471609,.734617,-.271465,.534958,.501446,.753663,-.27528,.53032,.532571,.770512,-.277617,.522134,.563641,.787356,-.278525,.51206,.595067,.806252,-.278512,.50119,.627226,.822061,-.277023,.486791,.659402,.838959,-.273175,.470467,.692874,.85379,-.267238,.450688,.725702,.868268,-.260327,.429741,.75832,.881994,-.251946,.407223,.790189,.893885,-.242432,.383214,.821625,.905118,-.231904,.357297,.853011,.916045,-.219545,.330733,.883773,.927614,-.205378,.303916,.914435,.936005,-.190388,.275941,.944502,.944533,-.1749,.247493,.974439,.950758,-.158588,.218996,1.00286,.957078,-.141027,.191559,1.0304,.962448,-.121507,.164457,1.05466,.964993,-.102068,.138636,1.0761,.970017,-.0822598,.111861,1.09541,.97661,-.062033,.0843438,1.11317,.985073,-.0409832,.0558496,1.12911,.993515,-.020146,.0275331,1.1438,1.00006,27329e-8,-107883e-9,1.15736,.525324,-999341e-11,.498153,105385e-10,.526513,-251605e-9,.499277,265329e-9,.526517,-.00100641,.499282,.0010613,.526588,-.00226466,.499337,.00238823,.526539,-.0040255,.499302,.00424535,.526547,-.00628954,.499306,.00663364,.526561,-.00905628,.499313,.00955337,.526593,-.0123253,.499334,.0130054,.526642,-.0160957,.499365,.0169911,.5267,-.0203661,.499396,.0215122,.526792,-.0251347,.499451,.0265718,.526904,-.0303985,.499511,.0321732,.527079,-.0361554,.499617,.0383231,.527285,-.0423982,.499731,.045026,.527602,-.0491121,.499924,.0522936,.528166,-.0561127,.500306,.0601528,.52879,-.0635988,.5007,.0686059,.529421,-.071581,.501048,.0776518,.530144,-.0799854,.501421,.0873148,.531062,-.0888032,.501884,.0976084,.532374,-.0977643,.50259,.108588,.533828,-.107197,.50329,.120234,.53581,-.116887,.504312,.132602,.538063,-.126755,.505365,.145721,.5409,-.136819,.506668,.159617,.544882,-.147117,.508731,.174369,.550238,-.157446,.511601,.190028,.556038,-.167988,.514431,.206587,.563031,-.178364,.517808,.224046,.571543,-.189007,.521937,.242503,.582255,-.199546,.527415,.261977,.59272,-.210084,.531682,.282162,.605648,-.220448,.537123,.303426,.61785,-.230593,.540664,.325323,.632223,-.240238,.544467,.348993,.648819,-.24887,.547594,.375462,.665825,-.256657,.54912,.403024,.683389,-.263711,.549294,.431773,.701495,-.269666,.547649,.461494,.719197,-.274169,.543786,.491623,.737906,-.278124,.538644,.522994,.756652,-.280632,.531057,.554775,.775279,-.281741,.521972,.586441,.792688,-.281652,.509613,.618596,.811894,-.280345,.496497,.651462,.827938,-.277128,.47968,.684023,.844837,-.271646,.460688,.718024,.859239,-.264397,.438872,.751207,.874088,-.256144,.41577,.784232,.887693,-.246311,.391369,.816191,.899402,-.235497,.365872,.847828,.910973,-.223631,.338618,.87934,.92204,-.209874,.310803,.910325,.930987,-.194265,.281802,.940695,.94,-.178125,.252836,.970958,.948018,-.161479,.224239,1.00078,.955141,-.144038,.195857,1.0288,.960513,-.124915,.168487,1.05371,.963964,-.104284,.141495,1.07596,.968713,-.0838732,.114437,1.09628,.975524,-.0635579,.0863105,1.11448,.98431,-.042291,.0574774,1.13069,.992916,-.0209131,.0284343,1.14568,.999926,743097e-9,-379265e-9,1.15955,.501042,-998428e-11,.498726,100306e-10,.502992,-252112e-9,.500665,253283e-9,.502417,-.00100791,.500092,.00101259,.502965,-.00226919,.500621,.00227978,.502318,-.00403109,.499994,.00405011,.502333,-.00629832,.500005,.00632868,.502362,-.00906907,.500027,.00911446,.502369,-.0123423,.500023,.0124078,.50243,-.0161178,.500066,.016211,.502493,-.0203937,.500103,.0205256,.502592,-.0251684,.500166,.0253548,.502707,-.0304389,.50023,.0307029,.502881,-.0362015,.500335,.0365753,.503124,-.0424507,.500488,.0429798,.503443,-.0491582,.500686,.0499268,.504083,-.0561476,.501155,.0574541,.504668,-.0636846,.501524,.0655408,.505319,-.0716834,.501904,.0742072,.50609,-.0800925,.502321,.0834699,.507122,-.0888425,.502896,.0933603,.508414,-.097855,.503603,.10391,.509955,-.107304,.504416,.115113,.512061,-.116921,.505565,.127054,.514419,-.12689,.506732,.139709,.517529,-.136934,.508338,.153173,.522085,-.147327,.510987,.167528,.526986,-.157612,.513527,.182708,.533122,-.168213,.516717,.198881,.540807,-.178688,.520832,.215986,.550687,-.189511,.52632,.234335,.560567,-.199998,.531009,.253375,.571698,-.210652,.535839,.273499,.584364,-.220917,.541091,.294355,.599066,-.23137,.546875,.316525,.614148,-.241206,.551306,.339671,.631157,-.250379,.555187,.36531,.647919,-.258397,.556595,.392767,.666112,-.265528,.556949,.421397,.686158,-.271827,.556617,.451433,.704838,-.27674,.552975,.482131,.723957,-.280733,.547814,.513458,.74262,-.283359,.53997,.545446,.762009,-.284541,.530422,.57775,.781314,-.284507,.518546,.610434,.799116,-.283309,.504178,.643178,.817604,-.280378,.48843,.676248,.83459,-.275619,.469457,.709698,.850974,-.26856,.447698,.744245,.866747,-.260094,.424791,.777695,.881412,-.249929,.399913,.810392,.8936,-.239137,.37308,.842872,.905943,-.226818,.345705,.874677,.916408,-.213699,.31706,.906257,.927215,-.198428,.288444,.936881,.935625,-.181643,.258329,.96795,.944076,-.164386,.228488,.998216,.951229,-.146339,.199763,1.02689,.958793,-.127709,.172153,1.0535,.963219,-.107244,.144989,1.07646,.967562,-.0857764,.11685,1.09675,.974866,-.0645377,.0880571,1.11576,.983353,-.0431732,.0587352,1.13227,.992503,-.0218356,.0294181,1.1478,1.00003,605203e-9,-231013e-9,1.16207,.482935,-101177e-10,.504695,968142e-11,.477554,-251521e-9,.499071,240676e-9,.477904,-.00100683,.499436,96342e-8,.478368,-.00226636,.499899,.0021687,.477977,-.00402719,.499513,.00385384,.477993,-.00629226,.499525,.0060221,.478011,-.00906011,.499536,.00867289,.478051,-.0123305,.499566,.0118074,.478089,-.016102,.499587,.0154269,.478171,-.0203736,.499645,.0195341,.478254,-.025143,.499692,.0241318,.47839,-.0304071,.499779,.0292247,.478588,-.0361631,.499911,.0348196,.478812,-.0424023,.500046,.0409231,.479208,-.0490724,.500326,.047552,.479841,-.0560722,.500805,.0547377,.480392,-.0636125,.501152,.0624607,.481068,-.0716134,.501561,.0707473,.481898,-.0800062,.502054,.0796118,.483022,-.0886568,.502728,.0890974,.484332,-.0977553,.503479,.0992099,.486126,-.107173,.504546,.10999,.488066,-.11677,.50557,.121476,.490521,-.126725,.506849,.133672,.494232,-.136793,.50911,.146731,.498302,-.147116,.511345,.160577,.503565,-.157446,.514344,.175335,.510902,-.168121,.518824,.191207,.519263,-.178799,.523666,.208058,.528204,-.189407,.528296,.225875,.538854,-.200145,.533724,.244782,.551278,-.210701,.539833,.264753,.565222,-.221303,.546131,.285745,.579403,-.231688,.551496,.307592,.595469,-.241718,.556809,.330582,.610929,-.250992,.559641,.354995,.629433,-.259602,.562379,.382471,.648504,-.267038,.563676,.411126,.66756,-.273388,.562092,.440924,.689143,-.278788,.560807,.472118,.709056,-.282783,.555701,.503774,.729855,-.285836,.548698,.536364,.748954,-.287078,.538544,.56895,.768373,-.287133,.526711,.601991,.78827,-.285839,.512511,.635403,.807465,-.283238,.496323,.668797,.825194,-.27906,.477638,.702584,.842203,-.272286,.456253,.736393,.857749,-.263854,.432412,.77096,.874799,-.253943,.407806,.80489,.887497,-.24237,.38033,.83771,.89966,-.230278,.352446,.870376,.911753,-.21646,.323268,.902256,.923011,-.202071,.294314,.933306,.932375,-.185519,.264104,.965177,.940537,-.167604,.234035,.996303,.948904,-.149068,.20412,1.0261,.955263,-.129539,.175431,1.05304,.960303,-.109932,.148116,1.07617,.965512,-.0880572,.119693,1.09742,.973466,-.0660548,.0901619,1.11721,.98284,-.0439228,.0599875,1.13436,.992216,-.0219588,.0298975,1.15006,.999946,119402e-9,-208547e-10,1.16471,.447827,-100414e-10,.491543,914833e-11,.454778,-251257e-9,.499172,22891e-8,.453519,-.00100342,.497787,914184e-9,.45357,-.00225776,.497847,.00205701,.453578,-.00401371,.497855,.00365705,.45357,-.00627107,.497841,.00571453,.453598,-.00902968,.497864,.00823019,.453627,-.0122888,.497882,.0112049,.453684,-.0160475,.497923,.0146405,.453764,-.0203044,.49798,.0185394,.453866,-.0250576,.498049,.0229054,.453996,-.0303028,.49813,.0277424,.454196,-.0360379,.498267,.0330587,.454457,-.0422521,.498445,.0388613,.454926,-.0488393,.498812,.0451767,.455525,-.0558653,.499272,.0520153,.456074,-.0633772,.499625,.0593754,.456752,-.0713606,.500049,.0672751,.457648,-.07971,.500615,.0757447,.458849,-.0883032,.501399,.0848231,.46029,-.0974095,.502293,.0945135,.462,-.106729,.503301,.104848,.464121,-.116354,.504533,.115884,.466889,-.126214,.506172,.127652,.470744,-.136324,.508667,.14024,.47488,-.146595,.510995,.153673,.480845,-.157027,.514832,.168053,.488262,-.167658,.519506,.183508,.496547,-.178343,.524347,.199948,.506254,-.188916,.52983,.217503,.517961,-.199975,.536357,.236272,.531484,-.210624,.543641,.256096,.545496,-.221227,.550048,.277085,.559497,-.231568,.555076,.298615,.575752,-.241698,.560541,.321547,.591999,-.251172,.564156,.345602,.610654,-.260178,.567607,.371851,.630484,-.268094,.56923,.40076,.651807,-.274661,.569779,.430801,.67239,-.280331,.566791,.461939,.693024,-.284501,.562007,.493854,.715473,-.287852,.555791,.526992,.736323,-.28929,.546345,.560102,.755771,-.289405,.534,.593543,.775424,-.2881,.519114,.627256,.795447,-.285562,.502543,.661464,.815319,-.281416,.484773,.695206,.831769,-.275523,.463445,.729044,.849464,-.267516,.440269,.764069,.866775,-.257584,.415049,.799089,.881252,-.245817,.388049,.831948,.894209,-.233127,.35889,.865526,.906922,-.219579,.329915,.89818,.919686,-.204491,.300441,.930013,.929044,-.188962,.269445,.962061,.938393,-.171079,.238402,.994214,.94661,-.15199,.208204,1.02533,.953095,-.131953,.178653,1.0529,.958644,-.111233,.150684,1.0771,.963925,-.0903098,.122359,1.09855,.971995,-.0680505,.0923342,1.11874,.981658,-.0448512,.0614195,1.13635,.991649,-.0221931,.0303582,1.15238,.999985,393403e-9,-111086e-9,1.16772,.396806,-971563e-11,.457671,842355e-11,.429186,-249421e-9,.495017,21625e-8,.429324,-998052e-9,.495173,865322e-9,.429175,-.00224487,.494999,.00194637,.429129,-.00399041,.494952,.00346004,.429153,-.00623476,.494974,.00540684,.429168,-.0089773,.494983,.00778714,.429207,-.0122175,.495012,.0106022,.429257,-.0159542,.495047,.0138535,.429338,-.0201864,.495106,.0175443,.429431,-.0249104,.495165,.0216774,.429587,-.0301252,.495279,.0262594,.429796,-.0358249,.495432,.0312968,.430065,-.0419972,.495621,.0367985,.430588,-.0485144,.496061,.042798,.43113,-.0555028,.496472,.0492914,.431743,-.0629852,.496904,.0562907,.432448,-.0709256,.497369,.0638056,.433414,-.0791942,.498032,.071885,.434638,-.0877346,.498854,.0805517,.43611,-.0968056,.499812,.0898047,.437859,-.106002,.500891,.0997142,.440017,-.115648,.502198,.110289,.443236,-.125427,.504389,.121644,.44697,-.135492,.506809,.133769,.451689,-.145746,.509858,.146787,.45811,-.156219,.514247,.160793,.465305,-.166834,.518816,.175791,.474085,-.177546,.524331,.191906,.484808,-.188262,.53104,.209199,.49732,-.199346,.538511,.227825,.509693,-.209951,.544554,.247269,.524367,-.220533,.551616,.267978,.539228,-.231082,.557368,.289672,.55644,-.241342,.563782,.31268,.574204,-.250964,.568851,.33651,.593388,-.260306,.57312,.362219,.613358,-.268667,.574916,.390322,.634512,-.275591,.575053,.420478,.65563,-.281328,.572404,.451614,.678265,-.285948,.568893,.484112,.70011,-.289408,.561878,.517348,.723005,-.291328,.55359,.551355,.743744,-.291418,.541099,.585109,.763949,-.290252,.526489,.619487,.784186,-.287648,.509496,.65404,.804304,-.283782,.491484,.688649,.823629,-.278067,.470517,.723133,.84094,-.270588,.44705,.757163,.857852,-.261188,.421252,.792816,.874934,-.249313,.394191,.827248,.888709,-.236492,.365359,.861074,.902589,-.222185,.336016,.894417,.914201,-.207314,.30527,.926825,.925978,-.191146,.274532,.9595,.93512,-.174135,.243393,.991583,.943656,-.155231,.212414,1.02356,.951719,-.134403,.182005,1.05239,.957164,-.113023,.153043,1.07754,.962656,-.0914493,.124186,1.09984,.970695,-.0694179,.0941654,1.12,.980749,-.0466199,.0629671,1.13849,.991205,-.0227032,.0311146,1.15494,.999884,632388e-9,-254483e-9,1.1706,.379821,-957289e-11,.460637,789337e-11,.405188,-247483e-9,.491396,204064e-9,.404796,-989434e-9,.490914,815853e-9,.40483,-.00222607,.490949,.00183559,.40473,-.00395723,.49084,.00326332,.404731,-.00618287,.490836,.00509945,.404768,-.00890258,.490871,.00734463,.404791,-.0121156,.490883,.00999992,.404857,-.0158214,.490938,.0130676,.404943,-.0200178,.491004,.0165503,.405059,-.0247027,.491093,.0204521,.405213,-.0298729,.491205,.0247788,.405399,-.0355226,.491333,.0295373,.405731,-.0416352,.491604,.034741,.406303,-.0480807,.492116,.0404255,.406814,-.0550458,.492506,.0465732,.407404,-.0624652,.492926,.0532058,.408149,-.0702958,.493442,.0603442,.409128,-.0784623,.494136,.0680297,.410408,-.087007,.495054,.0762786,.411813,-.0959639,.495962,.0851046,.413735,-.105075,.497257,.0945878,.416137,-.114646,.498882,.104725,.41934,-.124394,.501132,.11563,.423326,-.134328,.503883,.127325,.428419,-.14458,.50747,.139911,.43484,-.154979,.511964,.153481,.442641,-.165628,.517328,.168114,.452511,-.176365,.524258,.183995,.463473,-.187298,.531248,.200953,.475564,-.198244,.538367,.219176,.488664,-.208938,.545175,.238514,.504073,-.219599,.553227,.259129,.520832,-.230378,.560653,.280997,.538455,-.240703,.567523,.303821,.55709,-.250548,.573287,.327948,.576646,-.259964,.577795,.353362,.596705,-.268721,.580077,.380336,.618053,-.276054,.58018,.4101,.640303,-.282176,.578747,.44161,.662365,-.286931,.574294,.474106,.684542,-.290521,.567035,.507549,.707984,-.292672,.558687,.541853,.730913,-.293189,.547606,.576581,.752948,-.292199,.533471,.61172,.773452,-.289508,.516395,.646339,.794715,-.285716,.497873,.682131,.814251,-.280051,.476845,.716396,.833057,-.272873,.453449,.751503,.84959,-.263982,.427857,.786085,.867022,-.252745,.400335,.821355,.882277,-.239655,.371304,.85646,.895375,-.225386,.340397,.890828,.909347,-.209587,.310005,.923532,.921885,-.193433,.2796,.956419,.932127,-.176135,.247276,.989445,.941869,-.157872,.216186,1.02221,.949735,-.137577,.185602,1.05195,.956617,-.115285,.155767,1.07822,.961974,-.0928418,.126103,1.10149,.96972,-.0700592,.0956758,1.12207,.98012,-.0474671,.0643269,1.1408,.990825,-.0238113,.0320863,1.1577,.999876,381574e-9,-812203e-10,1.17403,.367636,-961342e-11,.469176,753287e-11,.380377,-244772e-9,.485434,191797e-9,.380416,-978857e-9,.485475,767015e-9,.380376,-.00220165,.485435,.00172522,.380419,-.00391408,.485487,.00306734,.380438,-.00611549,.485505,.00479332,.380462,-.00880558,.485525,.00690391,.380496,-.0119837,.485551,.00940039,.38056,-.0156487,.485605,.0122848,.38064,-.0197988,.485666,.0155601,.380767,-.0244324,.48577,.0192313,.380909,-.0295444,.485871,.0233032,.381142,-.0351321,.48606,.0277861,.381472,-.0411535,.486336,.0326939,.382015,-.0475408,.486833,.0380565,.382523,-.0544395,.487231,.0438615,.383129,-.061784,.487683,.0501332,.383952,-.0695085,.488313,.0568996,.38498,-.0775819,.489077,.0641952,.386331,-.0860443,.490113,.0720324,.387788,-.0948406,.491099,.0804379,.389808,-.103899,.492566,.0894899,.39252,-.113313,.494601,.0992098,.395493,-.123007,.496619,.109641,.399826,-.132859,.499912,.120919,.405341,-.143077,.504061,.133107,.411932,-.153465,.508905,.146263,.420591,-.164108,.515482,.160544,.43101,-.174893,.523191,.176123,.441881,-.185839,.53026,.192757,.453919,-.196633,.537295,.210535,.468715,-.207611,.546156,.229886,.485182,-.218517,.555173,.250543,.501926,-.229249,.562728,.27221,.51785,-.239481,.567494,.294892,.536947,-.249395,.573889,.318987,.557115,-.259,.578831,.344348,.577966,-.268075,.582055,.371223,.599489,-.276115,.583307,.399834,.62479,-.282523,.583902,.431415,.647504,-.287663,.57953,.464301,.670601,-.291538,.573103,.498123,.693539,-.293842,.563731,.532662,.717385,-.294681,.553169,.567925,.741533,-.293717,.539908,.603502,.762142,-.291156,.521902,.639074,.783014,-.28719,.502815,.674439,.805158,-.281773,.482598,.710497,.823646,-.274682,.458949,.7456,.841879,-.266184,.433129,.781085,.859515,-.255682,.406064,.816,.875335,-.242849,.376509,.851074,.890147,-.228329,.345502,.886473,.903144,-.212491,.31428,.920751,.916618,-.195695,.282994,.954606,.927953,-.178267,.251091,.988402,.937414,-.159549,.219107,1.02141,.946823,-.140022,.18896,1.05167,.954651,-.118154,.158667,1.07819,.959955,-.0946636,.128808,1.1025,.96858,-.0711792,.0973787,1.12391,.97938,-.0475046,.0650965,1.14322,.990498,-.024059,.0326267,1.16077,.999844,-512408e-10,112444e-9,1.17727,.316912,-934977e-11,.425996,695559e-11,.356423,-241372e-9,.479108,179562e-9,.356272,-965292e-9,.478897,71811e-8,.356262,-.00217182,.478894,.00161574,.356265,-.00386092,.478895,.00287261,.356278,-.0060324,.478905,.00448907,.356293,-.00868565,.478914,.00646572,.356346,-.0118207,.478965,.00880438,.356395,-.0154355,.479001,.0115066,.356484,-.019529,.479075,.0145762,.356609,-.0240991,.47918,.018018,.356766,-.0291413,.479305,.0218379,.357009,-.0346498,.479512,.0260454,.357424,-.0405462,.479909,.0306657,.357899,-.0468825,.480337,.0357054,.358424,-.0536887,.480771,.0411728,.359041,-.0609416,.481242,.0470841,.359903,-.0685239,.481943,.0534831,.360932,-.0764883,.482741,.0603795,.362196,-.0848364,.483688,.0678028,.363847,-.0935002,.484947,.0758086,.365972,-.102471,.486588,.0844173,.368741,-.111751,.488787,.0937199,.372146,-.121334,.491405,.103732,.377114,-.131147,.495604,.114608,.38226,-.141213,.499436,.126345,.389609,-.151632,.505334,.139116,.397925,-.162073,.51168,.152995,.407824,-.172819,.518876,.168071,.420014,-.183929,.527639,.184495,.434266,-.195032,.537588,.20232,.447352,-.205792,.544379,.221189,.463726,-.216704,.553422,.241616,.481406,-.227531,.562074,.263298,.498707,-.238017,.568227,.286116,.518039,-.247936,.574473,.3101,.538277,-.257437,.579191,.335401,.561166,-.266829,.584807,.362246,.583189,-.275329,.586476,.390609,.606024,-.28234,.585578,.420998,.632419,-.287924,.584496,.454357,.656128,-.291972,.577766,.488233,.679953,-.29456,.56875,.523248,.704654,-.295816,.558388,.559168,.729016,-.295157,.544826,.595326,.752062,-.292779,.528273,.631864,.773138,-.288681,.508482,.667793,.794869,-.283358,.487341,.704035,.815101,-.27608,.46354,.739925,.834212,-.26767,.438672,.775539,.852368,-.257397,.411239,.810895,.870207,-.245689,.3829,.846472,.884063,-.231452,.351496,.881788,.898284,-.215561,.31895,.917438,.912964,-.198208,.287367,.952422,.924666,-.180426,.254487,.987551,.934429,-.161525,.222226,1.02142,.943485,-.141197,.191143,1.05218,.9521,-.120085,.161112,1.07937,.957876,-.0975881,.130982,1.10403,.966943,-.0726842,.0990553,1.12616,.978313,-.0483705,.0662818,1.14619,.990048,-.0239072,.0329243,1.16413,.999984,461885e-9,-772859e-10,1.18099,.321287,-935049e-11,.455413,659662e-11,.332595,-237513e-9,.471437,167562e-9,.332729,-949964e-9,.471618,670192e-9,.332305,-.00213618,.471028,.00150712,.332326,-.00379765,.471055,.00267959,.332344,-.00593353,.471072,.00418751,.332356,-.00854349,.471077,.00603172,.332403,-.0116268,.471121,.00821362,.332461,-.0151824,.47117,.0107357,.332552,-.0192088,.471251,.0136014,.332657,-.0237024,.47133,.0168152,.332835,-.0286615,.471487,.0203853,.333083,-.0340765,.471708,.0243212,.333547,-.0398563,.47219,.0286518,.333989,-.0460916,.472587,.0333763,.334532,-.0527897,.473054,.0385084,.335167,-.0599284,.473568,.0440638,.33608,-.0673514,.474362,.0500962,.337146,-.0752237,.475231,.0566022,.338462,-.083418,.476282,.0636272,.34014,-.0919382,.477615,.0712153,.342341,-.100741,.479404,.079417,.345088,-.109905,.481618,.0882631,.349049,-.119369,.485081,.0978851,.353939,-.129033,.489317,.108336,.359893,-.139038,.494309,.119698,.366945,-.149411,.499983,.132024,.375814,-.159843,.507185,.145558,.387112,-.170664,.516392,.160433,.40023,-.181897,.526519,.176648,.412555,-.192785,.53423,.193922,.427023,-.203663,.542741,.212662,.443685,-.214695,.552066,.232944,.461499,-.225561,.560762,.254495,.480975,-.236257,.569421,.277531,.501,-.24639,.576101,.301724,.521691,-.256101,.581493,.327112,.543478,-.265289,.585221,.353917,.566094,-.273938,.587614,.381941,.589578,-.281679,.587991,.41172,.614583,-.287655,.585928,.444148,.641813,-.292228,.582092,.478617,.666189,-.295172,.57398,.51397,.690475,-.29648,.561676,.550118,.715543,-.296203,.548758,.586933,.740405,-.293999,.532792,.62384,.762183,-.28998,.512735,.660723,.786069,-.28478,.492402,.69807,.806812,-.277568,.469058,.734422,.826987,-.268951,.443017,.770946,.844588,-.259049,.415501,.80699,.863725,-.2471,.387328,.842107,.879137,-.234157,.356108,.878078,.894634,-.218719,.324315,.914058,.909162,-.201293,.291813,.949922,.92072,-.18267,.258474,.985337,.93158,-.163212,.225593,1.0205,.941238,-.142771,.193986,1.05273,.949293,-.120956,.163392,1.08075,.956226,-.0985743,.132934,1.10559,.96546,-.075118,.101255,1.12823,.977403,-.0497921,.0675441,1.149,.989648,-.0241574,.0334681,1.16765,1.00001,5762e-7,-184807e-9,1.18519,.303474,-916603e-11,.4542,61243e-10,.308894,-232869e-9,.462306,155592e-9,.309426,-931661e-9,.463093,622499e-9,.308643,-.0020949,.461933,.00139979,.308651,-.0037242,.461941,.00248874,.308662,-.00581873,.46195,.00388933,.308687,-.00837818,.461974,.00560247,.308728,-.0114016,.462011,.00762948,.308789,-.0148884,.462067,.00997326,.308882,-.0188369,.462151,.0126375,.309007,-.0232436,.462263,.0156271,.30918,-.0281054,.462417,.0189498,.309442,-.0334065,.462667,.0226167,.309901,-.0390589,.463162,.0266614,.310331,-.0452042,.463555,.0310715,.310858,-.0517735,.464019,.0358698,.311576,-.0587359,.464669,.0410848,.312436,-.0660383,.465406,.0467453,.313526,-.0737266,.466339,.0528718,.314903,-.0817574,.467504,.0595039,.316814,-.090167,.469226,.0666888,.318965,-.0987555,.470981,.0744658,.322077,-.107792,.473814,.082912,.325947,-.117098,.477241,.0920846,.331008,-.126602,.48184,.102137,.337893,-.136619,.488334,.113135,.345106,-.146838,.494415,.12511,.355111,-.157357,.503275,.138356,.365095,-.167955,.510966,.152686,.378344,-.179157,.521508,.16856,.391599,-.190143,.530455,.18561,.407786,-.20123,.541275,.204308,.425294,-.212456,.551784,.224623,.444021,-.223568,.561493,.246172,.463418,-.234154,.569886,.268979,.484077,-.244546,.577116,.293411,.505513,-.254301,.582914,.318936,.527672,-.263564,.587208,.345856,.550565,-.272332,.589277,.374054,.573656,-.280011,.588426,.403276,.59827,-.286924,.587504,.43474,.624731,-.291994,.583401,.468767,.652396,-.295159,.576997,.504411,.67732,-.296954,.565863,.54114,.703147,-.296877,.552316,.57816,.728715,-.295147,.536773,.616124,.752448,-.291275,.51771,.653885,.775169,-.285905,.496087,.691537,.799307,-.279064,.474232,.729251,.819482,-.270294,.447676,.766267,.837659,-.260032,.419656,.802616,.856903,-.248497,.391328,.838583,.873325,-.235252,.360285,.874711,.889788,-.221126,.329215,.91077,.904486,-.204304,.296392,.94653,.917711,-.185562,.262159,.983828,.928969,-.165635,.229142,1.01955,.939707,-.14442,.19673,1.05317,.948167,-.122147,.165095,1.0823,.955222,-.099098,.13451,1.10791,.964401,-.0755332,.102476,1.1312,.976605,-.0513817,.0689667,1.15218,.989085,-.0258499,.034506,1.17129,.999908,617773e-9,-271268e-9,1.18961,.285803,-905752e-11,.452348,572272e-11,.284689,-22732e-8,.450581,143626e-9,.285263,-910214e-9,.451482,575099e-9,.285302,-.00204784,.451553,.00129395,.285318,-.00364057,.451574,.0023006,.28533,-.00568813,.451585,.00359547,.285361,-.00819001,.451618,.00517934,.285397,-.0111458,.45165,.007054,.285447,-.0145536,.451688,.00922167,.285527,-.0184127,.451758,.0116869,.285688,-.0227207,.451929,.0144555,.28584,-.0274712,.452055,.0175341,.286136,-.0326278,.452369,.0209406,.286574,-.0381792,.452853,.0246965,.287012,-.0441879,.453272,.0287996,.287542,-.0506096,.453752,.033268,.288299,-.0573634,.454488,.0381504,.289186,-.0645458,.455294,.0434447,.290302,-.0720405,.456301,.0491973,.291776,-.0799046,.457648,.0554453,.29372,-.088117,.459483,.0622311,.296052,-.0965328,.461571,.0695992,.299563,-.105409,.465085,.077658,.30335,-.114553,.468506,.0864176,.309167,-.123917,.474423,.0961078,.31529,-.13381,.47995,.106643,.324163,-.144021,.488592,.118322,.333272,-.154382,.496461,.131133,.344224,-.165015,.50562,.145208,.357733,-.176168,.516719,.16073,.373046,-.187468,.528513,.177807,.38788,-.198488,.537713,.196072,.405133,-.209545,.547999,.21605,.423845,-.220724,.55759,.237484,.443777,-.231518,.566246,.26039,.464824,-.242035,.574326,.284835,.486635,-.251898,.58037,.310518,.51012,-.261304,.58568,.337678,.535301,-.270384,.590197,.366242,.559193,-.27841,.590569,.395873,.583544,-.285325,.588161,.426857,.608834,-.291113,.584249,.459477,.635753,-.294882,.57763,.494734,.664367,-.297088,.569479,.532023,.689688,-.297364,.555064,.569629,.715732,-.295949,.539522,.608124,.741307,-.292259,.521613,.646231,.764949,-.287063,.49969,.684938,.788599,-.28012,.476747,.723548,.81048,-.27153,.45116,.761135,.831372,-.261289,.424101,.798916,.850092,-.249559,.39443,.835952,.867777,-.236348,.363849,.871606,.884632,-.221569,.332477,.907843,.90047,-.20618,.300667,.944187,.914524,-.188771,.266552,.981371,.926892,-.168362,.232349,1.01841,.937951,-.146761,.199359,1.05308,.947236,-.123813,.1675,1.0839,.954367,-.099984,.136166,1.11047,.963907,-.0759278,.103808,1.13414,.976218,-.0511367,.0697061,1.15575,.988772,-.0267415,.0352529,1.17531,.999888,-520778e-9,289926e-9,1.19389,.263546,-883274e-11,.441896,526783e-11,.262352,-221849e-9,.439889,132311e-9,.262325,-886683e-9,.439848,528824e-9,.26228,-.00199476,.439765,.00118975,.262372,-.00354671,.439922,.00211568,.26239,-.00554141,.439941,.00330652,.262412,-.00797888,.439961,.00476346,.262453,-.0108584,.440002,.00648818,.262528,-.0141788,.440085,.0084835,.262615,-.017938,.440166,.0107533,.262744,-.0221346,.440291,.0133044,.262939,-.026762,.440493,.0161445,.263277,-.0317573,.440889,.0192974,.26368,-.0371832,.441338,.0227699,.264106,-.0430371,.441753,.0265698,.264624,-.0493035,.442227,.0307178,.265378,-.0558669,.442985,.0352616,.266253,-.0628718,.443795,.0401968,.267478,-.0701569,.445008,.04559,.269062,-.077845,.446599,.0514539,.270926,-.0857941,.448349,.0578382,.273693,-.0940773,.451221,.0648363,.276746,-.102704,.454097,.0724389,.281693,-.111735,.459517,.0808744,.287335,-.121004,.46531,.0901551,.29448,-.130734,.472605,.100371,.30257,-.140777,.480251,.111644,.312465,-.15111,.489444,.124111,.324856,-.16189,.500919,.137979,.33774,-.172946,.511317,.153163,.35255,-.184152,.522684,.169817,.367786,-.19522,.53248,.187886,.385474,-.20632,.543326,.207634,.404976,-.217744,.554109,.229165,.425203,-.228691,.563395,.252068,.446704,-.239299,.571565,.276471,.468951,-.249348,.577935,.302323,.493487,-.258933,.584309,.329882,.517861,-.268009,.58773,.358525,.543309,-.276238,.589612,.388585,.569704,-.28356,.589294,.419787,.594871,-.289497,.585137,.452114,.622555,-.294452,.580356,.486466,.651167,-.296918,.57185,.523079,.677332,-.297647,.558428,.5611,.703718,-.296321,.542232,.599592,.730262,-.293339,.524541,.639138,.754304,-.288036,.502691,.677978,.778051,-.281018,.479212,.716537,.801557,-.272414,.454071,.75586,.822559,-.262419,.425952,.794477,.843051,-.250702,.397313,.832664,.86232,-.237264,.366534,.869876,.879044,-.222716,.334816,.906973,.896362,-.206827,.303143,.943558,.910342,-.189659,.269699,.979759,.924119,-.171108,.236411,1.01718,.935374,-.149579,.202224,1.05289,.944295,-.126295,.16989,1.08496,.952227,-.101511,.138089,1.11256,.962041,-.0766392,.105053,1.1375,.97528,-.0511967,.070329,1.15983,.988476,-.025463,.0351268,1.17987,.999962,286808e-10,145564e-10,1.19901,.227089,-841413e-11,.404216,472707e-11,.239725,-215083e-9,.426708,120833e-9,.239904,-860718e-9,.427028,483555e-9,.239911,-.00193661,.427039,.00108806,.239914,-.00344276,.42704,.00193457,.239933,-.00537907,.427064,.00302363,.239944,-.00774482,.427065,.00435604,.239993,-.01054,.427122,.00593398,.240052,-.0137626,.427179,.00775987,.240148,-.0174115,.427279,.00983854,.240278,-.021484,.42741,.0121763,.240472,-.0259729,.427618,.0147827,.240839,-.0308131,.428086,.0176837,.241201,-.0360893,.428482,.0208775,.241626,-.0417723,.428907,.0243821,.242207,-.0478337,.42952,.0282228,.24298,-.0542199,.430332,.0324333,.243881,-.0610015,.431222,.0370252,.245123,-.0680874,.432512,.0420535,.24667,-.0755482,.434088,.0475414,.248779,-.0832873,.436323,.0535542,.251665,-.0913546,.439509,.0601716,.255305,-.0998489,.443478,.0674282,.260049,-.108576,.448713,.0754673,.266192,-.117754,.455524,.084339,.273158,-.127294,.4627,.0941683,.282131,-.137311,.472068,.10515,.293332,-.147736,.483565,.117402,.304667,-.158357,.493702,.130824,.317785,-.169274,.504708,.145724,.333245,-.180595,.517107,.16215,.349843,-.191892,.528849,.180149,.367944,-.203168,.540301,.199746,.387579,-.214443,.551514,.221047,.408247,-.225624,.560906,.243981,.43014,-.236422,.56959,.268513,.452669,-.24654,.576098,.294409,.476196,-.256157,.580925,.322002,.501157,-.265289,.584839,.351052,.527632,-.273671,.587614,.3812,.555754,-.281254,.589119,.412994,.581682,-.287448,.585204,.445498,.608196,-.292614,.579006,.479505,.635661,-.296068,.571297,.514643,.664999,-.297395,.560855,.552213,.691039,-.296645,.544525,.591365,.7179,-.293785,.526535,.630883,.744059,-.289089,.50545,.670932,.76863,-.282239,.482514,.710904,.793273,-.273688,.457246,.750259,.814731,-.26328,.428872,.78948,.835603,-.251526,.399384,.828597,.85489,-.238339,.368811,.866892,.872828,-.223607,.336617,.90563,.889462,-.207538,.303997,.943538,.904929,-.190297,.270812,.980591,.919101,-.172034,.237453,1.01935,.930536,-.152058,.204431,1.05498,.941223,-.129515,.172495,1.08717,.94982,-.104263,.140175,1.11551,.960592,-.0781944,.106465,1.14098,.974629,-.051688,.0711592,1.16418,.98811,-.0253929,.0354432,1.18465,1.00004,804378e-9,-330876e-9,1.20462,.214668,-821282e-11,.406619,433582e-11,.218053,-208144e-9,.413025,109887e-9,.217987,-832212e-9,.412901,439362e-9,.217971,-.00187246,.412876,988623e-9,.217968,-.00332855,.41286,.00175772,.217985,-.00520055,.412882,.00274729,.218014,-.00748814,.412916,.00395842,.218054,-.0101901,.412957,.00539274,.218106,-.0133057,.413005,.00705348,.218217,-.0168342,.413139,.00894581,.218338,-.0207707,.413258,.0110754,.21855,-.0251001,.413509,.0134551,.218913,-.0297861,.413992,.0161081,.219265,-.0348956,.414383,.0190307,.219696,-.0403909,.414839,.0222458,.220329,-.0462003,.415567,.025792,.220989,-.0524208,.41621,.0296637,.222027,-.058948,.417385,.0339323,.223301,-.0658208,.418779,.0386055,.224988,-.0730347,.420665,.0437355,.227211,-.0805274,.423198,.0493844,.230131,-.088395,.426566,.0556135,.233908,-.0966208,.43091,.0624829,.239092,-.105223,.437148,.0701636,.245315,-.11424,.444302,.0786949,.253166,-.12368,.453262,.0882382,.262374,-.133569,.463211,.0988682,.273145,-.143836,.474271,.110727,.285512,-.154577,.4863,.123945,.299512,-.165501,.498817,.138581,.314287,-.176698,.510341,.154676,.331083,-.188066,.522583,.172459,.349615,-.199597,.534879,.191979,.369318,-.210843,.546083,.21309,.390377,-.222068,.5562,.235998,.412411,-.233059,.564704,.260518,.435715,-.24357,.572314,.286795,.461196,-.253356,.579395,.314559,.485587,-.262362,.581985,.343581,.511908,-.270895,.584347,.374367,.539798,-.278452,.58505,.406015,.567974,-.284877,.583344,.439168,.594303,-.290124,.577348,.473005,.622951,-.294183,.570751,.508534,.652404,-.296389,.561541,.544764,.679291,-.296605,.546426,.582927,.706437,-.294095,.528599,.622681,.734485,-.28978,.508676,.663567,.758841,-.283363,.484768,.704092,.78537,-.275015,.460434,.745101,.807315,-.264689,.432166,.784712,.8271,-.252597,.401807,.824241,.849191,-.239154,.371458,.863803,.867046,-.224451,.338873,.903063,.8852,-.208342,.306175,.942763,.901771,-.190684,.272759,.981559,.915958,-.172105,.239306,1.02048,.928046,-.152214,.206071,1.05765,.939961,-.130247,.17367,1.08999,.948711,-.10672,.142201,1.11829,.959305,-.0808688,.108454,1.14467,.973009,-.0539145,.0728109,1.16839,.987631,-.0262947,.0360625,1.19004,.999978,.00132758,-559424e-9,1.21058,.193925,-793421e-11,.391974,392537e-11,.196746,-200315e-9,.397675,991033e-10,.19667,-801099e-9,.397521,396342e-9,.196633,-.00180246,.397445,891829e-9,.196654,-.00320443,.397482,.00158582,.196659,-.00500647,.39748,.00247867,.196683,-.0072086,.397506,.00357167,.196728,-.00981001,.397562,.00486675,.196792,-.0128096,.397633,.00636707,.19689,-.0162055,.397746,.00807752,.197017,-.0199943,.397884,.0100052,.19729,-.024139,.39827,.0121691,.197583,-.0286671,.398639,.0145755,.197927,-.0335858,.399034,.0172355,.198383,-.0388806,.399554,.0201718,.199002,-.0444736,.400289,.0234194,.199739,-.0504583,.401111,.026984,.200784,-.056729,.402349,.0309217,.202075,-.0633643,.403841,.0352496,.203898,-.0703247,.406076,.0400313,.206199,-.0775565,.408841,.0453282,.209252,-.085184,.41259,.0511794,.213638,-.0931994,.418288,.0577459,.21881,-.101617,.424681,.0650508,.225642,-.11052,.433429,.0732759,.233717,-.119772,.442897,.0824683,.242823,-.129505,.452888,.0927484,.254772,-.139906,.466407,.104417,.266603,-.150402,.477413,.117211,.28073,-.161395,.490519,.131598,.295399,-.172465,.50201,.147407,.312705,-.183982,.515311,.165031,.331335,-.195532,.52786,.184336,.351037,-.206971,.5392,.205361,.372175,-.218117,.54941,.228043,.394548,-.229327,.558642,.25267,.419598,-.240052,.567861,.279071,.443922,-.249937,.573332,.306882,.471495,-.259407,.58013,.33661,.496769,-.267749,.580564,.367328,.524951,-.275524,.581696,.399753,.55318,-.282148,.579885,.433134,.581577,-.287533,.575471,.467534,.609231,-.291612,.567445,.502943,.637478,-.293911,.557657,.53871,.667795,-.295096,.546535,.576568,.694272,-.294073,.529561,.614929,.722937,-.290386,.510561,.655909,.749682,-.284481,.487846,.697663,.774754,-.276188,.462487,.738515,.799301,-.266215,.43481,.779802,.820762,-.254116,.404879,.820045,.843231,-.240393,.374559,.860294,.861857,-.225503,.341582,.900965,.880815,-.209382,.308778,.941727,.89766,-.19155,.275232,.980916,.912926,-.172346,.240938,1.02162,.926391,-.151799,.207223,1.0597,.938429,-.129968,.17484,1.09291,.947834,-.10651,.142984,1.12248,.958432,-.0824098,.109902,1.149,.972402,-.0565242,.0744454,1.1733,.987191,-.028427,.0373794,1.19538,.999975,385685e-10,-4203e-8,1.21676,.178114,-766075e-11,.385418,354027e-11,.176074,-191966e-9,.381002,887135e-10,.17601,-767549e-9,.380861,354715e-9,.17598,-.00172696,.380798,798168e-9,.175994,-.00307012,.380824,.00141928,.176017,-.00479684,.380858,.00221859,.176019,-.00690648,.380839,.00319714,.176072,-.00939888,.380913,.0043572,.176131,-.0122726,.380979,.005702,.176239,-.0155264,.38112,.00723689,.176371,-.0191551,.381272,.00896907,.176638,-.023117,.381669,.0109194,.176912,-.0274633,.382015,.0130903,.177279,-.032173,.382476,.0154949,.17774,-.0372219,.383041,.0181669,.178344,-.0426132,.38378,.0211209,.179153,-.0483309,.384773,.0243899,.180197,-.0543447,.386076,.0280062,.181581,-.0607122,.387809,.032004,.18344,-.0673855,.390205,.036453,.186139,-.0743989,.393944,.0414162,.189432,-.0817731,.39832,.0469394,.193795,-.0895464,.404188,.0531442,.199641,-.0978264,.4121,.0601374,.206679,-.106499,.421425,.0680078,.214865,-.115654,.431504,.076919,.224406,-.125268,.442526,.0868835,.235876,-.135475,.455465,.0981875,.248335,-.146023,.4681,.110759,.262868,-.157016,.482069,.124885,.278962,-.168245,.496182,.140645,.295082,-.17958,.507401,.157838,.313738,-.191227,.520252,.17695,.333573,-.202718,.531708,.197817,.356433,-.214424,.544509,.220785,.378853,-.225492,.55373,.245306,.402717,-.236236,.561348,.271593,.428375,-.246568,.568538,.299776,.454724,-.255941,.573462,.329433,.482291,-.264511,.576356,.360598,.509706,-.272129,.576446,.393204,.538805,-.278979,.575298,.427227,.568919,-.284528,.572154,.462157,.596804,-.288801,.564691,.497997,.625987,-.291334,.555134,.534467,.656414,-.292722,.545051,.571736,.683916,-.292185,.528813,.610158,.711809,-.290043,.51106,.649061,.739547,-.285246,.490103,.690081,.766914,-.277647,.465523,.732554,.791375,-.267603,.437718,.773982,.814772,-.256109,.40882,.81609,.836691,-.242281,.377823,.856849,.856984,-.227155,.34496,.898363,.876332,-.210395,.311335,.939471,.894988,-.192612,.277703,.980799,.911113,-.173236,.243019,1.02215,.924092,-.152258,.209037,1.06139,.936828,-.129575,.175909,1.09635,.946869,-.10594,.143852,1.12707,.958284,-.081318,.110289,1.15419,.972325,-.0556133,.0747232,1.17909,.986878,-.0297899,.0383149,1.20163,.999936,-.00197169,912402e-9,1.22338,.151174,-720365e-11,.351531,309789e-11,.155594,-18279e-8,.361806,78608e-9,.156099,-731569e-9,.362982,314615e-9,.156053,-.00164578,.362869,707845e-9,.156093,-.0029261,.362961,.00125884,.156099,-.00457155,.362959,.00196783,.15612,-.00658224,.362982,.00283622,.156168,-.00895774,.363048,.00386625,.156221,-.0116962,.363101,.00506109,.156324,-.0147973,.363241,.00642675,.156476,-.0182503,.363448,.00797175,.156731,-.0220266,.36384,.00971484,.156994,-.026176,.364179,.0116575,.157341,-.0306701,.36462,.0138207,.157867,-.0354591,.365364,.0162356,.15846,-.0406141,.366111,.0189092,.159308,-.0460519,.367248,.021885,.160426,-.0518096,.368767,.0252004,.161877,-.0578906,.370745,.0288825,.163995,-.0642812,.373831,.0330139,.16655,-.0710067,.377366,.0376283,.170237,-.0781522,.382799,.0428493,.175096,-.0857172,.389915,.0487324,.181069,-.0938025,.398487,.0554214,.188487,-.102363,.408799,.0630189,.197029,-.111343,.419991,.071634,.206684,-.120812,.431455,.0812797,.218698,-.131033,.445746,.0923651,.230726,-.141373,.457471,.104545,.245516,-.152387,.472388,.118449,.261551,-.163628,.486671,.133923,.277437,-.174814,.49762,.150849,.296662,-.186713,.51162,.169924,.31795,-.198513,.525435,.190848,.339422,-.210119,.536267,.213504,.362143,-.221354,.545982,.237947,.387198,-.23224,.555364,.264427,.412349,-.24257,.561489,.292519,.439274,-.252284,.566903,.322561,.466779,-.261023,.569614,.353952,.496011,-.26899,.571589,.387278,.524964,-.275498,.570325,.421356,.556518,-.281449,.568792,.457314,.584363,-.285526,.560268,.493199,.614214,-.28844,.55205,.530276,.645684,-.289777,.541906,.56855,.673446,-.289722,.526464,.606927,.701924,-.287792,.509872,.645945,.73037,-.284315,.490649,.685564,.757405,-.278804,.467964,.726511,.784025,-.269543,.441468,.768601,.808255,-.258117,.41216,.811321,.830739,-.244728,.380606,.853496,.851914,-.229428,.348111,.895374,.872586,-.212508,.314732,.937674,.891581,-.194025,.280338,.979869,.907641,-.174711,.245203,1.02253,.922233,-.153509,.21077,1.06371,.935878,-.130418,.177399,1.09972,.946338,-.105558,.144507,1.13124,.957265,-.080059,.110508,1.15973,.971668,-.0539766,.0742311,1.18515,.9866,-.0277101,.0375224,1.20858,1.00021,-515531e-9,135226e-9,1.23135,.137468,-686011e-11,.345041,273315e-11,.13703,-173378e-9,.343936,690761e-10,.136986,-693048e-9,.34383,276126e-9,.136964,-.00155931,.343761,621337e-9,.137003,-.00277211,.343863,.00110494,.137012,-.00433103,.343868,.00172744,.137043,-.00623606,.343916,.00249022,.13709,-.0084868,.343986,.00339559,.137145,-.0110814,.344045,.00444687,.137242,-.0140187,.344177,.00565007,.137431,-.0172713,.344491,.00701868,.137644,-.0208605,.344805,.00856042,.13791,-.024792,.345172,.0102863,.138295,-.0290461,.345734,.0122185,.138764,-.0335957,.346371,.0143771,.139415,-.038467,.347298,.0167894,.140272,-.0436176,.348527,.0194895,.141457,-.0491016,.350276,.0225043,.14303,-.0548764,.352646,.0258962,.145289,-.0610096,.356206,.0297168,.148502,-.0674777,.361488,.0340562,.152188,-.074345,.367103,.0389534,.157359,-.0817442,.375247,.0445541,.16379,-.0896334,.385064,.0509535,.171376,-.098005,.396082,.0582611,.179901,-.106817,.407418,.06654,.189892,-.116239,.420031,.075994,.201838,-.12627,.434321,.0867239,.214311,-.136701,.447631,.0987517,.228902,-.147616,.462046,.112353,.245107,-.158871,.476942,.127605,.262292,-.170261,.490285,.144469,.281215,-.182017,.503783,.163282,.301058,-.193729,.515505,.183873,.322752,-.205512,.52682,.206466,.347547,-.217214,.539473,.231194,.370969,-.227966,.546625,.257288,.397533,-.238555,.55472,.285789,.42398,-.248278,.559468,.315746,.452928,-.257422,.564095,.347724,.482121,-.265306,.565426,.380922,.510438,-.272043,.563205,.415639,.541188,-.277614,.561087,.451702,.571667,-.281927,.554922,.48845,.602432,-.285015,.546838,.526442,.634126,-.286512,.537415,.564896,.662816,-.286388,.522906,.604037,.692411,-.284734,.507003,.643795,.720946,-.281297,.488398,.68298,.748293,-.276262,.466353,.723466,.776931,-.269978,.443573,.764565,.801065,-.260305,.415279,.805838,.825843,-.247426,.384773,.849985,.84807,-.232437,.352555,.893174,.869122,-.215806,.318642,.936564,.888963,-.197307,.28381,.980253,.905547,-.177203,.247888,1.02463,.918554,-.155542,.212904,1.06714,.931395,-.131948,.1787,1.10451,.941749,-.106723,.145902,1.13694,.954551,-.0804939,.111193,1.1666,.970279,-.0534239,.0744697,1.19249,.986117,-.0257452,.0368788,1.21665,.999938,.00190634,-.0010291,1.23981,.118493,-647439e-11,.32272,23772e-10,.118765,-163023e-9,.323456,598573e-10,.118772,-65212e-8,.323477,239447e-9,.118843,-.00146741,.323657,538881e-9,.118804,-.00260846,.323553,95826e-8,.118826,-.00407576,.323595,.00149845,.118846,-.00586826,.323617,.00216047,.118886,-.00798578,.32367,.00294679,.118947,-.0104273,.323753,.00386124,.119055,-.0131909,.323922,.00490999,.119241,-.0162444,.324251,.00610804,.11944,-.0196339,.324544,.00745805,.119739,-.0233378,.325026,.00897805,.12011,-.0273179,.325586,.0106895,.120571,-.0316143,.326231,.0126073,.12124,-.0361939,.327264,.0147654,.122162,-.0410511,.328733,.0172001,.123378,-.0462233,.330659,.0199375,.125183,-.0517109,.333754,.0230498,.127832,-.0575652,.338507,.026597,.130909,-.0637441,.343666,.0306345,.135221,-.0704302,.351063,.035273,.14082,-.0776364,.360604,.0406137,.146781,-.0852293,.369638,.0466788,.155121,-.0935351,.3827,.0537628,.16398,-.102234,.39522,.0617985,.173926,-.111465,.40793,.07097,.185137,-.121296,.42105,.0813426,.19826,-.13169,.435735,.0931596,.212938,-.142614,.450932,.106547,.229046,-.153884,.465726,.121575,.246246,-.165382,.479461,.138286,.264637,-.176806,.492106,.15666,.284959,-.188793,.504774,.17728,.308157,-.200763,.518805,.19988,.330951,-.21239,.528231,.224293,.3549,-.223521,.536376,.250541,.381502,-.234169,.544846,.278902,.409529,-.244077,.551717,.309227,.437523,-.253363,.55517,.341426,.467624,-.261659,.557772,.37518,.497268,-.268498,.556442,.41007,.528294,-.274018,.553915,.446445,.559053,-.278169,.549153,.483779,.589329,-.281229,.539878,.522249,.622503,-.282902,.53162,.561754,.652382,-.282815,.518119,.601544,.681847,-.281247,.502187,.641574,.712285,-.277986,.484824,.682633,.740094,-.273017,.463483,.723426,.768478,-.266692,.441299,.763747,.794556,-.258358,.415238,.805565,.819408,-.248807,.386912,.847254,.843411,-.236214,.356165,.891091,.862397,-.219794,.320562,.936174,.883113,-.201768,.285322,.982562,.90023,-.181672,.249713,1.02862,.915192,-.159279,.214546,1.07163,.928458,-.134725,.180285,1.10995,.94069,-.10913,.147119,1.14354,.953409,-.0821315,.112492,1.17372,.969537,-.0542677,.0752014,1.20043,.985612,-.0259096,.0370361,1.22528,.999835,.00298198,-.00151801,1.24959,.10097,-602574e-11,.300277,202619e-11,.101577,-152164e-9,.302077,511662e-10,.101572,-608889e-9,.302066,204751e-9,.101566,-.00136997,.302047,460753e-9,.101592,-.00243557,.302114,819497e-9,.101608,-.0038053,.30214,.00128154,.101627,-.00547906,.30216,.0018483,.101669,-.00745647,.302224,.00252223,.101732,-.00973615,.302318,.00330716,.101844,-.0123097,.302513,.00421061,.102025,-.0151681,.30285,.00524481,.102224,-.0183334,.303166,.0064154,.102515,-.0217819,.303654,.00774063,.102886,-.0255067,.304243,.0092398,.103395,-.029514,.305089,.0109339,.104109,-.0337912,.306301,.0128561,.105074,-.0383565,.30798,.0150338,.10654,-.0432132,.310726,.0175228,.108478,-.0484244,.314351,.0203648,.111015,-.0539339,.319032,.0236325,.114682,-.0598885,.32605,.0274188,.11911,-.0663375,.334109,.0317905,.124736,-.0733011,.344013,.0368502,.131479,-.0807744,.355358,.0427104,.139283,-.0888204,.367614,.0494788,.148054,-.0973394,.380072,.0572367,.159037,-.10665,.395678,.0662704,.169794,-.116221,.40795,.0763192,.18314,-.126632,.423546,.087956,.197515,-.137383,.438213,.101042,.213514,-.148641,.453248,.115827,.23065,-.160117,.46688,.132283,.249148,-.171807,.479962,.150644,.270219,-.183695,.494618,.171073,.292338,-.195574,.506937,.193378,.314999,-.207205,.516463,.217585,.340991,-.218955,.528123,.24428,.367982,-.229917,.537025,.272784,.39432,-.239737,.541627,.302742,.423364,-.249048,.546466,.335112,.453751,-.257329,.549466,.369032,.48416,-.264623,.549503,.404577,.515262,-.270411,.547008,.441337,.547036,-.274581,.542249,.479162,.576614,-.277266,.533015,.517904,.611143,-.279144,.525512,.558508,.640989,-.279001,.51154,.598995,.671182,-.277324,.495641,.639935,.700848,-.273908,.477526,.681017,.729862,-.269063,.457955,.722764,.758273,-.262282,.434846,.764349,.784121,-.254281,.409203,.806206,.809798,-.24505,.382694,.848617,.834953,-.233861,.354034,.892445,.856817,-.221308,.321764,.936263,.877609,-.205996,.288118,.982401,.897489,-.186702,.253277,1.02975,.913792,-.164618,.217963,1.07488,.92785,-.140023,.183221,1.11487,.940378,-.11328,.149385,1.14947,.95273,-.0853958,.114152,1.1807,.969059,-.0568698,.0769845,1.20912,.985574,-.0276502,.0381186,1.23498,.999943,.00239052,-.00126861,1.25987,.0852715,-560067e-11,.279021,171162e-11,.0854143,-140871e-9,.279483,430516e-10,.0854191,-563385e-9,.2795,172184e-9,.0854188,-.00126753,.279493,387464e-9,.0854229,-.00225337,.279501,68918e-8,.0854443,-.00352086,.279549,.00107803,.0854697,-.00506962,.279591,.00155536,.0855093,-.00689873,.279652,.00212354,.0855724,-.00900821,.279752,.00278703,.0856991,-.0113799,.280011,.0035551,.085855,-.0140314,.280297,.00443449,.0860682,-.016963,.280682,.00543636,.086344,-.0201438,.281159,.0065788,.0867426,-.0235999,.281886,.00787977,.087239,-.0273069,.282745,.0093606,.0879815,-.031269,.284139,.011056,.0891258,-.035531,.28647,.0130065,.0906909,-.0400947,.289708,.0152495,.0927624,-.0449638,.293904,.0178454,.0958376,-.0502427,.300471,.0208915,.0995827,-.0559514,.30806,.0244247,.104526,-.0622152,.317874,.0285721,.110532,-.0690046,.329332,.0334227,.117385,-.0763068,.341217,.0390466,.12522,-.084184,.353968,.0455786,.134037,-.0925248,.366797,.0530773,.144014,-.101487,.380209,.0617424,.156013,-.111273,.395956,.071777,.168872,-.121431,.41053,.0830905,.183089,-.132105,.425073,.0959341,.198763,-.143286,.439833,.110448,.216159,-.154841,.454507,.126769,.234859,-.166588,.468368,.14495,.255879,-.178626,.482846,.165233,.27677,-.190218,.493489,.187217,.301184,-.202227,.506549,.211659,.325852,-.213764,.5158,.237922,.352824,-.22487,.525442,.26632,.380882,-.235246,.532487,.296691,.410137,-.244847,.537703,.329179,.439787,-.253122,.540361,.363135,.472291,-.260517,.542734,.399222,.501856,-.266519,.538826,.436352,.534816,-.270905,.535152,.474505,.565069,-.273826,.525979,.513988,.597154,-.275333,.516394,.554852,.630473,-.275314,.506206,.596592,.660574,-.273323,.489769,.638117,.692015,-.270008,.472578,.680457,.720647,-.265001,.452134,.723008,.750528,-.258311,.430344,.765954,.777568,-.250046,.405624,.809012,.80387,-.240114,.378339,.852425,.828439,-.228737,.349877,.895346,.851472,-.216632,.318968,.940695,.873906,-.202782,.287489,.987235,.89467,-.187059,.254394,1.03348,.912281,-.168818,.221294,1.07812,.927358,-.146494,.18675,1.11928,.940385,-.120009,.152322,1.15609,.952672,-.0917183,.117514,1.18875,.968496,-.0620321,.0797405,1.21821,.985236,-.0314945,.0402383,1.24523,.99998,-575153e-9,110644e-9,1.27133,.0702429,-512222e-11,.255273,140947e-11,.0702981,-128826e-9,.255469,354488e-10,.0703691,-515562e-9,.255727,141874e-9,.0703805,-.00116,.255754,31929e-8,.0703961,-.00206224,.255813,567999e-9,.0704102,-.00322223,.255839,88871e-8,.0704298,-.00463928,.255863,.00128272,.0704759,-.00631375,.255953,.00175283,.0705434,-.00824317,.256079,.00230342,.0706693,-.010412,.25636,.0029443,.0708189,-.0128439,.256647,.00368031,.0710364,-.0155177,.257084,.00452614,.0713223,-.0184374,.257637,.00549706,.0717182,-.0216002,.258416,.00661246,.072321,-.0249966,.259699,.00790147,.0731446,-.0286566,.261475,.0093884,.0743352,-.0325888,.264132,.0111186,.0760676,-.036843,.26815,.013145,.078454,-.0414292,.273636,.0155251,.0818618,-.0464634,.281653,.0183525,.0857382,-.0519478,.289992,.0216642,.0908131,-.0579836,.30066,.0255956,.0967512,-.0645124,.312204,.0301954,.103717,-.0716505,.325001,.0356017,.111596,-.0793232,.338129,.041896,.120933,-.087645,.352853,.0492447,.130787,-.096492,.366192,.0576749,.142311,-.105973,.380864,.0673969,.155344,-.116182,.396575,.0785899,.169535,-.126815,.411443,.0912377,.185173,-.138015,.426256,.105607,.201755,-.149325,.439607,.121551,.221334,-.161207,.455467,.139608,.241461,-.173162,.469096,.159591,.26294,-.18504,.481014,.18156,.286776,-.196881,.493291,.205781,.311596,-.208311,.503556,.231819,.338667,-.219671,.513268,.260274,.366021,-.230451,.519414,.290862,.395875,-.240131,.526766,.323196,.425564,-.248566,.52905,.357071,.457094,-.256195,.530796,.393262,.488286,-.262331,.528703,.430797,.522291,-.267141,.52727,.470231,.554172,-.270411,.519848,.510477,.586427,-.271986,.510307,.551594,.619638,-.27192,.499158,.593849,.650656,-.269817,.483852,.636314,.68284,-.266267,.467515,.679679,.714356,-.26113,.44931,.723884,.742717,-.254067,.425789,.767245,.770894,-.245652,.401144,.811819,.797358,-.235554,.374224,.856315,.823377,-.223896,.346167,.901077,.847456,-.210865,.316056,.946502,.870697,-.196574,.284503,.993711,.891068,-.180814,.251628,1.04134,.909267,-.163314,.219065,1.08609,.925653,-.143304,.186446,1.12702,.940017,-.121322,.153416,1.16371,.952398,-.0973872,.120334,1.19712,.967568,-.0698785,.08352,1.22791,.984772,-.0390031,.0439209,1.25672,1.00026,-.0070087,.00315668,1.28428,.0556653,-459654e-11,.227325,112556e-11,.0565238,-116382e-9,.230826,284985e-10,.0565717,-465666e-9,.231026,114036e-9,.0565859,-.00104773,.231079,256656e-9,.0565761,-.00186255,.231025,45663e-8,.0565913,-.00291002,.231058,714664e-9,.0566108,-.00418998,.231085,.00103224,.0566532,-.00570206,.231169,.00141202,.0567473,-.00743666,.231417,.00186018,.0568567,-.00940298,.231661,.00238264,.0569859,-.0115991,.231895,.00298699,.0572221,-.0140096,.232456,.00368957,.057519,-.0166508,.233096,.00450303,.0579534,-.01951,.234094,.00544945,.0585922,-.0225991,.235629,.00655564,.0595647,-.0259416,.238106,.00785724,.0609109,-.0295661,.241557,.00939127,.0628751,-.0335126,.246652,.0112198,.0656908,-.0378604,.254091,.0134168,.0691347,-.0426543,.262666,.0160374,.0732165,-.0478967,.272029,.0191514,.0782863,-.0536716,.283007,.0228597,.0843973,-.0600683,.295732,.0272829,.0913598,-.0670095,.308779,.032484,.0994407,-.0745516,.322886,.0385886,.108189,-.082712,.336408,.0457133,.118574,-.0914927,.351692,.0539832,.129989,-.100854,.366502,.0635162,.142722,-.110837,.381675,.0744386,.156654,-.121353,.3963,.0868483,.172151,-.132414,.411477,.100963,.188712,-.143809,.42508,.116795,.208093,-.155765,.441328,.134715,.227936,-.167608,.454328,.154396,.249495,-.179579,.467235,.176179,.27362,-.191488,.480248,.200193,.296371,-.202618,.487886,.225775,.324234,-.214133,.499632,.25441,.353049,-.225212,.509532,.285077,.381785,-.234875,.514265,.317047,.414038,-.244205,.521282,.351874,.445251,-.252145,.522931,.388279,.476819,-.258433,.520947,.425825,.509209,-.263411,.517669,.465104,.542759,-.266732,.512841,.505741,.574822,-.268263,.503317,.547611,.609324,-.268489,.493035,.590953,.641772,-.266941,.478816,.63488,.674049,-.263297,.462863,.679072,.705071,-.257618,.442931,.723487,.734709,-.250625,.421299,.768708,.763704,-.24179,.397085,.814375,.791818,-.231115,.370577,.859907,.817439,-.21922,.34232,.906715,.843202,-.205658,.312627,.953943,.866639,-.190563,.280933,1.00185,.888129,-.173978,.248393,1.05105,.907239,-.155485,.216007,1.09704,.923893,-.134782,.183233,1.13857,.938882,-.11249,.150376,1.17539,.952464,-.0890706,.117177,1.20924,.968529,-.0646523,.0813095,1.24055,.984763,-.038606,.0439378,1.27018,1.00053,-.01238,.00598668,1.29873,.0437928,-409594e-11,.204012,879224e-12,.0440166,-103395e-9,.205049,221946e-10,.0440529,-413633e-9,.205225,887981e-10,.0440493,-930594e-9,.2052,199858e-9,.0439884,-.00165352,.204901,355495e-9,.0440716,-.0025849,.205255,556983e-9,.0440968,-.00372222,.205311,805326e-9,.0441359,-.00506478,.205391,.00110333,.0442231,-.00660384,.205638,.00145768,.0443254,-.00835246,.205877,.00187275,.0444832,-.0102992,.20627,.00235938,.0447001,-.0124449,.206796,.0029299,.0450168,-.0147935,.207593,.0036005,.0454816,-.017336,.208819,.00439246,.0462446,-.0201156,.211036,.00533864,.0473694,-.0231568,.214388,.00646984,.0490191,-.0264941,.219357,.00783856,.0512776,-.030184,.226061,.00950182,.0541279,-.0342661,.234094,.0115156,.0578989,-.0388539,.244297,.0139687,.0620835,-.0438735,.254457,.0169015,.0673497,-.04951,.266706,.0204554,.0731759,-.0556263,.278753,.0246606,.0803937,-.0624585,.29309,.0297126,.0879287,-.0697556,.305856,.0355868,.0970669,-.0778795,.321059,.0425768,.106508,-.0863541,.333873,.05056,.11776,-.0955935,.349008,.0598972,.130081,-.105438,.363776,.0706314,.144454,-.115899,.380112,.0828822,.1596,-.126827,.394843,.0967611,.176097,-.138161,.409033,.112381,.194726,-.149904,.424257,.129952,.213944,-.161675,.436945,.149333,.235516,-.173659,.450176,.170892,.260564,-.185963,.466305,.194984,.285183,-.197582,.477328,.220805,.311095,-.208697,.486566,.248694,.338924,-.219519,.494811,.279015,.369757,-.229766,.504065,.311725,.3996,-.238879,.507909,.345844,.430484,-.246802,.509805,.381749,.46413,-.253924,.511436,.420251,.497077,-.259319,.508787,.459957,.530434,-.263297,.50394,.501356,.565725,-.265619,.49804,.544252,.599254,-.265842,.487346,.587856,.631251,-.263978,.472975,.631969,.663972,-.26043,.457135,.677471,.697724,-.255358,.439844,.723744,.727725,-.248308,.417872,.770653,.756417,-.239181,.39273,.817357,.785419,-.22814,.367839,.864221,.81266,-.215681,.339449,.912701,.839391,-.201623,.309279,.962419,.86366,-.185624,.278029,1.0122,.885028,-.16797,.245294,1.06186,.904639,-.148336,.212689,1.10934,.922048,-.12637,.179616,1.15063,.936952,-.102928,.146749,1.18885,.951895,-.0785268,.112733,1.22352,.967198,-.0530153,.0760056,1.25681,.984405,-.02649,.0383183,1.28762,1.00021,70019e-8,-20039e-8,1.31656,.0325964,-355447e-11,.176706,655682e-12,.0329333,-899174e-10,.178527,165869e-10,.0329181,-359637e-9,.178453,663498e-10,.0329085,-808991e-9,.178383,149332e-9,.0329181,-.00143826,.178394,265873e-9,.0329425,-.00224678,.178517,416597e-9,.0329511,-.00323575,.17849,603299e-9,.033011,-.00439875,.178695,829422e-9,.0330733,-.00574059,.178843,.00109908,.0331857,-.00725896,.179176,.00141933,.0333445,-.00895289,.179618,.0017999,.0335674,-.0108219,.180238,.00225316,.033939,-.0128687,.181417,.00279765,.0345239,-.015114,.183395,.0034564,.0354458,-.017596,.186616,.00425864,.0368313,-.0203524,.191547,.00524936,.0386115,-.0234105,.197508,.00647033,.0410303,-.0268509,.205395,.00798121,.0442245,-.0307481,.215365,.0098557,.0478659,-.0350863,.225595,.0121417,.0522416,-.0399506,.236946,.0149385,.0574513,-.045357,.249442,.0183189,.0631208,-.0512863,.261222,.0223644,.0701124,-.0579273,.275418,.0272418,.0777331,-.0650652,.288989,.0329458,.0862709,-.0728813,.302546,.0396819,.096103,-.081363,.317164,.04757,.106976,-.0904463,.331733,.0567012,.119175,-.100105,.34661,.067202,.132919,-.110375,.362249,.0792588,.147727,-.121115,.376978,.0928672,.163618,-.132299,.390681,.108228,.182234,-.143887,.406571,.125502,.201809,-.155827,.42042,.144836,.225041,-.168357,.438411,.166706,.247621,-.18004,.450368,.189909,.27097,-.191536,.460083,.215251,.296658,-.203024,.469765,.243164,.325892,-.214056,.481837,.273388,.35406,-.224104,.487474,.305344,.384372,-.233489,.492773,.339741,.41749,-.241874,.498451,.376287,.45013,-.248834,.499632,.414195,.481285,-.254658,.495233,.454077,.519183,-.259367,.496401,.496352,.551544,-.261818,.487686,.538798,.587349,-.262964,.479453,.583626,.621679,-.262128,.467709,.629451,.654991,-.258998,.452123,.67566,.686873,-.254119,.433495,.723248,.719801,-.246946,.413657,.771156,.750355,-.237709,.390366,.81989,.780033,-.226549,.364947,.868601,.809254,-.214186,.337256,.920034,.836576,-.199639,.307395,.971706,.861774,-.183169,.275431,1.02479,.885707,-.165111,.243431,1.07837,.904742,-.144363,.210921,1.12783,.915604,-.121305,.17647,1.17254,.930959,-.0962119,.143106,1.21012,.948404,-.069969,.108112,1.24474,.967012,-.0427586,.0708478,1.27718,.984183,-.0147043,.032335,1.3083,.999577,.0142165,-.00726867,1.3382,.0229227,-299799e-11,.148623,462391e-12,.0232194,-758796e-10,.15054,117033e-10,.0232315,-303636e-9,.15063,468397e-10,.0232354,-683189e-9,.150624,105472e-9,.0232092,-.0012136,.150445,187744e-9,.0232523,-.00189765,.150679,294847e-9,.0232828,-.00273247,.150789,428013e-9,.0233371,-.00371287,.150995,591134e-9,.0234015,-.00484794,.15118,787642e-9,.023514,-.00612877,.151562,.00102547,.023679,-.00756125,.152116,.00131351,.0239559,-.00914651,.153162,.00166594,.0244334,-.010904,.155133,.00210182,.025139,-.0128615,.158035,.00264406,.0262598,-.0150628,.162751,.00332923,.0277875,-.0175532,.168944,.00419773,.0298472,-.0203981,.176835,.00530034,.0325444,-.023655,.186686,.00669777,.0355581,-.0272982,.196248,.00842661,.0392841,-.0314457,.207352,.0105854,.0436815,-.0361157,.219279,.0132458,.0485272,-.0412932,.230728,.0164736,.0541574,-.0470337,.242994,.0203715,.0609479,-.0535002,.257042,.0250953,.0685228,-.0605409,.27102,.0306856,.0768042,-.0680553,.28406,.037193,.0864844,-.0765011,.299186,.0449795,.0969415,-.0852674,.3132,.0538316,.108478,-.0947333,.327138,.0641149,.121705,-.10481,.342345,.0759185,.136743,-.115474,.358472,.0894116,.152986,-.126536,.374067,.104562,.170397,-.138061,.388267,.121632,.191392,-.150203,.406467,.140996,.211566,-.161751,.418641,.161696,.233567,-.173407,.430418,.184557,.257769,-.185397,.44277,.210092,.28531,-.197048,.457191,.237827,.311726,-.20784,.464712,.267253,.340537,-.218345,.472539,.299332,.372921,-.228306,.482331,.333988,.402924,-.236665,.484378,.369722,.434475,-.244097,.484717,.407836,.469736,-.250547,.487093,.448465,.505045,-.25511,.485575,.490263,.540262,-.258444,.481225,.534495,.576347,-.259903,.473481,.579451,.608656,-.259572,.4603,.625604,.646679,-.257908,.450341,.674511,.679902,-.253663,.431561,.723269,.714159,-.247419,.412684,.773263,.745345,-.239122,.389388,.824182,.778248,-.228837,.365361,.876634,.807208,-.216197,.337667,.92945,.835019,-.201772,.307197,.985261,.860261,-.185291,.274205,1.04299,.877601,-.165809,.240178,1.09816,.898211,-.143897,.207571,1.14694,.915789,-.119513,.174904,1.19008,.931831,-.0932919,.141423,1.2297,.949244,-.0656528,.105603,1.26553,.967527,-.0370262,.0679551,1.29986,.984139,-.00730117,.0283133,1.33252,.999713,.0234648,-.0121785,1.36397,.0152135,-245447e-11,.122795,304092e-12,.0151652,-615778e-10,.122399,76292e-10,.0151181,-245948e-9,.122023,304802e-10,.0151203,-553394e-9,.12203,686634e-10,.015125,-983841e-9,.122037,122463e-9,.0151427,-.00153774,.12214,192706e-9,.0151708,-.0022103,.122237,281219e-9,.0152115,-.00300741,.12238,390804e-9,.0152877,-.00392494,.1227,526317e-9,.015412,-.00496597,.123244,69443e-8,.0156201,-.00613314,.124228,90547e-8,.0159658,-.00744113,.125945,.0011732,.0165674,-.00892546,.129098,.00151888,.017487,-.010627,.133865,.00197007,.018839,-.0126043,.140682,.0025637,.020554,-.0148814,.148534,.00333637,.0226727,-.0175123,.157381,.00433738,.0251879,-.0205266,.166685,.00561664,.0283635,-.0240319,.177796,.00725563,.0318694,-.0279432,.188251,.00928811,.0361044,-.0324313,.200038,.011835,.0406656,-.0373527,.210685,.0149146,.0463846,-.0430132,.224182,.0187254,.0525696,-.0491013,.23634,.0232283,.0598083,-.0559175,.250013,.0286521,.0679437,-.0633657,.263981,.0350634,.0771181,-.0714602,.278072,.0425882,.0881273,-.0803502,.29511,.0514487,.0996628,-.0896903,.309976,.0615766,.112702,-.099644,.325611,.0732139,.126488,-.109829,.339321,.0862324,.142625,-.120859,.35574,.101275,.15953,-.131956,.369845,.117892,.176991,-.143145,.38146,.136205,.199715,-.155292,.40052,.157252,.220787,-.167066,.412055,.179966,.243697,-.178396,.423133,.204418,.272106,-.190433,.439524,.232141,.297637,-.201265,.447041,.261109,.325273,-.211834,.454488,.292627,.357219,-.221889,.465004,.326669,.387362,-.230729,.468527,.362426,.423131,-.23924,.475836,.401533,.45543,-.246067,.475017,.441902,.493393,-.251557,.478017,.484239,.526253,-.255571,.4709,.528586,.560554,-.257752,.463167,.574346,.599306,-.258076,.456452,.621655,.634541,-.256471,.443725,.670492,.668907,-.253283,.428719,.721943,.705619,-.247562,.411348,.772477,.739034,-.240626,.388939,.8264,.771408,-.231493,.36425,.881702,.803312,-.220125,.337321,.9385,.828457,-.206645,.305364,.997437,.854819,-.190664,.273715,1.05693,.878666,-.171429,.242218,1.11251,.898404,-.149235,.209556,1.16398,.917416,-.12435,.176863,1.21014,.933133,-.0972703,.142775,1.25178,.95066,-.0683607,.106735,1.29028,.968589,-.0378724,.0681609,1.32703,.984776,-.00605712,.0273966,1.36158,.99994,.0263276,-.0138124,1.3943,.00867437,-186005e-11,.0928979,173682e-12,.00864003,-466389e-10,.0925237,435505e-11,.00864593,-186594e-9,.0925806,174322e-10,.00864095,-419639e-9,.0924903,392862e-10,.00863851,-746272e-9,.0924589,702598e-10,.00868531,-.00116456,.0929,111188e-9,.00869667,-.00167711,.0928529,163867e-9,.00874332,-.00228051,.0930914,23104e-8,.00882709,-.00297864,.0935679,31741e-8,.00898874,-.00377557,.0946165,430186e-9,.00929346,-.00469247,.0967406,580383e-9,.00978271,-.00575491,.100084,783529e-9,.0105746,-.00701514,.105447,.00106304,.0116949,-.00851797,.112494,.00144685,.0130419,-.0102757,.119876,.00196439,.0148375,-.012381,.129034,.00266433,.0168725,-.01482,.137812,.00358364,.0193689,-.0176563,.147696,.00478132,.0222691,-.0209211,.157795,.00631721,.0256891,-.0246655,.168431,.00826346,.0294686,-.0288597,.178587,.0106714,.0340412,-.0336441,.190251,.0136629,.0393918,-.039033,.202999,.0173272,.0453947,-.0450087,.215655,.0217448,.0521936,-.0515461,.228686,.0269941,.0600279,-.058817,.242838,.033272,.0692398,-.0667228,.258145,.0406457,.0793832,-.0752401,.273565,.0492239,.0902297,-.0841851,.287735,.0590105,.102014,-.0936479,.301161,.0702021,.116054,-.103967,.317438,.0832001,.13191,-.114622,.334166,.0977951,.148239,-.125452,.348192,.113985,.165809,-.136453,.361094,.131928,.184616,-.147648,.373534,.151811,.207491,-.159607,.39101,.174476,.230106,-.171119,.402504,.198798,.257036,-.182906,.418032,.225796,.281172,-.193605,.425468,.254027,.312034,-.204771,.440379,.285713,.340402,-.214988,.445406,.319196,.370231,-.224711,.44968,.35537,.407105,-.233516,.460747,.393838,.439037,-.240801,.460624,.433747,.47781,-.24762,.465957,.477234,.510655,-.251823,.460054,.52044,.550584,-.255552,.459172,.567853,.585872,-.257036,.450311,.615943,.620466,-.257535,.437763,.667693,.660496,-.255248,.426639,.718988,.695578,-.251141,.409185,.772503,.732176,-.244718,.39015,.827023,.760782,-.236782,.362594,.885651,.79422,-.225923,.33711,.943756,.824521,-.213855,.308272,1.00874,.854964,-.197723,.278529,1.06764,.878065,-.179209,.246208,1.12836,.899834,-.157569,.21329,1.18318,.918815,-.133206,.181038,1.23161,.934934,-.106545,.146993,1.27644,.952115,-.0780574,.111175,1.31842,.96906,-.0478279,.0728553,1.35839,.985178,-.0160014,.032579,1.39697,1.00039,.0173126,-.0095256,1.43312,.00384146,-124311e-11,.0613583,778271e-13,.00390023,-314043e-10,.0622919,196626e-11,.00389971,-125622e-9,.0622632,787379e-11,.00389491,-282352e-9,.0620659,1778e-8,.00391618,-502512e-9,.0624687,320918e-10,.00392662,-784458e-9,.0625113,515573e-10,.00396053,-.00112907,.0628175,778668e-10,.00401911,-.00153821,.0633286,113811e-9,.00414994,-.0020208,.0646443,16445e-8,.00441223,-.00260007,.0673886,237734e-9,.00484427,-.0033097,.0716528,345929e-9,.00549109,-.00418966,.0774998,505987e-9,.00636293,-.00527331,.0844758,739208e-9,.00746566,-.00660428,.0921325,.00107347,.00876625,-.00818826,.0997067,.00153691,.0103125,-.0100811,.107433,.00217153,.0123309,-.0123643,.117088,.00303427,.0146274,-.0150007,.126438,.00416018,.0172295,-.0180531,.135672,.00561513,.0204248,-.0215962,.146244,.007478,.0241597,-.0256234,.157481,.00981046,.0284693,-.0302209,.169125,.0127148,.033445,-.0353333,.181659,.0162453,.0391251,-.0410845,.1944,.0205417,.0454721,-.0473451,.207082,.0256333,.0530983,-.0542858,.221656,.0317036,.0615356,-.0618384,.236036,.0388319,.0703363,-.0697631,.248398,.046974,.0810391,-.0784757,.263611,.0565246,.0920144,-.0873488,.275857,.0671724,.105584,-.0973652,.292555,.0798105,.119506,-.107271,.306333,.0935945,.134434,-.117608,.318888,.109106,.153399,-.128938,.337552,.127074,.171258,-.139944,.349955,.14643,.191059,-.151288,.361545,.168,.215069,-.163018,.378421,.192082,.237838,-.174226,.38879,.217838,.266965,-.186063,.405857,.246931,.292827,-.196909,.414146,.277505,.324352,-.207473,.426955,.310711,.354427,-.217713,.433429,.346794,.389854,-.227183,.443966,.385237,.420749,-.235131,.44471,.424955,.459597,-.242786,.451729,.468446,.495316,-.248767,.45072,.513422,.534903,-.253351,.450924,.560618,.572369,-.256277,.445266,.609677,.612383,-.2576,.438798,.660995,.644037,-.256931,.421693,.713807,.686749,-.254036,.4109,.767616,.719814,-.249785,.390151,.82533,.754719,-.244283,.367847,.888311,.792022,-.235076,.345013,.948177,.822404,-.225061,.316193,1.01661,.853084,-.211113,.287013,1.08075,.879871,-.19449,.255424,1.14501,.901655,-.174023,.222879,1.20203,.919957,-.1509,.18989,1.25698,.938412,-.124923,.15606,1.30588,.953471,-.0968139,.120512,1.3529,.970451,-.066734,.0828515,1.3986,.985522,-.034734,.0424458,1.44148,1.00099,-.00102222,678929e-9,1.48398,965494e-9,-627338e-12,.0306409,197672e-13,99168e-8,-158573e-10,.0314638,499803e-12,991068e-9,-634012e-10,.031363,200682e-11,974567e-9,-14144e-8,.03036,457312e-11,998079e-9,-252812e-9,.031496,860131e-11,.00102243,-396506e-9,.0319955,148288e-10,.00107877,-577593e-9,.0331376,249141e-10,.00121622,-816816e-9,.0359396,423011e-10,.0014455,-.00113761,.0399652,724613e-10,.00178791,-.00156959,.0450556,123929e-9,.00225668,-.00214064,.0508025,208531e-9,.00285627,-.00287655,.0568443,341969e-9,.0035991,-.00380271,.0630892,544158e-9,.00455524,-.00496264,.0702204,842423e-9,.00569143,-.0063793,.0773426,.00126704,.00716928,-.00813531,.0860839,.00186642,.00885307,-.0101946,.0944079,.00267014,.0109316,-.0126386,.103951,.00374033,.0133704,-.0154876,.113786,.0051304,.0161525,-.0187317,.123477,.00688858,.0194267,-.0224652,.133986,.00910557,.0230967,-.0265976,.143979,.0118074,.0273627,-.0312848,.154645,.0151266,.0323898,-.0365949,.166765,.0191791,.0379225,-.0422914,.177932,.0239236,.0447501,-.0487469,.19167,.0296568,.0519391,-.0556398,.203224,.0362924,.0599464,-.0631646,.215652,.0440585,.0702427,-.0714308,.232089,.0531619,.0806902,-.0800605,.245258,.0634564,.0923194,-.0892815,.258609,.0752481,.106938,-.09931,.276654,.0888914,.121238,-.109575,.289847,.104055,.138817,-.120461,.307566,.121266,.15595,-.131209,.320117,.139944,.178418,-.143049,.339677,.161591,.197875,-.154074,.349886,.184303,.224368,-.166307,.369352,.210669,.252213,-.178051,.386242,.238895,.277321,-.189335,.395294,.269182,.310332,-.200683,.412148,.302508,.338809,-.210856,.418266,.337264,.372678,-.220655,.428723,.374881,.405632,-.230053,.433887,.415656,.442293,-.237993,.439911,.457982,.477256,-.244897,.440175,.502831,.515592,-.250657,.441079,.550277,.550969,-.255459,.435219,.601102,.592883,-.257696,.432882,.651785,.629092,-.259894,.421054,.708961,.672033,-.258592,.41177,.763806,.709147,-.256525,.395267,.824249,.745367,-.254677,.375013,.8951,.784715,-.247892,.353906,.959317,.818107,-.240162,.327801,1.03153,.847895,-.229741,.298821,1.10601,.879603,-.213084,.269115,1.164,.902605,-.195242,.236606,1.22854,.922788,-.174505,.203442,1.29017,.944831,-.150169,.169594,1.34157,.959656,-.124099,.135909,1.3956,.972399,-.0960626,.0990563,1.45128,.986549,-.0657097,.0602348,1.50312,1.00013,-.0333558,.0186694,1.55364,619747e-11,-1e-7,.00778326,796756e-16,237499e-13,-999999e-13,282592e-10,114596e-15,100292e-11,-166369e-11,250354e-9,677492e-14,350752e-11,-637769e-11,357289e-9,631655e-13,826445e-11,-174689e-10,516179e-9,31851e-11,242481e-10,-450868e-10,.0010223,130577e-11,455631e-10,-89044e-9,.00144302,374587e-11,971222e-10,-178311e-9,.00241912,102584e-10,171403e-9,-313976e-9,.00354938,236481e-10,292747e-9,-520026e-9,.00513765,496014e-10,789827e-9,-.00118187,.0238621,139056e-9,.00114093,-.00171827,.0286691,244093e-9,.00176119,-.00249667,.0368565,420623e-9,.0022233,-.00333742,.0400469,65673e-8,.00343382,-.00481976,.0535751,.00109323,.00427602,-.00600755,.057099,.00155268,.00461435,-.00737637,.0551084,.00215031,.00695698,-.00971401,.0715767,.00316529,.00867619,-.0120943,.0793314,.00436995,.0106694,-.0148202,.0869391,.0058959,.0140351,-.0183501,.101572,.00798757,.0168939,-.022006,.11018,.0104233,.020197,-.0261568,.119041,.0134167,.0254702,-.0312778,.135404,.0173009,.0298384,-.0362469,.1437,.0215428,.035159,-.042237,.15512,.0268882,.0427685,-.0488711,.17128,.033235,.0494848,-.0557997,.181813,.0404443,.0592394,-.0635578,.198745,.0490043,.0681463,-.071838,.210497,.0588239,.0804753,-.0809297,.228864,.0702835,.0942205,-.0906488,.247008,.0834012,.106777,-.100216,.258812,.0975952,.124471,-.110827,.278617,.114162,.138389,-.121193,.287049,.131983,.159543,-.13253,.307151,.152541,.176432,-.143611,.31564,.174673,.201723,-.15548,.33538,.199842,.229721,-.167166,.355256,.227097,.250206,-.178238,.360047,.256014,.282118,-.189905,.378761,.28855,.312821,-.201033,.39181,.323348,.341482,-.211584,.397716,.360564,.377368,-.221314,.410141,.400004,.418229,-.230474,.423485,.442371,.444881,-.239443,.418874,.488796,.488899,-.245987,.427545,.535012,.520317,-.253948,.422147,.589678,.568566,-.256616,.42719,.637683,.599607,-.26376,.415114,.703363,.64222,-.268687,.408715,.771363,.685698,-.2694,.399722,.83574,.732327,-.266642,.388651,.897764,.769873,-.267712,.369198,.983312,.806733,-.263479,.346802,1.06222,.843466,-.254575,.321368,1.13477,.873008,-.242749,.29211,1.20712,.908438,-.22725,.262143,1.27465,.936321,-.207621,.228876,1.33203,.950353,-.187932,.19484,1.40439,.96442,-.165154,.163178,1.4732,.979856,-.139302,.127531,1.53574,.982561,-.11134,.0903457,1.59982,.996389,-.0808124,.0489007,1.6577],t=[1,0,0,0,1,791421e-36,0,0,1,104392e-29,0,0,1,349405e-26,0,0,1,109923e-23,0,0,1,947414e-22,0,0,1,359627e-20,0,0,1,772053e-19,0,0,1,108799e-17,0,0,1,110655e-16,0,0,1,865818e-16,0,0,.999998,545037e-15,0,0,.999994,285095e-14,0,0,.999989,126931e-13,0,0,.999973,489938e-13,0,0,.999947,166347e-12,0,0,.999894,502694e-12,0,0,.999798,136532e-11,0,0,.999617,335898e-11,0,0,.999234,752126e-11,0,0,.998258,152586e-10,0,0,.99504,266207e-10,0,0,.980816,236802e-10,0,0,.967553,207684e-11,0,0,.966877,403733e-11,0,0,.965752,741174e-11,0,0,.96382,127746e-10,0,0,.960306,202792e-10,0,0,.953619,280232e-10,0,0,.941103,278816e-10,0,0,.926619,160221e-10,0,0,.920983,235164e-10,0,0,.912293,311924e-10,0,.0158731,.899277,348118e-10,0,.0476191,.880884,26041e-9,0,.0793651,.870399,338726e-10,0,.111111,.856138,392906e-10,0,.142857,.837436,372874e-10,0,.174603,.820973,392558e-10,0,.206349,.803583,434658e-10,0,.238095,.782168,40256e-9,0,.269841,.764107,448159e-10,0,.301587,.743092,457627e-10,0,.333333,.721626,455314e-10,0,.365079,.700375,477335e-10,0,.396825,.677334,461072e-10,0,.428571,.655702,484393e-10,0,.460317,.632059,464583e-10,0,.492064,.610125,483923e-10,0,.52381,.58653,464342e-10,0,.555556,.564508,477033e-10,0,.587302,.541405,459263e-10,0,.619048,.519556,46412e-9,0,.650794,.497292,448913e-10,0,.68254,.475898,445789e-10,0,.714286,.454722,433496e-10,0,.746032,.434042,423054e-10,0,.777778,.414126,413737e-10,0,.809524,.394387,397265e-10,0,.84127,.375841,390709e-10,0,.873016,.357219,369938e-10,0,.904762,.340084,365618e-10,0,.936508,.322714,342533e-10,0,.968254,.306974,339596e-10,0,1,1,101524e-23,0,0,1,10292e-22,0,0,1,130908e-23,0,0,1,473331e-23,0,0,1,625319e-22,0,0,1,107932e-20,0,0,1,163779e-19,0,0,1,203198e-18,0,0,1,204717e-17,0,0,.999999,168995e-16,0,0,.999998,115855e-15,0,0,.999996,66947e-14,0,0,.999991,330863e-14,0,0,.999983,141737e-13,0,0,.999968,532626e-13,0,0,.99994,177431e-12,0,0,.999891,528835e-12,0,0,.999797,142169e-11,0,0,.999617,347057e-11,0,0,.999227,77231e-10,0,0,.998239,155753e-10,0,0,.994937,268495e-10,0,0,.980225,213742e-10,0,0,.967549,21631e-10,0,0,.966865,417989e-11,0,0,.965739,763341e-11,0,0,.963794,130892e-10,0,0,.960244,206456e-10,0,0,.953495,282016e-10,0,148105e-9,.940876,271581e-10,0,.002454,.926569,164159e-10,0,.00867491,.920905,239521e-10,0,.01956,.912169,315127e-10,0,.035433,.899095,346626e-10,0,.056294,.882209,290223e-10,0,.0818191,.870272,342992e-10,0,.111259,.855977,394164e-10,0,.142857,.837431,372343e-10,0,.174603,.820826,396691e-10,0,.206349,.803408,435395e-10,0,.238095,.782838,419579e-10,0,.269841,.763941,450953e-10,0,.301587,.742904,455847e-10,0,.333333,.721463,458833e-10,0,.365079,.700197,477159e-10,0,.396825,.677501,470641e-10,0,.428571,.655527,484732e-10,0,.460317,.6324,476834e-10,0,.492064,.609964,484213e-10,0,.52381,.586839,475541e-10,0,.555556,.564353,476951e-10,0,.587302,.541589,467611e-10,0,.619048,.519413,463493e-10,0,.650794,.497337,453994e-10,0,.68254,.475797,445308e-10,0,.714286,.454659,435787e-10,0,.746032,.434065,424839e-10,0,.777778,.414018,41436e-9,0,.809524,.39455,401902e-10,0,.84127,.375742,390813e-10,0,.873016,.357501,377116e-10,0,.904762,.339996,36535e-9,0,.936508,.323069,351265e-10,0,.968254,.306897,339112e-10,0,1,1,10396e-19,0,0,1,104326e-20,0,0,1,110153e-20,0,0,1,144668e-20,0,0,1,34528e-19,0,0,1,175958e-19,0,0,1,12627e-17,0,0,1,936074e-18,0,0,1,645742e-17,0,0,.999998,401228e-16,0,0,.999997,222338e-15,0,0,.999995,10967e-13,0,0,.999991,482132e-14,0,0,.999981,189434e-13,0,0,.999967,667716e-13,0,0,.999938,212066e-12,0,0,.999886,60977e-11,0,0,.999792,159504e-11,0,0,.999608,381191e-11,0,0,.999209,833727e-11,0,0,.998179,165288e-10,0,0,.994605,274387e-10,0,0,.979468,167316e-10,0,0,.967529,242877e-11,0,0,.966836,461696e-11,0,0,.96569,830977e-11,0,0,.963706,140427e-10,0,244659e-11,.960063,217353e-10,0,760774e-9,.953113,286606e-10,0,.00367261,.940192,247691e-10,0,.00940263,.927731,195814e-10,0,.018333,.920669,252531e-10,0,.0306825,.911799,324277e-10,0,.0465556,.89857,340982e-10,0,.0659521,.883283,319622e-10,0,.0887677,.86989,35548e-9,0,.114784,.855483,397143e-10,0,.143618,.837987,391665e-10,0,.174606,.820546,411306e-10,0,.206349,.802878,436753e-10,0,.238095,.783402,444e-7,0,.269841,.763439,458726e-10,0,.301587,.742925,467097e-10,0,.333333,.721633,478887e-10,0,.365079,.69985,481251e-10,0,.396825,.67783,491811e-10,0,.428571,.655126,488199e-10,0,.460318,.632697,496025e-10,0,.492064,.609613,48829e-9,0,.52381,.587098,492754e-10,0,.555556,.564119,482625e-10,0,.587302,.541813,482807e-10,0,.619048,.519342,471552e-10,0,.650794,.497514,466765e-10,0,.68254,.475879,455582e-10,0,.714286,.454789,446007e-10,0,.746032,.434217,435382e-10,0,.777778,.414086,421753e-10,0,.809524,.394744,412093e-10,0,.84127,.375782,396634e-10,0,.873016,.357707,386419e-10,0,.904762,.340038,370345e-10,0,.936508,.323284,359725e-10,0,.968254,.306954,3436e-8,0,1,1,599567e-19,0,0,1,600497e-19,0,0,1,614839e-19,0,0,1,686641e-19,0,0,1,972658e-19,0,0,1,221271e-18,0,0,1,833195e-18,0,0,1,403601e-17,0,0,.999999,206001e-16,0,0,.999998,101739e-15,0,0,.999997,470132e-15,0,0,.999993,200436e-14,0,0,.999988,783682e-14,0,0,.999979,280338e-13,0,0,.999962,917033e-13,0,0,.999933,274514e-12,0,0,.999881,753201e-12,0,0,.999783,189826e-11,0,0,.999594,440279e-11,0,0,.999178,93898e-10,0,0,.998073,181265e-10,0,0,.993993,280487e-10,0,0,.979982,149422e-10,0,0,.968145,378481e-11,0,0,.966786,53771e-10,0,0,.965611,947508e-11,0,388934e-10,.963557,156616e-10,0,9693e-7,.959752,235144e-10,0,.00370329,.952461,291568e-10,0,.00868428,.940193,240102e-10,0,.0161889,.929042,231235e-10,0,.0263948,.920266,273968e-10,0,.0394088,.911178,337915e-10,0,.0552818,.897873,333629e-10,0,.0740138,.884053,351405e-10,0,.0955539,.869455,378034e-10,0,.119795,.854655,399378e-10,0,.14656,.838347,419108e-10,0,.175573,.820693,440831e-10,0,.206388,.802277,445599e-10,0,.238095,.783634,472691e-10,0,.269841,.763159,476984e-10,0,.301587,.742914,491487e-10,0,.333333,.721662,502312e-10,0,.365079,.699668,502817e-10,0,.396825,.677839,51406e-9,0,.428571,.655091,511095e-10,0,.460317,.632665,516067e-10,0,.492064,.609734,512255e-10,0,.52381,.587043,510263e-10,0,.555556,.564298,50565e-9,0,.587302,.541769,497951e-10,0,.619048,.519529,492698e-10,0,.650794,.497574,482066e-10,0,.68254,.476028,473689e-10,0,.714286,.454961,461941e-10,0,.746032,.434341,450618e-10,0,.777778,.414364,438355e-10,0,.809524,.394832,424196e-10,0,.84127,.376109,412563e-10,0,.873016,.35779,396226e-10,0,.904762,.340379,384886e-10,0,.936508,.323385,368214e-10,0,.968254,.307295,356636e-10,0,1,1,106465e-17,0,0,1,106555e-17,0,0,1,107966e-17,0,0,1,114601e-17,0,0,1,137123e-17,0,0,1,21243e-16,0,0,.999999,489653e-17,0,0,.999999,160283e-16,0,0,.999998,62269e-15,0,0,.999997,251859e-15,0,0,.999996,996192e-15,0,0,.999992,374531e-14,0,0,.999986,132022e-13,0,0,.999975,433315e-13,0,0,.999959,131956e-12,0,0,.999927,372249e-12,0,0,.999871,972461e-12,0,0,.999771,235343e-11,0,0,.999572,52768e-10,0,0,.999133,109237e-10,0,0,.997912,203675e-10,0,0,.993008,279396e-10,0,0,.980645,139604e-10,0,0,.970057,646596e-11,0,0,.966717,65089e-10,0,474145e-10,.965497,111863e-10,0,89544e-8,.96334,179857e-10,0,.0032647,.959294,259045e-10,0,.0075144,.951519,292327e-10,0,.0138734,.940517,249769e-10,0,.0224952,.93014,26803e-9,0,.0334828,.91972,303656e-10,0,.0468973,.910294,353323e-10,0,.0627703,.897701,351002e-10,0,.0811019,.884522,388104e-10,0,.10186,.869489,412932e-10,0,.124985,.853983,415781e-10,0,.150372,.838425,454066e-10,0,.177868,.820656,471624e-10,0,.207245,.801875,475243e-10,0,.238143,.783521,505621e-10,0,.269841,.763131,50721e-9,0,.301587,.74261,523293e-10,0,.333333,.72148,528699e-10,0,.365079,.699696,538677e-10,0,.396825,.677592,539255e-10,0,.428571,.65525,546367e-10,0,.460317,.632452,541348e-10,0,.492064,.609903,544976e-10,0,.52381,.586928,536201e-10,0,.555556,.564464,535185e-10,0,.587302,.541801,524949e-10,0,.619048,.519681,51812e-9,0,.650794,.497685,507687e-10,0,.68254,.47622,496243e-10,0,.714286,.455135,485714e-10,0,.746032,.4346,471847e-10,0,.777778,.414564,459294e-10,0,.809524,.395165,444705e-10,0,.84127,.376333,430772e-10,0,.873016,.358197,416229e-10,0,.904762,.34064,401019e-10,0,.936508,.323816,386623e-10,0,.968254,.307581,370933e-10,0,1,1,991541e-17,0,0,1,992077e-17,0,0,1,100041e-16,0,0,1,10385e-15,0,0,1,115777e-16,0,0,1,150215e-16,0,0,.999999,254738e-16,0,0,.999999,598822e-16,0,0,.999998,179597e-15,0,0,.999997,602367e-15,0,0,.999994,206835e-14,0,0,.99999,694952e-14,0,0,.999984,223363e-13,0,0,.999972,678578e-13,0,0,.999952,193571e-12,0,0,.999919,516594e-12,0,0,.99986,128739e-11,0,0,.999753,299298e-11,0,0,.999546,648258e-11,0,0,.999074,129985e-10,0,0,.997671,232176e-10,0,0,.991504,256701e-10,0,0,.981148,131141e-10,0,0,.971965,869048e-11,0,280182e-10,.966624,808301e-11,0,695475e-9,.965344,135235e-10,0,.00265522,.963048,210592e-10,0,.00622975,.958673,287473e-10,0,.0116234,.950262,281379e-10,0,.018976,.940836,271089e-10,0,.0283844,.930996,30926e-9,0,.0399151,.919848,348359e-10,0,.0536063,.909136,366092e-10,0,.0694793,.897554,384162e-10,0,.0875342,.884691,430971e-10,0,.107749,.869414,447803e-10,0,.130087,.853462,452858e-10,0,.154481,.838187,495769e-10,0,.180833,.820381,502709e-10,0,.209005,.801844,522713e-10,0,.238791,.783061,541505e-10,0,.269869,.763205,553712e-10,0,.301587,.742362,564909e-10,0,.333333,.721393,572646e-10,0,.365079,.699676,581012e-10,0,.396825,.677395,58096e-9,0,.428571,.655208,585766e-10,0,.460317,.632451,583602e-10,0,.492064,.609839,580234e-10,0,.52381,.587093,577161e-10,0,.555556,.564467,568447e-10,0,.587302,.542043,563166e-10,0,.619048,.519826,55156e-9,0,.650794,.497952,541682e-10,0,.68254,.476477,528971e-10,0,.714286,.455412,514952e-10,0,.746032,.434926,502222e-10,0,.777778,.4149,485779e-10,0,.809524,.395552,472242e-10,0,.84127,.376712,454891e-10,0,.873016,.358622,440924e-10,0,.904762,.341048,422984e-10,0,.936508,.324262,408582e-10,0,.968254,.308013,390839e-10,0,1,1,613913e-16,0,0,1,614145e-16,0,0,1,617708e-16,0,0,1,633717e-16,0,0,1,681648e-16,0,0,1,808291e-16,0,0,1,114608e-15,0,0,.999998,210507e-15,0,0,.999997,499595e-15,0,0,.999995,139897e-14,0,0,.999994,419818e-14,0,0,.999988,127042e-13,0,0,.999979,375153e-13,0,0,.999965,106206e-12,0,0,.999945,285381e-12,0,0,.999908,723611e-12,0,0,.999846,17255e-10,0,0,.999733,386104e-11,0,0,.999511,808493e-11,0,0,.998993,156884e-10,0,0,.997326,265538e-10,0,0,.989706,206466e-10,0,0,.981713,130756e-10,0,70005e-10,.973636,106473e-10,0,464797e-9,.966509,10194e-9,0,.00201743,.965149,165881e-10,0,.00497549,.962669,249147e-10,0,.00953262,.95786,317449e-10,0,.0158211,.949334,281045e-10,0,.0239343,.941041,303263e-10,0,.0339372,.931575,356754e-10,0,.0458738,.920102,397075e-10,0,.059772,.908002,384886e-10,0,.075645,.897269,43027e-9,0,.0934929,.884559,479925e-10,0,.113302,.869161,48246e-9,0,.135045,.853342,509505e-10,0,.158678,.837633,542846e-10,0,.184136,.820252,554139e-10,0,.211325,.801872,581412e-10,0,.240113,.782418,585535e-10,0,.270306,.7631,610923e-10,0,.301594,.742183,613678e-10,0,.333333,.721098,627275e-10,0,.365079,.699512,629413e-10,0,.396825,.677372,636351e-10,0,.428571,.655059,633555e-10,0,.460317,.632567,636513e-10,0,.492064,.609784,628965e-10,0,.52381,.587237,625546e-10,0,.555556,.564525,615825e-10,0,.587302,.542181,605048e-10,0,.619048,.520017,596329e-10,0,.650794,.498204,581516e-10,0,.68254,.476742,569186e-10,0,.714286,.455803,553833e-10,0,.746032,.435251,537807e-10,0,.777778,.415374,522025e-10,0,.809524,.395921,503421e-10,0,.84127,.377253,488211e-10,0,.873016,.359021,468234e-10,0,.904762,.341637,453269e-10,0,.936508,.3247,433014e-10,0,.968254,.308625,418007e-10,0,1,1,286798e-15,0,0,1,286877e-15,0,0,1,288094e-15,0,0,1,293506e-15,0,0,1,309262e-15,0,0,.999999,348593e-15,0,0,.999999,444582e-15,0,0,.999998,688591e-15,0,0,.999996,134391e-14,0,0,.999993,317438e-14,0,0,.999989,835609e-14,0,0,.999983,228677e-13,0,0,.999974,623361e-13,0,0,.999959,165225e-12,0,0,.999936,419983e-12,0,0,.999896,101546e-11,0,0,.99983,232376e-11,0,0,.999709,50156e-10,0,0,.999469,10167e-9,0,0,.998886,190775e-10,0,0,.996819,300511e-10,0,0,.988837,185092e-10,0,168222e-12,.982178,134622e-10,0,259622e-9,.975017,125961e-10,0,.00142595,.967101,13507e-9,0,.00382273,.964905,205003e-10,0,.00764164,.96218,29546e-9,0,.0130121,.956821,343738e-10,0,.0200253,.948829,305063e-10,0,.0287452,.941092,346487e-10,0,.039218,.931883,412061e-10,0,.0514748,.920211,444651e-10,0,.0655351,.907307,431252e-10,0,.0814082,.89684,490382e-10,0,.0990939,.884119,53334e-9,0,.118583,.869148,54114e-9,0,.139856,.853377,578536e-10,0,.162882,.836753,592285e-10,0,.187615,.820063,622787e-10,0,.213991,.801694,645492e-10,0,.241918,.782116,65353e-9,0,.271267,.762673,674344e-10,0,.301847,.742133,682788e-10,0,.333333,.720779,691959e-10,0,.365079,.699386,696817e-10,0,.396826,.67732,699583e-10,0,.428572,.654888,698447e-10,0,.460318,.632499,694063e-10,0,.492064,.609825,691612e-10,0,.52381,.587287,681576e-10,0,.555556,.564743,674138e-10,0,.587302,.542409,661617e-10,0,.619048,.520282,647785e-10,0,.650794,.498506,633836e-10,0,.68254,.477102,615905e-10,0,.714286,.456167,601013e-10,0,.746032,.435728,581457e-10,0,.777778,.415809,564215e-10,0,.809524,.396517,544997e-10,0,.84127,.377737,525061e-10,0,.873016,.359698,506831e-10,0,.904762,.342164,48568e-9,0,.936508,.325417,467826e-10,0,.968254,.309186,446736e-10,0,1,1,109018e-14,0,0,1,10904e-13,0,0,1,109393e-14,0,0,1,11095e-13,0,0,1,1154e-12,0,0,1,126089e-14,0,0,.999999,15059e-13,0,0,.999997,207899e-14,0,0,.999994,348164e-14,0,0,.999993,705728e-14,0,0,.999987,163692e-13,0,0,.999981,406033e-13,0,0,.999969,10245e-11,0,0,.999953,255023e-12,0,0,.999925,61511e-11,0,0,.999881,142218e-11,0,0,.99981,313086e-11,0,0,.99968,653119e-11,0,0,.999418,12832e-9,0,0,.998748,232497e-10,0,0,.996066,329522e-10,0,0,.988379,179613e-10,0,108799e-9,.982567,143715e-10,0,921302e-9,.976097,148096e-10,0,.00280738,.968475,178905e-10,0,.00596622,.964606,253921e-10,0,.0105284,.961564,348623e-10,0,.0165848,.955517,357612e-10,0,.0242,.948381,343493e-10,0,.03342,.941095,405849e-10,0,.0442777,.931923,475394e-10,0,.0567958,.91996,484328e-10,0,.0709879,.907419,502146e-10,0,.086861,.89618,561654e-10,0,.104415,.88337,587612e-10,0,.123643,.869046,618057e-10,0,.144531,.853278,657392e-10,0,.167057,.836091,66303e-9,0,.191188,.819644,704445e-10,0,.216878,.801246,714071e-10,0,.244062,.782031,740093e-10,0,.272649,.762066,74685e-9,0,.302509,.741964,766647e-10,0,.333442,.720554,766328e-10,0,.365079,.699098,777857e-10,0,.396826,.677189,774633e-10,0,.428572,.65484,776235e-10,0,.460318,.632496,770316e-10,0,.492064,.609908,762669e-10,0,.52381,.587312,753972e-10,0,.555556,.564938,739994e-10,0,.587302,.542577,728382e-10,0,.619048,.52062,71112e-9,0,.650794,.498819,694004e-10,0,.68254,.477555,675575e-10,0,.714286,.456568,653449e-10,0,.746032,.436278,636068e-10,0,.777778,.41637,613466e-10,0,.809524,.397144,594177e-10,0,.84127,.378412,570987e-10,0,.873016,.360376,550419e-10,0,.904762,.342906,527422e-10,0,.936508,.326136,506544e-10,0,.968254,.30997,484307e-10,0,1,1,354014e-14,0,0,1,354073e-14,0,0,1,354972e-14,0,0,1,358929e-14,0,0,1,370093e-14,0,0,.999999,396194e-14,0,0,.999998,453352e-14,0,0,.999997,578828e-14,0,0,.999994,863812e-14,0,0,.999991,153622e-13,0,0,.999985,316356e-13,0,0,.999977,712781e-13,0,0,.999964,166725e-12,0,0,.999945,390501e-12,0,0,.999912,895622e-12,0,0,.999866,198428e-11,0,0,.999786,421038e-11,0,0,.999647,850239e-11,0,0,.999356,162059e-10,0,0,.998563,282652e-10,0,0,.994928,336309e-10,0,244244e-10,.987999,178458e-10,0,523891e-9,.982893,159162e-10,0,.00194729,.977044,178056e-10,0,.00451099,.969972,230624e-10,0,.00835132,.964237,313922e-10,0,.013561,.960791,406145e-10,0,.0202056,.954292,372796e-10,0,.0283321,.948052,403199e-10,0,.0379739,.940938,479537e-10,0,.0491551,.931689,545292e-10,0,.0618918,.91987,54038e-9,0,.0761941,.907665,589909e-10,0,.0920672,.895281,642651e-10,0,.109511,.882621,659707e-10,0,.12852,.86873,709973e-10,0,.149085,.853008,742221e-10,0,.171189,.835944,761754e-10,0,.194809,.818949,797052e-10,0,.21991,.800951,812434e-10,0,.246447,.781847,838075e-10,0,.274352,.761649,84501e-9,0,.303535,.74152,860258e-10,0,.333857,.720495,866233e-10,0,.365104,.698742,868326e-10,0,.396826,.677096,87133e-9,0,.428572,.654782,863497e-10,0,.460318,.632335,860206e-10,0,.492064,.610031,849337e-10,0,.52381,.587457,838279e-10,0,.555556,.56513,82309e-9,0,.587302,.542877,803542e-10,0,.619048,.5209,786928e-10,0,.650794,.499291,765171e-10,0,.68254,.477971,744753e-10,0,.714286,.457221,72209e-9,0,.746032,.436803,697448e-10,0,.777778,.417083,675333e-10,0,.809524,.397749,648058e-10,0,.84127,.379177,625759e-10,0,.873016,.361061,598584e-10,0,.904762,.343713,575797e-10,0,.936508,.326894,549999e-10,0,.968254,.310816,527482e-10,0,1,1,10153e-12,0,0,1,101544e-13,0,0,1,101751e-13,0,0,1,102662e-13,0,0,1,10521e-12,0,0,.999999,111049e-13,0,0,.999999,123408e-13,0,0,.999996,14924e-12,0,0,.999992,204471e-13,0,0,.999989,326539e-13,0,0,.99998,603559e-13,0,0,.999971,123936e-12,0,0,.999955,269058e-12,0,0,.999933,593604e-12,0,0,.999901,129633e-11,0,0,.999847,275621e-11,0,0,.999761,564494e-11,0,0,.999607,110485e-10,0,0,.999282,204388e-10,0,0,.99831,341084e-10,0,22038e-11,.993288,294949e-10,0,242388e-9,.987855,192736e-10,0,.0012503,.983167,182383e-10,0,.0032745,.977908,218633e-10,0,.00646321,.971194,290662e-10,0,.0109133,.963867,386401e-10,0,.0166927,.95982,462827e-10,0,.0238494,.953497,420705e-10,0,.0324178,.947621,477743e-10,0,.0424225,.940611,568258e-10,0,.0538808,.931174,618061e-10,0,.0668047,.919919,627098e-10,0,.0812014,.907856,694714e-10,0,.0970745,.894509,735008e-10,0,.114424,.881954,763369e-10,0,.133246,.868309,821896e-10,0,.153534,.852511,83769e-9,0,.175275,.835821,881615e-10,0,.198453,.817981,896368e-10,0,.223042,.800504,930906e-10,0,.249009,.78141,945056e-10,0,.276304,.761427,963605e-10,0,.304862,.74094,968088e-10,0,.334584,.720233,981481e-10,0,.365322,.698592,979122e-10,0,.396826,.676763,981057e-10,0,.428571,.654808,973956e-10,0,.460318,.632326,962619e-10,0,.492064,.610049,952996e-10,0,.52381,.58763,933334e-10,0,.555556,.565261,917573e-10,0,.587302,.543244,896636e-10,0,.619048,.521273,873304e-10,0,.650794,.499818,852648e-10,0,.68254,.478536,823961e-10,0,.714286,.457826,79939e-9,0,.746032,.437549,77126e-9,0,.777778,.41776,743043e-10,0,.809524,.39863,716426e-10,0,.84127,.379954,686456e-10,0,.873016,.362025,660514e-10,0,.904762,.344581,630755e-10,0,.936508,.327909,605439e-10,0,.968254,.311736,576345e-10,0,1,1,263344e-13,0,0,1,263373e-13,0,0,1,263815e-13,0,0,1,265753e-13,0,0,1,271132e-13,0,0,.999999,283279e-13,0,0,.999997,30833e-12,0,0,.999995,358711e-13,0,0,.999992,461266e-13,0,0,.999985,67574e-12,0,0,.999977,11358e-11,0,0,.999966,213657e-12,0,0,.999948,431151e-12,0,0,.999923,896656e-12,0,0,.999884,186603e-11,0,0,.999826,381115e-11,0,0,.999732,754184e-11,0,0,.999561,143192e-10,0,0,.999191,257061e-10,0,0,.997955,405724e-10,0,744132e-10,.992228,276537e-10,0,716477e-9,.987638,208885e-10,0,.0022524,.983395,215226e-10,0,.00484816,.978614,270795e-10,0,.00860962,.972389,365282e-10,0,.0136083,.964392,474747e-10,0,.0198941,.95861,509141e-10,0,.0275023,.952806,48963e-9,0,.0364584,.94712,571119e-10,0,.04678,.940104,671704e-10,0,.0584799,.930398,687586e-10,0,.0715665,.919866,738161e-10,0,.086045,.907853,813235e-10,0,.101918,.894078,834582e-10,0,.119186,.881177,892093e-10,0,.137845,.867575,944548e-10,0,.157891,.852107,969607e-10,0,.179316,.835502,101456e-9,0,.202106,.81756,103256e-9,0,.226243,.79984,106954e-9,0,.251704,.780998,108066e-9,0,.278451,.761132,110111e-9,0,.306436,.740429,110459e-9,0,.335586,.719836,111219e-9,0,.365796,.698467,11145e-8,0,.3969,.676446,110393e-9,0,.428571,.654635,110035e-9,0,.460318,.632411,108548e-9,0,.492064,.609986,106963e-9,0,.52381,.587872,105238e-9,0,.555556,.565528,102665e-9,0,.587302,.543563,100543e-9,0,.619048,.52176,976182e-10,0,.650794,.500188,947099e-10,0,.68254,.479204,919929e-10,0,.714286,.458413,886139e-10,0,.746032,.438314,857839e-10,0,.777778,.418573,82411e-9,0,.809524,.39947,792211e-10,0,.84127,.380892,759546e-10,0,.873016,.362953,727571e-10,0,.904762,.345601,695738e-10,0,.936508,.328895,664907e-10,0,.968254,.312808,634277e-10,0,1,1,628647e-13,0,0,1,628705e-13,0,0,1,629587e-13,0,0,1,633441e-13,0,0,.999999,644087e-13,0,0,.999998,667856e-13,0,0,.999997,715889e-13,0,0,.999995,809577e-13,0,0,.999989,992764e-13,0,0,.999983,135834e-12,0,0,.999974,210482e-12,0,0,.999959,365215e-12,0,0,.999939,686693e-12,0,0,.999911,13472e-10,0,0,.999868,26731e-10,0,0,.999804,524756e-11,0,0,.9997,100403e-10,0,0,.99951,185019e-10,0,0,.999078,322036e-10,0,620676e-11,.997428,470002e-10,0,341552e-9,.99162,287123e-10,0,.00143727,.987479,234706e-10,0,.00349201,.983582,260083e-10,0,.0066242,.979186,337927e-10,0,.0109113,.97325,454689e-10,0,.0164064,.965221,573759e-10,0,.0231463,.957262,544114e-10,0,.0311571,.952211,587006e-10,0,.0404572,.946631,692256e-10,0,.0510592,.939391,787819e-10,0,.0629723,.929795,792368e-10,0,.0762025,.91965,875075e-10,0,.090753,.907737,950903e-10,0,.106626,.893899,972963e-10,0,.123822,.880239,10459e-8,0,.142337,.866562,107689e-9,0,.16217,.85164,113081e-9,0,.183314,.835021,116636e-9,0,.20576,.817311,120074e-9,0,.229496,.798845,121921e-9,0,.254502,.780479,12475e-8,0,.280753,.760694,125255e-9,0,.308212,.740142,126719e-9,0,.336825,.719248,12636e-8,0,.366517,.698209,126712e-9,0,.397167,.676398,125769e-9,0,.428578,.654378,124432e-9,0,.460318,.632484,123272e-9,0,.492064,.610113,12085e-8,0,.52381,.587931,118411e-9,0,.555556,.565872,11569e-8,0,.587302,.543814,112521e-9,0,.619048,.522265,109737e-9,0,.650794,.500835,106228e-9,0,.68254,.479818,102591e-9,0,.714286,.459258,991288e-10,0,.746032,.439061,952325e-10,0,.777778,.419552,91895e-9,0,.809524,.400399,879051e-10,0,.84127,.381976,844775e-10,0,.873016,.364009,806316e-10,0,.904762,.346761,771848e-10,0,.936508,.330049,735429e-10,0,.968254,.314018,702103e-10,0,1,1,139968e-12,0,0,1,139979e-12,0,0,1,140145e-12,0,0,1,14087e-11,0,0,.999999,142865e-12,0,0,.999998,147279e-12,0,0,.999997,156057e-12,0,0,.999992,17276e-11,0,0,.999989,204352e-12,0,0,.99998,26494e-11,0,0,.999969,383435e-12,0,0,.999953,618641e-12,0,0,.999929,108755e-11,0,0,.999898,201497e-11,0,0,.999849,381346e-11,0,0,.999778,719815e-11,0,0,.999661,133215e-10,0,0,.999451,238313e-10,0,0,.998936,401343e-10,0,113724e-9,.99662,517346e-10,0,820171e-9,.991094,304323e-10,0,.00238143,.987487,281757e-10,0,.00493527,.983731,320048e-10,0,.00856859,.979647,423905e-10,0,.0133393,.973837,562935e-10,0,.0192863,.96584,677442e-10,0,.0264369,.956309,623073e-10,0,.03481,.951523,704131e-10,0,.0444184,.946003,836594e-10,0,.0552713,.938454,911736e-10,0,.0673749,.929279,938264e-10,0,.0807329,.919239,103754e-9,0,.0953479,.907293,109928e-9,0,.111221,.893936,115257e-9,0,.128352,.879674,122265e-9,0,.14674,.865668,125733e-9,0,.166382,.850998,132305e-9,0,.187276,.834498,134844e-9,0,.209413,.816903,139276e-9,0,.232786,.798235,140984e-9,0,.257382,.779724,14378e-8,0,.283181,.760251,144623e-9,0,.310156,.739808,145228e-9,0,.338269,.718762,14539e-8,0,.367461,.697815,144432e-9,0,.397646,.67631,143893e-9,0,.428685,.654278,141846e-9,0,.460318,.632347,13935e-8,0,.492064,.610296,137138e-9,0,.52381,.588039,133806e-9,0,.555556,.566218,130755e-9,0,.587302,.544346,127128e-9,0,.619048,.522701,123002e-9,0,.650794,.501542,119443e-9,0,.68254,.480508,115055e-9,0,.714286,.460092,111032e-9,0,.746032,.440021,106635e-9,0,.777778,.420446,102162e-9,0,.809524,.401512,98184e-9,0,.84127,.38299,936497e-10,0,.873016,.365232,89813e-9,0,.904762,.347865,853073e-10,0,.936508,.331342,817068e-10,0,.968254,.315202,773818e-10,0,1,1,29368e-11,0,0,1,2937e-10,0,0,1,293998e-12,0,0,1,295298e-12,0,0,.999999,298865e-12,0,0,.999998,3067e-10,0,0,.999995,322082e-12,0,0,.999992,350767e-12,0,0,.999986,403538e-12,0,0,.999976,501372e-12,0,0,.999964,68562e-11,0,0,.999945,10374e-10,0,0,.999919,171269e-11,0,0,.999882,300175e-11,0,0,.999829,542144e-11,0,0,.999749,984182e-11,0,0,.99962,176213e-10,0,0,.999382,305995e-10,0,138418e-10,.998751,496686e-10,0,389844e-9,.995344,510733e-10,0,.00150343,.990768,345829e-10,0,.00352451,.987464,342841e-10,0,.00655379,.983846,399072e-10,0,.0106554,.980007,533219e-10,0,.0158723,.974494,696992e-10,0,.0222333,.96622,776754e-10,0,.029758,.956273,747718e-10,0,.0384596,.950952,864611e-10,0,.0483473,.945215,100464e-9,0,.0594266,.937287,103729e-9,0,.0717019,.928649,111665e-9,0,.0851752,.918791,12353e-8,0,.0998479,.906685,127115e-9,0,.115721,.893706,13628e-8,0,.132794,.879248,142427e-9,0,.151067,.864685,148091e-9,0,.170538,.850032,153517e-9,0,.191204,.833853,157322e-9,0,.213063,.816353,161086e-9,0,.236107,.797834,164111e-9,0,.260329,.778831,165446e-9,0,.285714,.759756,167492e-9,0,.312243,.739419,166928e-9,0,.339887,.718491,167e-6,0,.368604,.697392,165674e-9,0,.398329,.676102,163815e-9,0,.428961,.654243,162003e-9,0,.460331,.632176,158831e-9,0,.492064,.610407,155463e-9,0,.52381,.588394,152062e-9,0,.555556,.56645,147665e-9,0,.587302,.5449,14375e-8,0,.619048,.523276,138905e-9,0,.650794,.502179,134189e-9,0,.68254,.481359,129392e-9,0,.714286,.46092,124556e-9,0,.746032,.441084,11957e-8,0,.777778,.421517,114652e-9,0,.809524,.402721,109688e-9,0,.84127,.384222,104667e-9,0,.873016,.366534,999633e-10,0,.904762,.349205,950177e-10,0,.936508,.332702,907301e-10,0,.968254,.316599,859769e-10,0,1,1,585473e-12,0,0,1,585507e-12,0,0,1,58602e-11,0,0,.999999,588259e-12,0,0,.999999,594381e-12,0,0,.999998,607754e-12,0,0,.999995,633729e-12,0,0,.99999,68137e-11,0,0,.999984,767003e-12,0,0,.999973,921212e-12,0,0,.999959,120218e-11,0,0,.999936,172024e-11,0,0,.999907,268088e-11,0,0,.999866,445512e-11,0,0,.999806,768481e-11,0,0,.999716,1342e-8,0,0,.999576,232473e-10,0,0,.9993,391694e-10,0,129917e-9,.998498,608429e-10,0,845035e-9,.994132,489743e-10,0,.00237616,.99031,384644e-10,0,.00484456,.987409,421768e-10,0,.00832472,.983981,504854e-10,0,.0128643,.980268,671028e-10,0,.0184947,.974875,852749e-10,0,.025237,.966063,85531e-9,0,.0331046,.956779,900588e-10,0,.0421067,.950259,10577e-8,0,.0522487,.944239,119458e-9,0,.0635343,.936341,122164e-9,0,.0759654,.928047,134929e-9,0,.0895434,.918065,145544e-9,0,.104269,.906267,150531e-9,0,.120142,.893419,161652e-9,0,.137163,.878758,16593e-8,0,.15533,.863699,174014e-9,0,.174645,.848876,177877e-9,0,.195106,.833032,184049e-9,0,.21671,.815557,186088e-9,0,.239454,.797323,19054e-8,0,.263332,.778124,191765e-9,0,.288336,.758929,192535e-9,0,.314451,.738979,192688e-9,0,.341658,.718213,191522e-9,0,.369924,.696947,190491e-9,0,.399202,.675807,187913e-9,0,.429416,.654147,184451e-9,0,.460447,.63229,181442e-9,0,.492064,.610499,177139e-9,0,.523809,.588747,172596e-9,0,.555555,.566783,167457e-9,0,.587301,.545359,162518e-9,0,.619048,.523984,156818e-9,0,.650794,.502917,151884e-9,0,.68254,.482294,145514e-9,0,.714286,.461945,140199e-9,0,.746032,.442133,134101e-9,0,.777778,.422705,128374e-9,0,.809524,.403916,122996e-9,0,.84127,.38554,116808e-9,0,.873016,.367909,111973e-9,0,.904762,.350651,105938e-9,0,.936508,.334208,101355e-9,0,.968254,.318123,957629e-10,0,1,1,111633e-11,0,0,1,111639e-11,0,0,1,111725e-11,0,0,1,112096e-11,0,0,.999999,11311e-10,0,0,.999997,115315e-11,0,0,.999995,11956e-10,0,0,.999989,127239e-11,0,0,.999981,140772e-11,0,0,.999969,164541e-11,0,0,.999952,206607e-11,0,0,.999928,281783e-11,0,0,.999895,416835e-11,0,0,.999848,658728e-11,0,0,.999781,108648e-10,0,0,.999682,182579e-10,0,0,.999523,306003e-10,0,159122e-10,.999205,499862e-10,0,391184e-9,.998131,73306e-9,0,.00147534,.993334,513229e-10,0,.0034227,.99016,467783e-10,0,.00632232,.987321,523413e-10,0,.0102295,.984099,64267e-9,0,.0151794,.980432,843042e-10,0,.0211947,.974976,102819e-9,0,.0282899,.966429,996234e-10,0,.0364739,.957633,111074e-9,0,.0457522,.949422,128644e-9,0,.0561278,.943045,140076e-9,0,.0676023,.935448,146349e-9,0,.0801762,.927225,161854e-9,0,.0938499,.917033,169135e-9,0,.108623,.905762,179987e-9,0,.124496,.892879,189832e-9,0,.141469,.878435,195881e-9,0,.159541,.863114,20466e-8,0,.178713,.84776,209473e-9,0,.198985,.832084,214861e-9,0,.220355,.814915,217695e-9,0,.242823,.796711,220313e-9,0,.266385,.777603,22313e-8,0,.291036,.757991,222471e-9,0,.316767,.738371,222869e-9,0,.343563,.717872,221243e-9,0,.371402,.696619,218089e-9,0,.400248,.675379,21562e-8,0,.430047,.65411,21169e-8,0,.460709,.63241,206947e-9,0,.492079,.61046,201709e-9,0,.52381,.58903,196753e-9,0,.555556,.567267,189637e-9,0,.587302,.545886,184735e-9,0,.619048,.524714,177257e-9,0,.650794,.503789,171424e-9,0,.68254,.483204,164688e-9,0,.714286,.462976,157172e-9,0,.746032,.443294,151341e-9,0,.777778,.423988,143737e-9,0,.809524,.405325,138098e-9,0,.84127,.386981,130698e-9,0,.873016,.369436,125276e-9,0,.904762,.35219,118349e-9,0,.936508,.335804,11312e-8,0,.968254,.319749,106687e-9,0,1,1,204685e-11,0,0,1,204694e-11,0,0,1,204831e-11,0,0,.999999,205428e-11,0,0,.999999,207056e-11,0,0,.999997,210581e-11,0,0,.999993,21732e-10,0,0,.999987,229365e-11,0,0,.999979,250243e-11,0,0,.999965,286127e-11,0,0,.999947,348028e-11,0,0,.999918,455588e-11,0,0,.999881,643303e-11,0,0,.999828,970064e-11,0,0,.999753,153233e-10,0,0,.999642,24793e-9,0,0,.999464,402032e-10,0,122947e-9,.999089,635852e-10,0,807414e-9,.997567,857026e-10,0,.00227206,.992903,594912e-10,0,.00462812,.990011,578515e-10,0,.00794162,.987192,65399e-9,0,.0122534,.98418,819675e-10,0,.0175888,.980491,105514e-9,0,.0239635,.974779,121532e-9,0,.031387,.96675,119144e-9,0,.0398644,.958248,136125e-9,0,.0493982,.948884,155408e-9,0,.0599896,.941673,162281e-9,0,.0716382,.934521,176754e-9,0,.0843437,.926205,192873e-9,0,.0981056,.916089,200038e-9,0,.112923,.904963,213624e-9,0,.128796,.892089,221834e-9,0,.145725,.878028,232619e-9,0,.163709,.86249,238632e-9,0,.182749,.846587,247002e-9,0,.202847,.830988,250702e-9,0,.224001,.814165,255562e-9,0,.246214,.796135,257505e-9,0,.269482,.777052,258625e-9,0,.293805,.757201,258398e-9,0,.319176,.737655,256714e-9,0,.345587,.717477,255187e-9,0,.373021,.696433,251792e-9,0,.401454,.675084,247223e-9,0,.430844,.653907,242213e-9,0,.461125,.632561,237397e-9,0,.492187,.610658,229313e-9,0,.52381,.589322,224402e-9,0,.555556,.567857,216116e-9,0,.587302,.54652,209124e-9,0,.619048,.525433,201601e-9,0,.650794,.504679,192957e-9,0,.68254,.484203,186052e-9,0,.714286,.464203,177672e-9,0,.746032,.444549,170005e-9,0,.777778,.425346,162401e-9,0,.809524,.406706,1544e-7,0,.84127,.388576,147437e-9,0,.873016,.37094,139493e-9,0,.904762,.353996,133219e-9,0,.936508,.337391,125573e-9,0,.968254,.321648,119867e-9,0,1,1,362511e-11,0,0,1,362525e-11,0,0,1,362739e-11,0,0,.999999,363673e-11,0,0,.999998,366214e-11,0,0,.999996,371698e-11,0,0,.999992,382116e-11,0,0,.999986,400554e-11,0,0,.999976,432058e-11,0,0,.999961,485194e-11,0,0,.999938,574808e-11,0,0,.999908,726643e-11,0,0,.999865,984707e-11,0,0,.999807,142217e-10,0,0,.999723,215581e-10,0,0,.999602,336114e-10,0,119113e-10,.999398,527353e-10,0,355813e-9,.998946,805809e-10,0,.00137768,.996647,942908e-10,0,.00322469,.992298,668733e-10,0,.00597897,.989802,716564e-10,0,.00968903,.987019,821355e-10,0,.0143845,.984219,104555e-9,0,.0200831,.980425,131245e-9,0,.0267948,.974241,139613e-9,0,.034525,.967006,145931e-9,0,.0432757,.95893,167153e-9,0,.0530471,.949157,188146e-9,0,.0638386,.94062,194625e-9,0,.0756487,.933509,213721e-9,0,.0884762,.925088,229616e-9,0,.10232,.915178,239638e-9,0,.117178,.904093,254814e-9,0,.133051,.891337,263685e-9,0,.149939,.877326,274789e-9,0,.167841,.861794,280534e-9,0,.18676,.845758,289534e-9,0,.206696,.829792,294446e-9,0,.22765,.813037,296877e-9,0,.249625,.795285,300217e-9,0,.27262,.776323,299826e-9,0,.296636,.756673,299787e-9,0,.321671,.736856,297867e-9,0,.347718,.716883,294052e-9,0,.374768,.696089,289462e-9,0,.402804,.67505,285212e-9,0,.431796,.653509,27653e-8,0,.461695,.63258,271759e-9,0,.49242,.61104,262811e-9,0,.523822,.589567,255151e-9,0,.555556,.568322,246434e-9,0,.587302,.547235,237061e-9,0,.619048,.52616,228343e-9,0,.650794,.505716,219236e-9,0,.68254,.485274,209595e-9,0,.714286,.465411,201011e-9,0,.746032,.445854,19109e-8,0,.777778,.426911,182897e-9,0,.809524,.408222,173569e-9,0,.84127,.390307,165496e-9,0,.873016,.372624,156799e-9,0,.904762,.355804,14917e-8,0,.936508,.33924,140907e-9,0,.968254,.323534,134062e-9,0,1,1,622487e-11,0,0,1,62251e-10,0,0,1,622837e-11,0,0,.999999,624259e-11,0,0,.999998,628127e-11,0,0,.999996,636451e-11,0,0,.999991,65218e-10,0,0,.999984,679782e-11,0,0,.999973,726361e-11,0,0,.999955,803644e-11,0,0,.999931,931397e-11,0,0,.999896,114299e-10,0,0,.999847,149402e-10,0,0,.999784,207461e-10,0,0,.999692,302493e-10,0,0,.999554,454957e-10,0,997275e-10,.999326,690762e-10,0,724813e-9,.998757,101605e-9,0,.0020972,.995367,958745e-10,0,.00432324,.99209,832808e-10,0,.00746347,.989517,887601e-10,0,.0115534,.987008,10564e-8,0,.0166134,.98421,133179e-9,0,.0226552,.98021,161746e-9,0,.0296838,.973676,161821e-9,0,.0377016,.967052,178635e-9,0,.0467079,.959385,206765e-9,0,.0567013,.949461,22476e-8,0,.0676796,.939578,23574e-8,0,.0796403,.932416,25893e-8,0,.0925812,.923759,271228e-9,0,.106501,.914223,289165e-9,0,.121397,.902942,301156e-9,0,.13727,.890419,313852e-9,0,.15412,.876639,324408e-9,0,.171946,.861316,33249e-8,0,.190751,.84496,338497e-9,0,.210537,.828427,345861e-9,0,.231305,.811871,347863e-9,0,.253057,.794397,350225e-9,0,.275797,.775726,349915e-9,0,.299525,.75617,347297e-9,0,.324242,.736091,344232e-9,0,.349947,.716213,340835e-9,0,.376633,.695736,332369e-9,0,.404289,.674961,327943e-9,0,.432895,.653518,318533e-9,0,.462415,.632574,310391e-9,0,.492788,.61134,300755e-9,0,.523909,.590017,290506e-9,0,.555556,.568752,280446e-9,0,.587302,.548061,269902e-9,0,.619048,.52711,258815e-9,0,.650794,.506682,248481e-9,0,.68254,.486524,237141e-9,0,.714286,.466812,226872e-9,0,.746032,.44732,216037e-9,0,.777778,.428473,205629e-9,0,.809524,.409921,195691e-9,0,.84127,.392028,185457e-9,0,.873016,.374606,176436e-9,0,.904762,.357601,166508e-9,0,.936508,.341348,158385e-9,0,.968254,.32542,149203e-9,0,1,1,103967e-10,0,0,1,10397e-9,0,0,1,104019e-10,0,0,.999999,104231e-10,0,0,.999998,104806e-10,0,0,.999995,106042e-10,0,0,.999991,108366e-10,0,0,.999982,112415e-10,0,0,.999968,119174e-10,0,0,.99995,130227e-10,0,0,.999922,148176e-10,0,0,.999884,177303e-10,0,0,.99983,224564e-10,0,0,.999758,300966e-10,0,0,.999654,423193e-10,0,549083e-11,.999503,614848e-10,0,296087e-9,.999237,903576e-10,0,.00123144,.998491,1271e-7,0,.00295954,.994594,107754e-9,0,.00555829,.99178,103025e-9,0,.00907209,.989265,11154e-8,0,.0135257,.986998,136296e-9,0,.0189327,.984137,169154e-9,0,.0252993,.979798,196671e-9,0,.0326272,.97337,196678e-9,0,.0409157,.967239,223121e-9,0,.0501623,.959543,253809e-9,0,.0603638,.949466,265972e-9,0,.0715171,.939074,288372e-9,0,.0836187,.931118,310983e-9,0,.0966657,.922525,325561e-9,0,.110656,.912983,345725e-9,0,.125588,.901617,3556e-7,0,.141461,.889487,374012e-9,0,.158275,.875787,383445e-9,0,.176031,.860654,393972e-9,0,.19473,.844417,400311e-9,0,.214374,.82741,405004e-9,0,.234967,.810545,407378e-9,0,.256512,.793312,407351e-9,0,.279011,.774847,406563e-9,0,.302468,.755621,404903e-9,0,.326887,.735511,397486e-9,0,.352266,.715435,39357e-8,0,.378605,.695403,384739e-9,0,.405897,.674681,376108e-9,0,.43413,.65359,365997e-9,0,.463277,.632471,354957e-9,0,.493295,.61151,343593e-9,0,.524106,.59064,331841e-9,0,.555561,.569386,318891e-9,0,.587302,.548785,3072e-7,0,.619048,.528146,29361e-8,0,.650794,.507872,281709e-9,0,.68254,.487805,268627e-9,0,.714286,.468196,255887e-9,0,.746032,.448922,243997e-9,0,.777778,.430093,231662e-9,0,.809524,.411845,220339e-9,0,.84127,.393808,208694e-9,0,.873016,.376615,198045e-9,0,.904762,.359655,187375e-9,0,.936508,.343452,177371e-9,0,.968254,.32765,167525e-9,0,1,1,169351e-10,0,0,1,169356e-10,0,0,1,169427e-10,0,0,.999999,169736e-10,0,0,.999998,170575e-10,0,0,.999995,172372e-10,0,0,.99999,175739e-10,0,0,.999979,181568e-10,0,0,.999966,191206e-10,0,0,.999944,20677e-9,0,0,.999912,231644e-10,0,0,.999869,271268e-10,0,0,.999811,334272e-10,0,0,.99973,433979e-10,0,0,.999617,590083e-10,0,680315e-10,.999445,829497e-10,0,612796e-9,.999138,118019e-9,0,.00187408,.998095,156712e-9,0,.00395791,.993919,125054e-9,0,.00692144,.991333,126091e-9,0,.0107962,.989226,144912e-9,0,.0155986,.986954,175737e-9,0,.0213364,.983982,213883e-9,0,.0280114,.979128,234526e-9,0,.0356226,.973327,243725e-9,0,.0441668,.967416,2773e-7,0,.0536399,.959729,308799e-9,0,.0640376,.949758,322447e-9,0,.0753554,.939173,350021e-9,0,.0875893,.9296,370089e-9,0,.100736,.921181,391365e-9,0,.114793,.91164,413636e-9,0,.129759,.900435,427068e-9,0,.145632,.888183,441046e-9,0,.162412,.874772,454968e-9,0,.180101,.859566,461882e-9,0,.1987,.843579,471556e-9,0,.218213,.826453,474335e-9,0,.238641,.809164,477078e-9,0,.259989,.792179,47755e-8,0,.282262,.773866,472573e-9,0,.305464,.754944,469765e-9,0,.329599,.735133,462371e-9,0,.35467,.714858,453674e-9,0,.380678,.694829,443888e-9,0,.407622,.674453,432052e-9,0,.435493,.653685,420315e-9,0,.464275,.632666,406829e-9,0,.493938,.611676,392234e-9,0,.524422,.591193,379208e-9,0,.555624,.570145,36319e-8,0,.587302,.549566,349111e-9,0,.619048,.529278,334166e-9,0,.650794,.509026,318456e-9,0,.68254,.489186,30449e-8,0,.714286,.469662,289051e-9,0,.746032,.450691,275494e-9,0,.777778,.431841,261437e-9,0,.809524,.413752,247846e-9,0,.84127,.395951,235085e-9,0,.873016,.378633,222245e-9,0,.904762,.36194,210533e-9,0,.936508,.345599,198494e-9,0,.968254,.329999,188133e-9,0,1,1,269663e-10,0,0,1,26967e-9,0,0,1,269772e-10,0,0,.999999,270214e-10,0,0,.999998,271415e-10,0,0,.999994,27398e-9,0,0,.999988,278771e-10,0,0,.999977,287019e-10,0,0,.999961,300544e-10,0,0,.999937,322138e-10,0,0,.999904,356163e-10,0,0,.999854,409465e-10,0,0,.99979,492651e-10,0,0,.999699,621722e-10,0,88288e-11,.999572,819715e-10,0,223369e-9,.999381,111689e-9,0,.00105414,.999016,153862e-9,0,.0026493,.997437,187667e-9,0,.00508608,.993545,155672e-9,0,.00840554,.991135,161455e-9,0,.012629,.989157,188241e-9,0,.0177661,.986874,226229e-9,0,.0238198,.983714,268668e-9,0,.0307887,.978301,277109e-9,0,.0386688,.973227,303446e-9,0,.0474554,.967317,341851e-9,0,.0571428,.959477,370885e-9,0,.0677256,.950012,392753e-9,0,.0791988,.939484,42781e-8,0,.0915576,.928135,443866e-9,0,.104798,.919819,472959e-9,0,.118918,.910049,491551e-9,0,.133915,.899181,512616e-9,0,.149788,.886881,523563e-9,0,.166537,.87359,540183e-9,0,.184164,.858613,547386e-9,0,.202669,.842809,554809e-9,0,.222056,.825727,558316e-9,0,.242329,.808086,557824e-9,0,.263492,.790728,556346e-9,0,.285551,.772987,552672e-9,0,.30851,.7541,543738e-9,0,.332376,.734669,536107e-9,0,.357153,.714411,523342e-9,0,.382845,.694196,512238e-9,0,.409454,.674252,497465e-9,0,.436977,.65357,481096e-9,0,.465404,.632999,467054e-9,0,.494713,.611994,448771e-9,0,.524864,.591604,431889e-9,0,.555779,.571134,415238e-9,0,.587302,.550528,396369e-9,0,.619048,.530292,379477e-9,0,.650794,.510364,361488e-9,0,.68254,.490749,343787e-9,0,.714286,.471266,327822e-9,0,.746032,.452462,310626e-9,0,.777778,.433907,295352e-9,0,.809524,.415659,279179e-9,0,.84127,.398138,264685e-9,0,.873016,.380833,249905e-9,0,.904762,.364247,236282e-9,0,.936508,.348041,222905e-9,0,.968254,.332389,210522e-9,0,1,1,420604e-10,0,0,1,420614e-10,0,0,1,420757e-10,0,0,.999999,42138e-9,0,0,.999997,423067e-10,0,0,.999993,426668e-10,0,0,.999986,433372e-10,0,0,.999974,444857e-10,0,0,.999956,463554e-10,0,0,.99993,493105e-10,0,0,.999892,539077e-10,0,0,.999838,610005e-10,0,0,.999767,718822e-10,0,0,.999666,884581e-10,0,365471e-10,.999525,113398e-9,0,485623e-9,.999311,150043e-9,0,.00162096,.998865,200063e-9,0,.00355319,.996278,211014e-9,0,.00633818,.992956,189672e-9,0,.0100043,.991017,210262e-9,0,.0145648,.989055,244292e-9,0,.0200237,.986741,290481e-9,0,.0263798,.983288,334303e-9,0,.033629,.977784,340307e-9,0,.0417652,.973037,377864e-9,0,.0507821,.967181,4239e-7,0,.060673,.958971,443854e-9,0,.0714314,.950093,483039e-9,0,.0830518,.939552,517934e-9,0,.0955288,.927678,539449e-9,0,.108859,.918278,568604e-9,0,.123038,.908449,588505e-9,0,.138065,.897713,612473e-9,0,.153938,.885533,625575e-9,0,.170657,.872131,63854e-8,0,.188224,.857517,647034e-9,0,.20664,.841796,65209e-8,0,.225909,.824726,6544e-7,0,.246035,.807297,655744e-9,0,.267022,.789058,646716e-9,0,.288878,.77189,643898e-9,0,.311607,.753082,629973e-9,0,.335216,.7341,621564e-9,0,.359713,.714094,605171e-9,0,.385103,.693839,588752e-9,0,.41139,.673891,573294e-9,0,.438576,.653565,552682e-9,0,.466656,.633326,533446e-9,0,.495617,.612582,514635e-9,0,.525431,.59205,49303e-8,0,.556041,.571918,471842e-9,0,.587338,.551572,451713e-9,0,.619048,.531553,430049e-9,0,.650794,.51175,410445e-9,0,.68254,.49238,390098e-9,0,.714286,.473143,370033e-9,0,.746032,.45423,351205e-9,0,.777778,.435963,332049e-9,0,.809524,.41787,315021e-9,0,.84127,.400387,297315e-9,0,.873016,.383332,281385e-9,0,.904762,.366665,265397e-9,0,.936508,.350633,250601e-9,0,.968254,.334964,23589e-8,0,1,1,643736e-10,0,0,1,64375e-9,0,0,1,643947e-10,0,0,.999999,64481e-9,0,0,.999997,647143e-10,0,0,.999994,652119e-10,0,0,.999985,661359e-10,0,0,.999972,677116e-10,0,0,.999952,702599e-10,0,0,.999922,742517e-10,0,0,.99988,803906e-10,0,0,.99982,897315e-10,0,0,.999741,103838e-9,0,0,.999629,12496e-8,0,149024e-9,.999474,156161e-9,0,861027e-9,.999229,201034e-9,0,.00231198,.998662,259069e-9,0,.00458147,.995299,245439e-9,0,.00770895,.992732,24498e-8,0,.0117126,.990847,273211e-9,0,.0165989,.988911,316492e-9,0,.0223674,.98654,37161e-8,0,.0290135,.982636,410352e-9,0,.0365309,.977346,421756e-9,0,.0449117,.972909,475578e-9,0,.0541481,.966821,522482e-9,0,.0642326,.958686,545008e-9,0,.075158,.949754,589286e-9,0,.0869181,.939184,619995e-9,0,.0995074,.927505,654266e-9,0,.112922,.916606,682362e-9,0,.127157,.906707,704286e-9,0,.142212,.895937,725909e-9,0,.158085,.883913,743939e-9,0,.174776,.870642,755157e-9,0,.192287,.856241,764387e-9,0,.210619,.84069,771032e-9,0,.229775,.823728,765906e-9,0,.249761,.806481,767604e-9,0,.270582,.787924,754385e-9,0,.292243,.770588,749668e-9,0,.314753,.751991,731613e-9,0,.338118,.733407,717655e-9,0,.362347,.713688,700604e-9,0,.387447,.693595,678765e-9,0,.413424,.673426,657042e-9,0,.440284,.65359,635892e-9,0,.468027,.633576,611569e-9,0,.496645,.613144,586011e-9,0,.526122,.592711,563111e-9,0,.556417,.572722,537699e-9,0,.587451,.552762,512556e-9,0,.619048,.532985,489757e-9,0,.650794,.513219,464139e-9,0,.68254,.493992,442193e-9,0,.714286,.47509,418629e-9,0,.746032,.456287,397045e-9,0,.777778,.438152,375504e-9,0,.809524,.420294,35492e-8,0,.84127,.402749,335327e-9,0,.873016,.385879,316422e-9,0,.904762,.369352,298333e-9,0,.936508,.353301,281417e-9,0,.968254,.337781,265203e-9,0,1,1,968267e-10,0,0,1,968284e-10,0,0,1,968556e-10,0,0,.999999,969733e-10,0,0,.999997,972913e-10,0,0,.999993,979688e-10,0,0,.999984,992239e-10,0,0,.999969,101356e-9,0,0,.999946,104784e-9,0,0,.999913,110111e-9,0,0,.999868,118217e-9,0,0,.999801,130396e-9,0,0,.999712,148523e-9,0,124907e-10,.999589,175233e-9,0,355405e-9,.999416,213999e-9,0,.0013528,.999136,268529e-9,0,.00312557,.998367,333088e-9,0,.00573045,.994701,304757e-9,0,.00919397,.992497,318031e-9,0,.0135261,.990608,353863e-9,0,.0187278,.988715,409044e-9,0,.0247947,.986241,472967e-9,0,.0317196,.981696,495104e-9,0,.039494,.977097,532873e-9,0,.0481087,.972583,594447e-9,0,.0575549,.966142,636867e-9,0,.0678242,.95823,669899e-9,0,.0789089,.949677,719499e-9,0,.0908023,.939226,750584e-9,0,.103499,.927501,793183e-9,0,.116993,.915199,81995e-8,0,.131282,.90498,847654e-9,0,.146364,.894243,868929e-9,0,.162237,.882154,884278e-9,0,.178902,.869161,898108e-9,0,.196358,.854751,901254e-9,0,.21461,.839368,90679e-8,0,.23366,.822874,901541e-9,0,.253512,.805514,897297e-9,0,.274174,.78716,881856e-9,0,.29565,.769061,870032e-9,0,.31795,.751,851719e-9,0,.341081,.732614,830671e-9,0,.365053,.713171,806569e-9,0,.389874,.693472,78338e-8,0,.415553,.673528,756404e-9,0,.442098,.653397,726872e-9,0,.469512,.633781,700494e-9,0,.497794,.613877,67105e-8,0,.526935,.593506,640361e-9,0,.556908,.573667,613502e-9,0,.587657,.553932,583177e-9,0,.61906,.534345,554375e-9,0,.650794,.515042,527811e-9,0,.68254,.495674,499367e-9,0,.714286,.477132,47429e-8,0,.746032,.458609,447726e-9,0,.777778,.440354,424205e-9,0,.809524,.422765,399549e-9,0,.84127,.405472,378315e-9,0,.873016,.388482,355327e-9,0,.904762,.372191,336122e-9,0,.936508,.356099,315247e-9,0,.968254,.340737,29794e-8,0,1,1,143327e-9,0,0,1,14333e-8,0,0,1,143366e-9,0,0,.999999,143524e-9,0,0,.999996,143952e-9,0,0,.999991,144862e-9,0,0,.999981,146544e-9,0,0,.999966,149391e-9,0,0,.999941,153946e-9,0,0,.999905,160971e-9,0,0,.999852,171562e-9,0,0,.99978,18729e-8,0,0,.999681,210386e-9,0,826239e-10,.999546,243906e-9,0,664807e-9,.999352,291739e-9,0,.00196192,.999027,357419e-9,0,.00405941,.997886,422349e-9,0,.00699664,.99419,385008e-9,0,.0107896,.99214,409775e-9,0,.0154415,.990274,456418e-9,0,.0209488,.988455,527008e-9,0,.0273037,.985804,597685e-9,0,.0344969,.98103,613124e-9,0,.0425183,.976674,668321e-9,0,.0513575,.972021,736985e-9,0,.0610046,.965274,773789e-9,0,.0714508,.958046,830852e-9,0,.0826877,.949333,875766e-9,0,.0947085,.939135,917088e-9,0,.107507,.927119,952244e-9,0,.121078,.91469,990626e-9,0,.135419,.903006,.00101304,0,.150526,.892368,.00103834,0,.166399,.880231,.00105002,0,.183038,.867432,.00106331,0,.200443,.853208,.00106783,0,.218618,.837956,.00106458,0,.237566,.821772,.00105945,0,.257291,.804328,.00104685,0,.2778,.786465,.00103178,0,.2991,.768004,.00101077,0,.321199,.74972,985504e-9,0,.344106,.731682,962893e-9,0,.36783,.712813,932146e-9,0,.392383,.693139,89871e-8,0,.417774,.673566,869678e-9,0,.444013,.653483,835525e-9,0,.471107,.633891,799853e-9,0,.49906,.614433,766838e-9,0,.527869,.594586,732227e-9,0,.557517,.574769,696442e-9,0,.587966,.555149,663935e-9,0,.61913,.535898,629826e-9,0,.650794,.516753,596486e-9,0,.68254,.497816,567078e-9,0,.714286,.479034,534399e-9,0,.746032,.460975,507013e-9,0,.777778,.442935,477421e-9,0,.809524,.425263,451101e-9,0,.84127,.408248,424964e-9,0,.873016,.391339,39993e-8,0,.904762,.37513,377619e-9,0,.936508,.359172,354418e-9,0,.968254,.343876,334823e-9,0,1,1,209042e-9,0,0,1,209045e-9,0,0,1,209093e-9,0,0,.999999,209304e-9,0,0,.999996,209871e-9,0,0,.999991,211078e-9,0,0,.999979,213304e-9,0,0,.999963,217061e-9,0,0,.999933,223042e-9,0,0,.999894,232206e-9,0,0,.999837,245901e-9,0,0,.999756,266023e-9,0,102927e-11,.999648,295204e-9,0,233468e-9,.999499,336958e-9,0,.00108237,.999283,395563e-9,0,.00268832,.998896,473785e-9,0,.00511138,.997006,520008e-9,0,.00837705,.993819,497261e-9,0,.0124928,.991632,523722e-9,0,.0174561,.989875,587258e-9,0,.0232596,.988109,676329e-9,0,.0298932,.985155,747701e-9,0,.0373453,.980479,768803e-9,0,.0456045,.976271,841054e-9,0,.0546593,.971347,911469e-9,0,.0644994,.964528,953057e-9,0,.0751152,.957632,.00102221,0,.0864981,.948681,.00106122,0,.0986407,.938716,.00111857,0,.111537,.926629,.00114762,0,.125182,.914025,.00118995,0,.139571,.901026,.00121228,0,.154703,.890358,.00123946,0,.170576,.878283,.0012527,0,.18719,.865459,.00125536,0,.204547,.851407,.00126134,0,.222648,.836276,.00124759,0,.241498,.820436,.00124443,0,.261101,.803253,.00122071,0,.281465,.785562,.00120107,0,.302595,.76718,.00117762,0,.324501,.748551,.00114289,0,.347192,.730564,.00110872,0,.370679,.712253,.00107636,0,.394973,.692867,.00103646,0,.420085,.673695,996793e-9,0,.446027,.653912,95675e-8,0,.47281,.634129,916739e-9,0,.500441,.615004,874401e-9,0,.528921,.595587,833411e-9,0,.558244,.575965,794556e-9,0,.588384,.5566,75196e-8,0,.619281,.537428,716381e-9,0,.650795,.518623,676558e-9,0,.68254,.499964,64074e-8,0,.714286,.481356,605984e-9,0,.746032,.463279,570256e-9,0,.777778,.445673,540138e-9,0,.809524,.428032,507299e-9,0,.84127,.411112,479553e-9,0,.873016,.394444,450737e-9,0,.904762,.378247,424269e-9,0,.936508,.362415,399111e-9,0,.968254,.347103,375274e-9,0,1,1,300729e-9,0,0,1,300733e-9,0,0,1,300797e-9,0,0,.999998,301072e-9,0,0,.999996,301817e-9,0,0,.999989,303398e-9,0,0,.999977,306309e-9,0,0,.999958,311209e-9,0,0,.999927,318975e-9,0,0,.999884,330804e-9,0,0,.99982,34834e-8,0,0,.999733,373854e-9,0,326995e-10,.999613,410424e-9,0,477174e-9,.999447,462047e-9,0,.00161099,.999204,533322e-9,0,.00353153,.998725,624964e-9,0,.00627965,.995871,631786e-9,0,.0098693,.993194,632017e-9,0,.0143011,.991541,68923e-8,0,.019568,.989773,766892e-9,0,.0256593,.987647,863668e-9,0,.0325625,.984193,922089e-9,0,.0402647,.980016,970749e-9,0,.0487532,.975859,.00106027,0,.058016,.970514,.00112239,0,.0680419,.963625,.00117212,0,.0788208,.956959,.00125211,0,.0903439,.947956,.00129411,0,.102604,.93809,.00135879,0,.115594,.92659,.00139309,0,.129309,.913829,.00143253,0,.143745,.90005,.00145809,0,.158901,.888129,.0014748,0,.174774,.87607,.00148756,0,.191365,.863461,.00148714,0,.208674,.849594,.00148892,0,.226705,.834531,.00146496,0,.245461,.81903,.0014579,0,.264947,.802122,.00143039,0,.28517,.78445,.00139717,0,.306137,.766434,.00136312,0,.327857,.747816,.00132597,0,.350341,.729519,.00128323,0,.373598,.711454,.00123803,0,.397642,.692699,.00119097,0,.422485,.673723,.00114565,0,.448139,.654386,.00109552,0,.474619,.634673,.00104553,0,.501933,.615554,99985e-8,0,.530089,.596462,948207e-9,0,.559087,.577385,902299e-9,0,.588913,.558257,856448e-9,0,.619525,.5392,810395e-9,0,.650826,.520543,768558e-9,0,.68254,.502206,7239e-7,0,.714286,.48402,685794e-9,0,.746032,.465779,64471e-8,0,.777778,.448455,609583e-9,0,.809524,.431091,57227e-8,0,.84127,.414147,54042e-8,0,.873016,.39765,506545e-9,0,.904762,.381576,477635e-9,0,.936508,.365881,448446e-9,0,.968254,.350582,421424e-9,0,1,1,427144e-9,0,0,1,427151e-9,0,0,1,427232e-9,0,0,.999998,42759e-8,0,0,.999995,428555e-9,0,0,.999988,430603e-9,0,0,.999976,434368e-9,0,0,.999952,440688e-9,0,0,.999919,450667e-9,0,0,.999871,46578e-8,0,0,.999801,488024e-9,0,0,.999704,520092e-9,0,129791e-9,.999572,565553e-9,0,821056e-9,.999389,628906e-9,0,.00225241,.999114,714911e-9,0,.00449109,.998488,819218e-9,0,.00756249,.995234,80415e-8,0,.0114716,.993021,830181e-9,0,.0162131,.991407,902645e-9,0,.021776,.989625,996934e-9,0,.0281471,.987064,.00109707,0,.0353118,.983265,.00114353,0,.0432562,.979535,.0012272,0,.0519665,.975224,.00132642,0,.0614298,.969574,.00138092,0,.0716348,.963021,.00145896,0,.0825709,.956046,.00152834,0,.094229,.947136,.00158217,0,.106602,.937313,.0016347,0,.119682,.926073,.00168383,0,.133465,.913121,.00171627,0,.147947,.899165,.00174229,0,.163125,.885891,.00176137,0,.178998,.873783,.00176406,0,.195566,.861331,.00176156,0,.21283,.847569,.00175346,0,.230793,.832785,.00172753,0,.249459,.817442,.00170204,0,.268832,.800613,.00166576,0,.28892,.783597,.00162909,0,.30973,.76571,.0015826,0,.331271,.747021,.00153106,0,.353554,.728593,.00148036,0,.37659,.710661,.00142808,0,.400391,.692426,.00136906,0,.424973,.673623,.00131066,0,.450347,.65494,.00125569,0,.476531,.635448,.00119517,0,.503535,.616221,.00113828,0,.531372,.597531,.0010816,0,.560047,.578795,.00102673,0,.589554,.559892,970985e-9,0,.619869,.541307,919773e-9,0,.650923,.522608,868479e-9,0,.68254,.504484,82137e-8,0,.714286,.486603,772916e-9,0,.746032,.468802,730353e-9,0,.777778,.451172,684955e-9,0,.809524,.434348,647565e-9,0,.84127,.417445,605863e-9,0,.873016,.401077,571885e-9,0,.904762,.385039,536034e-9,0,.936508,.369483,504227e-9,0,.968254,.354272,473165e-9,0,1,1,599525e-9,0,0,1,599533e-9,0,0,1,599639e-9,0,0,.999998,600097e-9,0,0,.999994,601336e-9,0,0,.999987,603958e-9,0,0,.999972,608775e-9,0,0,.999949,616842e-9,0,0,.999912,629534e-9,0,0,.999857,648658e-9,0,0,.999781,676615e-9,0,538873e-11,.999674,716574e-9,0,308602e-9,.999528,772641e-9,0,.00127003,.999326,849806e-9,0,.00300783,.999009,952682e-9,0,.00556637,.998112,.00106394,0,.00895889,.994496,.00102228,0,.0131827,.992806,.00108586,0,.0182277,.991211,.0011759,0,.0240795,.989415,.00128955,0,.030723,.986499,.00139038,0,.0381418,.982679,.00144539,0,.046321,.978839,.00153954,0,.0552459,.974295,.00164417,0,.0649034,.968784,.00171517,0,.0752814,.962324,.00180282,0,.0863693,.954956,.00186387,0,.0981578,.94624,.00193817,0,.110639,.936517,.00198156,0,.123806,.925186,.00203042,0,.137655,.91252,.0020664,0,.15218,.898441,.00207822,0,.16738,.884394,.0020992,0,.183253,.871273,.00208748,0,.199799,.859057,.00208686,0,.21702,.845243,.00205519,0,.234918,.830723,.00202868,0,.253496,.815801,.00199501,0,.272761,.79914,.00194193,0,.292719,.782372,.00188824,0,.313377,.76482,.00183695,0,.334745,.746586,.00177418,0,.356833,.7281,.00170628,0,.379654,.709842,.00164063,0,.403221,.692019,.00157355,0,.427548,.67364,.00150262,0,.452651,.655277,.00143473,0,.478545,.636438,.00136371,0,.505246,.617364,.00129911,0,.532768,.598603,.00123014,0,.561122,.580195,.00116587,0,.590309,.561786,.00110398,0,.620318,.543377,.00104148,0,.651102,.525093,983984e-9,0,.682545,.506791,92667e-8,0,.714286,.489291,874326e-9,0,.746032,.471811,821734e-9,0,.777778,.454435,774698e-9,0,.809524,.437493,727302e-9,0,.84127,.420977,684039e-9,0,.873016,.404729,64373e-8,0,.904762,.388756,60285e-8,0,.936508,.373344,56765e-8,0,.968254,.358191,531929e-9,0,1,1,832169e-9,0,0,1,832178e-9,0,0,1,83231e-8,0,0,.999998,832893e-9,0,0,.999995,834465e-9,0,0,.999985,837791e-9,0,0,.999969,843893e-9,0,0,.999944,854086e-9,0,0,.999903,870071e-9,0,0,.999843,894042e-9,0,0,.999759,928865e-9,0,531805e-10,.999643,978242e-9,0,579365e-9,.99948,.00104684,0,.00182774,.999255,.00114012,0,.00387804,.998885,.00126188,0,.00675709,.997405,.00135888,0,.010468,.99424,.00133626,0,.0150018,.992458,.00140905,0,.0203443,.990929,.00152305,0,.0264786,.989116,.00165882,0,.0333875,.985624,.00174128,0,.0410536,.982003,.00182108,0,.0494609,.978336,.00194498,0,.0585941,.973184,.00202708,0,.0684396,.9678,.00212166,0,.0789851,.961348,.00221366,0,.0902199,.953841,.00228219,0,.102134,.94534,.00235662,0,.114721,.935552,.00240572,0,.127972,.924064,.00244405,0,.141884,.911827,.00247557,0,.156451,.897731,.00248374,0,.171672,.883409,.00249863,0,.187545,.868625,.00246688,0,.20407,.856529,.00246523,0,.221249,.842999,.00242368,0,.239083,.828505,.00237354,0,.257578,.813825,.00232588,0,.276738,.797813,.00226731,0,.296569,.781097,.00219704,0,.31708,.764038,.00212394,0,.338281,.746067,.00204786,0,.360181,.727687,.00196728,0,.382794,.709571,.00188779,0,.406133,.691503,.00180532,0,.430213,.673673,.00171849,0,.45505,.655732,.00164147,0,.480662,.637399,.00155858,0,.507065,.618616,.00147641,0,.534278,.60005,.00140125,0,.562313,.581713,.00132441,0,.59118,.563546,.00125014,0,.620875,.545605,.00118249,0,.651373,.527559,.0011116,0,.682593,.509764,.00104979,0,.714286,.49193,985977e-9,0,.746032,.475011,928592e-9,0,.777778,.457878,873466e-9,0,.809524,.440979,819585e-9,0,.84127,.424613,772365e-9,0,.873016,.408549,722195e-9,0,.904762,.392771,680014e-9,0,.936508,.377317,636797e-9,0,.968254,.362352,598318e-9,0,1,1,.00114313,0,0,1,.00114314,0,0,.999999,.00114331,0,0,.999998,.00114404,0,0,.999994,.00114601,0,0,.999984,.00115019,0,0,.999967,.00115784,0,0,.999937,.0011706,0,0,.999894,.00119054,0,0,.999828,.00122031,0,0,.999735,.00126331,0,169263e-9,.999606,.00132382,0,949167e-9,.999426,.0014071,0,.00249668,.999173,.00151895,0,.00486392,.99873,.00166102,0,.00806323,.996243,.0017023,0,.0120895,.993779,.00172782,0,.0169288,.9919,.0018108,0,.0225633,.990524,.00196028,0,.028974,.98868,.00212014,0,.036142,.984663,.00217598,0,.044049,.981457,.00230563,0,.0526781,.977608,.00243966,0,.0620137,.972215,.00251336,0,.0720418,.966798,.0026285,0,.0827499,.960241,.00271409,0,.0941271,.952489,.00278381,0,.106164,.944127,.00285399,0,.118852,.934282,.00290994,0,.132185,.923271,.00294558,0,.146157,.910803,.00296269,0,.160766,.896705,.00296803,0,.176007,.88238,.00296637,0,.19188,.867116,.00293163,0,.208385,.853636,.00289418,0,.225523,.840469,.00284663,0,.243296,.82639,.00278594,0,.261709,.811759,.00271618,0,.280767,.796113,.00263187,0,.300476,.779518,.00254589,0,.320845,.763142,.00246003,0,.341883,.745464,.00236529,0,.363601,.727491,.00226536,0,.386011,.709414,.00216375,0,.409128,.691396,.00207127,0,.432967,.67368,.00197106,0,.457545,.656049,.00187022,0,.482881,.638188,.00177605,0,.508992,.620177,.00168482,0,.535899,.601506,.00158909,0,.563619,.58362,.00150583,0,.592165,.565496,.00141791,0,.621544,.54789,.00133693,0,.651743,.530323,.00126038,0,.682709,.512795,.00118556,0,.714286,.495199,.00111527,0,.746032,.478101,.0010489,0,.777778,.461511,984264e-9,0,.809524,.444879,92591e-8,0,.84127,.428424,866582e-9,0,.873016,.412495,814463e-9,0,.904762,.396975,764498e-9,0,.936508,.381614,715967e-9,0,.968254,.366732,672483e-9,0,1,1,.00155501,0,0,1,.00155503,0,0,1,.00155524,0,0,.999998,.00155615,0,0,.999994,.0015586,0,0,.999983,.00156379,0,0,.999963,.0015733,0,0,.999932,.00158911,0,0,.999882,.00161376,0,0,.99981,.00165041,0,100875e-10,.999708,.00170304,0,367658e-9,.999565,.00177658,0,.0014234,.999368,.00187688,0,.00327939,.999081,.00200989,0,.00596629,.99852,.00217177,0,.0094852,.99549,.0021745,0,.013824,.993252,.00222357,0,.0189642,.991727,.00235022,0,.0248856,.989951,.00250561,0,.0315669,.988029,.00268829,0,.0389882,.984029,.0027496,0,.0471302,.980683,.00289793,0,.0559754,.976554,.00303315,0,.0655081,.97139,.00313257,0,.0757138,.965544,.00323656,0,.08658,.95912,.00333432,0,.0980954,.951183,.0034039,0,.110251,.942974,.00347515,0,.123038,.932642,.00350381,0,.13645,.922158,.00354519,0,.150482,.909404,.00353851,0,.165129,.896071,.0035435,0,.18039,.881206,.00349936,0,.196263,.866077,.00347256,0,.212748,.85093,.003415,0,.229847,.837703,.00333367,0,.247561,.823878,.003249,0,.265895,.809449,.00316347,0,.284854,.794379,.00306351,0,.304445,.778138,.0029499,0,.324675,.761997,.00284099,0,.345555,.744938,.00272104,0,.367095,.727212,.00260715,0,.389309,.709549,.00248855,0,.41221,.691704,.00236783,0,.435814,.673689,.00225178,0,.460138,.656453,.00213765,0,.485203,.639128,.00202178,0,.511028,.621512,.00191443,0,.537634,.603598,.00180977,0,.565041,.58559,.00170456,0,.593268,.567852,.00160927,0,.622327,.5503,.00151395,0,.652217,.533033,.00142499,0,.682907,.515942,.00133955,0,.714296,.498814,.0012602,0,.746032,.481595,.00118188,0,.777778,.465117,.00111171,0,.809524,.448865,.00104091,0,.84127,.432711,976618e-9,0,.873016,.416822,91859e-8,0,.904762,.401272,857704e-9,0,.936508,.386226,807172e-9,0,.968254,.371321,75464e-8,0,1,1,.00209596,0,0,1,.00209598,0,0,1,.00209624,0,0,.999997,.00209736,0,0,.999991,.00210039,0,0,.999979,.00210678,0,0,.999959,.00211847,0,0,.999925,.0021379,0,0,.99987,.00216809,0,0,.999791,.00221281,0,681487e-10,.999677,.00227669,0,658161e-9,.999521,.00236533,0,.00200635,.999301,.00248514,0,.0041779,.998977,.00264185,0,.00718648,.998191,.00281695,0,.0110239,.994801,.00278518,0,.015672,.993091,.00288774,0,.0211091,.991571,.00303931,0,.0273123,.9897,.00321643,0,.034259,.987023,.00337332,0,.0419282,.983289,.00346146,0,.0502998,.979892,.00363704,0,.0593562,.975111,.00373601,0,.069081,.970351,.0038842,0,.0794598,.964131,.00397053,0,.0904798,.957747,.00408078,0,.10213,.949536,.00413533,0,.1144,.941372,.00420305,0,.127284,.931049,.00422815,0,.140772,.920647,.00425048,0,.154862,.908033,.0042281,0,.169548,.895028,.00422026,0,.184828,.879968,.00415042,0,.200701,.864875,.00408821,0,.217167,.84918,.00400909,0,.234227,.834934,.00391178,0,.251884,.821397,.00380066,0,.270141,.807135,.00367974,0,.289004,.792363,.00355172,0,.308479,.776661,.003411,0,.328575,.760705,.00328123,0,.349301,.744408,.00314003,0,.370668,.726994,.0029906,0,.392689,.709598,.00285034,0,.415379,.692112,.00271179,0,.438754,.674435,.00257185,0,.46283,.65676,.00243425,0,.48763,.639982,.00230351,0,.513173,.622983,.0021777,0,.539482,.605471,.00204991,0,.566579,.58796,.00193759,0,.594488,.570463,.00181976,0,.623226,.553058,.00171497,0,.6528,.535894,.00161109,0,.683198,.519089,.00151394,0,.714354,.502454,.00142122,0,.746032,.485681,.00133488,0,.777778,.468935,.00124975,0,.809524,.452951,.00117309,0,.84127,.437139,.00110155,0,.873016,.421446,.00103124,0,.904762,.405951,966387e-9,0,.936508,.391003,908119e-9,0,.968254,.376198,848057e-9,0,1,1,.00280076,0,0,1,.00280078,0,0,.999999,.00280109,0,0,.999997,.00280246,0,0,.999992,.00280616,0,0,.999979,.00281396,0,0,.999956,.00282822,0,0,.999916,.00285186,0,0,.999857,.0028885,0,0,.999768,.00294259,0,196026e-9,.999645,.00301946,0,.00104842,.99947,.00312541,0,.00270199,.999229,.00326733,0,.00519449,.998852,.00344992,0,.00852602,.997558,.00361052,0,.0126804,.994417,.0035898,0,.017635,.992824,.00372393,0,.023365,.991344,.00390695,0,.0298456,.989337,.00410392,0,.0370529,.985811,.00420987,0,.0449651,.982772,.00437488,0,.0535615,.979001,.00455069,0,.0628243,.974102,.00464462,0,.0727368,.969197,.00480577,0,.0832844,.962759,.00487818,0,.0944545,.956207,.00498176,0,.106236,.947909,.00503392,0,.118619,.939596,.00507474,0,.131595,.929642,.00509798,0,.145159,.918807,.00508476,0,.159305,.906921,.00505634,0,.174028,.893312,.00498845,0,.189327,.878933,.0049133,0,.2052,.863986,.0048259,0,.221647,.847936,.00470848,0,.23867,.832253,.00456889,0,.25627,.818619,.00442726,0,.274453,.804788,.00427677,0,.293222,.790241,.00411906,0,.312585,.775162,.00394833,0,.33255,.759463,.00377366,0,.353126,.743598,.00361026,0,.374324,.72697,.00343627,0,.396158,.709646,.00326422,0,.418641,.69277,.00309717,0,.44179,.675371,.0029356,0,.465624,.657863,.00277712,0,.490163,.640772,.00261738,0,.515429,.624441,.0024737,0,.541445,.607497,.00233125,0,.568236,.590438,.00218994,0,.595828,.573224,.0020664,0,.624242,.556168,.00193526,0,.653496,.539232,.00182463,0,.683588,.522352,.00170735,0,.714482,.506172,.00160555,0,.746032,.489842,.00150451,0,.777778,.473463,.00140938,0,.809524,.457266,.00132568,0,.84127,.441609,.0012376,0,.873016,.426348,.00116265,0,.904762,.411002,.00108935,0,.936508,.396045,.00101946,0,.968254,.381448,955665e-9,0,1,1,.0037121,0,0,1,.00371213,0,0,1,.00371251,0,0,.999997,.00371417,0,0,.99999,.00371863,0,0,.999977,.00372807,0,0,.99995,.00374529,0,0,.999908,.0037738,0,0,.999843,.00381789,0,123596e-10,.999745,.00388273,0,407442e-9,.999608,.00397443,0,.0015447,.999415,.00409998,0,.00351385,.999143,.00426662,0,.0063316,.9987,.00447625,0,.00998679,.996363,.00455323,0,.0144569,.994021,.00461052,0,.0197151,.992372,.00476359,0,.0257344,.991007,.00499101,0,.0324882,.988767,.0051972,0,.0399517,.984872,.00528407,0,.0481022,.982004,.00548926,0,.0569191,.977714,.00564385,0,.0663839,.973076,.0057693,0,.0764801,.967565,.0058924,0,.0871928,.961384,.00599629,0,.0985095,.954435,.00605998,0,.110419,.946303,.0061133,0,.122912,.937662,.00612028,0,.13598,.927867,.00612209,0,.149617,.916475,.00604813,0,.163817,.90541,.00603088,0,.178577,.891591,.00592218,0,.193894,.877573,.00578854,0,.209767,.862511,.00566648,0,.226196,.846861,.00551481,0,.243182,.83068,.00533754,0,.260728,.815725,.00515487,0,.278837,.802321,.0049655,0,.297515,.787826,.00475421,0,.316768,.773454,.00456002,0,.336605,.758224,.00434727,0,.357034,.74265,.00414444,0,.378067,.726729,.00393738,0,.399717,.710155,.00373575,0,.421998,.693312,.00353736,0,.444928,.67653,.00334368,0,.468523,.659444,.00315981,0,.492806,.642051,.00297809,0,.517798,.625758,.00280592,0,.543525,.609615,.00264254,0,.570012,.592919,.00248459,0,.597288,.576298,.00233327,0,.625379,.559489,.00219519,0,.654307,.542891,.00205441,0,.684084,.526255,.00193385,0,.714693,.509853,.00180745,0,.746044,.494131,.00169817,0,.777778,.478114,.0015913,0,.809524,.462274,.00148981,0,.84127,.446412,.00139537,0,.873016,.431274,.00130984,0,.904762,.41635,.00122403,0,.936508,.401476,.00114809,0,.968254,.386993,.00107563,0,1,1,.00488216,0,0,1,.0048822,0,0,1,.00488265,0,0,.999997,.00488463,0,0,.999988,.00488999,0,0,.999974,.00490129,0,0,.999946,.00492191,0,0,.999897,.00495598,0,0,.999825,.00500855,0,744791e-10,.999718,.00508559,0,712744e-9,.999565,.005194,0,.00215249,.999352,.00534147,0,.00444576,.999046,.00553523,0,.00759218,.998492,.00577016,0,.0115714,.995564,.00578487,0,.0163557,.993339,.00586414,0,.021915,.991834,.00606002,0,.0282201,.990496,.00633312,0,.0352433,.987826,.00651941,0,.042959,.98383,.00660842,0,.0513439,.98109,.00685523,0,.0603772,.976131,.00695778,0,.0700402,.971922,.00714236,0,.0803163,.965901,.00721437,0,.0911908,.959606,.00732017,0,.102651,.952504,.00735788,0,.114686,.944365,.00738493,0,.127286,.935652,.00737969,0,.140443,.925813,.00733612,0,.154151,.914397,.00723094,0,.168405,.903257,.00714002,0,.183201,.890015,.00700149,0,.198536,.876014,.00682813,0,.214409,.861436,.00665567,0,.23082,.845752,.00644526,0,.24777,.829169,.00621635,0,.265263,.813435,.00597789,0,.283301,.799701,.00575694,0,.301889,.785726,.00549866,0,.321035,.77152,.0052503,0,.340746,.75683,.00499619,0,.361032,.741951,.0047543,0,.381904,.726367,.0045084,0,.403374,.710537,.00426784,0,.425457,.693965,.00403487,0,.448169,.677724,.0038075,0,.47153,.66117,.00359431,0,.495561,.644274,.00338354,0,.520284,.627449,.00318163,0,.545725,.611645,.00299672,0,.571911,.595614,.00281016,0,.598873,.579426,.00264252,0,.62664,.563016,.00247509,0,.655239,.546728,.00232647,0,.684692,.530539,.00217803,0,.714999,.514164,.00204216,0,.746106,.498344,.00191403,0,.777778,.482957,.00179203,0,.809524,.467336,.00167695,0,.84127,.451994,.00157567,0,.873016,.436514,.00147113,0,.904762,.42178,.00138034,0,.936508,.407271,.00129219,0,.968254,.392822,.0012098,0,1,1,.00637427,0,0,1,.00637431,0,0,.999999,.00637485,0,0,.999996,.00637721,0,0,.999987,.00638357,0,0,.999971,.006397,0,0,.999939,.00642142,0,0,.999888,.00646177,0,0,.999807,.00652387,0,207916e-9,.999689,.00661454,0,.00112051,.99952,.00674155,0,.00287719,.999283,.00691313,0,.00550145,.998936,.00713598,0,.00897928,.998165,.00738501,0,.0132829,.994847,.00734388,0,.01838,.993182,.00749991,0,.0242381,.991665,.0077246,0,.030826,.989708,.00797579,0,.0381152,.986663,.00813011,0,.0460794,.983288,.00830365,0,.0546951,.980104,.00853496,0,.0639411,.974855,.00861045,0,.0737988,.97045,.00879133,0,.0842516,.964509,.00886377,0,.0952848,.957594,.00890346,0,.106886,.950546,.00893289,0,.119044,.942225,.00890074,0,.131749,.933365,.00886826,0,.144994,.923202,.0087316,0,.158772,.912605,.00863082,0,.173078,.901099,.00847403,0,.187908,.888177,.00825838,0,.203261,.873955,.00801834,0,.219134,.860091,.00779026,0,.235527,.84434,.00752478,0,.252443,.828517,.00724074,0,.269883,.81239,.00693769,0,.287851,.79721,.00664817,0,.306352,.783489,.00634763,0,.325393,.769514,.00604221,0,.344981,.755419,.00573568,0,.365126,.741083,.00544359,0,.385839,.726059,.00515515,0,.407132,.710809,.00487139,0,.42902,.695052,.00459846,0,.45152,.678886,.00433412,0,.474651,.663042,.00407981,0,.498433,.646634,.00384264,0,.52289,.630117,.00360897,0,.548048,.613804,.00338863,0,.573936,.598338,.00318486,0,.600584,.582687,.00298377,0,.628027,.566809,.00280082,0,.656295,.550817,.00262255,0,.685417,.534937,.00245835,0,.715406,.519151,.00230574,0,.74624,.503118,.0021549,0,.777778,.487723,.00202008,0,.809524,.472725,.00189355,0,.84127,.457599,.00177108,0,.873016,.442558,.00165843,0,.904762,.427624,.00155494,0,.936508,.413171,.00145273,0,.968254,.399122,.00136454,0,1,1,.00826496,0,0,1,.00826499,0,0,1,.00826564,0,0,.999996,.00826842,0,0,.999987,.00827589,0,0,.999967,.00829167,0,0,.999933,.00832037,0,0,.999876,.00836768,0,109338e-10,.999786,.00844031,0,427145e-9,.999655,.00854603,0,.0016384,.999468,.00869337,0,.00372392,.999203,.008891,0,.00668513,.998803,.00914387,0,.0104968,.99748,.00935838,0,.015125,.994446,.00933309,0,.0205338,.99292,.00953084,0,.0266884,.991414,.0097893,0,.0335565,.989049,.0100228,0,.0411086,.98582,.0101664,0,.0493181,.982441,.0103582,0,.0581613,.978595,.0105292,0,.0676169,.973495,.0106274,0,.0776661,.968405,.0107261,0,.0882926,.962717,.0108234,0,.0994817,.955478,.0108102,0,.111221,.948275,.0107914,0,.123499,.940006,.0107161,0,.136308,.930831,.0106309,0,.149639,.920648,.0104083,0,.163485,.910205,.0102312,0,.177843,.898445,.0100051,0,.192707,.885986,.00971928,0,.208077,.872204,.00940747,0,.22395,.858436,.0091085,0,.240326,.843454,.00876595,0,.257208,.827437,.00839794,0,.274596,.811488,.00803692,0,.292496,.796039,.00767352,0,.310911,.781083,.0073097,0,.329849,.767642,.00694032,0,.349316,.753901,.00657476,0,.369323,.740131,.00622699,0,.38988,.725845,.0058838,0,.410999,.710991,.00555586,0,.432696,.696002,.00523089,0,.454987,.680461,.00492494,0,.47789,.664875,.00463464,0,.501426,.649273,.00435422,0,.52562,.63302,.0040875,0,.550498,.61705,.00384075,0,.576089,.601154,.00359557,0,.602427,.586008,.00337636,0,.629544,.570699,.00316019,0,.657479,.555166,.00296033,0,.686264,.539645,.00277552,0,.715924,.524159,.00259499,0,.746459,.508682,.00243257,0,.777789,.493163,.00227851,0,.809524,.478004,.00213083,0,.84127,.46347,.00199502,0,.873016,.448778,.00186967,0,.904762,.434105,.00174732,0,.936508,.419576,.00163861,0,.968254,.405541,.00153341,0,1,1,.0106462,0,0,1,.0106462,0,0,.999999,.010647,0,0,.999995,.0106502,0,0,.999985,.0106589,0,0,.999964,.0106773,0,0,.999925,.0107106,0,0,.999861,.0107655,0,712986e-10,.999763,.0108497,0,743959e-9,.999616,.0109716,0,.00227361,.999408,.0111408,0,.0046983,.999112,.0113659,0,.00800158,.998637,.0116475,0,.0121493,.996223,.0117231,0,.0171023,.994006,.0118064,0,.0228218,.992444,.0120254,0,.0292711,.991028,.0123314,0,.036417,.98803,.0124954,0,.0442295,.984816,.0126538,0,.0526815,.981399,.0128537,0,.0617492,.977085,.0129694,0,.0714114,.972154,.013091,0,.0816495,.966617,.0131166,0,.0924472,.960628,.0131583,0,.10379,.953295,.0131094,0,.115665,.94575,.0129966,0,.128062,.937654,.0128796,0,.140972,.927716,.0126477,0,.154387,.917932,.0123889,0,.168301,.907719,.012131,0,.182709,.89584,.0118013,0,.197608,.883526,.0114145,0,.212994,.870301,.0110075,0,.228867,.856272,.0106019,0,.245227,.842251,.0101938,0,.262074,.826466,.00973254,0,.279412,.810859,.0092846,0,.297244,.795051,.00883304,0,.315575,.780053,.00840272,0,.334412,.76575,.00796438,0,.35376,.752298,.00752526,0,.373631,.739153,.00711486,0,.394034,.725514,.00670361,0,.414983,.711473,.00632656,0,.436491,.696936,.00595206,0,.458575,.682126,.00559191,0,.481253,.667027,.00525362,0,.504547,.651875,.00493805,0,.528481,.636463,.00462848,0,.553081,.620641,.00433936,0,.578377,.604931,.00407,0,.604404,.589549,.00380864,0,.631197,.574712,.00357049,0,.658795,.559775,.00334466,0,.687238,.544514,.00312505,0,.716559,.529555,.00293199,0,.746776,.514402,.00274204,0,.777849,.499302,.00256647,0,.809524,.484114,.00239901,0,.84127,.469308,.00225148,0,.873016,.455133,.00210178,0,.904762,.440939,.0019727,0,.936508,.426627,.00184382,0,.968254,.412509,.00172548,0,1,1,.013628,0,0,1,.0136281,0,0,.999999,.0136289,0,0,.999995,.0136327,0,0,.999983,.0136427,0,0,.99996,.0136638,0,0,.999917,.0137022,0,0,.999846,.0137652,0,204597e-9,.999736,.0138615,0,.00116837,.999573,.0140007,0,.00303325,.99934,.0141927,0,.00580613,.999004,.0144457,0,.00945626,.998407,.0147489,0,.0139421,.995464,.014731,0,.0192202,.993328,.0148283,0,.0252495,.991799,.0150797,0,.0319921,.990397,.0154316,0,.0394138,.986835,.0155005,0,.0474843,.983938,.0157308,0,.0561763,.980154,.0158753,0,.0654661,.975659,.0159581,0,.0753326,.970171,.0159832,0,.0857571,.964803,.0160084,0,.0967236,.958366,.0159484,0,.108218,.950613,.0158001,0,.120227,.942874,.0155845,0,.132741,.935005,.0154292,0,.145751,.924991,.0150742,0,.159249,.914814,.0146757,0,.17323,.904743,.0143097,0,.187687,.893216,.0138695,0,.202619,.880769,.0133706,0,.218021,.868136,.0128606,0,.233894,.85469,.0123403,0,.250238,.840593,.0118091,0,.267052,.825808,.011253,0,.284341,.81009,.0107099,0,.302106,.79504,.0101636,0,.320354,.779757,.00964041,0,.33909,.764697,.00911896,0,.358322,.750913,.00859533,0,.378059,.738175,.00811592,0,.398311,.725242,.00764504,0,.41909,.711864,.00718885,0,.440412,.698009,.00675843,0,.462292,.683841,.00634984,0,.484748,.669391,.00595502,0,.507802,.654731,.00558671,0,.531477,.639805,.00523578,0,.555802,.624789,.00490834,0,.580805,.609325,.00459448,0,.606522,.593975,.00430342,0,.63299,.578983,.00403019,0,.66025,.564442,.0037707,0,.688346,.549835,.0035316,0,.717319,.535039,.00330255,0,.7472,.520403,.00308932,0,.777982,.505687,.00289335,0,.809524,.490939,.00270818,0,.84127,.476233,.0025343,0,.873016,.461624,.00237097,0,.904762,.447833,.00222065,0,.936508,.433992,.00207561,0,.968254,.420147,.00194955,0,1,1,.0173415,0,0,1,.0173416,0,0,.999999,.0173426,0,0,.999995,.0173468,0,0,.999983,.0173582,0,0,.999954,.0173822,0,0,.999908,.0174258,0,669501e-11,.999828,.0174973,0,427399e-9,.999705,.0176063,0,.00171019,.999524,.0177631,0,.0039248,.999263,.0179781,0,.00705382,.998878,.018258,0,.0110552,.998012,.0185551,0,.0158812,.994614,.0184264,0,.0214852,.993132,.0186385,0,.0278239,.991563,.0189067,0,.0348585,.989298,.0191577,0,.0425544,.986036,.0192522,0,.050881,.982558,.0194063,0,.059811,.978531,.019486,0,.0693209,.974198,.0195847,0,.0793895,.968148,.0194749,0,.0899984,.962565,.0194277,0,.101132,.956041,.0192991,0,.112775,.947749,.0189893,0,.124917,.94018,.018704,0,.137547,.93165,.0183458,0,.150655,.921798,.0178775,0,.164236,.911573,.0173618,0,.178281,.901569,.0168482,0,.192788,.890341,.016265,0,.207752,.877835,.0156199,0,.223171,.865472,.0149516,0,.239044,.852905,.0143274,0,.255371,.838906,.0136643,0,.272153,.824888,.0129903,0,.289393,.809977,.0123218,0,.307093,.794697,.0116572,0,.325259,.780028,.0110307,0,.343896,.765124,.0104236,0,.363012,.750411,.0098219,0,.382617,.737264,.00924397,0,.402719,.724799,.00868719,0,.423332,.712253,.00816476,0,.444469,.699267,.00767262,0,.466146,.685618,.00719746,0,.488383,.671736,.00673916,0,.511199,.657777,.00631937,0,.534618,.643497,.00592411,0,.558668,.62889,.00553928,0,.58338,.614299,.0051934,0,.608787,.599197,.00485985,0,.634929,.584175,.00454357,0,.661849,.569541,.00425787,0,.689594,.555193,.00397905,0,.718211,.540947,.00372364,0,.747742,.526593,.00348599,0,.778205,.512335,.00326103,0,.80953,.498017,.00305137,0,.84127,.483609,.00285485,0,.873016,.469368,.00267472,0,.904762,.455037,.00249945,0,.936508,.441493,.00234792,0,.968254,.428147,.00219936,0,1,1,.0219422,0,0,1,.0219423,0,0,.999998,.0219434,0,0,.999993,.0219481,0,0,.999981,.021961,0,0,.999949,.0219879,0,0,.999896,.0220367,0,593194e-10,.999808,.0221167,0,75364e-8,.99967,.0222383,0,.00237884,.999466,.0224125,0,.00495612,.999174,.0226495,0,.00844887,.998725,.0229525,0,.0128058,.996979,.0231123,0,.0179742,.994317,.0230742,0,.0239047,.992781,.0232895,0,.0305526,.991191,.0235734,0,.0378786,.987787,.0236152,0,.0458475,.985092,.0237994,0,.0544287,.981121,.0238553,0,.0635952,.976924,.0238706,0,.0733233,.97218,.0238704,0,.0835922,.965956,.0236598,0,.0943839,.959998,.0234735,0,.105682,.953245,.0232277,0,.117474,.944445,.0226973,0,.129747,.937087,.0223527,0,.142491,.928341,.0218144,0,.155697,.9184,.0211516,0,.169358,.907959,.0204553,0,.183469,.89808,.0197673,0,.198024,.887047,.0189915,0,.21302,.875221,.0182082,0,.228455,.86269,.0173584,0,.244329,.850735,.0165718,0,.260639,.837545,.0157524,0,.277389,.823639,.0149482,0,.29458,.809699,.0141431,0,.312216,.794797,.0133527,0,.3303,.780578,.0126193,0,.34884,.766019,.0118914,0,.367842,.751447,.0111839,0,.387315,.737275,.010514,0,.40727,.724545,.00987277,0,.427717,.712644,.00926569,0,.448671,.700432,.00869029,0,.470149,.687664,.00814691,0,.492167,.674288,.00763012,0,.514746,.660966,.00714437,0,.537911,.647264,.00668457,0,.561688,.633431,.00626581,0,.586108,.619133,.00585593,0,.611206,.604935,.00548188,0,.637022,.590236,.00513288,0,.663599,.575473,.0047906,0,.690989,.561228,.00448895,0,.719242,.547054,.00420233,0,.748411,.533175,.00392869,0,.778531,.519163,.00367445,0,.809583,.505328,.00344097,0,.84127,.491446,.00322003,0,.873016,.477356,.00301283,0,.904762,.46356,.00282592,0,.936508,.449623,.00264956,0,.968254,.436068,.00246956,0,1,1,.0276135,0,0,1,.0276136,0,0,.999998,.0276148,0,0,.999993,.0276201,0,0,.999976,.0276342,0,0,.999945,.027664,0,0,.999884,.0277179,0,18679e-8,.999784,.027806,0,.00119607,.99963,.0279394,0,.00318407,.999401,.0281295,0,.00613601,.999066,.0283858,0,.00999963,.998524,.0287027,0,.0147164,.995702,.0286256,0,.0202295,.993593,.0286733,0,.0264876,.992067,.0288989,0,.0334452,.990548,.0292135,0,.0410621,.986775,.0291296,0,.0493032,.984054,.0293099,0,.0581381,.979481,.0291881,0,.0675397,.975297,.0291598,0,.0774848,.96981,.028954,0,.0879528,.963524,.028628,0,.0989258,.957398,.0283135,0,.110388,.950088,.0278469,0,.122327,.941538,.0271798,0,.134729,.933332,.0265388,0,.147587,.924392,.0257776,0,.160889,.914581,.024916,0,.174631,.904347,.0240242,0,.188806,.894324,.0231229,0,.203409,.883724,.022153,0,.218437,.872207,.0211355,0,.233888,.859927,.0201048,0,.249761,.848373,.0191263,0,.266056,.836023,.0181306,0,.282774,.82289,.0171718,0,.299917,.809324,.0162196,0,.317488,.795361,.0152622,0,.335493,.781253,.01439,0,.353936,.767338,.013533,0,.372825,.753156,.0127244,0,.392168,.739122,.0119454,0,.411976,.725358,.0112054,0,.432259,.712949,.010487,0,.453032,.701621,.00984032,0,.47431,.689703,.00921495,0,.496111,.677216,.00862492,0,.518456,.664217,.00806882,0,.541367,.65137,.00755922,0,.564872,.638,.00705705,0,.589001,.62453,.00661266,0,.613789,.610601,.00618432,0,.639277,.59676,.00578033,0,.66551,.582433,.00540927,0,.692539,.568026,.00506104,0,.720422,.55414,.0047353,0,.749216,.540178,.00442889,0,.778974,.526513,.00414363,0,.809711,.512954,.00388237,0,.84127,.499403,.00362875,0,.873016,.486026,.00340827,0,.904762,.472345,.00318598,0,.936508,.458828,.00297635,0,.968254,.445379,.00279447,0,1,1,.0345716,0,0,1,.0345717,0,0,.999999,.034573,0,0,.999991,.0345787,0,0,.999974,.0345941,0,0,.999937,.0346263,0,188589e-11,.999869,.0346847,0,409238e-9,.999757,.0347798,0,.0017674,.999582,.0349233,0,.00413658,.999322,.0351265,0,.00747408,.998939,.0353967,0,.0117157,.998219,.0357018,0,.0167966,.994974,.0354726,0,.0226572,.993201,.0355621,0,.0292445,.991573,.0357641,0,.0365123,.989301,.0359252,0,.0444203,.985712,.0358017,0,.0529334,.982411,.0358353,0,.0620214,.977827,.035617,0,.0716574,.973278,.0354398,0,.0818186,.967397,.0350483,0,.0924846,.960696,.0344795,0,.103638,.954349,.0339861,0,.115263,.946066,.0331323,0,.127348,.938012,.032359,0,.13988,.929413,.0314413,0,.152849,.920355,.0304103,0,.166248,.910586,.0292785,0,.18007,.900609,.0281391,0,.194308,.890093,.0269103,0,.208958,.880013,.0257269,0,.224018,.869001,.0244671,0,.239485,.85751,.0232252,0,.255359,.84582,.0220117,0,.271638,.834383,.0208274,0,.288324,.822158,.0196628,0,.305419,.809056,.0185306,0,.322927,.795832,.0174174,0,.340851,.782547,.0163758,0,.359199,.7689,.015391,0,.377975,.755526,.0144488,0,.397189,.741681,.0135372,0,.416851,.728178,.0126957,0,.436971,.714642,.0118812,0,.457564,.702756,.0111165,0,.478644,.69175,.0104145,0,.500229,.680159,.00974439,0,.522339,.668073,.00911926,0,.544997,.655405,.00851393,0,.56823,.642921,.00797637,0,.592068,.629993,.00745119,0,.616546,.616828,.00696972,0,.641705,.603305,.00652425,0,.66759,.589833,.00610188,0,.694255,.575945,.00570834,0,.72176,.561745,.00533384,0,.750168,.548277,.00500001,0,.779545,.534467,.00467582,0,.809933,.521032,.00438092,0,.841272,.507877,.00410348,0,.873016,.494654,.00383618,0,.904762,.481592,.00358699,0,.936508,.468509,.00337281,0,.968254,.455293,.00316196,0,1,1,.0430698,0,0,1,.0430699,0,0,.999998,.0430713,0,0,.999991,.0430773,0,0,.99997,.0430936,0,0,.999928,.0431277,0,406396e-10,.999852,.0431893,0,744376e-9,.999724,.0432895,0,.0024806,.999527,.0434397,0,.00524779,.99923,.0436507,0,.00898164,.998783,.0439255,0,.0136083,.997507,.0441104,0,.0190582,.994418,.0438225,0,.0252694,.992864,.0439396,0,.0321879,.991127,.0440962,0,.039767,.987331,.0438408,0,.0479667,.984819,.0438991,0,.056752,.980384,.0435906,0,.0660929,.975846,.0432543,0,.075963,.970748,.0428293,0,.0863398,.964303,.042153,0,.0972035,.95772,.0414111,0,.108537,.950747,.0405893,0,.120325,.942533,.0394887,0,.132554,.934045,.0383544,0,.145215,.924942,.037057,0,.158296,.915811,.0356993,0,.17179,.90612,.0342401,0,.185691,.896434,.0328078,0,.199993,.886021,.031288,0,.214691,.876081,.0297776,0,.229782,.865608,.0282334,0,.245265,.854924,.026749,0,.261138,.843607,.02526,0,.277401,.832456,.0238214,0,.294056,.821342,.0224682,0,.311104,.809303,.0211297,0,.328548,.796468,.0198387,0,.346394,.784046,.0186227,0,.364645,.771262,.0174561,0,.38331,.758118,.0163806,0,.402396,.745075,.0153287,0,.421912,.731926,.0143647,0,.44187,.71863,.0134363,0,.462283,.705414,.0125603,0,.483165,.693792,.0117508,0,.504535,.683108,.0110016,0,.52641,.67183,.0102757,0,.548816,.66015,.00962044,0,.571776,.647907,.00898031,0,.595323,.635734,.00840811,0,.619489,.623208,.00786211,0,.644317,.610438,.00734953,0,.669852,.597345,.00687688,0,.696148,.584138,.00643469,0,.723267,.5707,.00602236,0,.75128,.556966,.0056324,0,.780258,.543607,.00528277,0,.810268,.530213,.00493999,0,.841311,.516912,.00462265,0,.873016,.503916,.0043307,0,.904762,.491146,.00406858,0,.936508,.478439,.00381436,0,.968254,.465834,.00358003,0,1,1,.0534039,0,0,1,.053404,0,0,.999998,.0534055,0,0,.999989,.0534116,0,0,.999968,.0534283,0,0,.999918,.0534633,0,155895e-9,.99983,.0535262,0,.00120914,.999685,.0536281,0,.00334944,.999461,.0537799,0,.00653077,.999119,.0539902,0,.0106718,.998582,.0542524,0,.0156907,.995919,.0540318,0,.0215147,.993735,.0538914,0,.0280801,.992126,.0539557,0,.0353323,.990266,.0540401,0,.0432247,.986317,.0536064,0,.0517172,.983213,.0534425,0,.0607754,.978303,.0528622,0,.0703698,.973665,.0523363,0,.0804742,.968091,.0516165,0,.0910667,.961026,.0505434,0,.102128,.954333,.049523,0,.113641,.946372,.0481698,0,.125591,.938254,.0467674,0,.137965,.929516,.0452341,0,.150754,.920106,.0435083,0,.163947,.910899,.0417399,0,.177537,.901532,.0399389,0,.191516,.891919,.0380901,0,.205881,.882006,.0362341,0,.220626,.871965,.0343444,0,.235749,.862145,.0324832,0,.251248,.852058,.0306681,0,.267121,.84161,.0289097,0,.283368,.830806,.0272079,0,.299992,.820476,.0256089,0,.316992,.809514,.0240394,0,.334374,.797865,.0225379,0,.35214,.785621,.0211235,0,.370296,.773765,.0197908,0,.388849,.761629,.0185235,0,.407807,.748891,.0173358,0,.427178,.736437,.0162305,0,.446974,.723707,.0151778,0,.467207,.710606,.0141791,0,.487892,.698019,.0132592,0,.509046,.686203,.0123887,0,.530687,.675692,.0115976,0,.552839,.664826,.0108325,0,.575527,.65349,.0101348,0,.59878,.641774,.00947756,0,.622634,.629794,.00886058,0,.647128,.617647,.00828526,0,.672308,.60534,.00775312,0,.698231,.592718,.00726033,0,.724958,.579746,.00679731,0,.752563,.566763,.00636111,0,.781127,.553515,.00595228,0,.810733,.540118,.00556876,0,.841426,.527325,.00523051,0,.873016,.514265,.00490712,0,.904762,.501406,.00460297,0,.936508,.488922,.00431247,0,.968254,.476541,.0040472,0,1,1,.0659184,0,0,1,.0659185,0,0,.999998,.06592,0,0,.999988,.0659259,0,0,.999963,.0659423,0,0,.999907,.0659764,0,374198e-9,.999806,.0660376,0,.00182071,.999639,.0661361,0,.0043894,.999378,.0662814,0,.00800055,.998985,.0664779,0,.0125594,.998285,.0666914,0,.0179786,.995071,.0661989,0,.0241822,.993172,.0660454,0,.031106,.991438,.0660105,0,.0386952,.988428,.0656875,0,.0469032,.985218,.0652913,0,.0556905,.981128,.0647107,0,.065023,.976015,.0638491,0,.0748717,.97097,.062993,0,.0852112,.964582,.0617927,0,.0960199,.957383,.0603626,0,.107279,.949969,.0588128,0,.118971,.941843,.0570274,0,.131084,.933624,.0551885,0,.143604,.924543,.053122,0,.156521,.914919,.0508897,0,.169825,.905773,.0486418,0,.18351,.896434,.0463364,0,.197569,.887195,.0440623,0,.211997,.877706,.0417799,0,.226789,.867719,.03945,0,.241944,.858587,.037243,0,.257458,.849317,.0350956,0,.273331,.839585,.0329852,0,.289563,.829856,.0310028,0,.306154,.819589,.0290953,0,.323108,.809714,.0272738,0,.340426,.79934,.0255631,0,.358113,.788224,.0239175,0,.376175,.776619,.0223831,0,.394616,.76521,.0209298,0,.413445,.753716,.0195786,0,.432671,.741564,.0183001,0,.452305,.729413,.0171259,0,.472358,.717146,.0159933,0,.492845,.70436,.0149495,0,.513783,.69219,.0139681,0,.535189,.680289,.0130577,0,.557087,.669611,.0122198,0,.5795,.659113,.0114174,0,.602459,.648148,.0106729,0,.625997,.636905,.00998997,0,.650154,.625154,.00934313,0,.674976,.613481,.00874839,0,.700518,.60154,.00818265,0,.726845,.58943,.00766889,0,.754032,.576828,.00717153,0,.782167,.564194,.00672696,0,.811344,.551501,.00630863,0,.841644,.538635,.00592177,0,.873016,.525724,.00554888,0,.904762,.513209,.00520225,0,.936508,.500457,.00488231,0,.968254,.48799,.00457153,0,1,1,.0810131,0,0,1,.0810133,0,0,.999997,.0810145,0,0,.999985,.08102,0,0,.999956,.0810347,0,195026e-10,.999893,.0810656,0,719316e-9,.999777,.0811205,0,.00259774,.999583,.081208,0,.00561807,.999281,.0813343,0,.00967472,.998813,.0814969,0,.0146627,.997597,.0815217,0,.0204902,.994379,.0808502,0,.0270802,.992744,.0806792,0,.0343674,.990745,.0804589,0,.0422974,.986646,.0796107,0,.0508242,.983611,.0790913,0,.0599087,.978869,.0780746,0,.0695175,.973475,.0768218,0,.0796223,.967845,.0754926,0,.0901983,.960778,.0737063,0,.101224,.953333,.0718052,0,.112682,.945274,.0695946,0,.124555,.936955,.0672492,0,.136831,.928319,.0647732,0,.149496,.919075,.0620947,0,.162542,.909114,.0591816,0,.175958,.900137,.0563917,0,.189739,.891069,.0535392,0,.203877,.882262,.0507642,0,.218368,.873232,.0479793,0,.233208,.864042,.045226,0,.248393,.855002,.0425413,0,.263923,.846569,.0400126,0,.279796,.837714,.0375269,0,.296012,.828918,.0352027,0,.312573,.819783,.0330011,0,.329479,.810129,.0308908,0,.346734,.800866,.0289112,0,.364342,.79093,.0270255,0,.382307,.780593,.0252758,0,.400637,.769511,.0236178,0,.419337,.758558,.0220652,0,.438418,.747632,.0206289,0,.457889,.736146,.0192873,0,.477761,.724093,.0180333,0,.49805,.71234,.0168264,0,.51877,.700201,.015746,0,.53994,.687949,.0147027,0,.561581,.676163,.0137512,0,.583718,.665001,.0128655,0,.60638,.65472,.0120366,0,.629599,.644213,.0112604,0,.653415,.633382,.0105413,0,.677874,.62212,.00986498,0,.70303,.610631,.00923308,0,.728948,.599078,.00864206,0,.755706,.587519,.00811784,0,.783396,.575505,.00761237,0,.812121,.563148,.00713949,0,.841989,.550828,.00668379,0,.873035,.538458,.00627715,0,.904762,.525905,.00588336,0,.936508,.513517,.00552687,0,.968254,.501395,.00519681,0,1,1,.0991506,0,0,1,.0991504,0,0,.999996,.0991515,0,0,.999984,.0991558,0,0,.999947,.0991672,0,114389e-9,.999874,.0991912,0,.00121503,.999739,.0992331,0,.00356108,.999514,.0992983,0,.00705578,.999159,.0993877,0,.011574,.998586,.0994837,0,.017003,.995731,.0988425,0,.0232484,.993384,.098276,0,.0302318,.991615,.0979269,0,.0378884,.989029,.0973432,0,.0461641,.985373,.0963539,0,.0550136,.981278,.0952306,0,.0643988,.975777,.0936233,0,.0742868,.970526,.0920219,0,.0846501,.963755,.0898912,0,.0954644,.956676,.0876064,0,.106709,.948099,.0847751,0,.118367,.939718,.0818638,0,.130423,.931305,.078857,0,.142862,.922342,.0756127,0,.155674,.912842,.0721473,0,.168849,.903304,.0686195,0,.182378,.89411,.0650589,0,.196255,.885512,.0616022,0,.210473,.877193,.0582434,0,.225027,.86877,.0548979,0,.239915,.860267,.0516095,0,.255132,.851915,.048468,0,.270678,.843912,.0454447,0,.286551,.83604,.0425612,0,.302751,.828245,.0398752,0,.31928,.820159,.0373198,0,.336138,.81167,.034916,0,.35333,.802659,.0326402,0,.370858,.793921,.0304901,0,.388728,.784713,.0284857,0,.406944,.774946,.0266186,0,.425515,.76448,.0248593,0,.444449,.753793,.0232114,0,.463756,.743506,.0217039,0,.483447,.732555,.0202841,0,.503535,.720965,.0189648,0,.524036,.709422,.0177189,0,.544968,.697756,.0165626,0,.56635,.685565,.015483,0,.588208,.673987,.0144892,0,.610569,.66244,.0135607,0,.633466,.651675,.0126956,0,.656936,.641598,.0118788,0,.681025,.63121,.0111261,0,.705788,.620514,.010437,0,.731289,.609366,.00978747,0,.757606,.598137,.00917257,0,.784834,.586966,.00859778,0,.813085,.575549,.00806803,0,.842485,.563797,.00757294,0,.87313,.551758,.00710592,0,.904762,.539894,.0066841,0,.936508,.527901,.00627901,0,.968254,.515819,.00590506,0,1,1,.120864,0,0,1,.120864,0,0,.999996,.120864,0,0,.99998,.120867,0,0,.99994,.120872,0,323781e-9,.999852,.120884,0,.00188693,.999693,.120903,0,.00473489,.999426,.120929,0,.00872704,.999002,.120955,0,.0137237,.998235,.120918,0,.0196068,.994608,.119764,0,.0262803,.992997,.119265,0,.0336657,.990968,.11863,0,.0416987,.987002,.117261,0,.0503261,.983524,.116009,0,.0595035,.97875,.114252,0,.0691935,.972652,.11193,0,.0793645,.966613,.109555,0,.0899894,.959275,.106612,0,.101045,.951272,.103375,0,.112512,.942323,.0996594,0,.124372,.933679,.0958841,0,.136611,.924822,.0919265,0,.149216,.915742,.0878061,0,.162176,.906348,.0834894,0,.175482,.896883,.079085,0,.189125,.88774,.0746745,0,.203098,.87986,.0705773,0,.217396,.871998,.0665005,0,.232015,.864325,.0625413,0,.24695,.856685,.0586781,0,.2622,.84925,.0550063,0,.277761,.841719,.0514727,0,.293634,.834755,.0481398,0,.309819,.827853,.0450172,0,.326315,.820888,.0420969,0,.343126,.813616,.0393702,0,.360254,.805767,.0367771,0,.377701,.797338,.0343274,0,.395474,.789122,.0320529,0,.413577,.780601,.0299485,0,.432018,.771424,.0279812,0,.450804,.761502,.0261054,0,.469944,.751166,.0243942,0,.489451,.741276,.0228087,0,.509337,.730898,.0213265,0,.529617,.719878,.0199307,0,.550307,.708379,.0186574,0,.571428,.697165,.0174446,0,.593003,.685554,.0163144,0,.615059,.673631,.015276,0,.637628,.662385,.0143003,0,.660746,.651059,.0134112,0,.68446,.640451,.0125794,0,.70882,.630536,.011793,0,.733893,.620316,.0110547,0,.759756,.609722,.0103668,0,.786505,.598804,.00973009,0,.814259,.587871,.00912812,0,.843157,.577121,.00858916,0,.87334,.566019,.00807333,0,.904762,.554664,.00759687,0,.936508,.543101,.00714759,0,.968254,.531558,.00673418,0,1,1,.146767,0,0,1,.146767,0,0,.999997,.146767,0,0,.999977,.146765,0,320658e-11,.999929,.146762,0,682576e-9,.999823,.146753,0,.00276402,.999633,.146735,0,.00614771,.999314,.146699,0,.0106613,.998796,.14662,0,.0161546,.997124,.146107,0,.0225063,.994062,.144857,0,.0296198,.992154,.144011,0,.037417,.989186,.142712,0,.0458348,.985279,.140926,0,.0548211,.980826,.13885,0,.0643326,.975056,.136168,0,.074333,.969005,.133217,0,.0847917,.961554,.12959,0,.0956828,.954206,.125886,0,.106984,.945046,.121335,0,.118675,.935678,.116492,0,.130741,.926748,.111635,0,.143166,.917764,.106625,0,.155939,.908358,.101325,0,.169049,.899219,.0960249,0,.182487,.890089,.0906527,0,.196245,.881488,.0853905,0,.210317,.874031,.0804177,0,.224697,.866932,.0756005,0,.23938,.859976,.0709019,0,.254364,.853375,.0664391,0,.269646,.846971,.0622012,0,.285223,.840483,.058129,0,.301096,.833969,.0542762,0,.317265,.82806,.0507042,0,.333729,.822128,.047368,0,.350491,.815989,.044272,0,.367554,.809336,.0413444,0,.38492,.802177,.038601,0,.402594,.79441,.0360227,0,.420582,.786573,.0336383,0,.438891,.778619,.0314321,0,.457527,.77,.029362,0,.476499,.760698,.0274102,0,.49582,.750932,.0256146,0,.5155,.740993,.023974,0,.535555,.731159,.0224182,0,.556,.720836,.0209889,0,.576855,.709913,.0196411,0,.598143,.698415,.0183824,0,.619888,.68745,.0172222,0,.642123,.676154,.0161509,0,.664883,.664383,.0151397,0,.688211,.6533,.0141873,0,.71216,.642072,.0133105,0,.736792,.631412,.0124932,0,.762186,.621622,.0117408,0,.788439,.611681,.0110358,0,.815672,.60142,.0103775,0,.844034,.59083,.00975623,0,.873699,.580254,.00918084,0,.904765,.569841,.00864721,0,.936508,.559224,.00815731,0,.968254,.548315,.00767924,0,1,1,.177563,0,0,1,.177563,0,0,.999994,.177562,0,0,.999972,.177555,0,664171e-10,.999914,.177536,0,.0012276,.999787,.177496,0,.00388025,.999556,.17742,0,.00783463,.999165,.177285,0,.0128953,.9985,.177037,0,.0189053,.995388,.175634,0,.025742,.993102,.174375,0,.033309,.990992,.173121,0,.0415298,.986932,.170896,0,.0503425,.982786,.16847,0,.0596964,.977592,.165455,0,.0695498,.971075,.161676,0,.0798676,.963967,.157458,0,.0906201,.956397,.152836,0,.101783,.947489,.147467,0,.113333,.937564,.14145,0,.125254,.928182,.135383,0,.137529,.919027,.129212,0,.150144,.909618,.12276,0,.163088,.900492,.116273,0,.176351,.891671,.1098,0,.189924,.883146,.103362,0,.203799,.875151,.0970799,0,.21797,.868338,.0911732,0,.232433,.862033,.0854966,0,.247182,.856107,.0800691,0,.262216,.850644,.0749618,0,.27753,.845261,.070079,0,.293124,.839885,.0654321,0,.308997,.834609,.0610975,0,.325149,.829083,.0569741,0,.341581,.82404,.0531736,0,.358294,.818968,.049665,0,.37529,.813496,.0463856,0,.392573,.807533,.0433217,0,.410148,.80099,.0404402,0,.428019,.793891,.0377578,0,.446192,.786281,.0352616,0,.464676,.778773,.0329577,0,.483478,.770737,.030808,0,.502608,.762094,.0287964,0,.522079,.752898,.0269254,0,.541905,.743306,.0251926,0,.5621,.733416,.023595,0,.582684,.723742,.0221155,0,.603677,.713542,.0207435,0,.625106,.702755,.019434,0,.646998,.691484,.0182046,0,.66939,.680531,.0170771,0,.692324,.66953,.0160339,0,.715849,.658126,.0150677,0,.740028,.646933,.0141551,0,.764937,.636107,.0133179,0,.790673,.625271,.0125284,0,.817358,.615225,.0117937,0,.84515,.605678,.0111181,0,.874244,.59583,.0104759,0,.904828,.585704,.00986672,0,.936508,.575413,.00929712,0,.968254,.565373,.00876713,0,1,1,.214058,0,0,.999999,.214058,0,0,.999994,.214055,0,0,.999966,.214039,0,259642e-9,.999893,.213998,0,.00200075,.999737,.21391,0,.00527775,.999449,.213745,0,.00983959,.99896,.213458,0,.0154755,.9979,.212855,0,.0220249,.994278,.210779,0,.0293654,.992254,.20926,0,.0374021,.98881,.206908,0,.0460604,.984715,.204009,0,.0552802,.979738,.200471,0,.0650127,.972884,.195813,0,.0752175,.965996,.190856,0,.0858612,.957974,.185077,0,.0969155,.949155,.17868,0,.108356,.939288,.171513,0,.120163,.928996,.163838,0,.132319,.919563,.156246,0,.144808,.910004,.148359,0,.157618,.900791,.140417,0,.170737,.892135,.132569,0,.184155,.883803,.124741,0,.197866,.876034,.117091,0,.211861,.869219,.109835,0,.226134,.863062,.102859,0,.240682,.857795,.0962928,0,.255499,.853009,.0900725,0,.270583,.848603,.0842101,0,.285931,.844335,.0786527,0,.301542,.840208,.0734397,0,.317415,.836035,.0685334,0,.33355,.83172,.0639275,0,.349948,.827135,.0595909,0,.36661,.822797,.0556204,0,.383539,.818387,.0519394,0,.400738,.813565,.0485317,0,.41821,.808142,.0453138,0,.435961,.802212,.0423354,0,.453997,.79573,.0395553,0,.472324,.788741,.036988,0,.490951,.781093,.0345688,0,.509887,.773597,.0323297,0,.529144,.765622,.0302719,0,.548735,.757083,.0283477,0,.568674,.747992,.0265562,0,.588979,.738591,.0248844,0,.609671,.728719,.0233342,0,.630773,.719146,.0219081,0,.652314,.709165,.0205711,0,.674328,.69875,.0193248,0,.696854,.687884,.0181582,0,.719942,.676818,.0170746,0,.743651,.666247,.0160718,0,.768057,.655284,.0151262,0,.793253,.64401,.0142561,0,.819363,.633353,.0134327,0,.846547,.622674,.012653,0,.875017,.612265,.0119354,0,.905021,.602455,.0112533,0,.936508,.593147,.0106234,0,.968254,.583592,.0100213,0,1,1,.25717,0,0,1,.25717,0,0,.999992,.257164,0,0,.999958,.257135,0,641715e-9,.999864,.25706,0,.00305314,.999666,.256897,0,.00700975,.999302,.256596,0,.0122194,.998663,.25607,0,.0184622,.995607,.254123,0,.0255773,.993094,.252081,0,.0334439,.9907,.249867,0,.0419696,.98594,.246118,0,.0510823,.981214,.242049,0,.0607242,.974966,.236869,0,.0708486,.967589,.230724,0,.081417,.95915,.223635,0,.0923974,.950257,.21596,0,.103763,.940165,.207296,0,.115491,.929396,.197901,0,.127562,.919288,.188437,0,.13996,.909428,.178762,0,.15267,.900105,.169072,0,.165679,.891418,.159478,0,.178979,.883347,.15002,0,.192558,.875992,.140813,0,.20641,.869466,.13196,0,.220529,.863699,.123501,0,.234907,.858553,.115436,0,.249542,.854379,.107901,0,.264428,.850894,.10088,0,.279564,.847632,.0942296,0,.294947,.844571,.0879861,0,.310575,.84163,.0821534,0,.326448,.838542,.0766409,0,.342566,.835412,.0715322,0,.358929,.831899,.0666883,0,.37554,.828177,.0622175,0,.392399,.82416,.0580452,0,.409511,.820393,.054267,0,.426878,.816068,.0507172,0,.444506,.811201,.0474041,0,.4624,.805785,.0443174,0,.480566,.799878,.0414562,0,.499013,.793469,.0388147,0,.517749,.786473,.0363453,0,.536785,.778874,.0340225,0,.556134,.771277,.0318599,0,.575809,.763426,.0298859,0,.595827,.755044,.0280357,0,.616207,.746161,.0262979,0,.636973,.737124,.0247295,0,.65815,.72761,.0232514,0,.679772,.717822,.0218755,0,.701876,.708279,.0205942,0,.724509,.698333,.0193947,0,.74773,.68802,.0182717,0,.771609,.677321,.0172044,0,.79624,.666504,.0162122,0,.821743,.656184,.0152924,0,.84828,.64556,.0144326,0,.876069,.634636,.0136157,0,.905404,.624124,.0128612,0,.936508,.613914,.0121435,0,.968254,.603589,.0114887,0,1,1,.307946,0,0,.999999,.307945,0,0,.999988,.307934,0,204479e-10,.999944,.307886,0,.00127833,.999824,.307756,0,.00445047,.999565,.30748,0,.00914673,.999085,.306966,0,.0150498,.998103,.306004,0,.0219367,.994249,.303028,0,.0296485,.991807,.300435,0,.038068,.987773,.296554,0,.0471062,.982673,.2916,0,.0566942,.976623,.285641,0,.0667768,.968757,.27815,0,.0773099,.959849,.269529,0,.088257,.950663,.260248,0,.0995879,.940129,.249704,0,.111277,.92895,.238291,0,.123304,.917996,.226501,0,.13565,.907813,.214669,0,.148299,.898305,.202835,0,.161237,.889626,.191158,0,.174455,.88175,.179695,0,.187941,.874715,.168548,0,.201687,.868746,.15792,0,.215687,.863703,.147807,0,.229933,.859315,.138149,0,.24442,.855538,.128993,0,.259145,.852428,.120414,0,.274103,.850168,.112498,0,.289293,.848132,.105054,0,.304711,.846291,.0981087,0,.320357,.844431,.0915942,0,.33623,.842493,.0855056,0,.35233,.840368,.0798204,0,.368658,.83798,.0745097,0,.385214,.83523,.0695424,0,.402002,.832091,.0649092,0,.419023,.828667,.0606291,0,.436282,.824805,.0566523,0,.453782,.820988,.0530229,0,.471529,.816635,.0496364,0,.489528,.811725,.0464658,0,.507788,.806316,.0435082,0,.526317,.800469,.0407873,0,.545124,.794107,.038255,0,.564221,.787218,.0358825,0,.583621,.779872,.0336785,0,.603341,.772097,.0316379,0,.623397,.764484,.0297379,0,.643812,.756428,.0279581,0,.664611,.748022,.0263153,0,.685824,.739268,.0247799,0,.707488,.73024,.0233385,0,.729646,.720893,.0220035,0,.752354,.71119,.0207555,0,.77568,.701791,.0195843,0,.799715,.692184,.0184891,0,.824574,.682258,.0174541,0,.850417,.67206,.0164873,0,.877466,.661717,.0155959,0,.90604,.651462,.0147519,0,.936528,.641467,.0139727,0,.968254,.631229,.0132363,0,1,1,.367573,0,0,.999999,.367571,0,0,.999984,.367553,0,183382e-9,.999925,.367473,0,.00225254,.999759,.367259,0,.00628165,.99941,.366801,0,.0117858,.998739,.365946,0,.0184359,.995529,.363191,0,.0260114,.992875,.360171,0,.0343581,.989135,.355981,0,.0433637,.984166,.350401,0,.0529438,.977871,.343348,0,.0630334,.96951,.334341,0,.0735805,.959964,.323862,0,.0845437,.950162,.312521,0,.095889,.938882,.299577,0,.107588,.926992,.285573,0,.119617,.915589,.271212,0,.131957,.904791,.256611,0,.144591,.895177,.242224,0,.157503,.886403,.227952,0,.170682,.878957,.214192,0,.184117,.872418,.200795,0,.197799,.867029,.188015,0,.21172,.862835,.175975,0,.225873,.859411,.164526,0,.240253,.856655,.153693,0,.254854,.854519,.14352,0,.269673,.852828,.13397,0,.284707,.851412,.124984,0,.299953,.850609,.116748,0,.315408,.849855,.10905,0,.331073,.849017,.101839,0,.346946,.848079,.0951359,0,.363028,.846911,.0888774,0,.379318,.845445,.0830375,0,.395818,.84362,.0775844,0,.41253,.841411,.0725054,0,.429457,.838768,.0677691,0,.446602,.835801,.0634016,0,.463968,.832341,.0593095,0,.481561,.828424,.0555121,0,.499386,.824312,.052024,0,.51745,.819918,.0487865,0,.535761,.815072,.0457801,0,.554328,.809863,.0430184,0,.573162,.804164,.0404245,0,.592275,.798034,.0380146,0,.611681,.791436,.0357436,0,.631398,.784498,.0336475,0,.651445,.777125,.0316666,0,.671845,.769365,.0298122,0,.692628,.761579,.0281001,0,.713827,.753746,.0265049,0,.735484,.745573,.0250067,0,.75765,.737083,.0236026,0,.78039,.728545,.0223302,0,.803789,.719691,.0211243,0,.82796,.710569,.0199983,0,.853056,.701216,.0189569,0,.879298,.692094,.0179702,0,.907014,.682909,.0170418,0,.936691,.673509,.0161732,0,.968254,.663863,.0153406,0,1,1,.437395,0,0,.999998,.437394,0,0,.99998,.437363,0,616704e-9,.999891,.437232,0,.00367925,.999656,.436877,0,.00867446,.999148,.436121,0,.0150679,.997959,.434564,0,.022531,.993464,.430134,0,.0308507,.990606,.426077,0,.0398805,.985027,.419397,0,.0495148,.978491,.41118,0,.0596749,.969643,.40048,0,.0703001,.959189,.38769,0,.0813427,.948223,.373575,0,.0927641,.935955,.357622,0,.104533,.923237,.34043,0,.116624,.911074,.322735,0,.129015,.899724,.30479,0,.141687,.890189,.287392,0,.154626,.881796,.270248,0,.167818,.874781,.253659,0,.181252,.869166,.237786,0,.194918,.864725,.222618,0,.208807,.861565,.208356,0,.222913,.859284,.194867,0,.237229,.857677,.18212,0,.25175,.856714,.17018,0,.266473,.856155,.158969,0,.281392,.8558,.148413,0,.296505,.855672,.138578,0,.311811,.855538,.129345,0,.327306,.855689,.120861,0,.342991,.855767,.112969,0,.358864,.855618,.105593,0,.374925,.85525,.0987451,0,.391176,.854583,.0923727,0,.407616,.853534,.0864143,0,.424249,.852061,.0808338,0,.441076,.850253,.0756771,0,.4581,.848004,.0708612,0,.475324,.845333,.0663784,0,.492754,.842376,.0622631,0,.510394,.838956,.0584112,0,.528251,.835121,.0548328,0,.546331,.830842,.0514838,0,.564644,.826212,.048355,0,.583198,.821522,.0454714,0,.602005,.816551,.0428263,0,.621078,.811211,.0403612,0,.640434,.805479,.038039,0,.660089,.799409,.0358739,0,.680066,.79306,.0338727,0,.70039,.786395,.0319985,0,.721094,.779416,.030241,0,.742215,.77214,.0285951,0,.7638,.764636,.0270747,0,.785912,.756836,.0256354,0,.808628,.749315,.0243027,0,.832055,.741561,.0230497,0,.856338,.733589,.0218801,0,.88169,.725479,.020784,0,.908441,.717255,.0197702,0,.937125,.708829,.0188168,0,.968254,.700191,.0179113,0,1,1,.518937,0,0,.999998,.518933,0,0,.999967,.518883,0,.00147741,.999832,.51866,0,.00573221,.999466,.518057,0,.011826,.998644,.516752,0,.0192116,.994458,.512347,0,.027573,.991223,.507675,0,.0367099,.985515,.500188,0,.046487,.978308,.490408,0,.0568071,.968359,.477357,0,.0675984,.95682,.461752,0,.0788059,.943929,.443796,0,.090386,.930224,.423893,0,.102304,.916514,.402682,0,.114532,.903653,.380914,0,.127047,.892315,.359212,0,.139828,.882942,.338102,0,.152861,.875438,.31773,0,.16613,.869642,.298186,0,.179624,.865304,.279491,0,.193332,.862382,.261804,0,.207247,.860666,.245146,0,.22136,.859788,.229406,0,.235666,.859608,.214605,0,.250158,.859912,.200691,0,.264832,.86053,.187623,0,.279684,.861368,.17539,0,.294711,.862237,.163901,0,.309911,.863127,.153175,0,.32528,.863923,.143147,0,.340819,.864567,.133781,0,.356524,.865013,.125042,0,.372397,.86539,.116952,0,.388438,.865591,.109476,0,.404645,.865517,.102542,0,.421022,.865084,.0960688,0,.437569,.864309,.0900499,0,.454287,.863151,.0844328,0,.471181,.861649,.0792218,0,.488253,.859742,.0743482,0,.505507,.857446,.0697963,0,.522947,.854757,.0655364,0,.54058,.851783,.061608,0,.558412,.848516,.0579701,0,.576449,.844897,.0545742,0,.594701,.840956,.0514167,0,.613178,.836676,.0484598,0,.631892,.832075,.0456934,0,.650856,.827191,.0431178,0,.670088,.822295,.0407718,0,.689606,.817294,.0386032,0,.709434,.812013,.0365675,0,.7296,.806465,.0346547,0,.750138,.800691,.0328717,0,.771093,.794709,.031211,0,.792519,.788493,.0296504,0,.814488,.782049,.0281782,0,.837097,.775403,.0267965,0,.860481,.76857,.0255002,0,.884842,.761536,.0242759,0,.910494,.754303,.0231142,0,.937985,.74692,.0220305,0,.968254,.739745,.0210192,0,1,1,.613914,0,0,.999996,.613907,0,963597e-10,.999942,.613814,0,.00301247,.999704,.613407,0,.00870385,.999046,.612302,0,.0160714,.995516,.608266,0,.0245899,.991726,.602863,0,.0339681,.985157,.593956,0,.0440254,.97642,.581748,0,.0546409,.964404,.565183,0,.0657284,.950601,.545273,0,.0772246,.935158,.522129,0,.0890812,.919364,.496782,0,.10126,.904754,.470571,0,.113731,.89176,.444037,0,.126469,.881492,.418322,0,.139454,.873656,.393522,0,.15267,.868053,.369795,0,.166101,.864336,.347171,0,.179736,.862259,.325737,0,.193565,.861556,.305532,0,.207578,.861776,.286416,0,.221769,.862661,.268355,0,.23613,.864015,.251334,0,.250656,.865711,.235352,0,.265343,.867519,.220302,0,.280187,.869351,.206161,0,.295183,.871144,.192908,0,.31033,.872839,.180505,0,.325624,.874307,.168848,0,.341065,.875667,.158021,0,.35665,.876758,.147877,0,.37238,.87764,.138441,0,.388253,.878237,.129627,0,.404269,.878563,.121415,0,.42043,.878572,.113741,0,.436735,.87842,.106652,0,.453187,.878057,.100097,0,.469786,.877413,.0940128,0,.486536,.87646,.0883462,0,.503439,.875233,.0830924,0,.520498,.8737,.0781975,0,.537717,.871873,.07364,0,.555102,.86978,.0694103,0,.572657,.867405,.0654696,0,.59039,.864751,.0617914,0,.608307,.861818,.0583491,0,.626419,.858645,.0551443,0,.644733,.855307,.0521894,0,.663264,.851736,.0494334,0,.682025,.847927,.0468504,0,.701032,.843888,.0444261,0,.720308,.839629,.0421497,0,.739875,.835158,.0400082,0,.759764,.830509,.0380076,0,.780014,.825714,.0361488,0,.800673,.820729,.0343956,0,.821803,.815751,.0327781,0,.843492,.810752,.031275,0,.86586,.805587,.0298542,0,.889087,.800317,.0285397,0,.913466,.79489,.0272948,0,.93952,.789314,.0261139,0,.96835,.783593,.0249938,0,1,1,.724258,0,0,.999992,.724243,0,726889e-9,.99987,.724044,0,.00569574,.999336,.72317,0,.0131702,.996271,.719432,0,.0220738,.991159,.712576,0,.0319405,.982465,.700927,0,.0425202,.97049,.684297,0,.0536599,.953973,.661244,0,.065258,.935546,.633804,0,.0772427,.916596,.603071,0,.0895616,.899353,.57105,0,.102175,.885216,.539206,0,.11505,.875076,.508714,0,.128164,.868334,.479571,0,.141495,.864414,.451796,0,.155026,.862678,.425328,0,.168745,.862835,.400352,0,.182639,.864067,.376532,0,.196699,.866086,.35391,0,.210915,.868557,.332424,0,.225282,.871271,.312053,0,.239792,.874058,.292764,0,.25444,.8768,.27453,0,.269223,.87939,.257297,0,.284135,.8819,.24114,0,.299174,.884187,.225934,0,.314337,.886262,.211669,0,.329622,.888119,.198311,0,.345026,.889709,.185783,0,.360549,.891054,.174063,0,.376189,.892196,.163143,0,.391946,.893101,.152952,0,.407819,.893803,.143475,0,.423808,.894277,.134647,0,.439914,.894532,.126434,0,.456137,.894576,.1188,0,.472479,.894393,.111694,0,.48894,.893976,.105069,0,.505523,.893346,.0989077,0,.52223,.892502,.0931724,0,.539064,.891441,.0878276,0,.556028,.890276,.082903,0,.573125,.888972,.0783505,0,.590361,.887469,.0741083,0,.607741,.885785,.0701633,0,.62527,.883914,.0664835,0,.642957,.881872,.0630567,0,.660809,.879651,.0598527,0,.678836,.877267,.0568615,0,.69705,.874717,.05406,0,.715465,.872012,.0514378,0,.734098,.869157,.0489805,0,.752968,.866155,.0466727,0,.772101,.863014,.0445056,0,.791529,.859748,.0424733,0,.81129,.856416,.0405957,0,.831438,.852958,.0388273,0,.852044,.849382,.0371619,0,.87321,.845694,.0355959,0,.89509,.841893,.0341155,0,.917932,.837981,.0327141,0,.942204,.833963,.0313856,0,.968981,.829847,.0301275,0,1,1,.85214,0,0,.999969,.852095,0,.00279627,.999483,.851408,0,.0107635,.994545,.84579,0,.0206454,.986188,.835231,0,.0315756,.969847,.814687,0,.0432021,.945951,.783735,0,.0553396,.91917,.746074,0,.0678766,.895488,.706938,0,.0807395,.878232,.669534,0,.0938767,.868252,.635168,0,.10725,.863873,.603069,0,.120832,.863369,.572514,0,.134598,.86545,.543169,0,.148533,.868803,.514578,0,.16262,.872794,.486762,0,.176849,.87702,.459811,0,.19121,.881054,.433654,0,.205694,.884974,.408574,0,.220294,.888587,.384525,0,.235005,.891877,.36156,0,.24982,.894793,.339661,0,.264737,.89743,.318913,0,.279751,.899796,.299302,0,.294859,.901943,.280843,0,.310058,.903858,.263481,0,.325346,.905574,.247197,0,.340721,.907069,.231915,0,.356181,.908379,.217614,0,.371725,.90952,.20425,0,.387353,.910483,.191758,0,.403063,.91128,.180092,0,.418854,.911936,.169222,0,.434727,.912454,.159098,0,.450682,.912835,.149668,0,.466718,.913078,.140884,0,.482837,.913192,.132709,0,.499038,.913175,.125095,0,.515324,.91304,.118012,0,.531695,.912781,.111417,0,.548153,.91241,.105281,0,.5647,.911924,.0995691,0,.581338,.911331,.0942531,0,.59807,.910637,.0893076,0,.6149,.90984,.0846998,0,.63183,.908941,.0804044,0,.648865,.907944,.0763984,0,.666011,.906857,.0726638,0,.683273,.90568,.0691783,0,.700659,.904416,.0659222,0,.718176,.903067,.0628782,0,.735834,.901637,.0600307,0,.753646,.900128,.0573647,0,.771625,.898544,.0548668,0,.78979,.89689,.052527,0,.808162,.895165,.0503306,0,.826771,.893371,.0482668,0,.845654,.891572,.0463605,0,.864863,.889763,.0445998,0,.884472,.887894,.0429451,0,.904592,.885967,.0413884,0,.925407,.883984,.0399225,0,.947271,.881945,.0385405,0,.97105,.879854,.0372362,0,1,.999804,.995833,0,0,.938155,.933611,0,.0158731,.864755,.854311,0,.0317461,.888594,.865264,0,.0476191,.905575,.863922,0,.0634921,.915125,.850558,0,.0793651,.920665,.829254,0,.0952381,.924073,.802578,0,.111111,.926304,.772211,0,.126984,.927829,.739366,0,.142857,.928924,.705033,0,.15873,.92973,.670019,0,.174603,.930339,.634993,0,.190476,.930811,.600485,0,.206349,.931191,.566897,0,.222222,.93149,.534485,0,.238095,.931737,.503429,0,.253968,.931939,.473811,0,.269841,.932108,.445668,0,.285714,.93225,.418993,0,.301587,.932371,.393762,0,.31746,.932474,.369939,0,.333333,.932562,.347479,0,.349206,.932638,.326336,0,.365079,.932703,.306462,0,.380952,.93276,.287805,0,.396825,.932809,.270313,0,.412698,.932851,.253933,0,.428571,.932887,.23861,0,.444444,.932917,.224289,0,.460317,.932943,.210917,0,.47619,.932965,.19844,0,.492063,.932982,.186807,0,.507937,.932995,.175966,0,.52381,.933005,.165869,0,.539683,.933011,.156468,0,.555556,.933013,.147719,0,.571429,.933013,.139579,0,.587302,.93301,.132007,0,.603175,.933004,.124965,0,.619048,.932994,.118416,0,.634921,.932982,.112326,0,.650794,.932968,.106663,0,.666667,.93295,.101397,0,.68254,.932931,.0964993,0,.698413,.932908,.0919438,0,.714286,.932883,.0877057,0,.730159,.932856,.0837623,0,.746032,.932827,.0800921,0,.761905,.932796,.0766754,0,.777778,.932762,.0734936,0,.793651,.932727,.0705296,0,.809524,.932689,.0677676,0,.825397,.93265,.0651929,0,.84127,.932609,.0627917,0,.857143,.932565,.0605515,0,.873016,.932521,.0584606,0,.888889,.932474,.0565082,0,.904762,.932427,.0546841,0,.920635,.932377,.0529793,0,.936508,.932326,.0513851,0,.952381,.932274,.0498936,0,.968254,.93222,.0484975,0,.984127,.932164,.0471899,0,1],r=new Float32Array(e),o=new Float32Array(t);vt.LTC_FLOAT_1=new Do(r,64,64,nn,ho,As,rn,rn,Sn,Ur,1),vt.LTC_FLOAT_2=new Do(o,64,64,nn,ho,As,rn,rn,Sn,Ur,1);let s=new Uint16Array(e.length);e.forEach(function(l,a){s[a]=em.toHalfFloat(l)});let i=new Uint16Array(t.length);t.forEach(function(l,a){i[a]=em.toHalfFloat(l)}),vt.LTC_HALF_1=new Do(s,64,64,nn,jo,As,rn,rn,Sn,Ur,1),vt.LTC_HALF_2=new Do(i,64,64,nn,jo,As,rn,rn,Sn,Ur,1)}};var rp=class extends Rr{static type(){return"areaLight"}cook(e,t){let r=this.createLight();if(this.updateLightParams(r,t),Ie(t.showHelper)){let o=new Tr;return o.add(r),o.add(this._createHelper(r)),this.createCoreGroupFromObjects([o])}else return this.createCoreGroupFromObjects([r])}createLight(){let e=new tc(16777215,1,1,1);return e.matrixAutoUpdate=!1,tp.initialized||(tp.init(),tp.initialized=!0),e}updateLightParams(e,t){e.color=t.color,e.intensity=t.intensity,e.width=t.width,e.height=t.height}_createHelper(e){let t=new na(e);return t.update(),t}};rp.DEFAULT_PARAMS=f4;rp.INPUT_CLONED_STATE=yr.NEVER;var Pw=class extends Nw(hi(je)){},EX=new Pw,m4=class extends d4{constructor(){super(...arguments);this.paramsConfig=EX}static type(){return"areaLight"}_operation(){return this.__operation__=this.__operation__||new rp(this._scene,this.states)}createLight(){return this._operation().createLight()}updateLightParams(){this._operation().updateLightParams(this.light,this.pv),Ie(this.pv.showHelper)?(this._helper=this._helper||new na(this.light),this.light.add(this._helper),this._helper.update()):this._helper&&this.light.remove(this._helper)}};var AX={dependsOnDisplayNode:!0},np=class{constructor(e,t,r=AX){this.node=e,this.options=r,this._initialized=!1,this._display_node=void 0,this._graph_node=new zr(e.scene(),"DisplayNodeController"),this._graph_node.node=e,this._on_display_node_remove_callback=t.onDisplayNodeRemove,this._on_display_node_set_callback=t.onDisplayNodeSet,this._on_display_node_update_callback=t.onDisplayNodeUpdate}dispose(){this._graph_node.dispose()}displayNode(){return this._display_node}initializeNode(){if(this._initialized){console.error("display node controller already initialed",this.node);return}this._initialized=!0,this.node.lifecycle.onChildAdd(e=>{var t,r;this._display_node||(r=(t=e.flags)==null?void 0:t.display)==null||r.set(!0)}),this.node.lifecycle.onChildRemove(e=>{var t,r,o;if(e.graphNodeId()==((t=this._display_node)==null?void 0:t.graphNodeId())){let s=this.node.children(),i=s[s.length-1];i?(o=(r=i.flags)==null?void 0:r.display)==null||o.set(!0):this.setDisplayNode(void 0)}}),this._graph_node.dirtyController.addPostDirtyHook("_request_display_node_container",()=>{this._on_display_node_update_callback&&this._on_display_node_update_callback()})}async setDisplayNode(e){if(this._initialized||console.error("display node controller not initialized",this.node),this._display_node!=e){let t=this._display_node;t&&(t.flags.display.set(!1),this.options.dependsOnDisplayNode&&this._graph_node.removeGraphInput(t),this._on_display_node_remove_callback&&this._on_display_node_remove_callback()),this._display_node=e,this._display_node&&(this.options.dependsOnDisplayNode&&this._graph_node.addGraphInput(this._display_node),this._on_display_node_set_callback&&this._on_display_node_set_callback())}}};var Ow="display",op=class{constructor(e){this.node=e,this._children_uuids_dict=new Map,this._children_length=0,this._sopGroup=this._createSopGroup()}_createSopGroup(){let e=new Tr;return e.matrixAutoUpdate=!1,e}sopGroup(){return this._sopGroup}setSopGroupName(){this._sopGroup.name=`${this.node.name()}:sopGroup`}displayNodeControllerCallbacks(){return{onDisplayNodeRemove:()=>{this.remove_children()},onDisplayNodeSet:()=>{setTimeout(()=>{this.request_display_node_container()},0)},onDisplayNodeUpdate:()=>{this.request_display_node_container()}}}initializeNode(){var e;this.node.object.add(this.sopGroup()),this.node.nameController.add_post_set_fullPath_hook(this.setSopGroupName.bind(this)),this._createSopGroup();let t=(e=this.node.flags)==null?void 0:e.display;t&&t.onUpdate(()=>{this._updateSopGroupHierarchy(),t.active()&&this.request_display_node_container()})}_updateSopGroupHierarchy(){var e;if((e=this.node.flags)==null?void 0:e.display){let r=this.sopGroup();this.usedInScene()?(r.visible=!0,this.node.object.add(r),r.updateMatrix()):(r.visible=!1,this.node.object.remove(r))}}usedInScene(){var e,t;let r=this.node.params.has(Ow),o=this.node.params.boolean(Ow),s=this.node.usedInScene(),i=((t=(e=this.node.flags)==null?void 0:e.display)==null?void 0:t.active())||!1;return s&&i&&(!r||o)}async request_display_node_container(){!this.node.scene().loadingController.loaded()||this.usedInScene()&&await this._setContentUnderSopGroup()}remove_children(){if(this._sopGroup.children.length==0)return;let e;for(;e=this._sopGroup.children[0];)this._sopGroup.remove(e);this._children_uuids_dict.clear(),this._children_length=0}async _setContentUnderSopGroup(){var e;let t=this.node.displayNodeController.displayNode();if(t&&((e=t.parent())==null?void 0:e.graphNodeId())==this.node.graphNodeId()){let o=(await t.compute()).coreContent();if(o){let s=o.objects(),i=s.length!=this._children_length;if(!i)for(let l of s)this._children_uuids_dict.get(l.uuid)||(i=!0);if(i){this.remove_children();for(let l of s)this._sopGroup.add(l),l.updateMatrix(),this._children_uuids_dict.set(l.uuid,!0);this._children_length=s.length}return}}this.remove_children()}};var ip=(n=>(n.GEO="geo",n.CUBE_CAMERA="cubeCamera",n.AUDIO_LISTENER="audioListener",n.POSITIONAL_AUDIO="positionalAudio",n.SCENE="scene",n))(ip||{});var ww=class extends hi(je){constructor(){super(...arguments);this.display=N.BOOLEAN(1),this.renderOrder=N.INTEGER(0,{range:[0,10],rangeLocked:[!0,!1]})}},MX=new ww,h4=class extends vo{constructor(){super(...arguments);this.paramsConfig=MX,this.hierarchyController=new Go(this),this.transformController=new Hi(this),this.flags=new Ko(this),this.childrenDisplayController=new op(this),this.displayNodeController=new np(this,this.childrenDisplayController.displayNodeControllerCallbacks()),this._childrenControllerContext=it.SOP,this._onChildAddBound=this._onChildAdd.bind(this)}static type(){return ip.GEO}createObject(){let e=new Tr;return e.matrixAutoUpdate=!1,e}initializeNode(){this.lifecycle.onChildAdd(this._onChildAddBound),this.hierarchyController.initializeNode(),this.transformController.initializeNode(),this.childrenDisplayController.initializeNode()}isDisplayNodeCooking(){if(this.flags.display.active()){let e=this.displayNodeController.displayNode();return e?e.isDirty():!1}else return!1}createNode(e,t){return super.createNode(e,t)}children(){return super.children()}nodesByType(e){return super.nodesByType(e)}_onChildAdd(e){var t,r;this.scene().loadingController.loaded()&&this.children().length==1&&((r=(t=e.flags)==null?void 0:t.display)==null||r.set(!0))}cook(){this.transformController.update(),this.object.visible=Ie(this.pv.display),this.object.renderOrder=this.pv.renderOrder,this.cookController.endCook()}};var _4=(n=>(n.DIRECTIONAL="directionalLight",n.HEMISPHERE="hemisphereLight",n.POINT="pointLight",n.SPOT="spotLight",n))(_4||{});var sp={skyColor:new Ke(1,1,1),groundColor:new Ke(0,0,0),intensity:1,position:new F(0,0,0)},tm=sp;function Rw(n){return class extends n{constructor(){super(...arguments);this.skyColor=N.COLOR(tm.skyColor.toArray(),{conversion:Eo.SRGB_TO_LINEAR}),this.groundColor=N.COLOR(tm.groundColor.toArray(),{conversion:Eo.SRGB_TO_LINEAR}),this.intensity=N.FLOAT(tm.intensity),this.position=N.VECTOR3(tm.position.toArray())}}}var rc=class extends t0{constructor(e,t,r){super(e,r);this.type="HemisphereLight",this.position.copy(On.DefaultUp),this.updateMatrix(),this.groundColor=new Ke(t)}copy(e){return t0.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}};rc.prototype.isHemisphereLight=!0;var ap=class extends Rr{static type(){return"hemisphereLight"}cook(e,t){let r=this.createLight();return this.updateLightParams(r,t),this.updateLightParams(r,t),this.createCoreGroupFromObjects([r])}createLight(){let e=new rc;return e.name="Hemisphere",e.matrixAutoUpdate=!1,e.updateMatrix(),e.color.copy(sp.skyColor),e.groundColor.copy(sp.groundColor),e}updateLightParams(e,t){e.color.copy(t.skyColor),e.groundColor.copy(t.groundColor),e.intensity=t.intensity}};ap.DEFAULT_PARAMS=sp;ap.INPUT_CLONED_STATE=yr.NEVER;var Lw=class extends Rw(je){},NX=new Lw,g4=class extends Qu{constructor(){super(...arguments);this.paramsConfig=NX}static type(){return _4.HEMISPHERE}_operation(){return this.__operation__=this.__operation__||new ap(this._scene,this.states)}createLight(){return this._operation().createLight()}updateLightParams(){this._operation().updateLightParams(this.light,this.pv)}};var Iw=class extends vo{constructor(){super(...arguments);this._attachableToHierarchy=!1}createObject(){let e=new Tr;return e.matrixAutoUpdate=!1,e}cook(){this.cookController.endCook()}};var v4=class extends Iw{};var y4=class extends v4{constructor(){super(...arguments);this.renderOrder=ra.MANAGER,this._childrenControllerContext=it.MAT}static type(){return W0.MAT}createNode(e,t){return super.createNode(e,t)}children(){return super.children()}nodesByType(e){return super.nodesByType(e)}};var b4=class{constructor(e,t,r){this._camera_node_id=e,this._controls_node=t,this._controls=r,this._updateRequired=this._controls_node.updateRequired()}updateRequired(){return this._updateRequired}get camera_node_id(){return this._camera_node_id}get controls(){return this._controls}get controls_node(){return this._controls_node}is_equal(e){return e.camera_node_id==this._camera_node_id&&e.controls_node.graphNodeId()==this._controls_node.graphNodeId()}};var Dw="controls",x4=class{constructor(e){this.node=e,this._applied_controls_by_element_id=new Map,this._controls_node=null}controls_param(){return this.node.params.has(Dw)?this.node.params.get(Dw):null}async controls_node(){let e=this.node.p.controls,t=e.rawInput();if(t&&t!=""){e.isDirty()&&await e.compute();let r=e.value.node();if(r){if(jM.includes(r.type()))return r;this.node.states.error.set("found node is not of a camera control type")}else this.node.states.error.set("no node has been found")}return null}async update_controls(){let e=await this.controls_node();e&&this._controls_node!=e&&this._dispose_control_refs(),this._controls_node=e}async apply_controls(e){let t=e.canvas();if(!t)return;let r=await this.controls_node();if(r){this._controlsEndEventName=r.endEventName();let o=r.controls_id(),s=!1,i=this._applied_controls_by_element_id.get(t.id);if(i&&i.get(o)&&(s=!0),!s){i=new Map,this._applied_controls_by_element_id.set(t.id,i),i.set(o,r);let l=await r.apply_controls(this.node.object,e);if(!l)return;let a=new b4(this.node.graphNodeId(),r,l);return this.set_controls_events(l),a}}}_dispose_control_refs(){this._applied_controls_by_element_id.forEach((e,t)=>{this._dispose_controls_for_element_id(t)}),this._applied_controls_by_element_id.clear(),this._controlsEndEventName=void 0}_dispose_controls_for_element_id(e){let t=this._applied_controls_by_element_id.get(e);t&&t.forEach((r,o)=>{r.disposeControlsForHtmlElementId(e)}),this._applied_controls_by_element_id.delete(e)}async dispose_controls(e){this._dispose_controls_for_element_id(e.id)}set_controls_events(e){let t=rm[this.node.pv.updateFromControlsMode];switch(t){case lp.ON_END:return this._set_controls_events_to_update_on_end(e);case lp.ALWAYS:return this._set_controls_events_to_update_always(e);case lp.NEVER:return this._reset(e)}qr.unreachable(t)}_reset(e){this.controls_change_listener&&(e.removeEventListener("change",this.controls_change_listener),this.controls_change_listener=void 0),this.controls_end_listener&&this._controlsEndEventName&&(e.removeEventListener(this._controlsEndEventName,this.controls_end_listener),this.controls_end_listener=void 0)}_set_controls_events_to_update_on_end(e){this._reset(e),!!this._controlsEndEventName&&(this.controls_end_listener=()=>{this.node.update_transform_params_from_object()},e.addEventListener(this._controlsEndEventName,this.controls_end_listener))}_set_controls_events_to_update_always(e){this._reset(e),this.controls_change_listener=()=>{this.node.update_transform_params_from_object()},e.addEventListener("change",this.controls_change_listener)}};var SX="layer";function nm(n){return class extends n{constructor(){super(...arguments);this.layer=N.INTEGER(0,{range:[0,31],rangeLocked:[!0,!0]})}}}var C4=class{constructor(e){this.node=e}update(){let e=this.node.object;e.layers.set(0),e.layers.enable(this.node.params.integer(SX))}};var PX={callback:n=>{cp.PARAM_CALLBACK_reset_effects_composer(n)}};function om(n){return class extends n{constructor(){super(...arguments);this.doPostProcess=N.BOOLEAN(0),this.postProcessNode=N.NODE_PATH("",{visibleIf:{doPostProcess:1},nodeSelection:{types:[W0.POST]},...PX})}}}var T4=class{constructor(e){this.node=e,this._composersByCanvasId=new Map,this.node.p.postProcessNode?this._add_param_dirty_hook():this.node.params.onParamsCreated("post process add param dirty hook",()=>{this._add_param_dirty_hook()})}_add_param_dirty_hook(){this.node.p.postProcessNode.addPostDirtyHook("on_post_node_dirty",()=>{this.reset()})}render(e,t){let r=this.composer(e);r&&(t&&r.setSize(t.x,t.y),r.render())}reset(){this._composersByCanvasId.clear()}composer(e){let t=this._composersByCanvasId.get(e.id);if(t)return t;{let r=this._createComposer(e);return r&&this._composersByCanvasId.set(e.id,r),r}}_createComposer(e){let t=this.node.renderController().renderer(e);if(t){let r=this.node.renderController().resolvedScene()||this.node.scene().threejsScene(),o=this.node.object,s=this.node.p.postProcessNode.value.node();if(s)if(s.type()==W0.POST){let i=s,l=this.node.renderController().canvasResolution(e);return l?i.effectsComposerController.createEffectsComposer({renderer:t,scene:r,camera:o,resolution:l,requester:this.node,camera_node:this.node}):void 0}else this.node.states.error.set("found node is not a post process node");else this.node.states.error.set("no post node found")}}};var Bw=class extends Ef(Pu(Cf(xf(bf(je))))){},OX=new Bw,im=class extends vo{constructor(){super(...arguments);this.paramsConfig=OX,this.hierarchyController=new Go(this),this.SceneAutoUpdateController=new kl(this),this.sceneBackgroundController=new Gl(this),this.SceneEnvController=new Ul(this),this.sceneFogController=new Hl(this),this.sceneMaterialOverrideController=new jl(this)}static type(){return ip.SCENE}createObject(){let e=new Zo;return e.matrixAutoUpdate=!1,e}initializeNode(){this.hierarchyController.initializeNode()}cook(){this.SceneAutoUpdateController.update(),this.sceneBackgroundController.update(),this.SceneEnvController.update(),this.sceneFogController.update(),this.sceneMaterialOverrideController.update(),this.cookController.endCook()}};var E4=class extends no{constructor(){super(...arguments);this.flags=new q0(this)}static context(){return it.ROP}initializeBaseNode(){this.dirtyController.addPostDirtyHook("cook_immediately",()=>{this.cookController.cookMainWithoutInputs()})}cook(){this.cookController.endCook()}};var Z0=(n=>(n.CSS2D="CSS2DRenderer",n.CSS3D="CSS3DRenderer",n.WEBGL="WebGLRenderer",n))(Z0||{});var ji=(n=>(n[n.Linear=Pn]="Linear",n[n.sRGB=Wo]="sRGB",n[n.Gamma=Ps]="Gamma",n[n.RGBE=Os]="RGBE",n[n.LogLuv=Cd]="LogLuv",n[n.RGBM7=Ka]="RGBM7",n[n.RGBM16=Za]="RGBM16",n[n.RGBD=Qa]="RGBD",n))(ji||{}),wX=["Linear","sRGB","Gamma","RGBE","LogLuv","RGBM7","RGBM16","RGBD"],RX=[ji.Linear,ji.sRGB,ji.Gamma,ji.RGBE,ji.LogLuv,ji.RGBM7,ji.RGBM16,ji.RGBD],A4=ji.sRGB;var oa=(n=>(n[n.No=Lo]="No",n[n.Linear=hd]="Linear",n[n.Reinhard=_d]="Reinhard",n[n.Cineon=gd]="Cineon",n[n.ACESFilmic=vd]="ACESFilmic",n))(oa||{}),LX=["No","Linear","Reinhard","Cineon","ACESFilmic"],IX=[oa.No,oa.Linear,oa.Reinhard,oa.Cineon,oa.ACESFilmic],M4=oa.ACESFilmic,DX=LX.map((n,e)=>({name:n,value:IX[e]}));var N4=["highp","mediump","lowp"];var S4=["high-performance","low-power","default"];var nc=(n=>(n[n.Basic=Eg]="Basic",n[n.PCF=$a]="PCF",n[n.PCFSoft=dd]="PCFSoft",n[n.VSM=Qi]="VSM",n))(nc||{}),BX=["Basic","PCF","PCFSoft","VSM"],kX=[nc.Basic,nc.PCF,nc.PCFSoft,nc.VSM];var P4=nc.PCFSoft,kw={alpha:!1,precision:"highp",premultipliedAlpha:!0,antialias:!1,stencil:!0,preserveDrawingBuffer:!1,powerPreference:"default",depth:!0,logarithmicDepthBuffer:!1},Fw=class extends je{constructor(){super(...arguments);this.tprecision=N.BOOLEAN(0),this.precision=N.INTEGER(N4.indexOf("highp"),{visibleIf:{tprecision:1},menu:{entries:N4.map((e,t)=>({value:t,name:e}))}}),this.tpowerPreference=N.BOOLEAN(0),this.powerPreference=N.INTEGER(S4.indexOf("default"),{visibleIf:{tpowerPreference:1},menu:{entries:S4.map((e,t)=>({value:t,name:e}))}}),this.alpha=N.BOOLEAN(1),this.premultipliedAlpha=N.BOOLEAN(1),this.antialias=N.BOOLEAN(1),this.stencil=N.BOOLEAN(1),this.depth=N.BOOLEAN(1),this.logarithmicDepthBuffer=N.BOOLEAN(0),this.toneMapping=N.INTEGER(M4,{menu:{entries:DX}}),this.toneMappingExposure=N.FLOAT(1,{range:[0,2]}),this.outputEncoding=N.INTEGER(A4,{menu:{entries:wX.map((e,t)=>({name:e,value:RX[t]}))}}),this.physicallyCorrectLights=N.BOOLEAN(1),this.sortObjects=N.BOOLEAN(1),this.tpixelRatio=N.BOOLEAN(0),this.pixelRatio=N.INTEGER(2,{visibleIf:{tpixelRatio:!0},range:[1,4],rangeLocked:[!0,!1]}),this.tshadowMap=N.BOOLEAN(1),this.shadowMapAutoUpdate=N.BOOLEAN(1,{visibleIf:{tshadowMap:1}}),this.shadowMapNeedsUpdate=N.BOOLEAN(0,{visibleIf:{tshadowMap:1}}),this.shadowMapType=N.INTEGER(P4,{visibleIf:{tshadowMap:1},menu:{entries:BX.map((e,t)=>({name:e,value:kX[t]}))}})}},FX=new Fw,sm=class extends E4{constructor(){super(...arguments);this.paramsConfig=FX,this._renderersbyCameraNode=new Map}static type(){return Z0.WEBGL}createRenderer(e,t,r){let o={},s=Object.keys(kw),i;for(i of s)o[i]=kw[i];if(Ie(this.pv.tprecision)){let a=N4[this.pv.precision];o.precision=a}if(Ie(this.pv.tpowerPreference)){let a=S4[this.pv.powerPreference];o.powerPreference=a}o.antialias=Ie(this.pv.antialias),o.antialias=Ie(this.pv.antialias),o.alpha=Ie(this.pv.alpha),o.premultipliedAlpha=Ie(this.pv.premultipliedAlpha),o.depth=Ie(this.pv.depth),o.stencil=Ie(this.pv.stencil),o.logarithmicDepthBuffer=Ie(this.pv.logarithmicDepthBuffer),o.canvas=t,o.context=r;let l=Fe.renderersController.createWebGLRenderer(o);return Fe.renderersController.printDebug()&&(Fe.renderersController.printDebugMessage(`create renderer from node '${this.path()}'`),Fe.renderersController.printDebugMessage({params:o})),this._update_renderer(l),this._renderersbyCameraNode.set(e,l),l}cook(){this._renderersbyCameraNode.forEach((e,t)=>{this._update_renderer(e)}),this._traverse_scene_and_update_materials(),this.cookController.endCook()}_update_renderer(e){e.physicallyCorrectLights=this.pv.physicallyCorrectLights,e.outputEncoding=this.pv.outputEncoding,e.toneMapping=this.pv.toneMapping,e.toneMappingExposure=this.pv.toneMappingExposure,e.shadowMap.enabled=this.pv.tshadowMap,e.shadowMap.autoUpdate=this.pv.shadowMapAutoUpdate,e.shadowMap.needsUpdate=this.pv.shadowMapNeedsUpdate,e.shadowMap.type=this.pv.shadowMapType,e.sortObjects=this.pv.sortObjects;let t=this.pv.tpixelRatio?this.pv.pixelRatio:ia.defaultPixelRatio();Fe.renderersController.printDebug()&&(Fe.renderersController.printDebugMessage(`set renderer pixelRatio from '${this.path()}'`),Fe.renderersController.printDebugMessage({pixelRatio:t})),e.setPixelRatio(t)}_traverse_scene_and_update_materials(){this.scene().threejsScene().traverse(e=>{let t=e.material;if(t)if(xe.isArray(t))for(let r of t)r.needsUpdate=!0;else t.needsUpdate=!0})}};function am(n){return class extends n{constructor(){super(...arguments);this.render=N.FOLDER(),this.setScene=N.BOOLEAN(0),this.scene=N.NODE_PATH("",{visibleIf:{setScene:1},nodeSelection:{context:it.OBJ,types:[im.type()]}}),this.setRenderer=N.BOOLEAN(0),this.renderer=N.NODE_PATH("",{visibleIf:{setRenderer:1},nodeSelection:{context:it.ROP,types:[sm.type()]}}),this.setCSSRenderer=N.BOOLEAN(0),this.CSSRenderer=N.NODE_PATH("",{visibleIf:{setCSSRenderer:1},nodeSelection:{context:it.ROP,types:[Z0.CSS2D,Z0.CSS3D]}})}}}var ia=class{constructor(e){this.node=e,this._renderersByCanvasId=new Map,this._resolutionByCanvasId=new Map,this._super_sampling_size=new re}render(e,t,r,o){if(Ie(this.node.pv.doPostProcess)?this.node.postProcessController().render(e,t):this.renderWithRenderer(e,o),this._resolvedCSSRendererROP&&this._resolvedScene&&Ie(this.node.pv.setCSSRenderer)){let s=this.cssRenderer(e);s&&s.render(this._resolvedScene,this.node.object)}}renderWithRenderer(e,t){let r=this.renderer(e);if(r){let o=this._resolvedScene;o&&r.render(o,this.node.object)}}preCompile(e){let t=this.renderer(e);if(t){let r=this._resolvedScene;r&&t.compile(r,this.node.object)}}async update(){await this._updateScene(),await this._updateRenderer(),await this._updateCSSRenderer()}resolvedScene(){return this._resolvedScene}async _updateScene(){if(Ie(this.node.pv.setScene)){let e=this.node.p.scene;e.isDirty()&&await e.compute();let t=e.value.nodeWithContext(it.OBJ,this.node.states.error);if(t&&t.type()==im.type()){let r=t;r.isDirty()&&r.cookController.cookMainWithoutInputs(),this._resolvedScene=r.object}}else this._resolvedScene=this.node.scene().threejsScene()}async _updateRenderer(){if(Ie(this.node.pv.setRenderer)){let e=this.node.p.renderer;e.isDirty()&&await e.compute();let t=e.value.nodeWithContext(it.ROP,this.node.states.error);if(t&&t.type()==sm.type()){this._resolvedRendererROP=t;return}}this._resolvedRendererROP=void 0}async _updateCSSRenderer(){if(Ie(this.node.pv.setCSSRenderer)){let e=this.node.p.CSSRenderer;e.isDirty()&&await e.compute();let t=e.value.nodeWithContext(it.ROP,this.node.states.error),r=[Z0.CSS2D,Z0.CSS3D];if(t&&r.includes(t.type())){this._resolvedCSSRendererROP=t;return}}this._resolvedCSSRendererROP,this._resolvedCSSRendererROP=void 0}renderer(e){return this._renderersByCanvasId.get(e.id)}renderersByCanvasId(){return this._renderersByCanvasId}cssRenderer(e){if(this._resolvedCSSRendererROP&&Ie(this.node.pv.setCSSRenderer))return this._resolvedCSSRendererROP.renderer(e)}async createRenderer(e,t){let r=Fe.renderersController.getRenderingContext(e);if(!r){console.error("failed to create webgl context");return}let o;return Ie(this.node.pv.setRenderer)&&(await this._updateRenderer(),this._resolvedRendererROP&&(o=this._resolvedRendererROP.createRenderer(this.node,e,r))),o||(o=ia._createDefaultRenderer(e,r)),Fe.renderersController.registerRenderer(o),this._renderersByCanvasId.set(e.id,o),this._super_sampling_size.copy(t),this.setRendererSize(e,this._super_sampling_size),o}static defaultPixelRatio(){return Gi.isMobile()?1:Math.max(2,window.devicePixelRatio)}static _createDefaultRenderer(e,t){let r={canvas:e,antialias:!1,alpha:!1,context:t},o=Fe.renderersController.createWebGLRenderer(r),s=this.defaultPixelRatio();return o.setPixelRatio(s),o.shadowMap.enabled=!0,o.shadowMap.type=P4,o.physicallyCorrectLights=!0,o.toneMapping=M4,o.toneMappingExposure=1,o.outputEncoding=A4,Fe.renderersController.printDebug()&&(Fe.renderersController.printDebugMessage("create default renderer"),Fe.renderersController.printDebugMessage({params:r,pixelRatio:s})),o}deleteRenderer(e){let t=this.renderer(e);t&&Fe.renderersController.deregisterRenderer(t)}canvasResolution(e){return this._resolutionByCanvasId.get(e.id)}setRendererSize(e,t){let r=this._resolutionByCanvasId.get(e.id);r||(r=new re,this._resolutionByCanvasId.set(e.id,r)),r.copy(t);let o=this.renderer(e);if(o){let s=!1;o.setSize(t.x,t.y,s)}if(this._resolvedCSSRendererROP){let s=this.cssRenderer(e);s&&s.setSize(t.x,t.y)}}};var O4=class{constructor(e){this.viewer=e,this._active=!1,this._controls=null,this._bound_on_controls_start=this._on_controls_start.bind(this),this._bound_on_controls_end=this._on_controls_end.bind(this),this._update_graph_node()}controls(){return this._controls}async create_controls(){var e;this.dispose_controls(),!!this.viewer.canvas()&&(this._config=await((e=this.viewer.cameraControlsController())==null?void 0:e.apply_controls(this.viewer)),this._config&&(this._controls=this._config.controls,this._controls&&(this.viewer.active()?(this._controls.addEventListener("start",this._bound_on_controls_start),this._controls.addEventListener("end",this._bound_on_controls_end)):this.dispose_controls())))}update(e){this._config&&this._controls&&this._config.updateRequired()&&this._controls.update(e)}dispose(){var e;(e=this._graph_node)==null||e.graphDisconnectPredecessors(),this.dispose_controls()}dispose_controls(){var e;if(this._controls){let t=this.viewer.canvas();t&&((e=this.viewer)==null||e.cameraControlsController().dispose_controls(t)),this._bound_on_controls_start&&this._controls.removeEventListener("start",this._bound_on_controls_start),this._bound_on_controls_end&&this._controls.removeEventListener("end",this._bound_on_controls_end),this._controls.dispose(),this._controls=null}}_on_controls_start(){this._active=!0}_on_controls_end(){this._active=!1}_update_graph_node(){let e=this.viewer.cameraNode().p.controls;this._graph_node=this._graph_node||this._create_graph_node(),!!this._graph_node&&(this._graph_node.graphDisconnectPredecessors(),this._graph_node.addGraphInput(e))}_create_graph_node(){let e=new zr(this.viewer.cameraNode().scene(),"viewer-controls");return e.addPostDirtyHook("this.viewer.controlsController",async()=>{await this.create_controls()}),e}};var w4=class{constructor(e){this._viewer=e,this._size=new re(100,100),this._aspect=1}cameraNode(){return this._viewer.cameraNode()}get size(){return this._size}get aspect(){return this._aspect}computeSizeAndAspect(){this._updateSize(),this.cameraNode().scene().uniformsController.updateResolutionDependentUniformOwners(this._size),this._aspect=this._getAspect()}_updateSize(){var e,t;this._size.x=((e=this._viewer.domElement())==null?void 0:e.offsetWidth)||0,this._size.y=((t=this._viewer.domElement())==null?void 0:t.offsetHeight)||0}_getAspect(){return this._size.x/this._size.y}updateCameraAspect(){this.cameraNode().setupForAspectRatio(this._aspect)}async prepareCurrentCamera(){await this.cameraNode().compute(),await this._updateFromCameraContainer()}async _updateFromCameraContainer(){var e;this.updateCameraAspect(),await((e=this._viewer.controlsController())==null?void 0:e.create_controls())}};var R4=class{constructor(e){this.viewer=e}init(){let e=this.viewer.canvas();e&&(e.onwebglcontextlost=this._on_webglcontextlost.bind(this),e.onwebglcontextrestored=this._on_webglcontextrestored.bind(this))}_on_webglcontextlost(){console.warn("context lost at frame",this.viewer.scene().frame()),this.request_animation_frame_id?cancelAnimationFrame(this.request_animation_frame_id):console.warn("request_animation_frame_id not initialized"),console.warn("not canceled",this.request_animation_frame_id)}_on_webglcontextrestored(){console.log("context restored")}};var Gw={ON:`<svg xmlns="http://www.w3.org/2000/svg" class="soundOn h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
	<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" />
  </svg>`,OFF:`<svg xmlns="http://www.w3.org/2000/svg" class="soundOff h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
	<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" clip-rule="evenodd" />
	<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2" />
  </svg>`},L4=class{constructor(e){this._viewer=e}update(){let e=this._viewer.cameraNode().root();Ie(e.pv.displayAudioIcon)?(this._showIcon(),this._updateColor(),this._updateIcon()):this._hideIcon()}unmount(){var e;this.__iconContainer&&((e=this.__iconContainer.parentElement)==null||e.removeChild(this.__iconContainer),this.__iconContainer=void 0),this._onIcon=void 0,this._offIcon=void 0}_updateColor(){if(this.__iconContainer){let e=this._viewer.cameraNode().root();this.__iconContainer.style.color=e.pv.audioIconColor.getStyle()}}_showIcon(){let e=this._iconContainer();e&&(e.style.display="block")}_hideIcon(){this.__iconContainer&&(this.__iconContainer.style.display="none")}_iconContainer(){let e=()=>{let t=this._createIconContainer(),r=this._viewer.domElement();if(!!r)return r.append(t),t};return this.__iconContainer=this.__iconContainer||e()}_createIconContainer(){let e=document.createElement("div");return e.style.position="absolute",e.style.top="10px",e.style.right="10px",e.style.width="24px",e.style.height="24px",e.style.cursor="pointer",e.addEventListener("pointerdown",()=>{this._toggleSound()}),e}offIcon(){function e(){let t=document.createElement("div");return t.innerHTML=Gw.OFF,t.children[0]}return this._offIcon=this._offIcon||e()}onIcon(){function e(){let t=document.createElement("div");return t.innerHTML=Gw.ON,t.children[0]}return this._onIcon=this._onIcon||e()}_toggleSound(){this._viewer.cameraNode().root().audioController.toggleSound(),this._updateIcon()}_updateIcon(){var e,t;let r=this._iconContainer();if(!r)return;let o=this.onIcon(),s=this.offIcon();this._viewer.cameraNode().root().audioController.soundOn()?(r.appendChild(o),(e=s.parentElement)==null||e.removeChild(s)):(r.appendChild(s),(t=o.parentElement)==null||t.removeChild(o))}};var Uw="hovered",Vw=class{constructor(n){this._cameraNode=n,this._active=!1,this._mounted=!1,this._onBeforeTickCallbacks=[],this._onAfterTickCallbacks=[],this._onBeforeRenderCallbacks=[],this._onAfterRenderCallbacks=[],this._id=Vw._nextViewerId++,this._scene=this._cameraNode.scene()}mount(n){this._domElement=n,this._mounted=!0}unmount(){var n;!this._domElement||((n=this._audioController)==null||n.unmount(),this._domElement.removeChild(this.canvas()),this._mounted=!1)}_canvasIdPrefix(){return"TypedViewer"}_createCanvas(){let n=document.createElement("canvas");return n.id=`${this._canvasIdPrefix()}_${this._id}`,n.style.display="block",n.style.outline="none",n}canvas(){return this._canvas=this._canvas||this._createCanvas()}setRenderObjectOverride(n){n?this._renderObjectOverride=n:this._renderObjectOverride=void 0}active(){return this._active}activate(){this._active=!0}deactivate(){this._active=!1}camerasController(){return this._camerasController=this._camerasController||new w4(this)}controlsController(){return this._controlsController}eventsController(){return this._eventsController=this._eventsController||new I2(this)}webglController(){return this._webGLController=this._webGLController||new R4(this)}audioController(){return this._audioController=this._audioController||new L4(this)}domElement(){return this._domElement}scene(){return this._scene}cameraNode(){return this._cameraNode}cameraControlsController(){}id(){return this._id}dispose(){if(this._scene.viewersRegister.unregisterViewer(this),this.eventsController().dispose(),!this._domElement)return;let n;for(;n=this._domElement.children[0];)this._domElement.removeChild(n)}resetContainerClass(){var n;(n=this.domElement())==null||n.classList.remove(Uw)}setContainerClassHovered(){var n;(n=this.domElement())==null||n.classList.add(Uw)}registerOnBeforeTick(n,e){this._registerCallback(n,e,this.registeredBeforeTickCallbacks())}unRegisterOnBeforeTick(n){this._unregisterCallback(n,this._onBeforeTickCallbacksMap)}registeredBeforeTickCallbacks(){return this._onBeforeTickCallbacksMap=this._onBeforeTickCallbacksMap||new Map}registerOnAfterTick(n,e){this._registerCallback(n,e,this.registeredAfterTickCallbacks())}unRegisterOnAfterTick(n){this._unregisterCallback(n,this._onAfterTickCallbacksMap)}registeredAfterTickCallbacks(){return this._onAfterTickCallbacksMap=this._onAfterTickCallbacksMap||new Map}registerOnBeforeRender(n,e){this._registerCallback(n,e,this.registeredBeforeRenderCallbacks())}unRegisterOnBeforeRender(n){this._unregisterCallback(n,this._onBeforeRenderCallbacksMap)}registeredBeforeRenderCallbacks(){return this._onBeforeRenderCallbacksMap=this._onBeforeRenderCallbacksMap||new Map}registerOnAfterRender(n,e){this._registerCallback(n,e,this.registeredAfterRenderCallbacks())}unRegisterOnAfterRender(n){this._unregisterCallback(n,this._onAfterRenderCallbacksMap)}registeredAfterRenderCallbacks(){return this._onAfterRenderCallbacksMap=this._onAfterRenderCallbacksMap||new Map}_registerCallback(n,e,t){if(t.has(n)){console.warn(`callback ${n} already registered`);return}t.set(n,e),this._updateCallbacks()}_unregisterCallback(n,e){!e||(e.delete(n),this._updateCallbacks())}_updateCallbacks(){var n,e,t,r;this._onBeforeTickCallbacks=[],(n=this._onBeforeTickCallbacksMap)==null||n.forEach(o=>{this._onBeforeTickCallbacks.push(o)}),this._onAfterTickCallbacks=[],(e=this._onAfterTickCallbacksMap)==null||e.forEach(o=>{this._onAfterTickCallbacks.push(o)}),this._onBeforeRenderCallbacks=[],(t=this._onBeforeRenderCallbacksMap)==null||t.forEach(o=>{this._onBeforeRenderCallbacks.push(o)}),this._onAfterRenderCallbacks=[],(r=this._onAfterRenderCallbacksMap)==null||r.forEach(o=>{this._onAfterRenderCallbacks.push(o)})}_runCallbacks(n,e){for(let t of n)t(e)}_runOnBeforeTickCallbacks(n){this._runCallbacks(this._onBeforeTickCallbacks,n)}_runOnAfterTickCallbacks(n){this._runCallbacks(this._onAfterTickCallbacks,n)}_runOnBeforeRenderCallbacks(n){this._runCallbacks(this._onBeforeRenderCallbacks,n)}_runOnAfterRenderCallbacks(n){this._runCallbacks(this._onAfterRenderCallbacks,n)}},I4=Vw;I4._nextViewerId=0;var D4=class{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=zw(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let t=zw();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}};function zw(){return(typeof performance=="undefined"?Date:performance).now()}var GX="CoreThreejsViewer",lm=class extends I4{constructor(e,t){super(e);this._cameraNode=e,this._properties=t,this._doRender=!0,this._clock=new D4,this._delta=0,this._animateMethod=this.animate.bind(this),this._onResizeBound=this.onResize.bind(this),this._doRender=!0,this._properties!=null&&this._properties.autoRender!=null&&(this._doRender=this._properties.autoRender)}_canvasIdPrefix(){return"ThreejsViewer"}mount(e){var t,r;super.mount(e),(t=this._domElement)==null||t.appendChild(this.canvas()),(r=this._domElement)==null||r.classList.add(GX),this._build(),this._setEvents()}controlsController(){return this._controlsController=this._controlsController||new O4(this)}_build(){this._initDisplay(),this.activate()}dispose(){this.setAutoRender(!1),this.scene().viewersRegister.unregisterViewer(this),this._cancelAnimate(),this.controlsController().dispose(),this._disposeEvents(),super.dispose()}cameraControlsController(){return this._cameraNode.controlsController()}_setEvents(){this.eventsController().init(),this.webglController().init(),window.addEventListener("resize",this._onResizeBound.bind(this),!1)}_disposeEvents(){window.removeEventListener("resize",this._onResizeBound.bind(this),!1)}onResize(){let e=this._canvas;!e||(this.camerasController().computeSizeAndAspect(),this._cameraNode.renderController().setRendererSize(e,this.camerasController().size),this.camerasController().updateCameraAspect())}_initDisplay(){if(!this._canvas){console.warn("no canvas found for viewer");return}this.camerasController().computeSizeAndAspect();let e=this.camerasController().size,t=this._cameraNode.renderController();t.renderer(this._canvas)||t.createRenderer(this._canvas,e),this.audioController().update(),this.camerasController().prepareCurrentCamera(),this.animate()}setAutoRender(e=!0){this._doRender=e,this._doRender&&this.animate()}autoRenderState(){return this._doRender}animate(){var e;if(this._doRender){let t=this._clock.getDelta();this._delta=t,this._requestAnimationFrameId=requestAnimationFrame(this._animateMethod),this._runOnBeforeTickCallbacks(t),this._scene.timeController.incrementTimeIfPlaying(this._delta),this._runOnAfterTickCallbacks(t),this.render(this._delta),(e=this.controlsController())==null||e.update(this._delta)}}_cancelAnimate(){this._doRender=!1,this._requestAnimationFrameId&&cancelAnimationFrame(this._requestAnimationFrameId),this._canvas&&this._cameraNode.renderController().deleteRenderer(this._canvas)}render(e){if(this._canvas){let t=this._delta;this._runOnBeforeRenderCallbacks(t);let r=this.camerasController().size,o=this.camerasController().aspect;this._cameraNode.renderController().render(this._canvas,r,o,this._renderObjectOverride),this._runOnAfterRenderCallbacks(t)}else console.warn("no canvas to render onto")}renderer(){if(this._canvas)return this._cameraNode.renderController().renderer(this._canvas)}preCompile(){this._canvas&&this._cameraNode.renderController().preCompile(this._canvas)}};var cm=new F,yn=new Zv,B4=class extends $n{constructor(e){let t=new Gt,r=new Wn({color:16777215,vertexColors:!0,toneMapped:!1}),o=[],s=[],i={},l=new Ke(16755200),a=new Ke(16711680),c=new Ke(43775),h=new Ke(16777215),g=new Ke(3355443);p("n1","n2",l),p("n2","n4",l),p("n4","n3",l),p("n3","n1",l),p("f1","f2",l),p("f2","f4",l),p("f4","f3",l),p("f3","f1",l),p("n1","f1",l),p("n2","f2",l),p("n3","f3",l),p("n4","f4",l),p("p","n1",a),p("p","n2",a),p("p","n3",a),p("p","n4",a),p("u1","u2",c),p("u2","u3",c),p("u3","u1",c),p("c","t",h),p("p","c",g),p("cn1","cn2",g),p("cn3","cn4",g),p("cf1","cf2",g),p("cf3","cf4",g);function p(d,f,_){u(d,_),u(f,_)}function u(d,f){o.push(0,0,0),s.push(f.r,f.g,f.b),i[d]===void 0&&(i[d]=[]),i[d].push(o.length/3-1)}t.setAttribute("position",new _t(o,3)),t.setAttribute("color",new _t(s,3));super(t,r);this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrixAutoUpdate=!1,this.pointMap=i,this.update()}update(){let e=this.geometry,t=this.pointMap,r=1,o=1;yn.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),En("c",t,e,yn,0,0,-1),En("t",t,e,yn,0,0,1),En("n1",t,e,yn,-r,-o,-1),En("n2",t,e,yn,r,-o,-1),En("n3",t,e,yn,-r,o,-1),En("n4",t,e,yn,r,o,-1),En("f1",t,e,yn,-r,-o,1),En("f2",t,e,yn,r,-o,1),En("f3",t,e,yn,-r,o,1),En("f4",t,e,yn,r,o,1),En("u1",t,e,yn,r*.7,o*1.1,-1),En("u2",t,e,yn,-r*.7,o*1.1,-1),En("u3",t,e,yn,0,o*2,-1),En("cf1",t,e,yn,-r,0,1),En("cf2",t,e,yn,r,0,1),En("cf3",t,e,yn,0,-o,1),En("cf4",t,e,yn,0,o,1),En("cn1",t,e,yn,-r,0,-1),En("cn2",t,e,yn,r,0,-1),En("cn3",t,e,yn,0,-o,-1),En("cn4",t,e,yn,0,o,-1),e.getAttribute("position").needsUpdate=!0}};function En(n,e,t,r,o,s,i){cm.set(o,s,i).unproject(r);let l=e[n];if(l!==void 0){let a=t.getAttribute("position");for(let c=0,h=l.length;c<h;c++)a.setXYZ(l[c],cm.x,cm.y,cm.z)}}var Hw={type:"change"},up={near:.1,far:100},lp=(n=>(n.ON_END="on move end",n.ALWAYS="always",n.NEVER="never",n))(lp||{}),rm=["on move end","always","never"];function um(n){return class extends n{constructor(){super(...arguments);this.setMainCamera=N.BUTTON(null,{callback:(t,r)=>{qw.PARAM_CALLBACK_setMasterCamera(t)}})}}}function k4(n){return class extends n{constructor(){super(...arguments);this.camera=N.FOLDER(),this.controls=N.NODE_PATH("",{nodeSelection:{context:it.EVENT}}),this.updateFromControlsMode=N.INTEGER(rm.indexOf("on move end"),{menu:{entries:rm.map((t,r)=>({name:t,value:r}))}}),this.near=N.FLOAT(up.near,{range:[.1,100],cook:!1,computeOnDirty:!0,callback:(t,r)=>{cp.PARAM_CALLBACK_update_near_far_from_param(t,r)}}),this.far=N.FLOAT(up.far,{range:[0,100],cook:!1,computeOnDirty:!0,callback:(t,r)=>{cp.PARAM_CALLBACK_update_near_far_from_param(t,r)}}),this.display=N.BOOLEAN(1),this.showHelper=N.BOOLEAN(0)}}}var pp=(n=>(n.DEFAULT="default",n.COVER="cover",n.CONTAIN="contain",n))(pp||{}),oc=["default","cover","contain"];function jw(n){return class extends n{constructor(){super(...arguments);this.fovAdjustMode=N.INTEGER(oc.indexOf("default"),{menu:{entries:oc.map((t,r)=>({name:t,value:r}))}}),this.expectedAspectRatio=N.FLOAT("16/9",{visibleIf:[{fovAdjustMode:oc.indexOf("cover")},{fovAdjustMode:oc.indexOf("contain")}],range:[0,2],rangeLocked:[!0,!1]})}}}var UX=class extends um(je){},VX=class extends om(am(hi(nm(k4(um(je)))))){},F4=class extends vo{constructor(){super(...arguments);this.renderOrder=ra.CAMERA,this._aspect=-1}get object(){return this._object}async cook(){this.updateCamera(),this._object.dispatchEvent(Hw),this.cookController.endCook()}on_create(){}on_delete(){}prepareRaycaster(e,t){}camera(){return this._object}updateCamera(){}static PARAM_CALLBACK_setMasterCamera(e){e.set_as_master_camera()}set_as_master_camera(){this.scene().camerasController.setMainCameraNodePath(this.path())}setupForAspectRatio(e){}_updateForAspectRatio(){}update_transform_params_from_object(){Jr.setParamsFromObject(this._object,this)}static PARAM_CALLBACK_update_from_param(e,t){e.object[t.name()]=e.pv[t.name()]}},pm=class extends F4{constructor(){super(...arguments);this.flags=new Ko(this),this.hierarchyController=new Go(this),this.transformController=new Hi(this),this.childrenDisplayController=new op(this),this.displayNodeController=new np(this,this.childrenDisplayController.displayNodeControllerCallbacks()),this._childrenControllerContext=it.SOP}controlsController(){return this._controlsController=this._controlsController||new x4(this)}_layersController(){return this.__layersController__=this.__layersController__||new C4(this)}renderController(){return this._renderController=this._renderController||new ia(this)}postProcessController(){return this._postProcessController=this._postProcessController||new T4(this)}initializeBaseNode(){super.initializeBaseNode(),this.io.outputs.setHasOneOutput(),this.hierarchyController.initializeNode(),this.transformController.initializeNode(),this.childrenDisplayController.initializeNode(),this.initHelperHook()}createNode(e,t){return super.createNode(e,t)}children(){return super.children()}nodesByType(e){return super.nodesByType(e)}prepareRaycaster(e,t){t.setFromCamera(e,this._object)}async cook(){this.transformController.update(),this._layersController().update(),this.updateNearFar(),this.renderController().update(),this.updateCamera(),this._updateHelper(),this.controlsController().update_controls(),this._object.dispatchEvent(Hw),this.cookController.endCook()}static PARAM_CALLBACK_update_near_far_from_param(e,t){e.updateNearFar()}updateNearFar(){(this._object.near!=this.pv.near||this._object.far!=this.pv.far)&&(this._object.near=this.pv.near,this._object.far=this.pv.far,this._object.updateProjectionMatrix(),this._updateHelper())}setupForAspectRatio(e){xe.isNaN(e)||e&&this._aspect!=e&&(this._aspect=e,this._updateForAspectRatio())}createViewer(e){let t,r;return e&&e instanceof HTMLElement?(t=new lm(this),r=e):(t=new lm(this,(e==null?void 0:e.viewerProperties)||{}),r=e==null?void 0:e.element),r&&t.mount(r),this.scene().viewersRegister.registerViewer(t),t}static PARAM_CALLBACK_reset_effects_composer(e){e.postProcessController().reset()}initHelperHook(){this.flags.display.onUpdate(()=>{this._updateHelper()})}helperVisible(){return this.flags.display.active()&&Ie(this.pv.showHelper)}_createHelper(){let e=new B4(this.object);return e.update(),e}_updateHelper(){this.helperVisible()?(this._helper||(this._helper=this._createHelper()),this._helper&&(this.object.add(this._helper),this._helper.update())):this._helper&&this.object.remove(this._helper)}},qw=class extends F4{},cp=class extends pm{PARAM_CALLBACK_update_effects_composer(e){}};var Ww={fov:50};function zX(n){return class extends n{constructor(){super(...arguments);this.fov=N.FLOAT(Ww.fov,{range:[0,100]})}}}var $w=class extends om(am(nm(um(jw(zX(k4(hi(je,{matrixAutoUpdate:!0})))))))){},HX=new $w,G4=class extends pm{constructor(){super(...arguments);this.paramsConfig=HX}static type(){return _9.PERSPECTIVE}createObject(){return new qn(Ww.fov,1,up.near,up.far)}updateCamera(){this._object.fov!=this.pv.fov&&(this._object.fov=this.pv.fov,this._object.updateProjectionMatrix()),this._updateForAspectRatio()}_updateForAspectRatio(){this._aspect&&(this._object.aspect=this._aspect,this._adjustFOVFromMode(),this._object.updateProjectionMatrix())}_adjustFOVFromMode(){let e=oc[this.pv.fovAdjustMode];switch(e){case pp.DEFAULT:return this._adjustFOVFromModeDefault();case pp.COVER:return this._adjustFOVFromModeCover();case pp.CONTAIN:return this._adjustFOVFromModeContain()}qr.unreachable(e)}_adjustFOVFromModeDefault(){this._object.fov=this.pv.fov}_adjustFOVFromModeCover(){if(this._object.aspect>this.pv.expectedAspectRatio){let e=Math.tan(Pi(this.pv.fov/2)),t=this._object.aspect/this.pv.expectedAspectRatio,r=e/t;this._object.fov=k1(Math.atan(r))*2}else this._object.fov=this.pv.fov}_adjustFOVFromModeContain(){if(this._object.aspect>this.pv.expectedAspectRatio)this._object.fov=this.pv.fov;else{let e=Math.tan(Pi(this.pv.fov/2)),t=this._object.aspect/this.pv.expectedAspectRatio,r=e/t;this._object.fov=k1(Math.atan(r))*2}}};var U4=class extends $n{constructor(e=1){let t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],o=new Gt;o.setAttribute("position",new _t(t,3)),o.setAttribute("color",new _t(r,3));let s=new Wn({vertexColors:!0,toneMapped:!1});super(o,s);this.type="AxesHelper"}setColors(e,t,r){let o=new Ke,s=this.geometry.attributes.color.array;return o.set(e),o.toArray(s,0),o.toArray(s,3),o.set(t),o.toArray(s,6),o.toArray(s,9),o.set(r),o.toArray(s,12),o.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}};var V4=class extends $n{constructor(e=10,t=16,r=8,o=64,s=4473924,i=8947848){s=new Ke(s),i=new Ke(i);let l=[],a=[];for(let g=0;g<=t;g++){let p=g/t*(Math.PI*2),u=Math.sin(p)*e,d=Math.cos(p)*e;l.push(0,0,0),l.push(u,0,d);let f=g&1?s:i;a.push(f.r,f.g,f.b),a.push(f.r,f.g,f.b)}for(let g=0;g<=r;g++){let p=g&1?s:i,u=e-e/r*g;for(let d=0;d<o;d++){let f=d/o*(Math.PI*2),_=Math.sin(f)*u,m=Math.cos(f)*u;l.push(_,0,m),a.push(p.r,p.g,p.b),f=(d+1)/o*(Math.PI*2),_=Math.sin(f)*u,m=Math.cos(f)*u,l.push(_,0,m),a.push(p.r,p.g,p.b)}}let c=new Gt;c.setAttribute("position",new _t(l,3)),c.setAttribute("color",new _t(a,3));let h=new Wn({vertexColors:!0,toneMapped:!1});super(c,h);this.type="PolarGridHelper"}};var Yw=class extends je{constructor(){super(...arguments);this.center=N.VECTOR3([0,0,0]),this.longitude=N.FLOAT(0,{range:[0,360]}),this.latitude=N.FLOAT(0,{range:[-180,180]}),this.depth=N.FLOAT(1,{range:[0,10]})}},jX=new Yw,Xw="_cook_main_without_inputs_when_dirty",qX=new F(0,1,0),WX=new F(-1,0,0),z4=class extends vo{constructor(){super(...arguments);this.paramsConfig=jX,this.hierarchyController=new Go(this),this.flags=new Ko(this),this._helper=this._createHelper(),this._cook_main_without_inputs_when_dirty_bound=this._cook_main_without_inputs_when_dirty.bind(this),this._centerMatrix=new vr,this._longitudeMatrix=new vr,this._latitudeMatrix=new vr,this._depthMatrix=new vr,this._fullMatrix=new vr,this._decomposed={t:new F,q:new ao,s:new F}}static type(){return"polarTransform"}createObject(){let e=new Tr;return e.matrixAutoUpdate=!1,e}initializeNode(){this.hierarchyController.initializeNode(),this.dirtyController.hasHook(Xw)||this.dirtyController.addPostDirtyHook(Xw,this._cook_main_without_inputs_when_dirty_bound),this._updateHelperHierarchy(),this._helper.matrixAutoUpdate=!1,this.flags.display.onUpdate(()=>{this._updateHelperHierarchy()})}_updateHelperHierarchy(){this._displayedHelper()?(this.object.add(this._helper),this._updateHelper()):this.object.remove(this._helper)}_displayedHelper(){return this.flags.display.active()}_axisHelper(){return this.__axisHelper__=this.__axisHelper__||this._createAxisHelper()}_createAxisHelper(){let e=new U4(1);return e.matrixAutoUpdate=!1,e}_polarGridHelper(){return this.__polarGridHelper__=this.__polarGridHelper__||this._createPolarGridHelper()}_createPolarGridHelper(){let e=this.pv.depth,t=16,r=8,o=64,s=new V4(e,t,r,o);return s.matrixAutoUpdate=!1,s}_createHelper(){let e=new Tr;return e.name="PolarTransformHelper",e.matrixAutoUpdate=!1,e.add(this._axisHelper()),e.add(this._polarGridHelper()),e}async _cook_main_without_inputs_when_dirty(){await this.cookController.cookMainWithoutInputs()}cook(){let e=this.object;this._centerMatrix.identity(),this._longitudeMatrix.identity(),this._latitudeMatrix.identity(),this._depthMatrix.identity(),this._centerMatrix.makeTranslation(this.pv.center.x,this.pv.center.y,this.pv.center.z),this._longitudeMatrix.makeRotationAxis(qX,Pi(this.pv.longitude)),this._latitudeMatrix.makeRotationAxis(WX,Pi(this.pv.latitude)),this._depthMatrix.makeTranslation(0,0,this.pv.depth),this._fullMatrix.copy(this._centerMatrix).multiply(this._longitudeMatrix).multiply(this._latitudeMatrix).multiply(this._depthMatrix),this._fullMatrix.decompose(this._decomposed.t,this._decomposed.q,this._decomposed.s),e.position.copy(this._decomposed.t),e.quaternion.copy(this._decomposed.q),e.scale.copy(this._decomposed.s),e.updateMatrix(),this._updateHelper(),this.cookController.endCook()}_updateHelper(){!this._displayedHelper()||(this._helper.updateMatrix(),this._polarGridHelper().matrix.copy(this.object.matrix),this._polarGridHelper().matrix.invert(),this._polarGridHelper().matrix.multiply(this._centerMatrix))}};var dm=["Float64BufferAttribute","Float32BufferAttribute","Float16BufferAttribute","Uint32BufferAttribute","Int32BufferAttribute","Uint16BufferAttribute","Int16BufferAttribute","Uint8ClampedBufferAttribute","Uint8BufferAttribute","Int8BufferAttribute"],$X={Float64BufferAttribute:Jv,Float32BufferAttribute:_t,Float16BufferAttribute:Xv,Uint32BufferAttribute:Nd,Int32BufferAttribute:rl,Uint16BufferAttribute:Md,Int16BufferAttribute:Yv,Uint8ClampedBufferAttribute:$v,Uint8BufferAttribute:Wv,Int8BufferAttribute:qv},YX={Float64BufferAttribute:Float64Array,Float32BufferAttribute:Float32Array,Float16BufferAttribute:Uint16Array,Uint32BufferAttribute:Uint32Array,Int32BufferAttribute:Int32Array,Uint16BufferAttribute:Uint16Array,Int16BufferAttribute:Int16Array,Uint8ClampedBufferAttribute:Uint8Array,Uint8BufferAttribute:Uint8Array,Int8BufferAttribute:Int8Array},sa=class extends Rr{static type(){return"attribCast"}cook(e,t){let r=e[0],o=r.objectsWithGeo();for(let s of o)this._castGeoAttributes(s.geometry,t);return r}_castGeoAttributes(e,t){let r=dm[t.type],o=$X[r],s=YX[r];if(Ie(t.castAttributes)){let i=Yr.attribNamesMatchingMask(e,t.mask);for(let l of i){let a=e.attributes[l],c=a.array,h=a.count,g=a.itemSize,p=new s(h*g);for(let d=0;d<c.length;d++)p[d]=c[d];let u=new o(p,1);e.setAttribute(l,u)}}if(t.castIndex){let i=e.getIndex();if(i){let l=i.array,a=i.count,c=1,h=new s(a*c);for(let p=0;p<l.length;p++)h[p]=l[p];let g=new o(h,1);e.setIndex(g)}}}};sa.DEFAULT_PARAMS={castAttributes:!0,mask:"*",castIndex:!1,type:dm.indexOf("Float32BufferAttribute")};sa.INPUT_CLONED_STATE=yr.FROM_NODE;var fm=sa.DEFAULT_PARAMS,Jw=class extends je{constructor(){super(...arguments);this.castAttributes=N.BOOLEAN(fm.castAttributes),this.mask=N.STRING(fm.mask,{visibleIf:{castAttributes:1}}),this.castIndex=N.BOOLEAN(fm.castIndex),this.type=N.INTEGER(fm.type,{menu:{entries:dm.map((e,t)=>({name:e,value:t}))}})}},XX=new Jw,H4=class extends on{constructor(){super(...arguments);this.paramsConfig=XX}static type(){return"attribCast"}initializeNode(){this.io.inputs.setCount(1),this.io.inputs.initInputsClonedState(sa.INPUT_CLONED_STATE)}cook(e){this._operation=this._operation||new sa(this.scene(),this.states);let t=this._operation.cook(e,this.pv);this.setCoreGroup(t)}};var Kw=class extends no{static context(){return it.SOP}cook(){this.cookController.endCook()}},j4=class extends Kw{};var q4=class extends j4{constructor(){super(...arguments);this._childrenControllerContext=it.EVENT}static type(){return W0.EVENT}createNode(e,t){return super.createNode(e,t)}children(){return super.children()}nodesByType(e){return super.nodesByType(e)}};var Zw=new vr,Qw=new vr,mm=[],dp=new wr,hm=class extends wr{constructor(e,t,r){super(e,t);this.instanceMatrix=new oo(new Float32Array(r*16),16),this.instanceColor=null,this.count=r,this.frustumCulled=!1}copy(e){return super.copy(e),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}raycast(e,t){let r=this.matrixWorld,o=this.count;if(dp.geometry=this.geometry,dp.material=this.material,dp.material!==void 0)for(let s=0;s<o;s++){this.getMatrixAt(s,Zw),Qw.multiplyMatrices(r,Zw),dp.matrixWorld=Qw,dp.raycast(e,mm);for(let i=0,l=mm.length;i<l;i++){let a=mm[i];a.instanceId=s,a.object=this,t.push(a)}mm.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new oo(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}};hm.prototype.isInstancedMesh=!0;var ic,fp=new F,sc=new F,ac=new F,lc=new re,mp=new re,eR=new vr,_m=new F,hp=new F,gm=new F,tR=new re,W4=new re,rR=new re,vm=class extends On{constructor(e){super();if(this.type="Sprite",ic===void 0){ic=new Gt;let t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),r=new wd(t,5);ic.setIndex([0,1,2,0,2,3]),ic.setAttribute("position",new sl(r,3,0,!1)),ic.setAttribute("uv",new sl(r,2,3,!1))}this.geometry=ic,this.material=e!==void 0?e:new Xl,this.center=new re(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),sc.setFromMatrixScale(this.matrixWorld),eR.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),ac.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&sc.multiplyScalar(-ac.z);let r=this.material.rotation,o,s;r!==0&&(s=Math.cos(r),o=Math.sin(r));let i=this.center;ym(_m.set(-.5,-.5,0),ac,i,sc,o,s),ym(hp.set(.5,-.5,0),ac,i,sc,o,s),ym(gm.set(.5,.5,0),ac,i,sc,o,s),tR.set(0,0),W4.set(1,0),rR.set(1,1);let l=e.ray.intersectTriangle(_m,hp,gm,!1,fp);if(l===null&&(ym(hp.set(-.5,.5,0),ac,i,sc,o,s),W4.set(0,1),l=e.ray.intersectTriangle(_m,gm,hp,!1,fp),l===null))return;let a=e.ray.origin.distanceTo(fp);a<e.near||a>e.far||t.push({distance:a,point:fp.clone(),uv:I0.getUV(fp,_m,hp,gm,tR,W4,rR,new re),face:null,object:this})}copy(e){return super.copy(e),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}};vm.prototype.isSprite=!0;function ym(n,e,t,r,o,s){lc.subVectors(n,t).addScalar(.5).multiply(r),o!==void 0?(mp.x=s*lc.x-o*lc.y,mp.y=o*lc.x+s*lc.y):mp.copy(lc),n.copy(e),n.x+=mp.x,n.y+=mp.y,n.applyMatrix4(eR)}var An=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){let r=this.getUtoTmapping(e);return this.getPoint(r,t)}getPoints(e=5){let t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t}getSpacedPoints(e=5){let t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t=[],r,o=this.getPoint(0),s=0;t.push(0);for(let i=1;i<=e;i++)r=this.getPoint(i/e),s+=r.distanceTo(o),t.push(s),o=r;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){let r=this.getLengths(),o=0,s=r.length,i;t?i=t:i=e*r[s-1];let l=0,a=s-1,c;for(;l<=a;)if(o=Math.floor(l+(a-l)/2),c=r[o]-i,c<0)l=o+1;else if(c>0)a=o-1;else{a=o;break}if(o=a,r[o]===i)return o/(s-1);let h=r[o],p=r[o+1]-h,u=(i-h)/p;return(o+u)/(s-1)}getTangent(e,t){let r=1e-4,o=e-r,s=e+r;o<0&&(o=0),s>1&&(s=1);let i=this.getPoint(o),l=this.getPoint(s),a=t||(i.isVector2?new re:new F);return a.copy(l).sub(i).normalize(),a}getTangentAt(e,t){let r=this.getUtoTmapping(e);return this.getTangent(r,t)}computeFrenetFrames(e,t){let r=new F,o=[],s=[],i=[],l=new F,a=new vr;for(let u=0;u<=e;u++){let d=u/e;o[u]=this.getTangentAt(d,new F)}s[0]=new F,i[0]=new F;let c=Number.MAX_VALUE,h=Math.abs(o[0].x),g=Math.abs(o[0].y),p=Math.abs(o[0].z);h<=c&&(c=h,r.set(1,0,0)),g<=c&&(c=g,r.set(0,1,0)),p<=c&&r.set(0,0,1),l.crossVectors(o[0],r).normalize(),s[0].crossVectors(o[0],l),i[0].crossVectors(o[0],s[0]);for(let u=1;u<=e;u++){if(s[u]=s[u-1].clone(),i[u]=i[u-1].clone(),l.crossVectors(o[u-1],o[u]),l.length()>Number.EPSILON){l.normalize();let d=Math.acos(_o(o[u-1].dot(o[u]),-1,1));s[u].applyMatrix4(a.makeRotationAxis(l,d))}i[u].crossVectors(o[u],s[u])}if(t===!0){let u=Math.acos(_o(s[0].dot(s[e]),-1,1));u/=e,o[0].dot(l.crossVectors(s[0],s[e]))>0&&(u=-u);for(let d=1;d<=e;d++)s[d].applyMatrix4(a.makeRotationAxis(o[d],u*d)),i[d].crossVectors(o[d],s[d])}return{tangents:o,normals:s,binormals:i}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}};var ca={};b1(ca,{ArcCurve:()=>bm,CatmullRomCurve3:()=>Cm,CubicBezierCurve:()=>cc,CubicBezierCurve3:()=>Tm,EllipseCurve:()=>Q0,LineCurve:()=>es,LineCurve3:()=>Z4,QuadraticBezierCurve:()=>uc,QuadraticBezierCurve3:()=>pc,SplineCurve:()=>dc});var Q0=class extends An{constructor(e=0,t=0,r=1,o=1,s=0,i=Math.PI*2,l=!1,a=0){super();this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=o,this.aStartAngle=s,this.aEndAngle=i,this.aClockwise=l,this.aRotation=a}getPoint(e,t){let r=t||new re,o=Math.PI*2,s=this.aEndAngle-this.aStartAngle,i=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=o;for(;s>o;)s-=o;s<Number.EPSILON&&(i?s=0:s=o),this.aClockwise===!0&&!i&&(s===o?s=-o:s=s-o);let l=this.aStartAngle+e*s,a=this.aX+this.xRadius*Math.cos(l),c=this.aY+this.yRadius*Math.sin(l);if(this.aRotation!==0){let h=Math.cos(this.aRotation),g=Math.sin(this.aRotation),p=a-this.aX,u=c-this.aY;a=p*h-u*g+this.aX,c=p*g+u*h+this.aY}return r.set(a,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}};Q0.prototype.isEllipseCurve=!0;var bm=class extends Q0{constructor(e,t,r,o,s,i){super(e,t,r,r,o,s,i);this.type="ArcCurve"}};bm.prototype.isArcCurve=!0;function $4(){let n=0,e=0,t=0,r=0;function o(s,i,l,a){n=s,e=l,t=-3*s+3*i-2*l-a,r=2*s-2*i+l+a}return{initCatmullRom:function(s,i,l,a,c){o(i,l,c*(l-s),c*(a-i))},initNonuniformCatmullRom:function(s,i,l,a,c,h,g){let p=(i-s)/c-(l-s)/(c+h)+(l-i)/h,u=(l-i)/h-(a-i)/(h+g)+(a-l)/g;p*=h,u*=h,o(i,l,p,u)},calc:function(s){let i=s*s,l=i*s;return n+e*s+t*i+r*l}}}var xm=new F,Y4=new $4,X4=new $4,J4=new $4,Cm=class extends An{constructor(e=[],t=!1,r="centripetal",o=.5){super();this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=r,this.tension=o}getPoint(e,t=new F){let r=t,o=this.points,s=o.length,i=(s-(this.closed?0:1))*e,l=Math.floor(i),a=i-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/s)+1)*s:a===0&&l===s-1&&(l=s-2,a=1);let c,h;this.closed||l>0?c=o[(l-1)%s]:(xm.subVectors(o[0],o[1]).add(o[0]),c=xm);let g=o[l%s],p=o[(l+1)%s];if(this.closed||l+2<s?h=o[(l+2)%s]:(xm.subVectors(o[s-1],o[s-2]).add(o[s-1]),h=xm),this.curveType==="centripetal"||this.curveType==="chordal"){let u=this.curveType==="chordal"?.5:.25,d=Math.pow(c.distanceToSquared(g),u),f=Math.pow(g.distanceToSquared(p),u),_=Math.pow(p.distanceToSquared(h),u);f<1e-4&&(f=1),d<1e-4&&(d=f),_<1e-4&&(_=f),Y4.initNonuniformCatmullRom(c.x,g.x,p.x,h.x,d,f,_),X4.initNonuniformCatmullRom(c.y,g.y,p.y,h.y,d,f,_),J4.initNonuniformCatmullRom(c.z,g.z,p.z,h.z,d,f,_)}else this.curveType==="catmullrom"&&(Y4.initCatmullRom(c.x,g.x,p.x,h.x,this.tension),X4.initCatmullRom(c.y,g.y,p.y,h.y,this.tension),J4.initCatmullRom(c.z,g.z,p.z,h.z,this.tension));return r.set(Y4.calc(a),X4.calc(a),J4.calc(a)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let o=e.points[t];this.points.push(o.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){let o=this.points[t];e.points.push(o.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let o=e.points[t];this.points.push(new F().fromArray(o))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}};Cm.prototype.isCatmullRomCurve3=!0;function K4(n,e,t,r,o){let s=(r-e)*.5,i=(o-t)*.5,l=n*n,a=n*l;return(2*t-2*r+s+i)*a+(-3*t+3*r-2*s-i)*l+s*n+t}function JX(n,e){let t=1-n;return t*t*e}function KX(n,e){return 2*(1-n)*n*e}function ZX(n,e){return n*n*e}function aa(n,e,t,r){return JX(n,e)+KX(n,t)+ZX(n,r)}function QX(n,e){let t=1-n;return t*t*t*e}function eJ(n,e){let t=1-n;return 3*t*t*n*e}function tJ(n,e){return 3*(1-n)*n*n*e}function rJ(n,e){return n*n*n*e}function la(n,e,t,r,o){return QX(n,e)+eJ(n,t)+tJ(n,r)+rJ(n,o)}var cc=class extends An{constructor(e=new re,t=new re,r=new re,o=new re){super();this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=r,this.v3=o}getPoint(e,t=new re){let r=t,o=this.v0,s=this.v1,i=this.v2,l=this.v3;return r.set(la(e,o.x,s.x,i.x,l.x),la(e,o.y,s.y,i.y,l.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}};cc.prototype.isCubicBezierCurve=!0;var Tm=class extends An{constructor(e=new F,t=new F,r=new F,o=new F){super();this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=r,this.v3=o}getPoint(e,t=new F){let r=t,o=this.v0,s=this.v1,i=this.v2,l=this.v3;return r.set(la(e,o.x,s.x,i.x,l.x),la(e,o.y,s.y,i.y,l.y),la(e,o.z,s.z,i.z,l.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}};Tm.prototype.isCubicBezierCurve3=!0;var es=class extends An{constructor(e=new re,t=new re){super();this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new re){let r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){let r=t||new re;return r.copy(this.v2).sub(this.v1).normalize(),r}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}};es.prototype.isLineCurve=!0;var Z4=class extends An{constructor(e=new F,t=new F){super();this.type="LineCurve3",this.isLineCurve3=!0,this.v1=e,this.v2=t}getPoint(e,t=new F){let r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}};var uc=class extends An{constructor(e=new re,t=new re,r=new re){super();this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new re){let r=t,o=this.v0,s=this.v1,i=this.v2;return r.set(aa(e,o.x,s.x,i.x),aa(e,o.y,s.y,i.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}};uc.prototype.isQuadraticBezierCurve=!0;var pc=class extends An{constructor(e=new F,t=new F,r=new F){super();this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new F){let r=t,o=this.v0,s=this.v1,i=this.v2;return r.set(aa(e,o.x,s.x,i.x),aa(e,o.y,s.y,i.y),aa(e,o.z,s.z,i.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}};pc.prototype.isQuadraticBezierCurve3=!0;var dc=class extends An{constructor(e=[]){super();this.type="SplineCurve",this.points=e}getPoint(e,t=new re){let r=t,o=this.points,s=(o.length-1)*e,i=Math.floor(s),l=s-i,a=o[i===0?i:i-1],c=o[i],h=o[i>o.length-2?o.length-1:i+1],g=o[i>o.length-3?o.length-1:i+2];return r.set(K4(l,a.x,c.x,h.x,g.x),K4(l,a.y,c.y,h.y,g.y)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let o=e.points[t];this.points.push(o.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){let o=this.points[t];e.points.push(o.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let o=e.points[t];this.points.push(new re().fromArray(o))}return this}};dc.prototype.isSplineCurve=!0;var Q4=class extends An{constructor(){super();this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new es(t,e))}getPoint(e,t){let r=e*this.getLength(),o=this.getCurveLengths(),s=0;for(;s<o.length;){if(o[s]>=r){let i=o[s]-r,l=this.curves[s],a=l.getLength(),c=a===0?0:1-i/a;return l.getPointAt(c,t)}s++}return null}getLength(){let e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],t=0;for(let r=0,o=this.curves.length;r<o;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){let t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){let t=[],r;for(let o=0,s=this.curves;o<s.length;o++){let i=s[o],l=i&&i.isEllipseCurve?e*2:i&&(i.isLineCurve||i.isLineCurve3)?1:i&&i.isSplineCurve?e*i.points.length:e,a=i.getPoints(l);for(let c=0;c<a.length;c++){let h=a[c];r&&r.equals(h)||(t.push(h),r=h)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){let o=e.curves[t];this.curves.push(o.clone())}return this.autoClose=e.autoClose,this}toJSON(){let e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,r=this.curves.length;t<r;t++){let o=this.curves[t];e.curves.push(o.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){let o=e.curves[t];this.curves.push(new ca[o.type]().fromJSON(o))}return this}};var Em=class extends Q4{constructor(e){super();this.type="Path",this.currentPoint=new re,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){let r=new es(this.currentPoint.clone(),new re(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,r,o){let s=new uc(this.currentPoint.clone(),new re(e,t),new re(r,o));return this.curves.push(s),this.currentPoint.set(r,o),this}bezierCurveTo(e,t,r,o,s,i){let l=new cc(this.currentPoint.clone(),new re(e,t),new re(r,o),new re(s,i));return this.curves.push(l),this.currentPoint.set(s,i),this}splineThru(e){let t=[this.currentPoint.clone()].concat(e),r=new dc(t);return this.curves.push(r),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,r,o,s,i){let l=this.currentPoint.x,a=this.currentPoint.y;return this.absarc(e+l,t+a,r,o,s,i),this}absarc(e,t,r,o,s,i){return this.absellipse(e,t,r,r,o,s,i),this}ellipse(e,t,r,o,s,i,l,a){let c=this.currentPoint.x,h=this.currentPoint.y;return this.absellipse(e+c,t+h,r,o,s,i,l,a),this}absellipse(e,t,r,o,s,i,l,a){let c=new Q0(e,t,r,o,s,i,l,a);if(this.curves.length>0){let g=c.getPoint(0);g.equals(this.currentPoint)||this.lineTo(g.x,g.y)}this.curves.push(c);let h=c.getPoint(1);return this.currentPoint.copy(h),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){let e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}};var ua=class extends Em{constructor(e){super(e);this.uuid=el(),this.type="Shape",this.holes=[]}getPointsHoles(e){let t=[];for(let r=0,o=this.holes.length;r<o;r++)t[r]=this.holes[r].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){let o=e.holes[t];this.holes.push(o.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++){let o=this.holes[t];e.holes.push(o.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){let o=e.holes[t];this.holes.push(new Em().fromJSON(o))}return this}};var Am=class extends t0{constructor(e,t){super(e,t);this.type="AmbientLight"}};Am.prototype.isAmbientLight=!0;var Mm=class{constructor(){this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new F)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){let r=e.x,o=e.y,s=e.z,i=this.coefficients;return t.copy(i[0]).multiplyScalar(.282095),t.addScaledVector(i[1],.488603*o),t.addScaledVector(i[2],.488603*s),t.addScaledVector(i[3],.488603*r),t.addScaledVector(i[4],1.092548*(r*o)),t.addScaledVector(i[5],1.092548*(o*s)),t.addScaledVector(i[6],.315392*(3*s*s-1)),t.addScaledVector(i[7],1.092548*(r*s)),t.addScaledVector(i[8],.546274*(r*r-o*o)),t}getIrradianceAt(e,t){let r=e.x,o=e.y,s=e.z,i=this.coefficients;return t.copy(i[0]).multiplyScalar(.886227),t.addScaledVector(i[1],2*.511664*o),t.addScaledVector(i[2],2*.511664*s),t.addScaledVector(i[3],2*.511664*r),t.addScaledVector(i[4],2*.429043*r*o),t.addScaledVector(i[5],2*.429043*o*s),t.addScaledVector(i[6],.743125*s*s-.247708),t.addScaledVector(i[7],2*.429043*r*s),t.addScaledVector(i[8],.429043*(r*r-o*o)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let r=0;r<9;r++)this.coefficients[r].addScaledVector(e.coefficients[r],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let r=0;r<9;r++)this.coefficients[r].lerp(e.coefficients[r],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){let r=this.coefficients;for(let o=0;o<9;o++)r[o].fromArray(e,t+o*3);return this}toArray(e=[],t=0){let r=this.coefficients;for(let o=0;o<9;o++)r[o].toArray(e,t+o*3);return e}static getBasisAt(e,t){let r=e.x,o=e.y,s=e.z;t[0]=.282095,t[1]=.488603*o,t[2]=.488603*s,t[3]=.488603*r,t[4]=1.092548*r*o,t[5]=1.092548*o*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*r*s,t[8]=.546274*(r*r-o*o)}};Mm.prototype.isSphericalHarmonics3=!0;var Nm=class extends t0{constructor(e=new Mm,t=1){super(void 0,t);this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){let t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}};Nm.prototype.isLightProbe=!0;var e5=class extends al{constructor(e){super(e)}load(e,t,r,o){let s=this,i=new ws(s.manager);i.setPath(s.path),i.setRequestHeader(s.requestHeader),i.setWithCredentials(s.withCredentials),i.load(e,function(l){try{t(s.parse(JSON.parse(l)))}catch(a){o?o(a):console.error(a),s.manager.itemError(e)}},r,o)}parse(e){let t={},r={};function o(u,d){if(t[d]!==void 0)return t[d];let _=u.interleavedBuffers[d],m=s(u,_.buffer),v=L0(_.type,m),y=new wd(v,_.stride);return y.uuid=_.uuid,t[d]=y,y}function s(u,d){if(r[d]!==void 0)return r[d];let _=u.arrayBuffers[d],m=new Uint32Array(_).buffer;return r[d]=m,m}let i=e.isInstancedBufferGeometry?new $l:new Gt,l=e.data.index;if(l!==void 0){let u=L0(l.type,l.array);i.setIndex(new lo(u,1))}let a=e.data.attributes;for(let u in a){let d=a[u],f;if(d.isInterleavedBufferAttribute){let _=o(e.data,d.data);f=new sl(_,d.itemSize,d.offset,d.normalized)}else{let _=L0(d.type,d.array),m=d.isInstancedBufferAttribute?oo:lo;f=new m(_,d.itemSize,d.normalized)}d.name!==void 0&&(f.name=d.name),d.usage!==void 0&&f.setUsage(d.usage),d.updateRange!==void 0&&(f.updateRange.offset=d.updateRange.offset,f.updateRange.count=d.updateRange.count),i.setAttribute(u,f)}let c=e.data.morphAttributes;if(c)for(let u in c){let d=c[u],f=[];for(let _=0,m=d.length;_<m;_++){let v=d[_],y;if(v.isInterleavedBufferAttribute){let b=o(e.data,v.data);y=new sl(b,v.itemSize,v.offset,v.normalized)}else{let b=L0(v.type,v.array);y=new lo(b,v.itemSize,v.normalized)}v.name!==void 0&&(y.name=v.name),f.push(y)}i.morphAttributes[u]=f}e.data.morphTargetsRelative&&(i.morphTargetsRelative=!0);let g=e.data.groups||e.data.drawcalls||e.data.offsets;if(g!==void 0)for(let u=0,d=g.length;u!==d;++u){let f=g[u];i.addGroup(f.start,f.count,f.materialIndex)}let p=e.data.boundingSphere;if(p!==void 0){let u=new F;p.center!==void 0&&u.fromArray(p.center),i.boundingSphere=new Hv(u,p.radius)}return e.name&&(i.name=e.name),e.userData&&(i.userData=e.userData),i}};var Wm={};b1(Wm,{BoxBufferGeometry:()=>wi,BoxGeometry:()=>wi,CircleBufferGeometry:()=>Sm,CircleGeometry:()=>Sm,ConeBufferGeometry:()=>Pm,ConeGeometry:()=>Pm,CylinderBufferGeometry:()=>fc,CylinderGeometry:()=>fc,DodecahedronBufferGeometry:()=>Om,DodecahedronGeometry:()=>Om,EdgesGeometry:()=>nR,ExtrudeBufferGeometry:()=>km,ExtrudeGeometry:()=>km,IcosahedronBufferGeometry:()=>hc,IcosahedronGeometry:()=>hc,LatheBufferGeometry:()=>Fm,LatheGeometry:()=>Fm,OctahedronBufferGeometry:()=>Gm,OctahedronGeometry:()=>Gm,PlaneBufferGeometry:()=>B0,PlaneGeometry:()=>B0,PolyhedronBufferGeometry:()=>Qo,PolyhedronGeometry:()=>Qo,RingBufferGeometry:()=>Um,RingGeometry:()=>Um,ShapeBufferGeometry:()=>Vm,ShapeGeometry:()=>Vm,SphereBufferGeometry:()=>pa,SphereGeometry:()=>pa,TetrahedronBufferGeometry:()=>zm,TetrahedronGeometry:()=>zm,TorusBufferGeometry:()=>Hm,TorusGeometry:()=>Hm,TorusKnotBufferGeometry:()=>jm,TorusKnotGeometry:()=>jm,TubeBufferGeometry:()=>qm,TubeGeometry:()=>qm,WireframeGeometry:()=>pR});var Sm=class extends Gt{constructor(e=1,t=8,r=0,o=Math.PI*2){super();this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:o},t=Math.max(3,t);let s=[],i=[],l=[],a=[],c=new F,h=new re;i.push(0,0,0),l.push(0,0,1),a.push(.5,.5);for(let g=0,p=3;g<=t;g++,p+=3){let u=r+g/t*o;c.x=e*Math.cos(u),c.y=e*Math.sin(u),i.push(c.x,c.y,c.z),l.push(0,0,1),h.x=(i[p]/e+1)/2,h.y=(i[p+1]/e+1)/2,a.push(h.x,h.y)}for(let g=1;g<=t;g++)s.push(g,g+1,0);this.setIndex(s),this.setAttribute("position",new _t(i,3)),this.setAttribute("normal",new _t(l,3)),this.setAttribute("uv",new _t(a,2))}static fromJSON(e){return new Sm(e.radius,e.segments,e.thetaStart,e.thetaLength)}};var fc=class extends Gt{constructor(e=1,t=1,r=1,o=8,s=1,i=!1,l=0,a=Math.PI*2){super();this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:o,heightSegments:s,openEnded:i,thetaStart:l,thetaLength:a};let c=this;o=Math.floor(o),s=Math.floor(s);let h=[],g=[],p=[],u=[],d=0,f=[],_=r/2,m=0;v(),i===!1&&(e>0&&y(!0),t>0&&y(!1)),this.setIndex(h),this.setAttribute("position",new _t(g,3)),this.setAttribute("normal",new _t(p,3)),this.setAttribute("uv",new _t(u,2));function v(){let b=new F,x=new F,E=0,T=(t-e)/r;for(let M=0;M<=s;M++){let D=[],U=M/s,L=U*(t-e)+e;for(let se=0;se<=o;se++){let $=se/o,H=$*a+l,ae=Math.sin(H),ue=Math.cos(H);x.x=L*ae,x.y=-U*r+_,x.z=L*ue,g.push(x.x,x.y,x.z),b.set(ae,T,ue).normalize(),p.push(b.x,b.y,b.z),u.push($,1-U),D.push(d++)}f.push(D)}for(let M=0;M<o;M++)for(let D=0;D<s;D++){let U=f[D][M],L=f[D+1][M],se=f[D+1][M+1],$=f[D][M+1];h.push(U,L,$),h.push(L,se,$),E+=6}c.addGroup(m,E,0),m+=E}function y(b){let x=d,E=new re,T=new F,M=0,D=b===!0?e:t,U=b===!0?1:-1;for(let se=1;se<=o;se++)g.push(0,_*U,0),p.push(0,U,0),u.push(.5,.5),d++;let L=d;for(let se=0;se<=o;se++){let H=se/o*a+l,ae=Math.cos(H),ue=Math.sin(H);T.x=D*ue,T.y=_*U,T.z=D*ae,g.push(T.x,T.y,T.z),p.push(0,U,0),E.x=ae*.5+.5,E.y=ue*.5*U+.5,u.push(E.x,E.y),d++}for(let se=0;se<o;se++){let $=x+se,H=L+se;b===!0?h.push(H,H+1,$):h.push(H+1,H,$),M+=3}c.addGroup(m,M,b===!0?1:2),m+=M}}static fromJSON(e){return new fc(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}};var Pm=class extends fc{constructor(e=1,t=1,r=8,o=1,s=!1,i=0,l=Math.PI*2){super(0,e,t,r,o,s,i,l);this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:o,openEnded:s,thetaStart:i,thetaLength:l}}static fromJSON(e){return new Pm(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}};var Qo=class extends Gt{constructor(e=[],t=[],r=1,o=0){super();this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:o};let s=[],i=[];l(o),c(r),h(),this.setAttribute("position",new _t(s,3)),this.setAttribute("normal",new _t(s.slice(),3)),this.setAttribute("uv",new _t(i,2)),o===0?this.computeVertexNormals():this.normalizeNormals();function l(v){let y=new F,b=new F,x=new F;for(let E=0;E<t.length;E+=3)u(t[E+0],y),u(t[E+1],b),u(t[E+2],x),a(y,b,x,v)}function a(v,y,b,x){let E=x+1,T=[];for(let M=0;M<=E;M++){T[M]=[];let D=v.clone().lerp(b,M/E),U=y.clone().lerp(b,M/E),L=E-M;for(let se=0;se<=L;se++)se===0&&M===E?T[M][se]=D:T[M][se]=D.clone().lerp(U,se/L)}for(let M=0;M<E;M++)for(let D=0;D<2*(E-M)-1;D++){let U=Math.floor(D/2);D%2==0?(p(T[M][U+1]),p(T[M+1][U]),p(T[M][U])):(p(T[M][U+1]),p(T[M+1][U+1]),p(T[M+1][U]))}}function c(v){let y=new F;for(let b=0;b<s.length;b+=3)y.x=s[b+0],y.y=s[b+1],y.z=s[b+2],y.normalize().multiplyScalar(v),s[b+0]=y.x,s[b+1]=y.y,s[b+2]=y.z}function h(){let v=new F;for(let y=0;y<s.length;y+=3){v.x=s[y+0],v.y=s[y+1],v.z=s[y+2];let b=_(v)/2/Math.PI+.5,x=m(v)/Math.PI+.5;i.push(b,1-x)}d(),g()}function g(){for(let v=0;v<i.length;v+=6){let y=i[v+0],b=i[v+2],x=i[v+4],E=Math.max(y,b,x),T=Math.min(y,b,x);E>.9&&T<.1&&(y<.2&&(i[v+0]+=1),b<.2&&(i[v+2]+=1),x<.2&&(i[v+4]+=1))}}function p(v){s.push(v.x,v.y,v.z)}function u(v,y){let b=v*3;y.x=e[b+0],y.y=e[b+1],y.z=e[b+2]}function d(){let v=new F,y=new F,b=new F,x=new F,E=new re,T=new re,M=new re;for(let D=0,U=0;D<s.length;D+=9,U+=6){v.set(s[D+0],s[D+1],s[D+2]),y.set(s[D+3],s[D+4],s[D+5]),b.set(s[D+6],s[D+7],s[D+8]),E.set(i[U+0],i[U+1]),T.set(i[U+2],i[U+3]),M.set(i[U+4],i[U+5]),x.copy(v).add(y).add(b).divideScalar(3);let L=_(x);f(E,U+0,v,L),f(T,U+2,y,L),f(M,U+4,b,L)}}function f(v,y,b,x){x<0&&v.x===1&&(i[y]=v.x-1),b.x===0&&b.z===0&&(i[y]=x/2/Math.PI+.5)}function _(v){return Math.atan2(v.z,-v.x)}function m(v){return Math.atan2(-v.y,Math.sqrt(v.x*v.x+v.z*v.z))}}static fromJSON(e){return new Qo(e.vertices,e.indices,e.radius,e.details)}};var Om=class extends Qo{constructor(e=1,t=0){let r=(1+Math.sqrt(5))/2,o=1/r,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-o,-r,0,-o,r,0,o,-r,0,o,r,-o,-r,0,-o,r,0,o,-r,0,o,r,0,-r,0,-o,r,0,-o,-r,0,o,r,0,o],i=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,i,e,t);this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Om(e.radius,e.detail)}};var wm=new F,Rm=new F,t5=new F,Lm=new I0,nR=class extends Gt{constructor(e=null,t=1){super();if(this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){let o=Math.pow(10,4),s=Math.cos(Ed*t),i=e.getIndex(),l=e.getAttribute("position"),a=i?i.count:l.count,c=[0,0,0],h=["a","b","c"],g=new Array(3),p={},u=[];for(let d=0;d<a;d+=3){i?(c[0]=i.getX(d),c[1]=i.getX(d+1),c[2]=i.getX(d+2)):(c[0]=d,c[1]=d+1,c[2]=d+2);let{a:f,b:_,c:m}=Lm;if(f.fromBufferAttribute(l,c[0]),_.fromBufferAttribute(l,c[1]),m.fromBufferAttribute(l,c[2]),Lm.getNormal(t5),g[0]=`${Math.round(f.x*o)},${Math.round(f.y*o)},${Math.round(f.z*o)}`,g[1]=`${Math.round(_.x*o)},${Math.round(_.y*o)},${Math.round(_.z*o)}`,g[2]=`${Math.round(m.x*o)},${Math.round(m.y*o)},${Math.round(m.z*o)}`,!(g[0]===g[1]||g[1]===g[2]||g[2]===g[0]))for(let v=0;v<3;v++){let y=(v+1)%3,b=g[v],x=g[y],E=Lm[h[v]],T=Lm[h[y]],M=`${b}_${x}`,D=`${x}_${b}`;D in p&&p[D]?(t5.dot(p[D].normal)<=s&&(u.push(E.x,E.y,E.z),u.push(T.x,T.y,T.z)),p[D]=null):M in p||(p[M]={index0:c[v],index1:c[y],normal:t5.clone()})}}for(let d in p)if(p[d]){let{index0:f,index1:_}=p[d];wm.fromBufferAttribute(l,f),Rm.fromBufferAttribute(l,_),u.push(wm.x,wm.y,wm.z),u.push(Rm.x,Rm.y,Rm.z)}this.setAttribute("position",new _t(u,3))}}};var oR={triangulate:function(n,e,t=2){let r=e&&e.length,o=r?e[0]*t:n.length,s=iR(n,0,o,t,!0),i=[];if(!s||s.next===s.prev)return i;let l,a,c,h,g,p,u;if(r&&(s=aJ(n,e,s,t)),n.length>80*t){l=c=n[0],a=h=n[1];for(let d=t;d<o;d+=t)g=n[d],p=n[d+1],g<l&&(l=g),p<a&&(a=p),g>c&&(c=g),p>h&&(h=p);u=Math.max(c-l,h-a),u=u!==0?1/u:0}return _p(s,i,t,l,a,u),i}};function iR(n,e,t,r,o){let s,i;if(o===vJ(n,e,t,r)>0)for(s=e;s<t;s+=r)i=lR(s,n[s],n[s+1],i);else for(s=t-r;s>=e;s-=r)i=lR(s,n[s],n[s+1],i);return i&&Im(i,i.next)&&(vp(i),i=i.next),i}function ts(n,e){if(!n)return n;e||(e=n);let t=n,r;do if(r=!1,!t.steiner&&(Im(t,t.next)||fn(t.prev,t,t.next)===0)){if(vp(t),t=e=t.prev,t===t.next)break;r=!0}else t=t.next;while(r||t!==e);return e}function _p(n,e,t,r,o,s,i){if(!n)return;!i&&s&&dJ(n,r,o,s);let l=n,a,c;for(;n.prev!==n.next;){if(a=n.prev,c=n.next,s?oJ(n,r,o,s):nJ(n)){e.push(a.i/t),e.push(n.i/t),e.push(c.i/t),vp(n),n=c.next,l=c.next;continue}if(n=c,n===l){i?i===1?(n=iJ(ts(n),e,t),_p(n,e,t,r,o,s,2)):i===2&&sJ(n,e,t,r,o,s):_p(ts(n),e,t,r,o,s,1);break}}}function nJ(n){let e=n.prev,t=n,r=n.next;if(fn(e,t,r)>=0)return!1;let o=n.next.next;for(;o!==n.prev;){if(mc(e.x,e.y,t.x,t.y,r.x,r.y,o.x,o.y)&&fn(o.prev,o,o.next)>=0)return!1;o=o.next}return!0}function oJ(n,e,t,r){let o=n.prev,s=n,i=n.next;if(fn(o,s,i)>=0)return!1;let l=o.x<s.x?o.x<i.x?o.x:i.x:s.x<i.x?s.x:i.x,a=o.y<s.y?o.y<i.y?o.y:i.y:s.y<i.y?s.y:i.y,c=o.x>s.x?o.x>i.x?o.x:i.x:s.x>i.x?s.x:i.x,h=o.y>s.y?o.y>i.y?o.y:i.y:s.y>i.y?s.y:i.y,g=r5(l,a,e,t,r),p=r5(c,h,e,t,r),u=n.prevZ,d=n.nextZ;for(;u&&u.z>=g&&d&&d.z<=p;){if(u!==n.prev&&u!==n.next&&mc(o.x,o.y,s.x,s.y,i.x,i.y,u.x,u.y)&&fn(u.prev,u,u.next)>=0||(u=u.prevZ,d!==n.prev&&d!==n.next&&mc(o.x,o.y,s.x,s.y,i.x,i.y,d.x,d.y)&&fn(d.prev,d,d.next)>=0))return!1;d=d.nextZ}for(;u&&u.z>=g;){if(u!==n.prev&&u!==n.next&&mc(o.x,o.y,s.x,s.y,i.x,i.y,u.x,u.y)&&fn(u.prev,u,u.next)>=0)return!1;u=u.prevZ}for(;d&&d.z<=p;){if(d!==n.prev&&d!==n.next&&mc(o.x,o.y,s.x,s.y,i.x,i.y,d.x,d.y)&&fn(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function iJ(n,e,t){let r=n;do{let o=r.prev,s=r.next.next;!Im(o,s)&&sR(o,r,r.next,s)&&gp(o,s)&&gp(s,o)&&(e.push(o.i/t),e.push(r.i/t),e.push(s.i/t),vp(r),vp(r.next),r=n=s),r=r.next}while(r!==n);return ts(r)}function sJ(n,e,t,r,o,s){let i=n;do{let l=i.next.next;for(;l!==i.prev;){if(i.i!==l.i&&hJ(i,l)){let a=aR(i,l);i=ts(i,i.next),a=ts(a,a.next),_p(i,e,t,r,o,s),_p(a,e,t,r,o,s);return}l=l.next}i=i.next}while(i!==n)}function aJ(n,e,t,r){let o=[],s,i,l,a,c;for(s=0,i=e.length;s<i;s++)l=e[s]*r,a=s<i-1?e[s+1]*r:n.length,c=iR(n,l,a,r,!1),c===c.next&&(c.steiner=!0),o.push(mJ(c));for(o.sort(lJ),s=0;s<o.length;s++)cJ(o[s],t),t=ts(t,t.next);return t}function lJ(n,e){return n.x-e.x}function cJ(n,e){if(e=uJ(n,e),e){let t=aR(e,n);ts(e,e.next),ts(t,t.next)}}function uJ(n,e){let t=e,r=n.x,o=n.y,s=-1/0,i;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){let p=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(p<=r&&p>s){if(s=p,p===r){if(o===t.y)return t;if(o===t.next.y)return t.next}i=t.x<t.next.x?t:t.next}}t=t.next}while(t!==e);if(!i)return null;if(r===s)return i;let l=i,a=i.x,c=i.y,h=1/0,g;t=i;do r>=t.x&&t.x>=a&&r!==t.x&&mc(o<c?r:s,o,a,c,o<c?s:r,o,t.x,t.y)&&(g=Math.abs(o-t.y)/(r-t.x),gp(t,n)&&(g<h||g===h&&(t.x>i.x||t.x===i.x&&pJ(i,t)))&&(i=t,h=g)),t=t.next;while(t!==l);return i}function pJ(n,e){return fn(n.prev,n,e.prev)<0&&fn(e.next,n,n.next)<0}function dJ(n,e,t,r){let o=n;do o.z===null&&(o.z=r5(o.x,o.y,e,t,r)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next;while(o!==n);o.prevZ.nextZ=null,o.prevZ=null,fJ(o)}function fJ(n){let e,t,r,o,s,i,l,a,c=1;do{for(t=n,n=null,s=null,i=0;t;){for(i++,r=t,l=0,e=0;e<c&&(l++,r=r.nextZ,!!r);e++);for(a=c;l>0||a>0&&r;)l!==0&&(a===0||!r||t.z<=r.z)?(o=t,t=t.nextZ,l--):(o=r,r=r.nextZ,a--),s?s.nextZ=o:n=o,o.prevZ=s,s=o;t=r}s.nextZ=null,c*=2}while(i>1);return n}function r5(n,e,t,r,o){return n=32767*(n-t)*o,e=32767*(e-r)*o,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function mJ(n){let e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function mc(n,e,t,r,o,s,i,l){return(o-i)*(e-l)-(n-i)*(s-l)>=0&&(n-i)*(r-l)-(t-i)*(e-l)>=0&&(t-i)*(s-l)-(o-i)*(r-l)>=0}function hJ(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!_J(n,e)&&(gp(n,e)&&gp(e,n)&&gJ(n,e)&&(fn(n.prev,n,e.prev)||fn(n,e.prev,e))||Im(n,e)&&fn(n.prev,n,n.next)>0&&fn(e.prev,e,e.next)>0)}function fn(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function Im(n,e){return n.x===e.x&&n.y===e.y}function sR(n,e,t,r){let o=Bm(fn(n,e,t)),s=Bm(fn(n,e,r)),i=Bm(fn(t,r,n)),l=Bm(fn(t,r,e));return!!(o!==s&&i!==l||o===0&&Dm(n,t,e)||s===0&&Dm(n,r,e)||i===0&&Dm(t,n,r)||l===0&&Dm(t,e,r))}function Dm(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function Bm(n){return n>0?1:n<0?-1:0}function _J(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&sR(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function gp(n,e){return fn(n.prev,n,n.next)<0?fn(n,e,n.next)>=0&&fn(n,n.prev,e)>=0:fn(n,e,n.prev)<0||fn(n,n.next,e)<0}function gJ(n,e){let t=n,r=!1,o=(n.x+e.x)/2,s=(n.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&o<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(r=!r),t=t.next;while(t!==n);return r}function aR(n,e){let t=new n5(n.i,n.x,n.y),r=new n5(e.i,e.x,e.y),o=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=o,o.prev=t,r.next=t,t.prev=r,s.next=r,r.prev=s,r}function lR(n,e,t,r){let o=new n5(n,e,t);return r?(o.next=r.next,o.prev=r,r.next.prev=o,r.next=o):(o.prev=o,o.next=o),o}function vp(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function n5(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function vJ(n,e,t,r){let o=0;for(let s=e,i=t-r;s<t;s+=r)o+=(n[i]-n[s])*(n[s+1]+n[i+1]),i=s;return o}var _i=class{static area(e){let t=e.length,r=0;for(let o=t-1,s=0;s<t;o=s++)r+=e[o].x*e[s].y-e[s].x*e[o].y;return r*.5}static isClockWise(e){return _i.area(e)<0}static triangulateShape(e,t){let r=[],o=[],s=[];cR(e),uR(r,e);let i=e.length;t.forEach(cR);for(let a=0;a<t.length;a++)o.push(i),i+=t[a].length,uR(r,t[a]);let l=oR.triangulate(r,o);for(let a=0;a<l.length;a+=3)s.push(l.slice(a,a+3));return s}};function cR(n){let e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function uR(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}var km=class extends Gt{constructor(e=new ua([new re(.5,.5),new re(-.5,.5),new re(-.5,-.5),new re(.5,-.5)]),t={}){super();this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];let r=this,o=[],s=[];for(let l=0,a=e.length;l<a;l++){let c=e[l];i(c)}this.setAttribute("position",new _t(o,3)),this.setAttribute("uv",new _t(s,2)),this.computeVertexNormals();function i(l){let a=[],c=t.curveSegments!==void 0?t.curveSegments:12,h=t.steps!==void 0?t.steps:1,g=t.depth!==void 0?t.depth:1,p=t.bevelEnabled!==void 0?t.bevelEnabled:!0,u=t.bevelThickness!==void 0?t.bevelThickness:.2,d=t.bevelSize!==void 0?t.bevelSize:u-.1,f=t.bevelOffset!==void 0?t.bevelOffset:0,_=t.bevelSegments!==void 0?t.bevelSegments:3,m=t.extrudePath,v=t.UVGenerator!==void 0?t.UVGenerator:yJ;t.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),g=t.amount);let y,b=!1,x,E,T,M;m&&(y=m.getSpacedPoints(h),b=!0,p=!1,x=m.computeFrenetFrames(h,!1),E=new F,T=new F,M=new F),p||(_=0,u=0,d=0,f=0);let D=l.extractPoints(c),U=D.shape,L=D.holes;if(!_i.isClockWise(U)){U=U.reverse();for(let Re=0,tt=L.length;Re<tt;Re++){let ut=L[Re];_i.isClockWise(ut)&&(L[Re]=ut.reverse())}}let $=_i.triangulateShape(U,L),H=U;for(let Re=0,tt=L.length;Re<tt;Re++){let ut=L[Re];U=U.concat(ut)}function ae(Re,tt,ut){return tt||console.error("THREE.ExtrudeGeometry: vec does not exist"),tt.clone().multiplyScalar(ut).add(Re)}let ue=U.length,me=$.length;function Ue(Re,tt,ut){let It,pt,V,B=Re.x-tt.x,Pe=Re.y-tt.y,lt=ut.x-Re.x,A=ut.y-Re.y,St=B*B+Pe*Pe,Ut=B*A-Pe*lt;if(Math.abs(Ut)>Number.EPSILON){let Dt=Math.sqrt(St),De=Math.sqrt(lt*lt+A*A),Le=tt.x-Pe/Dt,Y=tt.y+B/Dt,ot=ut.x-A/De,Oe=ut.y+lt/De,bt=((ot-Le)*A-(Oe-Y)*lt)/(B*A-Pe*lt);It=Le+B*bt-Re.x,pt=Y+Pe*bt-Re.y;let Pt=It*It+pt*pt;if(Pt<=2)return new re(It,pt);V=Math.sqrt(Pt/2)}else{let Dt=!1;B>Number.EPSILON?lt>Number.EPSILON&&(Dt=!0):B<-Number.EPSILON?lt<-Number.EPSILON&&(Dt=!0):Math.sign(Pe)===Math.sign(A)&&(Dt=!0),Dt?(It=-Pe,pt=B,V=Math.sqrt(St)):(It=B,pt=Pe,V=Math.sqrt(St/2))}return new re(It/V,pt/V)}let st=[];for(let Re=0,tt=H.length,ut=tt-1,It=Re+1;Re<tt;Re++,ut++,It++)ut===tt&&(ut=0),It===tt&&(It=0),st[Re]=Ue(H[Re],H[ut],H[It]);let ft=[],Ze,gt=st.concat();for(let Re=0,tt=L.length;Re<tt;Re++){let ut=L[Re];Ze=[];for(let It=0,pt=ut.length,V=pt-1,B=It+1;It<pt;It++,V++,B++)V===pt&&(V=0),B===pt&&(B=0),Ze[It]=Ue(ut[It],ut[V],ut[B]);ft.push(Ze),gt=gt.concat(Ze)}for(let Re=0;Re<_;Re++){let tt=Re/_,ut=u*Math.cos(tt*Math.PI/2),It=d*Math.sin(tt*Math.PI/2)+f;for(let pt=0,V=H.length;pt<V;pt++){let B=ae(H[pt],st[pt],It);Tt(B.x,B.y,-ut)}for(let pt=0,V=L.length;pt<V;pt++){let B=L[pt];Ze=ft[pt];for(let Pe=0,lt=B.length;Pe<lt;Pe++){let A=ae(B[Pe],Ze[Pe],It);Tt(A.x,A.y,-ut)}}}let ce=d+f;for(let Re=0;Re<ue;Re++){let tt=p?ae(U[Re],gt[Re],ce):U[Re];b?(T.copy(x.normals[0]).multiplyScalar(tt.x),E.copy(x.binormals[0]).multiplyScalar(tt.y),M.copy(y[0]).add(T).add(E),Tt(M.x,M.y,M.z)):Tt(tt.x,tt.y,0)}for(let Re=1;Re<=h;Re++)for(let tt=0;tt<ue;tt++){let ut=p?ae(U[tt],gt[tt],ce):U[tt];b?(T.copy(x.normals[Re]).multiplyScalar(ut.x),E.copy(x.binormals[Re]).multiplyScalar(ut.y),M.copy(y[Re]).add(T).add(E),Tt(M.x,M.y,M.z)):Tt(ut.x,ut.y,g/h*Re)}for(let Re=_-1;Re>=0;Re--){let tt=Re/_,ut=u*Math.cos(tt*Math.PI/2),It=d*Math.sin(tt*Math.PI/2)+f;for(let pt=0,V=H.length;pt<V;pt++){let B=ae(H[pt],st[pt],It);Tt(B.x,B.y,g+ut)}for(let pt=0,V=L.length;pt<V;pt++){let B=L[pt];Ze=ft[pt];for(let Pe=0,lt=B.length;Pe<lt;Pe++){let A=ae(B[Pe],Ze[Pe],It);b?Tt(A.x,A.y+y[h-1].y,y[h-1].x+ut):Tt(A.x,A.y,g+ut)}}}oe(),yt();function oe(){let Re=o.length/3;if(p){let tt=0,ut=ue*tt;for(let It=0;It<me;It++){let pt=$[It];At(pt[2]+ut,pt[1]+ut,pt[0]+ut)}tt=h+_*2,ut=ue*tt;for(let It=0;It<me;It++){let pt=$[It];At(pt[0]+ut,pt[1]+ut,pt[2]+ut)}}else{for(let tt=0;tt<me;tt++){let ut=$[tt];At(ut[2],ut[1],ut[0])}for(let tt=0;tt<me;tt++){let ut=$[tt];At(ut[0]+ue*h,ut[1]+ue*h,ut[2]+ue*h)}}r.addGroup(Re,o.length/3-Re,0)}function yt(){let Re=o.length/3,tt=0;X(H,tt),tt+=H.length;for(let ut=0,It=L.length;ut<It;ut++){let pt=L[ut];X(pt,tt),tt+=pt.length}r.addGroup(Re,o.length/3-Re,1)}function X(Re,tt){let ut=Re.length;for(;--ut>=0;){let It=ut,pt=ut-1;pt<0&&(pt=Re.length-1);for(let V=0,B=h+_*2;V<B;V++){let Pe=ue*V,lt=ue*(V+1),A=tt+It+Pe,St=tt+pt+Pe,Ut=tt+pt+lt,Dt=tt+It+lt;Nt(A,St,Ut,Dt)}}}function Tt(Re,tt,ut){a.push(Re),a.push(tt),a.push(ut)}function At(Re,tt,ut){Mt(Re),Mt(tt),Mt(ut);let It=o.length/3,pt=v.generateTopUV(r,o,It-3,It-2,It-1);Vt(pt[0]),Vt(pt[1]),Vt(pt[2])}function Nt(Re,tt,ut,It){Mt(Re),Mt(tt),Mt(It),Mt(tt),Mt(ut),Mt(It);let pt=o.length/3,V=v.generateSideWallUV(r,o,pt-6,pt-3,pt-2,pt-1);Vt(V[0]),Vt(V[1]),Vt(V[3]),Vt(V[1]),Vt(V[2]),Vt(V[3])}function Mt(Re){o.push(a[Re*3+0]),o.push(a[Re*3+1]),o.push(a[Re*3+2])}function Vt(Re){s.push(Re.x),s.push(Re.y)}}}toJSON(){let e=super.toJSON(),t=this.parameters.shapes,r=this.parameters.options;return bJ(t,r,e)}static fromJSON(e,t){let r=[];for(let s=0,i=e.shapes.length;s<i;s++){let l=t[e.shapes[s]];r.push(l)}let o=e.options.extrudePath;return o!==void 0&&(e.options.extrudePath=new ca[o.type]().fromJSON(o)),new km(r,e.options)}},yJ={generateTopUV:function(n,e,t,r,o){let s=e[t*3],i=e[t*3+1],l=e[r*3],a=e[r*3+1],c=e[o*3],h=e[o*3+1];return[new re(s,i),new re(l,a),new re(c,h)]},generateSideWallUV:function(n,e,t,r,o,s){let i=e[t*3],l=e[t*3+1],a=e[t*3+2],c=e[r*3],h=e[r*3+1],g=e[r*3+2],p=e[o*3],u=e[o*3+1],d=e[o*3+2],f=e[s*3],_=e[s*3+1],m=e[s*3+2];return Math.abs(l-h)<Math.abs(i-c)?[new re(i,1-a),new re(c,1-g),new re(p,1-d),new re(f,1-m)]:[new re(l,1-a),new re(h,1-g),new re(u,1-d),new re(_,1-m)]}};function bJ(n,e,t){if(t.shapes=[],Array.isArray(n))for(let r=0,o=n.length;r<o;r++){let s=n[r];t.shapes.push(s.uuid)}else t.shapes.push(n.uuid);return e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}var hc=class extends Qo{constructor(e=1,t=0){let r=(1+Math.sqrt(5))/2,o=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(o,s,e,t);this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new hc(e.radius,e.detail)}};var Fm=class extends Gt{constructor(e=[new re(0,.5),new re(.5,0),new re(0,-.5)],t=12,r=0,o=Math.PI*2){super();this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:o},t=Math.floor(t),o=_o(o,0,Math.PI*2);let s=[],i=[],l=[],a=1/t,c=new F,h=new re;for(let g=0;g<=t;g++){let p=r+g*a*o,u=Math.sin(p),d=Math.cos(p);for(let f=0;f<=e.length-1;f++)c.x=e[f].x*u,c.y=e[f].y,c.z=e[f].x*d,i.push(c.x,c.y,c.z),h.x=g/t,h.y=f/(e.length-1),l.push(h.x,h.y)}for(let g=0;g<t;g++)for(let p=0;p<e.length-1;p++){let u=p+g*e.length,d=u,f=u+e.length,_=u+e.length+1,m=u+1;s.push(d,f,m),s.push(f,_,m)}if(this.setIndex(s),this.setAttribute("position",new _t(i,3)),this.setAttribute("uv",new _t(l,2)),this.computeVertexNormals(),o===Math.PI*2){let g=this.attributes.normal.array,p=new F,u=new F,d=new F,f=t*e.length*3;for(let _=0,m=0;_<e.length;_++,m+=3)p.x=g[m+0],p.y=g[m+1],p.z=g[m+2],u.x=g[f+m+0],u.y=g[f+m+1],u.z=g[f+m+2],d.addVectors(p,u).normalize(),g[m+0]=g[f+m+0]=d.x,g[m+1]=g[f+m+1]=d.y,g[m+2]=g[f+m+2]=d.z}}static fromJSON(e){return new Fm(e.points,e.segments,e.phiStart,e.phiLength)}};var Gm=class extends Qo{constructor(e=1,t=0){let r=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],o=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(r,o,e,t);this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Gm(e.radius,e.detail)}};var Um=class extends Gt{constructor(e=.5,t=1,r=8,o=1,s=0,i=Math.PI*2){super();this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:o,thetaStart:s,thetaLength:i},r=Math.max(3,r),o=Math.max(1,o);let l=[],a=[],c=[],h=[],g=e,p=(t-e)/o,u=new F,d=new re;for(let f=0;f<=o;f++){for(let _=0;_<=r;_++){let m=s+_/r*i;u.x=g*Math.cos(m),u.y=g*Math.sin(m),a.push(u.x,u.y,u.z),c.push(0,0,1),d.x=(u.x/t+1)/2,d.y=(u.y/t+1)/2,h.push(d.x,d.y)}g+=p}for(let f=0;f<o;f++){let _=f*(r+1);for(let m=0;m<r;m++){let v=m+_,y=v,b=v+r+1,x=v+r+2,E=v+1;l.push(y,b,E),l.push(b,x,E)}}this.setIndex(l),this.setAttribute("position",new _t(a,3)),this.setAttribute("normal",new _t(c,3)),this.setAttribute("uv",new _t(h,2))}static fromJSON(e){return new Um(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}};var Vm=class extends Gt{constructor(e=new ua([new re(0,.5),new re(-.5,-.5),new re(.5,-.5)]),t=12){super();this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};let r=[],o=[],s=[],i=[],l=0,a=0;if(Array.isArray(e)===!1)c(e);else for(let h=0;h<e.length;h++)c(e[h]),this.addGroup(l,a,h),l+=a,a=0;this.setIndex(r),this.setAttribute("position",new _t(o,3)),this.setAttribute("normal",new _t(s,3)),this.setAttribute("uv",new _t(i,2));function c(h){let g=o.length/3,p=h.extractPoints(t),u=p.shape,d=p.holes;_i.isClockWise(u)===!1&&(u=u.reverse());for(let _=0,m=d.length;_<m;_++){let v=d[_];_i.isClockWise(v)===!0&&(d[_]=v.reverse())}let f=_i.triangulateShape(u,d);for(let _=0,m=d.length;_<m;_++){let v=d[_];u=u.concat(v)}for(let _=0,m=u.length;_<m;_++){let v=u[_];o.push(v.x,v.y,0),s.push(0,0,1),i.push(v.x,v.y)}for(let _=0,m=f.length;_<m;_++){let v=f[_],y=v[0]+g,b=v[1]+g,x=v[2]+g;r.push(y,b,x),a+=3}}}toJSON(){let e=super.toJSON(),t=this.parameters.shapes;return xJ(t,e)}static fromJSON(e,t){let r=[];for(let o=0,s=e.shapes.length;o<s;o++){let i=t[e.shapes[o]];r.push(i)}return new Vm(r,e.curveSegments)}};function xJ(n,e){if(e.shapes=[],Array.isArray(n))for(let t=0,r=n.length;t<r;t++){let o=n[t];e.shapes.push(o.uuid)}else e.shapes.push(n.uuid);return e}var pa=class extends Gt{constructor(e=1,t=32,r=16,o=0,s=Math.PI*2,i=0,l=Math.PI){super();this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:o,phiLength:s,thetaStart:i,thetaLength:l},t=Math.max(3,Math.floor(t)),r=Math.max(2,Math.floor(r));let a=Math.min(i+l,Math.PI),c=0,h=[],g=new F,p=new F,u=[],d=[],f=[],_=[];for(let m=0;m<=r;m++){let v=[],y=m/r,b=0;m==0&&i==0?b=.5/t:m==r&&a==Math.PI&&(b=-.5/t);for(let x=0;x<=t;x++){let E=x/t;g.x=-e*Math.cos(o+E*s)*Math.sin(i+y*l),g.y=e*Math.cos(i+y*l),g.z=e*Math.sin(o+E*s)*Math.sin(i+y*l),d.push(g.x,g.y,g.z),p.copy(g).normalize(),f.push(p.x,p.y,p.z),_.push(E+b,1-y),v.push(c++)}h.push(v)}for(let m=0;m<r;m++)for(let v=0;v<t;v++){let y=h[m][v+1],b=h[m][v],x=h[m+1][v],E=h[m+1][v+1];(m!==0||i>0)&&u.push(y,b,E),(m!==r-1||a<Math.PI)&&u.push(b,x,E)}this.setIndex(u),this.setAttribute("position",new _t(d,3)),this.setAttribute("normal",new _t(f,3)),this.setAttribute("uv",new _t(_,2))}static fromJSON(e){return new pa(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}};var zm=class extends Qo{constructor(e=1,t=0){let r=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],o=[2,1,0,0,3,2,1,3,0,2,3,1];super(r,o,e,t);this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new zm(e.radius,e.detail)}};var Hm=class extends Gt{constructor(e=1,t=.4,r=8,o=6,s=Math.PI*2){super();this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:o,arc:s},r=Math.floor(r),o=Math.floor(o);let i=[],l=[],a=[],c=[],h=new F,g=new F,p=new F;for(let u=0;u<=r;u++)for(let d=0;d<=o;d++){let f=d/o*s,_=u/r*Math.PI*2;g.x=(e+t*Math.cos(_))*Math.cos(f),g.y=(e+t*Math.cos(_))*Math.sin(f),g.z=t*Math.sin(_),l.push(g.x,g.y,g.z),h.x=e*Math.cos(f),h.y=e*Math.sin(f),p.subVectors(g,h).normalize(),a.push(p.x,p.y,p.z),c.push(d/o),c.push(u/r)}for(let u=1;u<=r;u++)for(let d=1;d<=o;d++){let f=(o+1)*u+d-1,_=(o+1)*(u-1)+d-1,m=(o+1)*(u-1)+d,v=(o+1)*u+d;i.push(f,_,v),i.push(_,m,v)}this.setIndex(i),this.setAttribute("position",new _t(l,3)),this.setAttribute("normal",new _t(a,3)),this.setAttribute("uv",new _t(c,2))}static fromJSON(e){return new Hm(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}};var jm=class extends Gt{constructor(e=1,t=.4,r=64,o=8,s=2,i=3){super();this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:o,p:s,q:i},r=Math.floor(r),o=Math.floor(o);let l=[],a=[],c=[],h=[],g=new F,p=new F,u=new F,d=new F,f=new F,_=new F,m=new F;for(let y=0;y<=r;++y){let b=y/r*s*Math.PI*2;v(b,s,i,e,u),v(b+.01,s,i,e,d),_.subVectors(d,u),m.addVectors(d,u),f.crossVectors(_,m),m.crossVectors(f,_),f.normalize(),m.normalize();for(let x=0;x<=o;++x){let E=x/o*Math.PI*2,T=-t*Math.cos(E),M=t*Math.sin(E);g.x=u.x+(T*m.x+M*f.x),g.y=u.y+(T*m.y+M*f.y),g.z=u.z+(T*m.z+M*f.z),a.push(g.x,g.y,g.z),p.subVectors(g,u).normalize(),c.push(p.x,p.y,p.z),h.push(y/r),h.push(x/o)}}for(let y=1;y<=r;y++)for(let b=1;b<=o;b++){let x=(o+1)*(y-1)+(b-1),E=(o+1)*y+(b-1),T=(o+1)*y+b,M=(o+1)*(y-1)+b;l.push(x,E,M),l.push(E,T,M)}this.setIndex(l),this.setAttribute("position",new _t(a,3)),this.setAttribute("normal",new _t(c,3)),this.setAttribute("uv",new _t(h,2));function v(y,b,x,E,T){let M=Math.cos(y),D=Math.sin(y),U=x/b*y,L=Math.cos(U);T.x=E*(2+L)*.5*M,T.y=E*(2+L)*D*.5,T.z=E*Math.sin(U)*.5}}static fromJSON(e){return new jm(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}};var qm=class extends Gt{constructor(e=new pc(new F(-1,-1,0),new F(-1,1,0),new F(1,1,0)),t=64,r=1,o=8,s=!1){super();this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:o,closed:s};let i=e.computeFrenetFrames(t,s);this.tangents=i.tangents,this.normals=i.normals,this.binormals=i.binormals;let l=new F,a=new F,c=new re,h=new F,g=[],p=[],u=[],d=[];f(),this.setIndex(d),this.setAttribute("position",new _t(g,3)),this.setAttribute("normal",new _t(p,3)),this.setAttribute("uv",new _t(u,2));function f(){for(let y=0;y<t;y++)_(y);_(s===!1?t:0),v(),m()}function _(y){h=e.getPointAt(y/t,h);let b=i.normals[y],x=i.binormals[y];for(let E=0;E<=o;E++){let T=E/o*Math.PI*2,M=Math.sin(T),D=-Math.cos(T);a.x=D*b.x+M*x.x,a.y=D*b.y+M*x.y,a.z=D*b.z+M*x.z,a.normalize(),p.push(a.x,a.y,a.z),l.x=h.x+r*a.x,l.y=h.y+r*a.y,l.z=h.z+r*a.z,g.push(l.x,l.y,l.z)}}function m(){for(let y=1;y<=t;y++)for(let b=1;b<=o;b++){let x=(o+1)*(y-1)+(b-1),E=(o+1)*y+(b-1),T=(o+1)*y+b,M=(o+1)*(y-1)+b;d.push(x,E,M),d.push(E,T,M)}}function v(){for(let y=0;y<=t;y++)for(let b=0;b<=o;b++)c.x=y/t,c.y=b/o,u.push(c.x,c.y)}}toJSON(){let e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new qm(new ca[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}};var pR=class extends Gt{constructor(e=null){super();if(this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){let t=[],r=new Set,o=new F,s=new F;if(e.index!==null){let i=e.attributes.position,l=e.index,a=e.groups;a.length===0&&(a=[{start:0,count:l.count,materialIndex:0}]);for(let c=0,h=a.length;c<h;++c){let g=a[c],p=g.start,u=g.count;for(let d=p,f=p+u;d<f;d+=3)for(let _=0;_<3;_++){let m=l.getX(d+_),v=l.getX(d+(_+1)%3);o.fromBufferAttribute(i,m),s.fromBufferAttribute(i,v),dR(o,s,r)===!0&&(t.push(o.x,o.y,o.z),t.push(s.x,s.y,s.z))}}}else{let i=e.attributes.position;for(let l=0,a=i.count/3;l<a;l++)for(let c=0;c<3;c++){let h=3*l+c,g=3*l+(c+1)%3;o.fromBufferAttribute(i,h),s.fromBufferAttribute(i,g),dR(o,s,r)===!0&&(t.push(o.x,o.y,o.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new _t(t,3))}}};function dR(n,e,t){let r=`${n.x},${n.y},${n.z}-${e.x},${e.y},${e.z}`,o=`${e.x},${e.y},${e.z}-${n.x},${n.y},${n.z}`;return t.has(r)===!0||t.has(o)===!0?!1:(t.add(r,o),!0)}var o5=class extends al{constructor(e){super(e)}load(e,t,r,o){let s=this,i=this.path===""?V1.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||i;let l=new ws(this.manager);l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(a){let c=null;try{c=JSON.parse(a)}catch(g){o!==void 0&&o(g),console.error("THREE:ObjectLoader: Can't parse "+e+".",g.message);return}let h=c.metadata;if(h===void 0||h.type===void 0||h.type.toLowerCase()==="geometry"){console.error("THREE.ObjectLoader: Can't load "+e);return}s.parse(c,t)},r,o)}async loadAsync(e,t){let r=this,o=this.path===""?V1.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;let s=new ws(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);let i=await s.loadAsync(e,t),l=JSON.parse(i),a=l.metadata;if(a===void 0||a.type===void 0||a.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await r.parseAsync(l)}parse(e,t){let r=this.parseAnimations(e.animations),o=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,o),i=this.parseImages(e.images,function(){t!==void 0&&t(c)}),l=this.parseTextures(e.textures,i),a=this.parseMaterials(e.materials,l),c=this.parseObject(e.object,s,a,l,r),h=this.parseSkeletons(e.skeletons,c);if(this.bindSkeletons(c,h),t!==void 0){let g=!1;for(let p in i)if(i[p]instanceof HTMLImageElement){g=!0;break}g===!1&&t(c)}return c}async parseAsync(e){let t=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),o=this.parseGeometries(e.geometries,r),s=await this.parseImagesAsync(e.images),i=this.parseTextures(e.textures,s),l=this.parseMaterials(e.materials,i),a=this.parseObject(e.object,o,l,i,t),c=this.parseSkeletons(e.skeletons,a);return this.bindSkeletons(a,c),a}parseShapes(e){let t={};if(e!==void 0)for(let r=0,o=e.length;r<o;r++){let s=new ua().fromJSON(e[r]);t[s.uuid]=s}return t}parseSkeletons(e,t){let r={},o={};if(t.traverse(function(s){s.isBone&&(o[s.uuid]=s)}),e!==void 0)for(let s=0,i=e.length;s<i;s++){let l=new ty().fromJSON(e[s],o);r[l.uuid]=l}return r}parseGeometries(e,t){let r={};if(e!==void 0){let o=new e5;for(let s=0,i=e.length;s<i;s++){let l,a=e[s];switch(a.type){case"BufferGeometry":case"InstancedBufferGeometry":l=o.parse(a);break;case"Geometry":console.error("THREE.ObjectLoader: The legacy Geometry type is no longer supported.");break;default:a.type in Wm?l=Wm[a.type].fromJSON(a,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${a.type}"`)}l.uuid=a.uuid,a.name!==void 0&&(l.name=a.name),l.isBufferGeometry===!0&&a.userData!==void 0&&(l.userData=a.userData),r[a.uuid]=l}}return r}parseMaterials(e,t){let r={},o={};if(e!==void 0){let s=new Fu;s.setTextures(t);for(let i=0,l=e.length;i<l;i++){let a=e[i];if(a.type==="MultiMaterial"){let c=[];for(let h=0;h<a.materials.length;h++){let g=a.materials[h];r[g.uuid]===void 0&&(r[g.uuid]=s.parse(g)),c.push(r[g.uuid])}o[a.uuid]=c}else r[a.uuid]===void 0&&(r[a.uuid]=s.parse(a)),o[a.uuid]=r[a.uuid]}}return o}parseAnimations(e){let t={};if(e!==void 0)for(let r=0;r<e.length;r++){let o=e[r],s=iy.parse(o);t[s.uuid]=s}return t}parseImages(e,t){let r=this,o={},s;function i(a){return r.manager.itemStart(a),s.load(a,function(){r.manager.itemEnd(a)},void 0,function(){r.manager.itemError(a),r.manager.itemEnd(a)})}function l(a){if(typeof a=="string"){let c=a,h=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:r.resourcePath+c;return i(h)}else return a.data?{data:L0(a.type,a.data),width:a.width,height:a.height}:null}if(e!==void 0&&e.length>0){let a=new Ld(t);s=new U1(a),s.setCrossOrigin(this.crossOrigin);for(let c=0,h=e.length;c<h;c++){let g=e[c],p=g.url;if(Array.isArray(p)){o[g.uuid]=[];for(let u=0,d=p.length;u<d;u++){let f=p[u],_=l(f);_!==null&&(_ instanceof HTMLImageElement?o[g.uuid].push(_):o[g.uuid].push(new Do(_.data,_.width,_.height)))}}else{let u=l(g.url);u!==null&&(o[g.uuid]=u)}}}return o}async parseImagesAsync(e){let t=this,r={},o;async function s(i){if(typeof i=="string"){let l=i,a=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l)?l:t.resourcePath+l;return await o.loadAsync(a)}else return i.data?{data:L0(i.type,i.data),width:i.width,height:i.height}:null}if(e!==void 0&&e.length>0){o=new U1(this.manager),o.setCrossOrigin(this.crossOrigin);for(let i=0,l=e.length;i<l;i++){let a=e[i],c=a.url;if(Array.isArray(c)){r[a.uuid]=[];for(let h=0,g=c.length;h<g;h++){let p=c[h],u=await s(p);u!==null&&(u instanceof HTMLImageElement?r[a.uuid].push(u):r[a.uuid].push(new Do(u.data,u.width,u.height)))}}else{let h=await s(a.url);h!==null&&(r[a.uuid]=h)}}}return r}parseTextures(e,t){function r(s,i){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),i[s])}let o={};if(e!==void 0)for(let s=0,i=e.length;s<i;s++){let l=e[s];l.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',l.uuid),t[l.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",l.image);let a,c=t[l.image];Array.isArray(c)?(a=new k0(c),c.length===6&&(a.needsUpdate=!0)):(c&&c.data?a=new Do(c.data,c.width,c.height):a=new Yo(c),c&&(a.needsUpdate=!0)),a.uuid=l.uuid,l.name!==void 0&&(a.name=l.name),l.mapping!==void 0&&(a.mapping=r(l.mapping,CJ)),l.offset!==void 0&&a.offset.fromArray(l.offset),l.repeat!==void 0&&a.repeat.fromArray(l.repeat),l.center!==void 0&&a.center.fromArray(l.center),l.rotation!==void 0&&(a.rotation=l.rotation),l.wrap!==void 0&&(a.wrapS=r(l.wrap[0],fR),a.wrapT=r(l.wrap[1],fR)),l.format!==void 0&&(a.format=l.format),l.type!==void 0&&(a.type=l.type),l.encoding!==void 0&&(a.encoding=l.encoding),l.minFilter!==void 0&&(a.minFilter=r(l.minFilter,mR)),l.magFilter!==void 0&&(a.magFilter=r(l.magFilter,mR)),l.anisotropy!==void 0&&(a.anisotropy=l.anisotropy),l.flipY!==void 0&&(a.flipY=l.flipY),l.premultiplyAlpha!==void 0&&(a.premultiplyAlpha=l.premultiplyAlpha),l.unpackAlignment!==void 0&&(a.unpackAlignment=l.unpackAlignment),o[l.uuid]=a}return o}parseObject(e,t,r,o,s){let i;function l(p){return t[p]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",p),t[p]}function a(p){if(p!==void 0){if(Array.isArray(p)){let u=[];for(let d=0,f=p.length;d<f;d++){let _=p[d];r[_]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",_),u.push(r[_])}return u}return r[p]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",p),r[p]}}function c(p){return o[p]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",p),o[p]}let h,g;switch(e.type){case"Scene":i=new Zo,e.background!==void 0&&(Number.isInteger(e.background)?i.background=new Ke(e.background):i.background=c(e.background)),e.environment!==void 0&&(i.environment=c(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?i.fog=new Di(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(i.fog=new Bi(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":i=new qn(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(i.focus=e.focus),e.zoom!==void 0&&(i.zoom=e.zoom),e.filmGauge!==void 0&&(i.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(i.filmOffset=e.filmOffset),e.view!==void 0&&(i.view=Object.assign({},e.view));break;case"OrthographicCamera":i=new Pd(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(i.zoom=e.zoom),e.view!==void 0&&(i.view=Object.assign({},e.view));break;case"AmbientLight":i=new Am(e.color,e.intensity);break;case"DirectionalLight":i=new oy(e.color,e.intensity);break;case"PointLight":i=new ny(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":i=new tc(e.color,e.intensity,e.width,e.height);break;case"SpotLight":i=new ry(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":i=new rc(e.color,e.groundColor,e.intensity);break;case"LightProbe":i=new Nm().fromJSON(e);break;case"SkinnedMesh":h=l(e.geometry),g=a(e.material),i=new ol(h,g),e.bindMode!==void 0&&(i.bindMode=e.bindMode),e.bindMatrix!==void 0&&i.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(i.skeleton=e.skeleton);break;case"Mesh":h=l(e.geometry),g=a(e.material),i=new wr(h,g);break;case"InstancedMesh":h=l(e.geometry),g=a(e.material);let p=e.count,u=e.instanceMatrix,d=e.instanceColor;i=new hm(h,g,p),i.instanceMatrix=new oo(new Float32Array(u.array),16),d!==void 0&&(i.instanceColor=new oo(new Float32Array(d.array),d.itemSize));break;case"LOD":i=new Ol;break;case"Line":i=new Od(l(e.geometry),a(e.material));break;case"LineLoop":i=new ey(l(e.geometry),a(e.material));break;case"LineSegments":i=new $n(l(e.geometry),a(e.material));break;case"PointCloud":case"Points":i=new Xo(l(e.geometry),a(e.material));break;case"Sprite":i=new vm(a(e.material));break;case"Group":i=new Tr;break;case"Bone":i=new il;break;default:i=new On}if(i.uuid=e.uuid,e.name!==void 0&&(i.name=e.name),e.matrix!==void 0?(i.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(i.matrixAutoUpdate=e.matrixAutoUpdate),i.matrixAutoUpdate&&i.matrix.decompose(i.position,i.quaternion,i.scale)):(e.position!==void 0&&i.position.fromArray(e.position),e.rotation!==void 0&&i.rotation.fromArray(e.rotation),e.quaternion!==void 0&&i.quaternion.fromArray(e.quaternion),e.scale!==void 0&&i.scale.fromArray(e.scale)),e.castShadow!==void 0&&(i.castShadow=e.castShadow),e.receiveShadow!==void 0&&(i.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(i.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(i.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(i.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&i.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(i.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(i.visible=e.visible),e.frustumCulled!==void 0&&(i.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(i.renderOrder=e.renderOrder),e.userData!==void 0&&(i.userData=e.userData),e.layers!==void 0&&(i.layers.mask=e.layers),e.children!==void 0){let p=e.children;for(let u=0;u<p.length;u++)i.add(this.parseObject(p[u],t,r,o,s))}if(e.animations!==void 0){let p=e.animations;for(let u=0;u<p.length;u++){let d=p[u];i.animations.push(s[d])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(i.autoUpdate=e.autoUpdate);let p=e.levels;for(let u=0;u<p.length;u++){let d=p[u],f=i.getObjectByProperty("uuid",d.object);f!==void 0&&i.addLevel(f,d.distance)}}return i}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(r){if(r.isSkinnedMesh===!0&&r.skeleton!==void 0){let o=t[r.skeleton];o===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",r.skeleton):r.bind(o,r.bindMatrix)}})}setTexturePath(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}},CJ={UVMapping:As,CubeReflectionMapping:Ni,CubeRefractionMapping:e0,EquirectangularReflectionMapping:Ms,EquirectangularRefractionMapping:Ns,CubeUVReflectionMapping:Si,CubeUVRefractionMapping:Ss},fR={RepeatWrapping:yd,ClampToEdgeWrapping:rn,MirroredRepeatWrapping:bd},mR={NearestFilter:Ur,NearestMipmapNearestFilter:Xc,NearestMipmapLinearFilter:Jc,LinearFilter:Sn,LinearMipmapNearestFilter:xd,LinearMipmapLinearFilter:R0};var Pr=(n=>(n.BasisTextureLoader="BasisTextureLoader",n.DRACOLoader="DRACOLoader",n.EXRLoader="EXRLoader",n.FBXLoader="FBXLoader",n.GLTFLoader="GLTFLoader",n.LDrawLoader="LDrawLoader",n.OBJLoader="OBJLoader",n.PDBLoader="PDBLoader",n.PLYLoader="PLYLoader",n.RGBELoader="RGBELoader",n.SVGLoader="SVGLoader",n.STLLoader="STLLoader",n.TTFLoader="TTFLoader",n))(Pr||{});var i5=new Ld;i5.setURLModifier(n=>{let e=Fe.assetUrls.remapedUrl(n);if(e)return e;let t=Fe.blobs.blobUrl(n);return t||n});var hR=class{constructor(n,e,t,r={}){this._url=n,this._scene=e,this._node=t,this.blobOptions=r,this.loadingManager=i5}static extension(n){let e=null;try{e=new URL(n).searchParams.get("ext")}catch{}if(!e){let r=n.split("?")[0].split(".");e=r[r.length-1].toLowerCase()}return e}extension(){return hR.extension(this._url)}async _urlToLoad(){let{storedUrl:n,fullUrl:e}=this._urlData();return this._node&&await Fe.blobs.fetchBlobForNode({storedUrl:n,fullUrl:e,node:this._node,multiAssetsForNode:this.blobOptions.multiAssetsForNode}),Fe.blobs.blobUrl(n)||e}deregisterUrl(){let{storedUrl:n}=this._urlData();Fe.blobs.deregisterUrl(n)}_urlData(){let n=this._url,e=this._url.split("?")[0];if(n[0]!="h"){let t=this._scene.assets.root();t&&(n=`${t}${n}`)}return{fullUrl:n,storedUrl:e}}static async _loadMultipleBlobGlobal(n){let e=[];for(let r of n.files){let o=r.storedUrl,s=r.fullUrl,i=n.node;e.push(Fe.blobs.fetchBlobGlobal({storedUrl:o,fullUrl:s,node:i}))}let t=await Promise.all(e);for(let r of t)r.error&&n.node.states.error.set(n.error)}},yp=hR;yp.loadingManager=i5;var s5=(n=>(n.AUTO="auto",n.DRC="drc",n.FBX="fbx",n.JSON="json",n.GLTF="gltf",n.GLTF_WITH_DRACO="gltf_with_draco",n.LDRAW="ldraw",n.OBJ="obj",n.PDB="pdb",n.PLY="ply",n.STL="stl",n))(s5||{}),_R=["auto","drc","fbx","json","gltf","gltf_with_draco","ldraw","obj","pdb","ply","stl"];var io=class extends yp{constructor(n,e,t){super(n.url,e,t);this._options=n,this._scene=e,this._node=t}load(n,e){this._load().then(t=>{n(t)}).catch(t=>{e(t)})}_load(){return new Promise(async(n,e)=>{let t=await this._urlToLoad(),r=this.extension();if(r=="json"&&this._options.format=="auto")io.incrementInProgressLoadsCount(),await io.wait_for_max_concurrent_loads_queue_freed(),fetch(t).then(async o=>{let s=await o.json();new o5(this.loadingManager).parse(s,l=>{io.decrementInProgressLoadsCount(),n(this._onLoadSuccess(l.children[0]))})}).catch(o=>{io.decrementInProgressLoadsCount(),e(o)});else{let o=await this._loaderForFormat();if(o)io.incrementInProgressLoadsCount(),await io.wait_for_max_concurrent_loads_queue_freed(),o.load(t,s=>{this._onLoadSuccess(s).then(i=>{io.decrementInProgressLoadsCount(),n(i)})},void 0,s=>{Fe.warn("error loading",t,s),io.decrementInProgressLoadsCount(),e(s)});else{let s=`format not supported (${r})`;e(s)}}})}async _onLoadSuccess(n){let e=this.extension();if(e=="json")return[n];let t=n;if(Ie(t.isObject3D))switch(e){case"pdb":return this._onLoadSuccessPDB(n);case"obj":return[t];case"mpd":return t.rotation.x=Math.PI,t.updateMatrix(),[t];default:return[t]}let r=n;if(r.isBufferGeometry)switch(e){case"drc":return this._onLoadSuccessDRC(r);default:return[new wr(r)]}let o=n;if(o.scene!=null||o.scenes!=null)switch(e){case"gltf":return this._onLoadSuccessGLTF(o);case"glb":return this._onLoadSuccessGLTF(o);default:return[t]}let s=n;if(s.geometryAtoms||s.geometryBonds)switch(e){case"pdb":return this._onLoadSuccessPDB(s);default:return[]}return[]}_onLoadSuccessDRC(n){return[new wr(n,io._default_mat_mesh)]}_onLoadSuccessGLTF(n){let e=n.scene||n.scenes[0];return e.animations=n.animations,[e]}_onLoadSuccessPDB(n){let e=new Xo(n.geometryAtoms,io._default_mat_point),t=new $n(n.geometryBonds,io._default_mat_line);return[e,t]}static moduleNamesFromFormat(n,e){switch(n){case"auto":return this.moduleNamesFromExt(e);case"drc":return[Pr.DRACOLoader];case"fbx":return[Pr.FBXLoader];case"json":return[];case"gltf":return[Pr.GLTFLoader];case"gltf_with_draco":return[Pr.GLTFLoader,Pr.DRACOLoader];case"ldraw":return[Pr.LDrawLoader];case"obj":return[Pr.OBJLoader];case"pdb":return[Pr.PDBLoader];case"ply":return[Pr.PLYLoader];case"stl":return[Pr.STLLoader]}qr.unreachable(n)}static moduleNamesFromExt(n){switch(n){case"drc":return[Pr.DRACOLoader];case"fbx":return[Pr.FBXLoader];case"gltf":return[Pr.GLTFLoader];case"glb":return[Pr.GLTFLoader,Pr.DRACOLoader];case"obj":return[Pr.OBJLoader];case"pdb":return[Pr.PDBLoader];case"ply":return[Pr.PLYLoader];case"stl":return[Pr.STLLoader]}}async _loaderForFormat(){let n=this._options.format;switch(n){case"auto":return this._loaderForExt();case"drc":return this.loader_for_drc(this._node);case"fbx":return this.loader_for_fbx();case"json":return;case"gltf":return this.loader_for_gltf();case"gltf_with_draco":return this.loader_for_glb(this._node);case"ldraw":return this.loader_for_ldraw();case"obj":return this.loader_for_obj();case"pdb":return this.loader_for_pdb();case"ply":return this.loader_for_ply();case"stl":return this.loader_for_stl()}qr.unreachable(n)}async _loaderForExt(){switch(this.extension().toLowerCase()){case"drc":return this.loader_for_drc(this._node);case"fbx":return this.loader_for_fbx();case"gltf":return this.loader_for_gltf();case"glb":return this.loader_for_glb(this._node);case"mpd":return this.loader_for_ldraw();case"obj":return this.loader_for_obj();case"pdb":return this.loader_for_pdb();case"ply":return this.loader_for_ply();case"stl":return this.loader_for_stl()}}loader_for_fbx(){let n=Fe.modulesRegister.module(Pr.FBXLoader);if(n)return new n(this.loadingManager)}loader_for_gltf(){let n=Fe.modulesRegister.module(Pr.GLTFLoader);if(n)return new n(this.loadingManager)}static async loader_for_drc(n){let e=Fe.modulesRegister.module(Pr.DRACOLoader);if(e){let t=!0,r=new e(this.loadingManager),o=Fe.libs.root(),s=Fe.libs.DRACOPath();if(o||s){let i=`${o||""}${s||""}/`;if(n){let l=t?["draco_decoder.js"]:["draco_decoder.wasm","draco_wasm_wrapper.js"];await this._loadMultipleBlobGlobal({files:l.map(a=>({storedUrl:`${i}/${a}`,fullUrl:`${i}${a}`})),node:n,error:"failed to load draco libraries. Make sure to install them to load .glb files"})}r.setDecoderPath(i)}else r.setDecoderPath(void 0);return r.setDecoderConfig({type:t?"js":"wasm"}),r}}loader_for_drc(n){return io.loader_for_drc(n)}static loader_for_ldraw(n){let e=Fe.modulesRegister.module(Pr.LDrawLoader);if(e)return new e(this.loadingManager)}loader_for_ldraw(n){return io.loader_for_ldraw(n)}static async loader_for_glb(n){let e=Fe.modulesRegister.module(Pr.GLTFLoader),t=Fe.modulesRegister.module(Pr.DRACOLoader);if(e&&t){this.gltfLoader=this.gltfLoader||new e(this.loadingManager),this.dracoLoader=this.dracoLoader||new t(this.loadingManager);let r=Fe.libs.root(),o=Fe.libs.DRACOGLTFPath(),s=!1;if(r||o){let i=`${r||""}${o||""}/`;if(n){let l=s?["draco_decoder.js"]:["draco_decoder.wasm","draco_wasm_wrapper.js"];await this._loadMultipleBlobGlobal({files:l.map(a=>({storedUrl:`${i}/${a}`,fullUrl:`${i}${a}`})),node:n,error:"failed to load draco libraries. Make sure to install them to load .glb files"})}this.dracoLoader.setDecoderPath(i)}else this.dracoLoader.setDecoderPath(void 0);return this.dracoLoader.setDecoderConfig({type:s?"js":"wasm"}),this.gltfLoader.setDRACOLoader(this.dracoLoader),this.gltfLoader}}loader_for_glb(n){return io.loader_for_glb(n)}loader_for_obj(){let n=Fe.modulesRegister.module(Pr.OBJLoader);if(n)return new n(this.loadingManager)}loader_for_pdb(){let n=Fe.modulesRegister.module(Pr.PDBLoader);if(n)return new n(this.loadingManager)}loader_for_ply(){let n=Fe.modulesRegister.module(Pr.PLYLoader);if(n)return new n(this.loadingManager)}loader_for_stl(){let n=Fe.modulesRegister.module(Pr.STLLoader);if(n)return new n(this.loadingManager)}static setMaxConcurrentLoadsCount(n){this._maxConcurrentLoadsCountMethod=n}static _init_max_concurrent_loads_count(){return this._maxConcurrentLoadsCountMethod?this._maxConcurrentLoadsCountMethod():Gi.isChrome()?4:1}static _init_concurrent_loads_delay(){return Gi.isChrome()?1:10}static incrementInProgressLoadsCount(){this._inProgressLoadsCount++}static decrementInProgressLoadsCount(){this._inProgressLoadsCount--;let n=this._queue.pop();if(n){let e=this.CONCURRENT_LOADS_DELAY;setTimeout(()=>{n()},e)}}static async wait_for_max_concurrent_loads_queue_freed(){if(!(this._inProgressLoadsCount<=this.MAX_CONCURRENT_LOADS_COUNT))return new Promise(n=>{this._queue.push(n)})}},gi=io;gi._default_mat_mesh=new Jl;gi._default_mat_point=new D0;gi._default_mat_line=new Wn;gi.MAX_CONCURRENT_LOADS_COUNT=io._init_max_concurrent_loads_count();gi.CONCURRENT_LOADS_DELAY=io._init_concurrent_loads_delay();gi._inProgressLoadsCount=0;gi._queue=[];var gR="https://raw.githubusercontent.com/polygonjs/polygonjs-assets/master/";var a5=class extends Rr{static type(){return"file"}static loader(n,e,t){return new gi({url:n.url,format:n.format},e,t)}cook(n,e){let t=a5.loader(e,this.scene(),this._node);return new Promise(r=>{t.load(o=>{let s=this._onLoad(o,e);r(this.createCoreGroupFromObjects(s))},o=>{this._onError(o,e)})})}clearLoadedBlob(n){a5.loader(n,this.scene(),this._node).deregisterUrl()}_onLoad(n,e){for(let t of n)t.traverse(r=>{this._ensureGeometryHasIndex(r),e.matrixAutoUpdate||r.updateMatrix(),r.matrixAutoUpdate=e.matrixAutoUpdate});return n}_onError(n,e){var t;(t=this.states)==null||t.error.set(`could not load geometry from ${e.url} (${n})`)}_ensureGeometryHasIndex(n){let t=n.geometry;t&&this.createIndexIfNone(t)}},$m=a5;$m.DEFAULT_PARAMS={url:`${gR}/models/wolf.obj`,format:s5.AUTO,matrixAutoUpdate:!1};var vR=$m.DEFAULT_PARAMS,yR=class extends je{constructor(){super(...arguments);this.url=N.STRING(vR.url,{fileBrowse:{type:[z9.GEOMETRY]}}),this.format=N.STRING(vR.format,{menuString:{entries:_R.map(e=>({name:e,value:e}))}}),this.matrixAutoUpdate=N.BOOLEAN(0),this.reload=N.BUTTON(null,{callback:e=>{Ym.PARAM_CALLBACK_reload(e)}})}},TJ=new yR,Ym=class extends on{constructor(){super(...arguments);this.paramsConfig=TJ}static type(){return"file"}async requiredModules(){for(let r of[this.p.url,this.p.format])r.isDirty()&&await r.compute();let e=yp.extension(this.pv.url||""),t=this.pv.format;return gi.moduleNamesFromFormat(t,e)}operation(){return this._operation=this._operation||new $m(this.scene(),this.states,this)}async cook(e){let t=await this.operation().cook(e,this.pv);this.setCoreGroup(t)}static PARAM_CALLBACK_reload(e){e._paramCallbackReload()}_paramCallbackReload(){this.operation().clearLoadedBlob(this.pv),this.p.url.setDirty()}};var rs=(n=>(n.ADD_PARENT="add_parent",n.REMOVE_PARENT="remove_parent",n.ADD_CHILD="add_child",n))(rs||{}),da=["add_parent","remove_parent","add_child"],fa=class extends Rr{static type(){return"hierarchy"}cook(e,t){let r=e[0],o=da[t.mode];switch(o){case"add_parent":{let s=this._add_parent_to_core_group(r,t);return this.createCoreGroupFromObjects(s)}case"remove_parent":{let s=this._remove_parent_from_core_group(r,t);return this.createCoreGroupFromObjects(s)}case"add_child":{let s=this._add_child_to_core_group(r,e[1],t);return this.createCoreGroupFromObjects(s)}}qr.unreachable(o)}_add_parent_to_core_group(e,t){return t.levels==0?e.objects():[this._add_parent_to_object(e.objects(),t)]}_add_parent_to_object(e,t){let r=new Tr;if(r.matrixAutoUpdate=!1,r.add(...e),t.levels>0)for(let o=0;o<t.levels-1;o++)r=this._add_new_parent(r,t);return r}_add_new_parent(e,t){let r=new Tr;return r.matrixAutoUpdate=!1,r.add(e),r}_remove_parent_from_core_group(e,t){if(t.levels==0)return e.objects();{let r=[];for(let o of e.objects()){let s=this._remove_parent_from_object(o,t);for(let i of s)r.push(i)}return r}}_remove_parent_from_object(e,t){let r=e.children;for(let o=0;o<t.levels-1;o++)r=this._get_children_from_objects(r,t);return r}_get_children_from_objects(e,t){let r,o=[];for(;r=e.pop();)if(r.children)for(let s of r.children)o.push(s);return o}_add_child_to_core_group(e,t,r){var o,s;let i=e.objects();if(!t)return(o=this.states)==null||o.error.set("input 1 is invalid"),[];let l=t.objects(),a=r.objectMask.trim(),h=a!=""?this._findObjectsByMaskFromObjects(a,i):i;Ie(r.debugObjectMask)&&console.log(h);for(let g=0;g<h.length;g++){let p=h[g],u=l[g]||l[0];if(!u)return(s=this.states)==null||s.error.set("no objects found in input 1"),[];p.add(u)}return i}_findObjectsByMaskFromObjects(e,t){let r=[];for(let o of t)this.scene().objectsController.objectsByMaskInObject(e,o,r);return r}};fa.DEFAULT_PARAMS={mode:0,levels:1,objectMask:"",debugObjectMask:!1};fa.INPUT_CLONED_STATE=yr.FROM_NODE;var IRe=[rs.ADD_PARENT,rs.REMOVE_PARENT],bR=fa.DEFAULT_PARAMS,xR=class extends je{constructor(){super(...arguments);this.mode=N.INTEGER(bR.mode,{menu:{entries:da.map((e,t)=>({name:e,value:t}))}}),this.levels=N.INTEGER(bR.levels,{range:[0,5],visibleIf:[{mode:da.indexOf(rs.ADD_PARENT)},{mode:da.indexOf(rs.REMOVE_PARENT)}]}),this.objectMask=N.STRING("",{visibleIf:{mode:da.indexOf(rs.ADD_CHILD)}}),this.debugObjectMask=N.BOOLEAN(0,{visibleIf:{mode:da.indexOf(rs.ADD_CHILD)}})}},EJ=new xR,l5=class extends on{constructor(){super(...arguments);this.paramsConfig=EJ}static type(){return"hierarchy"}static displayedInputNames(){return["geometry to add or remove parents to/from","objects to use as parent or children (optional)"]}initializeNode(){this.io.inputs.setCount(1,2),this.io.inputs.initInputsClonedState(fa.INPUT_CLONED_STATE)}cook(e){this._operation=this._operation||new fa(this._scene,this.states);let t=this._operation.cook(e,this.pv);this.setCoreGroup(t)}};var CR=class{constructor(){this._id=CR.__next_id++}id(){return this._id}handle_globals_node(n,e,t){}},c5=CR;c5.__next_id=0;var AJ=/\/+/g,u5=class extends no{static context(){return it.GL}initializeBaseNode(){this.uiData.setLayoutHorizontal(),this.io.connections.initInputs(),this.io.connection_points.spare_params.initializeNode()}cook(){console.warn("gl nodes should never cook")}_setMatToRecompile(){var e,t;(t=(e=this.materialNode())==null?void 0:e.assemblerController)==null||t.set_compilation_required_and_dirty(this)}materialNode(){let e=this.parent();if(e)return e.context()==it.GL?e==null?void 0:e.materialNode():e}glVarName(e){return`v_POLY_${this.path(this.materialNode()).replace(AJ,"_")}_${e}`}variableForInputParam(e){return this.variableForInput(e.name())}variableForInput(e){var t;let r=this.io.inputs.get_input_index(e),o=this.io.connections.inputConnection(r);if(o){let s=o.node_src,i=s.io.outputs.namedOutputConnectionPoints()[o.output_index];if(i){let l=i.name();return s.glVarName(l)}else throw console.warn(`no output called '${e}' for gl node ${s.path()}`),"variable_for_input ERROR"}else{if(this.params.has(e))return ta.any((t=this.params.get(e))==null?void 0:t.value);{let s=this.io.inputs.namedInputConnectionPoints()[r];return ta.any(s.init_value)}}}setLines(e){}reset_code(){var e;(e=this._param_configs_controller)==null||e.reset()}setParamConfigs(){}param_configs(){var e;return(e=this._param_configs_controller)==null?void 0:e.list()}paramsGenerating(){return!1}paramDefaultValue(e){return null}};var TR=class extends je{},zRe=new TR;var Xm=[s0.FLOAT,s0.VEC2,s0.VEC3,s0.VEC4],ER=class extends je{constructor(){super(...arguments);this.name=N.STRING(""),this.type=N.INTEGER(0,{menu:{entries:Xm.map((e,t)=>({name:e,value:t}))}}),this.texportWhenConnected=N.BOOLEAN(0,{hidden:!0}),this.exportWhenConnected=N.BOOLEAN(0,{visibleIf:{texportWhenConnected:1}})}},MJ=new ER,ma=class extends u5{constructor(){super(...arguments);this.paramsConfig=MJ,this._on_create_set_name_if_none_bound=this._on_create_set_name_if_none.bind(this),this._bound_setExportWhenConnectedStatus=this._setExportWhenConnectedStatus.bind(this)}static type(){return g9.ATTRIBUTE}initializeNode(){this.addPostDirtyHook("_setMatToRecompile",this._setMatToRecompileIfIsExporting.bind(this)),this.lifecycle.onAfterCreated(this._on_create_set_name_if_none_bound),this.io.connection_points.initializeNode(),this.io.connection_points.set_expected_input_types_function(()=>{var n,e;return((e=(n=this.materialNode())==null?void 0:n.assemblerController)==null?void 0:e.allow_attribute_exports())?[Xm[this.pv.type]]:[]}),this.io.connection_points.set_input_name_function(n=>ma.INPUT_NAME),this.io.connection_points.set_expected_output_types_function(()=>[Xm[this.pv.type]]),this.lifecycle.onAfterAdded(this._bound_setExportWhenConnectedStatus),this.params.addOnSceneLoadHook("prepare params",this._bound_setExportWhenConnectedStatus)}_setExportWhenConnectedStatus(){var n,e;((e=(n=this.materialNode())==null?void 0:n.assemblerController)==null?void 0:e.allow_attribute_exports())&&this.p.texportWhenConnected.set(1)}setAttribSize(n){this.p.type.set(n-1)}inputName(){return ma.INPUT_NAME}outputName(){return ma.OUTPUT_NAME}setLines(n){n.assembler().set_node_lines_attribute(this,n)}attributeName(){return this.pv.name.trim()}glType(){return this.io.outputs.namedOutputConnectionPoints()[0].type()}setGlType(n){this.p.type.set(Xm.indexOf(n))}connected_input_node(){return this.io.inputs.named_input(ma.INPUT_NAME)}connected_input_connection_point(){return this.io.inputs.named_input_connection_point(ma.INPUT_NAME)}output_connection_point(){return this.io.outputs.namedOutputConnectionPointsByName(this.outputName())}isImporting(){return this.io.outputs.used_output_names().length>0}isExporting(){return Ie(this.pv.exportWhenConnected)?this.io.inputs.named_input(ma.INPUT_NAME)!=null:!1}_setMatToRecompileIfIsExporting(){Ie(this.pv.exportWhenConnected)&&this._setMatToRecompile()}_on_create_set_name_if_none(){this.pv.name==""&&this.p.name.set(this.name())}},Jm=ma;Jm.INPUT_NAME="in";Jm.OUTPUT_NAME="val";var p5=class{constructor(e=[]){this._definitions=e,this._errored=!1}get errored(){return this._errored}get error_message(){return this._error_message}uniq(){let e=new Map,t=[];for(let o of this._definitions)if(!this._errored){let s=o.name(),i=e.get(s);i?i.data_type!=o.data_type&&(this._errored=!0,this._error_message=`attempt to create '${o.name()}' with types '${o.data_type}' by node '${o.node.path()}', when there is already an existing with type ${i.data_type} from node '${i.node.path()}'`,console.warn("emitting error message:",this._error_message)):(e.set(s,o),t.push(s))}let r=[];for(let o of t){let s=e.get(o);s&&r.push(s)}return r}};var d5=class{constructor(e,t,r,o){this._definition_type=e,this._data_type=t,this._node=r,this._name=o}get definition_type(){return this._definition_type}get data_type(){return this._data_type}get node(){return this._node}name(){return this._name}collection_instance(){return new p5}},f5=class extends d5{constructor(e,t,r){super("attribute",t,e,r);this._node=e,this._data_type=t,this._name=r}get line(){return`attribute ${this.data_type} ${this.name()}`}};var Km=class extends d5{constructor(e,t,r){super("varying",t,e,r);this._node=e,this._data_type=t,this._name=r}get line(){return`varying ${this.data_type} ${this.name()}`}};var ha=(n=>(n.VERTEX="vertex",n.FRAGMENT="fragment",n.LEAVES_FROM_NODES_SHADER="leaves_from_nodes_shader",n))(ha||{});var NJ={position:"vec3( position )"},bp=class extends c5{handle_globals_node(n,e,t){var r,o;let s=n.io.outputs.namedOutputConnectionPointsByName(e);if(!s)return;let i=n.glVarName(e),l=s.type(),a=new Km(n,l,i);t.addDefinitions(n,[a]);let c=(o=(r=n.materialNode())==null?void 0:r.assemblerController)==null?void 0:o.assembler;if(!c)return;let h=c.shader_config(t.current_shader_name);if(!h)return;let g=h.dependencies(),p=[],u=`${i} = modelMatrix * vec4( position, 1.0 )`,d=`${i} = normalize( mat3( modelMatrix[0].xyz, modelMatrix[1].xyz, modelMatrix[2].xyz ) * normal )`;switch(e){case"worldPosition":{p.push(u);break}case"worldNormal":{p.push(d);break}default:p.push(`${i} = ${l}(${e})`)}for(let f of g)t.addDefinitions(n,[a],f),t.addBodyLines(n,p,f);g.length==0&&t.addBodyLines(n,p)}static variable_config_default(n){return NJ[n]}variable_config_default(n){return bp.variable_config_default(n)}read_attribute(n,e,t,r){return bp.read_attribute(n,e,t,r)}static read_attribute(n,e,t,r){var o,s;bp.PRE_DEFINED_ATTRIBUTES.indexOf(t)<0&&r.addDefinitions(n,[new f5(n,e,t)],ha.VERTEX);let i=r.current_shader_name;switch(i){case ha.VERTEX:return t;case ha.FRAGMENT:{if(!(n instanceof Jm))return;let l="varying_"+n.glVarName(n.outputName()),a=new Km(n,e,l),c=new Map;c.set(ha.FRAGMENT,[]);let h=new Map;h.set(ha.FRAGMENT,[]),Ir.pushOnArrayAtEntry(c,i,a);let g=`${l} = ${e}(${t})`,p=(s=(o=n.materialNode())==null?void 0:o.assemblerController)==null?void 0:s.assembler.shader_config(i);if(p){let u=p.dependencies();for(let d of u)Ir.pushOnArrayAtEntry(c,d,a),Ir.pushOnArrayAtEntry(h,d,g);c.forEach((d,f)=>{r.addDefinitions(n,d,f)}),h.forEach((d,f)=>{r.addBodyLines(n,d,f)})}return l}}}handle_attribute_node(n,e,t,r){return bp.read_attribute(n,e,t,r)}},Zm=bp;Zm.PRE_DEFINED_ATTRIBUTES=["position","color","normal","uv","uv2","morphTarget0","morphTarget1","morphTarget2","morphTarget3","skinIndex","skinWeight"];Zm.IF_RULE={uv:"defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )"};var _a=class extends Rr{constructor(){super(...arguments);this._globals_handler=new Zm,this._old_mat_by_old_new_id=new Map,this._materials_by_uuid=new Map}static type(){return"material"}async cook(e,t){let r=e[0];return this._old_mat_by_old_new_id.clear(),await this._apply_materials(r,t),this._swap_textures(r,t),r}async _apply_materials(e,t){var r,o,s;if(!Ie(t.assignMat))return;let i=t.material.nodeWithContext(it.MAT,(r=this.states)==null?void 0:r.error);if(i){let l=i.material,a=i.assemblerController;if(a&&a.set_assembler_globals_handler(this._globals_handler),await i.compute(),l){if(Ie(t.applyToChildren))for(let c of e.objects())c.traverse(h=>{this._apply_material(h,l,t)});else for(let c of e.objectsFromGroup(t.group))this._apply_material(c,l,t);return e}else(o=this.states)==null||o.error.set(`material invalid. (error: '${i.states.error.message()}')`)}else(s=this.states)==null||s.error.set("no material node found")}_swap_textures(e,t){if(!!Ie(t.swapCurrentTex)){this._materials_by_uuid.clear();for(let r of e.objectsFromGroup(t.group))if(t.applyToChildren)r.traverse(o=>{let s=r.material;this._materials_by_uuid.set(s.uuid,s)});else{let o=r.material;this._materials_by_uuid.set(o.uuid,o)}this._materials_by_uuid.forEach((r,o)=>{this._swap_texture(r,t)})}}_apply_material(e,t,r){if(r.group&&!Dn.isInGroup(r.group,e))return;let o=Ie(r.cloneMat)?Fs.clone(t):t;if(t instanceof co&&o instanceof co)for(let i in t.uniforms)o.uniforms[i]=t.uniforms[i];let s=e;this._old_mat_by_old_new_id.set(o.uuid,s.material),s.material=o,Fs.apply_render_hook(e,o),Fs.applyCustomMaterials(e,o)}_swap_texture(e,t){if(t.texSrc0==""||t.texDest0=="")return;let r=this._old_mat_by_old_new_id.get(e.uuid);r=r||e;let o=r[t.texSrc0];if(o){e[t.texDest0]=o;let s=e.uniforms;s&&s[t.texDest0]&&(s[t.texDest0]={value:o})}}};_a.DEFAULT_PARAMS={group:"",assignMat:!0,material:new li(""),applyToChildren:!0,cloneMat:!1,shareUniforms:!0,swapCurrentTex:!1,texSrc0:"emissiveMap",texDest0:"map"};_a.INPUT_CLONED_STATE=yr.FROM_NODE;var ns=_a.DEFAULT_PARAMS,AR=class extends je{constructor(){super(...arguments);this.group=N.STRING(ns.group),this.assignMat=N.BOOLEAN(ns.assignMat),this.material=N.NODE_PATH("",{nodeSelection:{context:it.MAT},dependentOnFoundNode:!1,visibleIf:{assignMat:1}}),this.applyToChildren=N.BOOLEAN(ns.applyToChildren,{visibleIf:{assignMat:1}}),this.cloneMat=N.BOOLEAN(ns.cloneMat,{visibleIf:{assignMat:1}}),this.shareUniforms=N.BOOLEAN(ns.shareUniforms,{visibleIf:{assignMat:1,cloneMat:1}}),this.swapCurrentTex=N.BOOLEAN(ns.swapCurrentTex),this.texSrc0=N.STRING(ns.texSrc0,{visibleIf:{swapCurrentTex:1}}),this.texDest0=N.STRING(ns.texDest0,{visibleIf:{swapCurrentTex:1}})}},SJ=new AR,m5=class extends on{constructor(){super(...arguments);this.paramsConfig=SJ}static type(){return"material"}static displayedInputNames(){return["objects to assign material to"]}initializeNode(){this.io.inputs.setCount(1),this.io.inputs.initInputsClonedState(_a.INPUT_CLONED_STATE)}async cook(e){this._operation=this._operation||new _a(this._scene,this.states);let t=await this._operation.cook(e,this.pv);this.setCoreGroup(t)}};var ga=class extends Rr{static type(){return"merge"}cook(e,t){let r=[];for(let o of e)if(o){let s=o.objects();if(Ie(t.compact))for(let i of s)i.traverse(l=>{r.push(l)});else for(let i of o.objects())r.push(i)}return Ie(t.compact)&&(r=this._makeCompact(r)),this.createCoreGroupFromObjects(r)}_makeCompact(e){let t=new Map,r=new Map,o=[];for(let i of e)i.traverse(l=>{if(l instanceof Tr)return;let a=l;if(a.geometry){let c=sf(a.constructor);o.includes(c)||o.push(c),c&&(t.get(c)||t.set(c,a.material),Ir.pushOnArrayAtEntry(r,c,a))}});let s=[];return o.forEach(i=>{var l,a;let c=r.get(i);if(c){let h=[];for(let g of c){let p=g.geometry;p.applyMatrix4(g.matrix),h.push(p)}try{let g=Yr.mergeGeometries(h);if(g){let p=t.get(i),u=this.createObject(g,i,p);u.matrixAutoUpdate=!1,s.push(u)}else(l=this.states)==null||l.error.set("merge failed, check that input geometries have the same attributes")}catch(g){(a=this.states)==null||a.error.set(g.message)}}}),s}};ga.DEFAULT_PARAMS={compact:!1,keepHierarchy:!1};ga.INPUT_CLONED_STATE=yr.FROM_NODE;var Qm="geometry to merge",PJ=ga.DEFAULT_PARAMS,MR=4,NR=class extends je{constructor(){super(...arguments);this.compact=N.BOOLEAN(PJ.compact),this.inputsCount=N.INTEGER(MR,{range:[1,32],rangeLocked:[!0,!1],callback:e=>{eh.PARAM_CALLBACK_setInputsCount(e)}})}},OJ=new NR,eh=class extends on{constructor(){super(...arguments);this.paramsConfig=OJ}static type(){return"merge"}static displayedInputNames(){return[Qm,Qm,Qm,Qm]}setCompactMode(e){this.p.compact.set(e)}initializeNode(){this.io.inputs.setCount(1,MR),this.io.inputs.initInputsClonedState(ga.INPUT_CLONED_STATE),this.scene().dispatchController.onAddListener(()=>{this.params.addOnSceneLoadHook("update inputs",()=>{this._callbackUpdateInputsCount()})})}cook(e){this._operation=this._operation||new ga(this.scene(),this.states);let t=this._operation.cook(e,this.pv);this.setCoreGroup(t)}_callbackUpdateInputsCount(){this.io.inputs.setCount(1,this.pv.inputsCount),this.emit(Sr.INPUTS_UPDATED)}static PARAM_CALLBACK_setInputsCount(e){e._callbackUpdateInputsCount()}};var wJ=new F(0,0,1),RJ=new F(0,0,1),LJ=new F(0,1,0),va=class extends Rr{constructor(){super(...arguments);this._coreTransform=new Jr,this._size=new F,this._center=new F,this._segmentsCount=new re(1,1)}static type(){return"plane"}cook(e,t){let r=e[0];return r?this._cook_with_input(r,t):this._cook_without_input(t)}_cook_without_input(e){let t=this._create_plane(e.size,e);this._coreTransform.rotateGeometry(t,wJ,e.direction);let r=this._coreTransform.translationMatrix(e.center);return t.applyMatrix4(r),this.createCoreGroupFromGeometry(t)}_cook_with_input(e,t){let r=e.boundingBox();r.getSize(this._size),r.getCenter(this._center);let o=new re(this._size.x,this._size.z),s=this._create_plane(o,t);this._coreTransform.rotateGeometry(s,RJ,LJ);let i=this._coreTransform.translationMatrix(this._center);return s.applyMatrix4(i),this.createCoreGroupFromGeometry(s)}_create_plane(e,t){return e=e.clone(),Ie(t.useSegmentsCount)?(this._segmentsCount.x=Math.floor(t.segments.x),this._segmentsCount.y=Math.floor(t.segments.y)):t.stepSize>0&&(this._segmentsCount.x=Math.floor(e.x/t.stepSize),this._segmentsCount.y=Math.floor(e.y/t.stepSize),e.x=this._segmentsCount.x*t.stepSize,e.y=this._segmentsCount.y*t.stepSize),new B0(e.x,e.y,this._segmentsCount.x,this._segmentsCount.y)}};va.DEFAULT_PARAMS={size:new re(1,1),useSegmentsCount:!1,stepSize:1,segments:new re(1,1),direction:new F(0,1,0),center:new F(0,0,0)};va.INPUT_CLONED_STATE=yr.NEVER;var _c=va.DEFAULT_PARAMS,SR=class extends je{constructor(){super(...arguments);this.size=N.VECTOR2(_c.size),this.useSegmentsCount=N.BOOLEAN(_c.useSegmentsCount),this.stepSize=N.FLOAT(_c.stepSize,{range:[.001,1],rangeLocked:[!1,!1],visibleIf:{useSegmentsCount:0}}),this.segments=N.VECTOR2(_c.segments,{visibleIf:{useSegmentsCount:1}}),this.direction=N.VECTOR3(_c.direction),this.center=N.VECTOR3(_c.center)}},IJ=new SR,h5=class extends on{constructor(){super(...arguments);this.paramsConfig=IJ}static type(){return"plane"}static displayedInputNames(){return["geometry to create plane from (optional)"]}initializeNode(){this.io.inputs.setCount(0,1),this.io.inputs.initInputsClonedState(va.INPUT_CLONED_STATE)}cook(e){this._operation=this._operation||new va(this.scene(),this.states);let t=this._operation.cook(e,this.pv);this.setCoreGroup(t)}};var ei={default:0,isocahedron:1},PR=["default","isocahedron"],ya=class extends Rr{static type(){return"sphere"}cook(e,t){let r=e[0];return r?this._cook_with_input(r,t):this._cook_without_input(t)}_cook_without_input(e){let t=this._create_required_geometry(e);return t.translate(e.center.x,e.center.y,e.center.z),this.createCoreGroupFromGeometry(t)}_cook_with_input(e,t){let r=e.boundingBox(),o=r.max.clone().sub(r.min),s=r.max.clone().add(r.min).multiplyScalar(.5),i=this._create_required_geometry(t);return i.translate(t.center.x,t.center.y,t.center.z),i.translate(s.x,s.y,s.z),i.scale(o.x,o.y,o.z),this.createCoreGroupFromGeometry(i)}_create_required_geometry(e){return e.type==ei.default?this._create_default_sphere(e):this._create_default_isocahedron(e)}_create_default_sphere(e){return Ie(e.open)?new pa(e.radius,e.resolution.x,e.resolution.y,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength):new pa(e.radius,e.resolution.x,e.resolution.y)}_create_default_isocahedron(e){return new hc(e.radius,e.detail)}};ya.DEFAULT_PARAMS={type:ei.default,radius:1,resolution:new re(30,30),open:!1,phiStart:0,phiLength:Math.PI*2,thetaStart:0,thetaLength:Math.PI,detail:1,center:new F(0,0,0)};ya.INPUT_CLONED_STATE=yr.FROM_NODE;var os=ya.DEFAULT_PARAMS,OR=class extends je{constructor(){super(...arguments);this.type=N.INTEGER(os.type,{menu:{entries:PR.map(e=>({name:e,value:ei[e]}))}}),this.radius=N.FLOAT(os.radius,{visibleIf:{type:ei.default}}),this.resolution=N.VECTOR2(os.resolution,{visibleIf:{type:ei.default}}),this.open=N.BOOLEAN(os.open,{visibleIf:{type:ei.default}}),this.phiStart=N.FLOAT(os.phiStart,{range:[0,Math.PI*2],visibleIf:{type:ei.default,open:!0}}),this.phiLength=N.FLOAT("$PI*2",{range:[0,Math.PI*2],visibleIf:{type:ei.default,open:!0}}),this.thetaStart=N.FLOAT(os.thetaStart,{range:[0,Math.PI],visibleIf:{type:ei.default,open:!0}}),this.thetaLength=N.FLOAT("$PI",{range:[0,Math.PI],visibleIf:{type:ei.default,open:!0}}),this.detail=N.INTEGER(os.detail,{range:[0,5],rangeLocked:[!0,!1],visibleIf:{type:ei.isocahedron}}),this.center=N.VECTOR3(os.center)}},DJ=new OR,_5=class extends on{constructor(){super(...arguments);this.paramsConfig=DJ}static type(){return"sphere"}initializeNode(){this.io.inputs.setCount(0,1),this.io.inputs.initInputsClonedState(ya.INPUT_CLONED_STATE)}cook(e){this._operation=this._operation||new ya(this.scene(),this.states);let t=this._operation.cook(e,this.pv);this.setCoreGroup(t)}};var xp=["set params","update matrix"],ba=class extends Rr{constructor(){super(...arguments);this._coreTransform=new Jr,this._point_pos=new F,this._object_scale=new F,this._r=new F,this._object_position=new F}static type(){return"transform"}cook(e,t){let r=e[0].objects();return this._applyTransform(r,t),e[0]}_applyTransform(e,t){let r=u0[t.applyOn];switch(r){case c0.GEOMETRIES:return this._updateGeometries(e,t);case c0.OBJECTS:return this._updateObjects(e,t)}qr.unreachable(r)}_updateGeometries(e,t){let r=this._matrix(t);if(t.group.trim()==="")for(let o of e){let s=o.geometry;s&&(s.translate(-t.pivot.x,-t.pivot.y,-t.pivot.z),s.applyMatrix4(r),s.translate(t.pivot.x,t.pivot.y,t.pivot.z))}else{let s=mi._fromObjects(e).pointsFromGroup(t.group);for(let i of s){let l=i.getPosition(this._point_pos).sub(t.pivot);l.applyMatrix4(r),i.setPosition(l.add(t.pivot))}}}_updateObjects(e,t){let r=xp[t.objectMode];switch(r){case"set params":return this._update_objects_params(e,t);case"update matrix":return this._update_objects_matrix(e,t)}qr.unreachable(r)}_update_objects_params(e,t){for(let r of e){r.position.copy(t.t);let o=Fi[t.rotationOrder];this._r.copy(t.r).multiplyScalar(Ed),r.rotation.set(this._r.x,this._r.y,this._r.z,o),this._object_scale.copy(t.s).multiplyScalar(t.scale),r.scale.copy(this._object_scale),r.updateMatrix()}}_update_objects_matrix(e,t){let r=this._matrix(t);for(let o of e)this._object_position.copy(o.position),o.position.multiplyScalar(0),o.updateMatrix(),o.applyMatrix4(r),o.position.add(this._object_position),o.updateMatrix()}_matrix(e){return this._coreTransform.matrix(e.t,e.r,e.s,e.scale,Fi[e.rotationOrder])}};ba.DEFAULT_PARAMS={applyOn:u0.indexOf(c0.GEOMETRIES),objectMode:xp.indexOf("set params"),group:"",rotationOrder:Fi.indexOf(qs.XYZ),t:new F(0,0,0),r:new F(0,0,0),s:new F(1,1,1),scale:1,pivot:new F(0,0,0)};ba.INPUT_CLONED_STATE=yr.FROM_NODE;var g5=(n=>(n.SHEAR="shear",n.TRANSFORM="transform",n.UV_LAYOUT="uvLayout",n.UV_TRANSFORM="uvTransform",n.UV_UNWRAP="uvUnwrap",n))(g5||{});var g0=ba.DEFAULT_PARAMS,wR=class extends je{constructor(){super(...arguments);this.applyOn=N.INTEGER(g0.applyOn,{menu:{entries:u0.map((e,t)=>({name:e,value:t}))}}),this.objectMode=N.INTEGER(g0.objectMode,{visibleIf:{applyOn:u0.indexOf(c0.OBJECTS)},menu:{entries:xp.map((e,t)=>({name:e,value:t}))}}),this.group=N.STRING(g0.group,{visibleIf:{applyOn:u0.indexOf(c0.GEOMETRIES)}}),this.rotationOrder=N.INTEGER(g0.rotationOrder,{menu:{entries:Fi.map((e,t)=>({name:e,value:t}))}}),this.t=N.VECTOR3(g0.t),this.r=N.VECTOR3(g0.r),this.s=N.VECTOR3(g0.s),this.scale=N.FLOAT(g0.scale,{range:[0,10]}),this.pivot=N.VECTOR3(g0.pivot,{visibleIf:{applyOn:u0.indexOf(c0.GEOMETRIES)}})}},BJ=new wR,v5=class extends on{constructor(){super(...arguments);this.paramsConfig=BJ}static type(){return g5.TRANSFORM}static displayedInputNames(){return["geometries or objects to transform"]}initializeNode(){this.io.inputs.setCount(1),this.io.inputs.initInputsClonedState(ba.INPUT_CLONED_STATE)}setApplyOn(e){this.p.applyOn.set(u0.indexOf(e))}setObjectMode(e){this.p.objectMode.set(xp.indexOf(e))}cook(e){this._operation=this._operation||new ba(this.scene(),this.states);let t=this._operation.cook(e,this.pv);this.setCoreGroup(t)}};var y5={nodes:[qf,r4,c4,p4,m4,h4,g4,y4,G4,z4,H4,Du,q4,Ym,l5,m5,eh,h5,_5,v5],operations:[]};var xa=class{static toArray(e){let t=[];return e.forEach(r=>{t.push(r)}),t}static union(e,t){let r=new Set;return e.forEach(o=>r.add(o)),t.forEach(o=>r.add(o)),r}static intersection(e,t){let r=new Set;return e.forEach(o=>{t.has(o)&&r.add(o)}),t.forEach(o=>{e.has(o)&&r.add(o)}),r}static difference(e,t){let r=new Set;return e.forEach(o=>{t.has(o)||r.add(o)}),t.forEach(o=>{e.has(o)||r.add(o)}),r}};var yo=class{static arrayFromValues(e){let t=[];return e.forEach(r=>{t.push(r)}),t}static pushOnArrayAtEntry(e,t,r){e.has(t)?e.get(t).push(r):e.set(t,[r])}static addToSetAtEntry(e,t,r){if(e.has(t))e.get(t).add(r);else{let s=new Set;s.add(r),e.set(t,s)}}static popFromArrayAtEntry(e,t,r){if(e.has(t)){let s=e.get(t),i=s.indexOf(r);i>=0&&s.splice(i,1)}}static removeFromSetAtEntry(e,t,r){if(e.has(t)){let s=e.get(t);s.delete(r),s.size==0&&e.delete(t)}}static unshiftOnArrayAtEntry(e,t,r){e.has(t)?e.get(t).unshift(r):e.set(t,[r])}static concatOnArrayAtEntry(e,t,r){if(e.has(t)){let s=e.get(t);for(let i of r)s.push(i)}else e.set(t,r)}static async forEachSync(e,t){let r=[],o=[];e.forEach((s,i)=>{r.push(s),o.push(i)});for(let s=0;s<r.length;s++){let i=o[s],l=r[s];await t(l,i)}}};var ct=class{static isNumber(e){return typeof e=="number"}static isVector(e){return e instanceof re||e instanceof F||e instanceof kt}static isQuaternion(e){return e instanceof ao}static isString(e){return typeof e=="string"}static isBoolean(e){return e===!0||e===!1}static isNaN(e){return isNaN(e)}static isArray(e){return Array.isArray(e)}static isObject(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}};function Er(n){return n}var xr=class{static shallowClone(e){return[...e]}static min(e){let t=e[0];for(let r of e)r<t&&(t=r);return t}static max(e){let t=e[0];for(let r of e)r>t&&(t=r);return t}static sum(e){let t=0;for(let r of e)t+=r;return t}static compact(e){let t=[];for(let r of e)r!=null&&t.push(r);return t}static uniq(e){let t=new Set;for(let s of e)t.add(s);let r=new Array(t.size),o=0;return t.forEach(s=>{r[o]=s,o++}),r}static chunk(e,t){let r=[],o=[];r.push(o);for(let s=0;s<e.length;s++)o.length==t&&(o=[],r.push(o)),o.push(e[s]);return r}static union(e,t){let r=[];return xa.union(this.toSet(e),this.toSet(t)).forEach(s=>r.push(s)),r}static intersection(e,t){let r=[];return xa.intersection(this.toSet(e),this.toSet(t)).forEach(s=>r.push(s)),r}static difference(e,t){let r=[];return xa.difference(this.toSet(e),this.toSet(t)).forEach(s=>r.push(s)),r}static toSet(e){let t=new Set;for(let r of e)t.add(r);return t}static isEqual(e,t){if(e.length!=t.length)return!1;let r=e.length;for(let o=0;o<r;o++)if(e[o]!=t[o])return!1;return!0}static sortBy(e,t){if(e.length==0)return[];let r=new Map,o=new Set;for(let a of e){let c=t(a);o.add(c),yo.pushOnArrayAtEntry(r,c,a)}let s=new Array(o.size),i=0;o.forEach(a=>{s[i]=a,i++}),ct.isString(s[0])?s.sort():s.sort((a,c)=>a-c);let l=new Array(e.length);i=0;for(let a of s){let c=r.get(a);if(c)for(let h of c)l[i]=h,i++}return l}static range(e,t,r=1){t==null&&(t=e,e=0);let o=Math.floor((t-e)/r),s=new Array(o);for(let i=0;i<s.length;i++)s[i]=e+i*r;return s}};var RR=Zi(j_()),LR=Zi(q_()),Jn=class{static isEqual(e,t){if(ct.isObject(e)&&ct.isObject(t)){let r=Object.keys(e),o=Object.keys(t);return xr.isEqual(r,o)?JSON.stringify(e)==JSON.stringify(t):!1}return!1}static merge(e,t){return Object.assign(e,t)}static clone(e){return(0,LR.default)(e)}static cloneDeep(e){return(0,RR.default)(e)}};var IR={};var x5=class{constructor(){this._next_renderer_id=0;this._renderers=new Map;this._firstRenderer=null;this._printDebug=!1;this._require_webgl2=!1;this._resolves=[]}setPrintDebug(e=!0){this._printDebug=e}printDebug(){return this._printDebug}printDebugMessage(e){!this._printDebug||console.warn("[Poly debug]",e)}setRequireWebGL2(){this._require_webgl2||(this._require_webgl2=!0)}webgl2Available(){return this._webgl2_available===void 0&&(this._webgl2_available=this._set_webgl2_available()),this._webgl2_available}_set_webgl2_available(){let e=document.createElement("canvas");return(window.WebGL2RenderingContext&&e.getContext("webgl2"))!=null}createWebGLRenderer(e){let t=new Vd(e);return this.printDebugMessage(["create renderer:",e]),t}getRenderingContext(e){let t=null;return this._require_webgl2&&(t=this._getRenderingContextWebgl(e,!0),t||console.warn("failed to create webgl2 context")),t||(t=this._getRenderingContextWebgl(e,!1)),t}_getRenderingContextWebgl(e,t){let r;this.webgl2Available()?r="webgl2":r=t?"webgl2":"webgl";let o=e.getContext(r,IR);return o?this.printDebugMessage(`create gl context: ${r}.`):(r=t?"experimental-webgl2":"experimental-webgl",this.printDebugMessage(`create gl context: ${r}.`),o=e.getContext(r,IR)),o}registerRenderer(e){if(e._polygonId)throw new Error("render already registered");let t=this._next_renderer_id+=1;e._polygonId=t,this._renderers.set(t,e),this._renderers.size==1&&this._flushCallbacksWithRenderer(e),this._updateCache()}deregisterRenderer(e){let t=e._polygonId;this._renderers.delete(t),e.dispose(),this._updateCache()}deregisterAllRenderers(){let e=[];this._renderers.forEach((t,r)=>{e.push(t)});for(let t of e)this.deregisterRenderer(t)}_updateCache(){this._firstRenderer=null,this._renderers.forEach(e=>{this._firstRenderer=this._firstRenderer||e})}firstRenderer(){return this._firstRenderer}renderers(){return Object.values(this._renderers)}_flushCallbacksWithRenderer(e){let t=[];for(let r of this._resolves)t.push(r);this._resolves=[];for(let r of t)r(e)}async waitForRenderer(){let e=this.firstRenderer();return e||new Promise((t,r)=>{this._resolves.push(t)})}renderTarget(e,t,r){return this.webgl2Available()?new V0(e,t,r):new Yn(e,t,r)}};var C5=class{constructor(){this._root="/three/js/libs";this._BASISPath="/basis";this._DRACOPath="/draco";this._DRACOGLTFPath="/draco/gltf"}root(){return this._root}setRoot(e){this._root=e}BASISPath(){return this._BASISPath}DRACOPath(){return this._DRACOPath}DRACOGLTFPath(){return this._DRACOGLTFPath}};var vi=class{constructor(e){this.poly=e;this._node_register=new Map;this._node_register_categories=new Map;this._node_register_options=new Map}static type(e){return this.filterType(e.type())}static filterType(e){return e.toLowerCase()}register(e,t,r){let o=e.context(),s=vi.type(e),i=this._node_register.get(o);if(i||(i=new Map,this._node_register.set(o,i)),i.get(s)){console.error(`node ${o}/${s} already registered`);return}if(i.set(s,e),t){let a=this._node_register_categories.get(o);a||(a=new Map,this._node_register_categories.set(o,a)),a.set(s,t)}if(r){let a=this._node_register_options.get(o);a||(a=new Map,this._node_register_options.set(o,a)),a.set(s,r)}this.poly.pluginsRegister.registerNode(e)}deregister(e,t){t=vi.filterType(t),this._node_register.get(e)?.delete(t),this._node_register_categories.get(e)?.delete(t),this._node_register_options.get(e)?.delete(t)}isRegistered(e,t){let r=this._node_register.get(e);return r?(t=vi.filterType(t),r.get(t)!=null):!1}nodeOptions(e,t){return t=vi.filterType(t),this._node_register_options.get(e)?.get(t)}registeredNodesForContextAndParentType(e,t){if(this._node_register.get(e)){let o=[];return this._node_register.get(e)?.forEach((s,i)=>{o.push(s)}),o.filter(s=>{let i=vi.type(s),l=this._node_register_options.get(e)?.get(i);if(l){let a=l.only,c=l.except,h=`${e}/${t}`;return a?a.includes(h):c?!c.includes(h):!0}else return!0})}else return[]}registeredNodes(e,t){let r={},o=this.registeredNodesForContextAndParentType(e,t);for(let s of o){let i=vi.type(s);r[i]=s}return r}registeredCategory(e,t){return t=vi.filterType(t),this._node_register_categories.get(e)?.get(t)}map(){return this._node_register}},gc=class{constructor(e){this.poly=e;this._operation_register=new Map}static type(e){return this.filterType(e.type())}static filterType(e){return e.toLowerCase()}register(e){let t=e.context(),r=this._operation_register.get(t);r||(r=new Map,this._operation_register.set(t,r));let o=gc.type(e);if(r.get(o)){let i=`operation ${t}/${o} already registered`;console.error(i);return}r.set(o,e),this.poly.pluginsRegister.registerOperation(e)}registeredOperationsForContextAndParentType(e,t){if(this._operation_register.get(e)){let o=[];return this._operation_register.get(e)?.forEach((s,i)=>{o.push(s)}),o}else return[]}registeredOperation(e,t){let r=this._operation_register.get(e);if(r)return t=gc.filterType(t),r.get(t)}};var T5=class{constructor(){this._methods_names=[];this._methods_by_name=new Map}register(e,t){this._methods_names.push(t),this._methods_by_name.set(t,e)}getMethod(e){return this._methods_by_name.get(e)}availableMethods(){return this._methods_names}};var E5=class extends T5{getMethod(e){return super.getMethod(e)}};var A5=class{constructor(){this._module_by_name=new Map}register(e,t){this._module_by_name.set(e,t)}moduleNames(){let e=[];return this._module_by_name.forEach((t,r)=>{e.push(r)}),e}module(e){return this._module_by_name.get(e)}};var M5=class extends A5{};var N5=class{constructor(){this._controller_assembler_by_name=new Map}register(e,t,r){this._controller_assembler_by_name.set(e,{controller:t,assembler:r})}unregister(e){this._controller_assembler_by_name.delete(e)}};var S5=class extends N5{assembler(e,t){let r=this._controller_assembler_by_name.get(t);if(r){let o=r.controller,s=r.assembler;return new o(e,s)}return r}unregister(e){let t=this._controller_assembler_by_name.get(e);return super.unregister(e),t}};var P5=class{constructor(e){this.poly=e;this._plugins_by_name=new Map;this._plugin_name_by_node_context_by_type=new Map;this._plugin_name_by_operation_context_by_type=new Map}register(e){this._current_plugin=e,this._plugins_by_name.set(e.name(),e),e.init(this.poly),this._current_plugin=void 0}pluginByName(e){return this._plugins_by_name.get(e)}registerNode(e){if(!this._current_plugin)return;let t=e.context(),r=e.type(),o=this._plugin_name_by_node_context_by_type.get(t);o||(o=new Map,this._plugin_name_by_node_context_by_type.set(t,o)),o.set(r,this._current_plugin.name())}registerOperation(e){if(!this._current_plugin)return;let t=e.context(),r=e.type(),o=this._plugin_name_by_operation_context_by_type.get(t);o||(o=new Map,this._plugin_name_by_operation_context_by_type.set(t,o)),o.set(r,this._current_plugin.name())}toJson(){let e={plugins:{},nodes:{},operations:{}};return this._plugins_by_name.forEach((t,r)=>{e.plugins[r]=t.toJSON()}),this._plugin_name_by_node_context_by_type.forEach((t,r)=>{e.nodes[r]={},t.forEach((o,s)=>{e.nodes[r][s]=o})}),this._plugin_name_by_operation_context_by_type.forEach((t,r)=>{e.operations[r]={},t.forEach((o,s)=>{e.operations[r][s]=o})}),e}};var O5=class{constructor(e){this._camera_types=[]}register(e){let t=e.type();this._camera_types.includes(t)||this._camera_types.push(t)}registeredTypes(){return this._camera_types}};function DR(n){return(window.URL||window.webkitURL).createObjectURL(n)}var w5=class{constructor(){this._blobUrlsByStoredUrl=new Map;this._blobsByStoredUrl=new Map;this._blobDataByNodeId=new Map;this._globalBlobsByStoredUrl=new Map}registerBlobUrl(e){!er.playerMode()||this._blobUrlsByStoredUrl.set(e.storedUrl,e.blobUrl)}deregisterUrl(e){this._blobUrlsByStoredUrl.delete(e)}blobUrl(e){return this._blobUrlsByStoredUrl.get(e)}clear(){this._blobUrlsByStoredUrl.clear(),this._blobsByStoredUrl.clear(),this._blobDataByNodeId.clear(),this._globalBlobsByStoredUrl.clear()}_clearBlobForNode(e){let t=this._blobDataByNodeId.get(e.graphNodeId());if(t){let r=t[0];r&&(this._blobsByStoredUrl.delete(r.storedUrl),this._blobUrlsByStoredUrl.delete(r.storedUrl))}this._blobDataByNodeId.delete(e.graphNodeId())}_assignBlobToNode(e,t,r={}){r.multiAssetsForNode!=!0&&this._clearBlobForNode(e),yo.pushOnArrayAtEntry(this._blobDataByNodeId,e.graphNodeId(),{storedUrl:t.storedUrl,fullUrl:t.fullUrl})}async fetchBlobGlobal(e){if(er.playerMode())return{};try{if(this._blobUrlsByStoredUrl.get(e.storedUrl))return{};let r=er.assetUrls.remapedUrl(e.fullUrl),o=await fetch(r||e.fullUrl);if(o.ok){let s=await o.blob();return this._blobsByStoredUrl.set(e.storedUrl,s),this._blobUrlsByStoredUrl.set(e.storedUrl,this.createBlobUrl(s)),this._globalBlobsByStoredUrl.set(e.storedUrl,s),{blobData:{storedUrl:e.storedUrl,fullUrl:e.fullUrl}}}else return{error:`failed to fetch ${e.fullUrl}`}}catch{return{error:`failed to fetch ${e.fullUrl}`}}}async fetchBlobForNode(e){if(er.playerMode())return{};try{if(this._blobUrlsByStoredUrl.get(e.storedUrl))return{};let r=er.assetUrls.remapedUrl(e.fullUrl),o=await fetch(r||e.fullUrl);if(o.ok){let s=await o.blob();return this._blobsByStoredUrl.set(e.storedUrl,s),this._blobUrlsByStoredUrl.set(e.storedUrl,this.createBlobUrl(s)),this._scene=e.node.scene(),this._assignBlobToNode(e.node,{storedUrl:e.storedUrl,fullUrl:e.fullUrl},{multiAssetsForNode:e.multiAssetsForNode}),{blobData:{storedUrl:e.storedUrl,fullUrl:e.fullUrl}}}else return{error:`failed to fetch ${e.fullUrl}`}}catch{return{error:`failed to fetch ${e.fullUrl}`}}}forEachBlob(e){this._blobDataByNodeId.forEach((o,s)=>{if(this._scene&&this._scene.graph.nodeFromId(s))for(let l of o){let{storedUrl:a}=l,c=this._blobsByStoredUrl.get(a);c&&e(c,l)}});let t=[],r=new Map;this._globalBlobsByStoredUrl.forEach((o,s)=>{t.push(s),r.set(s,o)}),t=t.sort(),t.forEach(o=>{let s=this._globalBlobsByStoredUrl.get(o);s&&e(s,{storedUrl:o})})}createBlobUrl(e){return DR(e)}assetsManifestWithBlobsMap(){let e={},t=new Map,r=[],o=[],s=[];er.blobs.forEachBlob((i,l)=>{r.push(i);let a=l.fullUrl;a&&o.push(a),s.push(l.storedUrl)});for(let i=0;i<r.length;i++){let l=s[i],a=r[i],c=l.split("?")[0],h=l.split("."),g=h[h.length-1],p=`${i}.${g}`,u=`assets/${p}`;t.set(u,a),e[c]=p}return{manifest:e,blobsMap:t,fullUrls:o,storedUrls:s}}};var R5=class{setMap(e){this._map=e}remapedUrl(e){if(!this._map)return;let t=e.split("?"),r=t[0],o=t[1],s=this._map[r];if(s)return o?`${s}?${o}`:s}};var L5=class{static fadeOut(e){return new Promise(t=>{let r=setInterval(()=>{e.style.opacity||(e.style.opacity="1");let o=parseFloat(e.style.opacity);o>0?e.style.opacity=`${o-.05}`:(t(),clearInterval(r))},20)})}};var I5=class{markAsLoaded(e,t){this._sceneJsonImporterContructor=t,e()}load(e){if(!this._sceneJsonImporterContructor)return;let t=[];e.forEach((r,o)=>{t.push(o)});for(let r of t){let o=e.get(r);o&&(this._loadElement(r,o,this._sceneJsonImporterContructor),e.delete(r))}}async _loadElement(e,t,r){let{sceneData:o,assetsManifest:s,unzippedData:i}=t,l=Object.keys(s);for(let p of l){let u=s[p],d=i[`assets/${u}`];if(!d){console.error(p,d);return}let f=new Blob([d]),_=er.blobs.createBlobUrl(f),m={storedUrl:p,blobUrl:_};er.blobs.registerBlobUrl(m)}er.setPlayerMode(!0),er.libs.setRoot(null);let a=`${Math.random()}`.replace(".","_"),c={Poly:`___POLY_polyConfig_configurePolygonjs_${a}`,scriptElementId:`___POLY_polyConfig_scriptElement_${a}`,loadSceneArgs:`___POLY_polyConfig_loadSceneArgs_${a}`};window[c.Poly]=er;let g={method:this._loadScene.bind(this),element:e,sceneData:o,sceneJsonImporterContructor:r};window[c.loadSceneArgs]=g,this._loadScene(e,o,r)}async _loadScene(e,t,r,o){this._fadeOutPoster(e);let i=await new r(t).scene();o&&o(i);let l=i.mainCameraNode();if(!l){console.warn("no main camera found");return}let a=l.createViewer({element:e});i.play(),e.scene=i,e.viewer=a}_fadeOutPoster(e){let t=e.firstElementChild;t&&(t.style.pointerEvents="none",L5.fadeOut(t).then(()=>{t.parentElement?.removeChild(t)}))}};var D5=class{setPerformanceManager(e){this._performanceManager=e}performanceManager(){return this._performanceManager||window.performance}};var th=class{constructor(){this.renderersController=new x5;this.nodesRegister=new vi(this);this.operationsRegister=new gc(this);this.expressionsRegister=new E5;this.modulesRegister=new M5;this.assemblersRegister=new S5;this.pluginsRegister=new P5(this);this.camerasRegister=new O5(this);this.blobs=new w5;this.assetUrls=new R5;this.selfContainedScenesLoader=new I5;this.performance=new D5;this.scenesByUuid={};this._player_mode=!0;this._logger=null}static _instance_(){if(window.__POLYGONJS_POLY_INSTANCE__)return window.__POLYGONJS_POLY_INSTANCE__;{let e=new th;return window.__POLYGONJS_POLY_INSTANCE__=e,window.__POLYGONJS_POLY_INSTANCE__}}setPlayerMode(e){this._player_mode=e}playerMode(){return this._player_mode}registerNode(e,t,r){this.nodesRegister.register(e,t,r)}registerOperation(e){this.operationsRegister.register(e)}registerCamera(e){this.camerasRegister.register(e)}registerPlugin(e){this.pluginsRegister.register(e)}registeredNodes(e,t){return this.nodesRegister.registeredNodes(e,t)}registeredOperation(e,t){return this.operationsRegister.registeredOperation(e,t)}registeredCameraTypes(){return this.camerasRegister.registeredTypes()}registerModule(e){this.modulesRegister.register(e.moduleName,e.module)}inWorkerThread(){return!1}get libs(){return this._libs_controller=this._libs_controller||new C5}setEnv(e){this._env=e}env(){return this._env}setLogger(e){this._logger=e}log(e,...t){this._logger?.log(e,...t)}warn(e,...t){this._logger?.warn(e,...t)}error(e,...t){this._logger?.error(e,...t)}},er=th._instance_();var rh=class extends Event{constructor(e){super(e)}get type(){return super.type}},GJ={event:new rh("sceneLoaded")},BR={event:new rh("play")},kR={event:new rh("pause")};var Ca=class{constructor(e=""){this._path=e;this._node=null}set_path(e){this._path=e}set_node(e){this._node=e}path(){return this._path}node(){return this._node}resolve(e){this._node=Ar.findNode(e,this._path)}clone(){let e=new Ca(this._path);return e.set_node(this._node),e}nodeWithContext(e,t){let r=this.node();if(!r){t?.set(`no node found at ${this.path()}`);return}let o=r.context();if(o==e)return r;t?.set(`expected ${e} node, but got a ${o}`)}},Tp=class{constructor(e=""){this._path=e;this._param=null}set_path(e){this._path=e}set_param(e){this._param=e}path(){return this._path}param(){return this._param}resolve(e){this._param=Ar.findParam(e,this._path)}clone(){let e=new Tp(this._path);return e.set_param(this._param),e}paramWithType(e,t){let r=this.param();if(!r){t?.set(`no param found at ${this.path()}`);return}if(r.type()==e)return r;t?.set(`expected ${e} node, but got a ${r.type()}`)}},Dr=class{static splitParentChild(e){let t=e.split(Dr.SEPARATOR).filter(s=>s.length>0),r=t.pop();return{parent:t.join(Dr.SEPARATOR),child:r}}static findNode(e,t,r){if(!e)return null;let o=t.split(Dr.SEPARATOR).filter(l=>l.length>0),s=o[0],i=null;if(t[0]===Dr.SEPARATOR){let l=t.substr(1);i=this.findNode(e.root(),l,r)}else{switch(s){case Dr.PARENT:r?.add_path_element(s),i=e.parent();break;case Dr.CURRENT:r?.add_path_element(s),i=e;break;default:i=e.node(s),i&&r?.add_node(s,i)}if(i!=null&&o.length>1){let l=o.slice(1).join(Dr.SEPARATOR);i=this.findNode(i,l,r)}return i}return i}static findParam(e,t,r){if(!e)return null;let o=t.split(Dr.SEPARATOR);if(o.length===1)return e.params.get(o[0]);{let s=o.slice(0,+(o.length-2)+1||void 0).join(Dr.SEPARATOR),i=this.findNode(e,s,r);if(i!=null){let l=o[o.length-1],a=i.params.get(l);return r&&a&&r.add_node(l,a),a}else return null}}static relativePath(e,t){let r=this.closestCommonParent(e,t);if(r){let o=this.distanceToParent(e,r),s="";if(o>0){let g=0,p=[];for(;g++<o;)p.push(Dr.PARENT);s=p.join(Dr.SEPARATOR)+Dr.SEPARATOR}let i=r.path().split(Dr.SEPARATOR).filter(g=>g.length>0),l=t.path().split(Dr.SEPARATOR).filter(g=>g.length>0),a=[],c=0;for(let g of l)i[c]||a.push(g),c++;let h=a.join(Dr.SEPARATOR);return`${s}${h}`}else return t.path()}static closestCommonParent(e,t){let r=this.parents(e).reverse().concat([e]),o=this.parents(t).reverse().concat([t]),s=Math.min(r.length,o.length),i=null;for(let l=0;l<s;l++)r[l].graphNodeId()==o[l].graphNodeId()&&(i=r[l]);return i}static parents(e){let t=[],r=e.parent();for(;r;)t.push(r),r=r.parent();return t}static distanceToParent(e,t){let r=0,o=e,s=t.graphNodeId();for(;o&&o.graphNodeId()!=s;)r+=1,o=o.parent();return o&&o.graphNodeId()==s?r:-1}static makeAbsolutePath(e,t){if(t[0]==Dr.SEPARATOR)return t;let r=t.split(Dr.SEPARATOR),o=r.shift();if(o)switch(o){case"..":{let s=e.parent();return s?s==e.scene().root()?Dr.SEPARATOR+r.join(Dr.SEPARATOR):this.makeAbsolutePath(s,r.join(Dr.SEPARATOR)):null}case".":return this.makeAbsolutePath(e,r.join(Dr.SEPARATOR));default:return[e.path(),t].join(Dr.SEPARATOR)}else return e.path()}},Ar=Dr;Ar.SEPARATOR="/",Ar.DOT=".",Ar.CURRENT=Dr.DOT,Ar.PARENT="..",Ar.CURRENT_WITH_SLASH=`${Dr.CURRENT}/`,Ar.PARENT_WITH_SLASH=`${Dr.PARENT}/`,Ar.NON_LETTER_PREFIXES=[Dr.SEPARATOR,Dr.DOT];var B5=class{constructor(e){this.node=e;this._dirtyCount=0;this._dirty=!0}dispose(){this._cachedSuccessors=void 0,this._postDirtyHooks=void 0,this._postDirtyHookNames=void 0}isDirty(){return this._dirty===!0}dirtyTimestamp(){return this._dirtyTimestamp}dirtyCount(){return this._dirtyCount}addPostDirtyHook(e,t){this._postDirtyHookNames=this._postDirtyHookNames||[],this._postDirtyHooks=this._postDirtyHooks||[],this._postDirtyHookNames.includes(e)?console.warn(`hook with name ${e} already exists`,this.node):(this._postDirtyHookNames.push(e),this._postDirtyHooks.push(t))}removePostDirtyHook(e){if(this._postDirtyHookNames&&this._postDirtyHooks){let t=this._postDirtyHookNames.indexOf(e);t>=0&&(this._postDirtyHookNames.splice(t,1),this._postDirtyHooks.splice(t,1))}}hasHook(e){return this._postDirtyHookNames?this._postDirtyHookNames.includes(e):!1}removeDirtyState(){this._dirty=!1}setForbiddenTriggerNodes(e){this._forbiddenTriggerNodeIds?this._forbiddenTriggerNodeIds.clear():this._forbiddenTriggerNodeIds=new Set;for(let t of e)this._forbiddenTriggerNodeIds.add(t.graphNodeId()),t.dirtyController.clearSuccessorsCacheWithPredecessors()}isForbiddenTriggerNodeId(e){return this._forbiddenTriggerNodeIds!=null&&this._forbiddenTriggerNodeIds.has(e)}setDirty(e,t){t==null&&(t=!0),!(e&&this.isForbiddenTriggerNodeId(e.graphNodeId()))&&(e==null&&(e=this.node),this._dirty=!0,this._dirtyTimestamp=er.performance.performanceManager().now(),this._dirtyCount+=1,this.runPostDirtyHooks(e),t===!0&&this.setSuccessorsDirty(e))}runPostDirtyHooks(e){if(!this._postDirtyHooks)return;let t=this.node.scene().cooker;if(t.blocked())t.enqueue(this.node,e);else for(let r of this._postDirtyHooks)r(e)}setSuccessorsDirty(e){let t=!1;this._cachedSuccessors=this._cachedSuccessors||this.node.graphAllSuccessors();for(let r of this._cachedSuccessors)r.dirtyController.setDirty(e,t)}clearSuccessorsCache(){this._cachedSuccessors=void 0}clearSuccessorsCacheWithPredecessors(){this.clearSuccessorsCache();for(let e of this.node.graphAllPredecessors())e.dirtyController.clearSuccessorsCache()}};var Un=class{constructor(e,t){this._scene=e;this._name=t;this._dirtyController=new B5(this);this._graphNodeId=e.graph.nextId(),e.graph.addNode(this),this._graph=e.graph}dispose(){this._dirtyController.dispose(),this.graphRemove()}name(){return this._name}setName(e){this._name=e}scene(){return this._scene}graphNodeId(){return this._graphNodeId}get dirtyController(){return this._dirtyController}setDirty(e){e=e||this,this._dirtyController.setDirty(e)}setSuccessorsDirty(e){this._dirtyController.setSuccessorsDirty(e)}removeDirtyState(){this._dirtyController.removeDirtyState()}isDirty(){return this._dirtyController.isDirty()}addPostDirtyHook(e,t){this._dirtyController.addPostDirtyHook(e,t)}removePostDirtyHook(e){this._dirtyController.removePostDirtyHook(e)}graphRemove(){this._graph.removeNode(this)}addGraphInput(e,t=!0){return this._graph.connect(e,this,t)}removeGraphInput(e){this._graph.disconnect(e,this)}graphDisconnectPredecessors(){this._graph.disconnectPredecessors(this)}graphDisconnectSuccessors(){this._graph.disconnectSuccessors(this)}graphPredecessorIds(){return this._graph.predecessorIds(this._graphNodeId)||[]}graphPredecessors(){return this._graph.predecessors(this)}graphSuccessors(){return this._graph.successors(this)}graphAllPredecessors(){return this._graph.allPredecessors(this)}graphAllSuccessors(){return this._graph.allSuccessors(this)}};var Br=(f=>(f.CREATED="node_created",f.DELETED="node_deleted",f.NAME_UPDATED="node_name_update",f.OVERRIDE_CLONABLE_STATE_UPDATE="node_override_clonable_state_update",f.NAMED_OUTPUTS_UPDATED="node_named_outputs_updated",f.NAMED_INPUTS_UPDATED="node_named_inputs_updated",f.INPUTS_UPDATED="node_inputs_updated",f.PARAMS_UPDATED="node_params_updated",f.UI_DATA_POSITION_UPDATED="node_ui_data_position_updated",f.UI_DATA_COMMENT_UPDATED="node_ui_data_comment_updated",f.ERROR_UPDATED="node_error_updated",f.FLAG_BYPASS_UPDATED="bypass_flag_updated",f.FLAG_DISPLAY_UPDATED="display_flag_updated",f.FLAG_OPTIMIZE_UPDATED="optimize_flag_updated",f.SELECTION_UPDATED="selection_updated",f))(Br||{});var k5=class{constructor(e,t=0,r=0){this.node=e;this._position=new re;this._width=50;this._color=new Ke(.75,.75,.75);this._layoutVertical=!0;this._json={x:0,y:0};this._position.x=t,this._position.y=r}dispose(){this._comment=void 0}setComment(e){this._comment=e,this.node.emit(Br.UI_DATA_COMMENT_UPDATED)}comment(){return this._comment}setColor(e){this._color=e}color(){return this._color}setLayoutHorizontal(){this._layoutVertical=!1}isLayoutVertical(){return this._layoutVertical}copy(e){this._position.copy(e.position()),this._color.copy(e.color())}position(){return this._position}setPosition(e,t=0){if(ct.isNumber(e)){let r=e;this._position.set(r,t)}else this._position.copy(e);this.node.emit(Br.UI_DATA_POSITION_UPDATED)}translate(e,t=!1){this._position.add(e),t&&(this._position.x=Math.round(this._position.x),this._position.y=Math.round(this._position.y)),this.node.emit(Br.UI_DATA_POSITION_UPDATED)}toJSON(){return this._json.x=this._position.x,this._json.y=this._position.y,this._json.comment=this._comment,this._json}};var Ta=class{constructor(e){this.node=e;this._state=!0;this._hooks=null}onUpdate(e){this._hooks=this._hooks||[],this._hooks.push(e)}_on_update(){}set(e){this._state!=e&&(this._state=e,this._on_update(),this.runHooks())}active(){return this._state}toggle(){this.set(!this._state)}runHooks(){if(this._hooks)for(let e of this._hooks)e()}};var F5=class extends Ta{constructor(){super(...arguments);this._state=!1}_on_update(){this.node.emit(Br.FLAG_BYPASS_UPDATED),this.node.setDirty()}};var G5=class extends Ta{_on_update(){this.node.emit(Br.FLAG_DISPLAY_UPDATED)}};var U5=class extends Ta{constructor(){super(...arguments);this._state=!1}_on_update(){this.node.emit(Br.FLAG_OPTIMIZE_UPDATED)}};var vc=class{constructor(e){this.node=e}hasDisplay(){return!1}hasBypass(){return!1}hasOptimize(){return!1}};function V5(n){return class extends n{constructor(){super(...arguments);this.display=new G5(this.node)}hasDisplay(){return!0}}}function nh(n){return class extends n{constructor(){super(...arguments);this.bypass=new F5(this.node)}hasBypass(){return!0}}}function FR(n){return class extends n{constructor(){super(...arguments);this.optimize=new U5(this.node)}hasOptimize(){return!0}}}var GR=class extends V5(vc){},UJ=class extends nh(vc){},VJ=class extends nh(V5(vc)){},zJ=class extends FR(nh(vc)){},HJ=class extends FR(nh(V5(vc))){};var Ep=class{constructor(e){this.node=e}};var z5=class extends Ep{active(){return this.paramsTimeDependent()||this.inputsTimeDependent()}paramsTimeDependent(){let e=this.node.params.names;for(let t of e){let r=this.node.params.get(t);if(r&&r.states.timeDependent.active())return!0}return!1}inputsTimeDependent(){let e=this.node.io.inputs.inputs();for(let t of e)if(t&&t.states.timeDependent.active())return!0;return!1}forceTimeDependent(){let e=this.node.graphPredecessors().map(r=>r.graphNodeId()),t=this.node.scene().timeController.graphNode;e.includes(t.graphNodeId())||this.node.addGraphInput(t,!1)}unforceTimeDependent(){let e=this.node.scene().timeController.graphNode;this.node.removeGraphInput(e)}};var H5=class extends Ep{set(e){this._message!=e&&(e?er.error(`[${this.node.path()}] error: '${e}'`):er.warn(`[${this.node.path()}] clear error`),this._message=e,this.onUpdate())}message(){return this._message}clear(){this.set(void 0)}active(){return this._message!=null}onUpdate(){this._message!=null&&this.node._setContainer(null,`from error '${this._message}'`),this.node.emit(Br.ERROR_UPDATED)}};var j5=class{constructor(e){this.node=e;this.timeDependent=new z5(this.node);this.error=new H5(this.node)}};var q5=class{constructor(e){this.node=e;this._parent=null}parent(){return this._parent}setParent(e){e!=this.node.parentController.parent()&&(this._parent=e,this._parent&&this.node.nameController.requestNameToParent(this.node.name()))}firstAncestorWithContext(e){return this._parent?this._parent.context()==e?this._parent:this._parent.parentController.firstAncestorWithContext(e):null}path(e){let t=Ar.SEPARATOR;if(this._parent!=null){if(this._parent==e)return this.node.name();{let r=this._parent.path(e);return r===t?r+this.node.name():r+t+this.node.name()}}else return t}onSetParent(){if(this._on_set_parent_hooks)for(let e of this._on_set_parent_hooks)e()}findNode(e){if(e==null)return null;if(e==Ar.CURRENT||e==Ar.CURRENT_WITH_SLASH)return this.node;if(e==Ar.PARENT||e==Ar.PARENT_WITH_SLASH)return this.node.parent();let t=Ar.SEPARATOR;if(e===t)return this.node.scene().root();if(e[0]===t)return e=e.substring(1,e.length),this.node.scene().root().node(e);if(e.split){let r=e.split(t);if(r.length===1){let o=r[0];return this.node.childrenController?this.node.childrenController.childByName(o):null}else return Ar.findNode(this.node,e)}else return console.error("unexpected path given:",e),null}};var jJ=/[, ]/,UR=/\d+$/,qJ=/^0+/,WJ=/,| /,$J="0",YJ=" ",XJ=/^-?\d+\.?\d*$/;var Lr=class{static isBoolean(e){return e=="true"||e=="false"}static toBoolean(e){return e=="true"}static isNumber(e){return XJ.test(e)}static tailDigits(e){let t=e.match(UR);return t?parseInt(t[0]):0}static increment(e){let t=e.match(UR);if(t){let r=t[0],o="",s=r.match(qJ);s&&(o=s[0]);let i=parseInt(r);return i==0&&o.length>0&&o[o.length-1]==$J&&(o=o.slice(0,-1)),`${e.substring(0,e.length-t[0].length)}${o}${i+1}`}else return`${e}1`}static pluralize(e){return e[e.length-1]!=="s"?`${e}s`:e}static camelCase(e){let t=e.replace(/_/g," ").split(" "),r="";for(let o=0;o<t.length;o++){let s=t[o].toLowerCase();o>0&&(s=this.upperFirst(s)),r+=s}return r}static upperFirst(e){return e[0].toUpperCase()+e.substr(1)}static titleize(e){return e.split(/\s|_/g).map(o=>this.upperFirst(o)).join(" ")}static precision(e,t=2){t=Math.max(t,0);let r=`${e}`.split(".");if(t<=0)return r[0];let o=r[1];if(o!==void 0)return o.length>t&&(o=o.substring(0,t)),o=o.padEnd(t,"0"),`${r[0]}.${o}`;{let s=`${e}.`,i=s.length+t;return s.padEnd(i,"0")}}static ensureFloat(e){let t=`${e}`;return t.indexOf(".")>=0?t:`${t}.0`}static ensureInteger(e){let t=`${e}`;return t.indexOf(".")>=0?t.split(".")[0]:t}static matchMask(e,t){if(t==="*"||e==t)return!0;let r=t.split(YJ);if(r.length>1){for(let s of r)if(this.matchMask(e,s))return!0;return!1}return t=t.split("*").join(".*"),t=`^${t}$`,new RegExp(t).test(e)}static matchesOneMask(e,t){let r=!1;for(let o of t)Lr.matchMask(e,o)&&(r=!0);return r}static attribNames(e){let t=e.split(jJ),r=new Set;for(let i of t)i=i.trim(),i.length>0&&r.add(i);let o=new Array(r.size),s=0;return r.forEach(i=>{o[s]=i,s++}),o}static indices(e){let t=e.split(WJ);if(t.length>1){let r=t.flatMap(o=>this.indices(o));return xr.uniq(r).sort((o,s)=>o-s)}else{let r=t[0];if(r){let o="-";if(r.indexOf(o)>0){let s=r.split(o);return xr.range(parseInt(s[0]),parseInt(s[1])+1)}else{let s=parseInt(r);return ct.isNumber(s)?[s]:[]}}else return[]}}static escapeLineBreaks(e){return e.replace(/(\r\n|\n|\r)/gm,"\\n")}static sanitizeName(e){return e=e.replace(/[^A-Za-z0-9]/g,"_"),e=e.replace(/^[0-9]/,"_"),e}};var W5=class{constructor(e){this._node=e;this._node_ids=[];this._json=[]}node(){return this._node}nodes(){return this._node.scene().graph.nodesFromIds(this._node_ids)}contains(e){return this._node_ids.includes(e.graphNodeId())}equals(e){let t=e.map(r=>r.graphNodeId()).sort();return xr.isEqual(t,this._node_ids)}clear(){this._node_ids=[],this.send_update_event()}set(e){this._node_ids=[],this.add(e)}add(e){let t=e.map(r=>r.graphNodeId());this._node_ids=xr.union(this._node_ids,t),this.send_update_event()}remove(e){let t=e.map(r=>r.graphNodeId());this._node_ids=xr.difference(this._node_ids,t),this.send_update_event()}send_update_event(){this._node.emit(Br.SELECTION_UPDATED)}toJSON(){return this._json=this._json||[],this._json=this._node_ids.map(e=>e),this._json}};var Uo=(r=>(r.ALWAYS="always",r.NEVER="never",r.FROM_NODE="from_node",r))(Uo||{});var v0=class{static unreachable(e){throw new Error("Didn't expect to get here")}};var $5=class{constructor(e){this.inputs_controller=e;this._clone_required_states=[];this._overridden=!1}initInputsClonedState(e){ct.isArray(e)?this._cloned_states=e:this._cloned_state=e,this._update_clone_required_state()}override_cloned_state_allowed(){if(this._cloned_states){for(let e of this._cloned_states)if(e==Uo.FROM_NODE)return!0}return this._cloned_state?this._cloned_state==Uo.FROM_NODE:!1}clone_required_state(e){return this._clone_required_states[e]}clone_required_states(){return this._clone_required_states}_get_clone_required_state(e){let t=this._cloned_states;if(t){let r=t[e];if(r!=null)return this.clone_required_from_state(r)}return this._cloned_state?this.clone_required_from_state(this._cloned_state):!0}clone_required_from_state(e){switch(e){case Uo.ALWAYS:return!0;case Uo.NEVER:return!1;case Uo.FROM_NODE:return!this._overridden}return v0.unreachable(e)}override_cloned_state(e){this._overridden=e,this._update_clone_required_state()}overriden(){return this._overridden}_update_clone_required_state(){if(this._cloned_states){let e=[];for(let t=0;t<this._cloned_states.length;t++)e[t]=this._get_clone_required_state(t);this._clone_required_states=e;return}if(this._cloned_state){let e=this.inputs_controller.inputsCount(),t=[];for(let r=0;r<e;r++)t[r]=this._get_clone_required_state(r);this._clone_required_states=t;return}}};var Y5=class{constructor(e){this.operationContainer=e}inputsCount(){return this.operationContainer.inputsCount()}initInputsClonedState(e){this._clonedStatesController||(this._clonedStatesController=new $5(this),this._clonedStatesController.initInputsClonedState(e))}cloneRequired(e){let t=this._clonedStatesController?.clone_required_state(e);return t??!0}override_cloned_state(e){this._clonedStatesController?.override_cloned_state(e)}};var X5=class{constructor(e,t,r){this.operation=e;this.name=t;this.params={};this._applyDefaultParams(),this._applyInitParams(r),this._initClonedStates()}pathParamResolveRequired(){return this._path_params!=null}resolvePathParams(e){if(!!this._path_params)for(let t of this._path_params)t.resolve(e)}_applyDefaultParams(){let e=this.operation.constructor.DEFAULT_PARAMS,t=Object.keys(e);for(let r of t){let o=e[r],s=this._convertParamData(r,o);s!=null&&(this.params[r]=s)}}_applyInitParams(e){let t=Object.keys(e);for(let r of t){let o=e[r];if(o.simple_data!=null){let s=o.simple_data,i=this.operation.convertExportParamData({paramName:r,paramData:s,params:this.params});i!=null&&(this.params[r]=i)}}}_convertParamData(e,t){if(ct.isNumber(t)||ct.isBoolean(t)||ct.isString(t))return t;if(t instanceof Ca){let r=t.clone();return this._path_params||(this._path_params=[]),this._path_params.push(r),r}if(t instanceof Ke||t instanceof re||t instanceof F||t instanceof kt)return t.clone()}setInput(e,t){this._inputs=this._inputs||[],this._inputs[e]=t}inputsCount(){return this._inputs?this._inputs.length:0}inputsController(){return this._inputsController=this._inputsController||new Y5(this)}_initClonedStates(){let e=this.operation.constructor.INPUT_CLONED_STATE;this.inputsController().initInputsClonedState(e)}inputCloneRequired(e){return this._inputsController?this._inputsController.cloneRequired(e):!0}overrideInputCloneState(e){this.inputsController().override_cloned_state(e)}cook(e){return this.operation.cook(e,this.params)}};var J5=class extends X5{constructor(e,t,r){super(e,t,r);this.operation=e;this.name=t;this.init_params=r;this._inputs=[];this._currentInputIndex=0;this._dirty=!0}operationType(){return this.operation.type()}addInput(e){super.setInput(this._currentInputIndex,e),this.incrementInputIndex()}incrementInputIndex(){this._currentInputIndex++}currentInputIndex(){return this._currentInputIndex}setDirty(){if(!this._dirty){this._computeResult=void 0;for(let e=0;e<this._inputs.length;e++)this._inputs[e].setDirty()}}async compute(e,t){if(this._computeResult)return this._computeResult;let r=[],o=t.get(this);o&&o.forEach((i,l)=>{r[l]=e[i]});for(let i=0;i<this._inputs.length;i++){let a=await this._inputs[i].compute(e,t);a&&(this.inputCloneRequired(i)&&(a=a.clone()),r[i]=a)}let s=this.operation.cook(r,this.params);return s?s instanceof Promise?this._computeResult=await s:this._computeResult=s:this._computeResult=void 0,this._dirty=!1,this._computeResult}};var Ap=class{constructor(e){this.node=e;this._graph_node=new Un(e.scene(),"nodeNameController")}dispose(){this._graph_node.dispose(),this._on_set_name_hooks=void 0,this._on_set_fullPath_hooks=void 0}get graph_node(){return this._graph_node}static baseName(e){let t=e.type(),r=t[t.length-1];return ct.isNaN(parseInt(r))||(t+="_"),`${t}1`}requestNameToParent(e){let t=this.node.parent();t&&t.childrenAllowed()&&t.childrenController?t.childrenController.setChildName(this.node,e):console.warn("requestNameToParent failed, no parent found")}setName(e){e!=this.node.name()&&this.requestNameToParent(e)}updateNameFromParent(e){if(this.node._setCoreName(e),this._postSetName(),this.runPostSetFullPathHooks(),this.node.childrenAllowed()){let t=this.node.childrenController?.children();if(t)for(let r of t)r.nameController.runPostSetFullPathHooks()}this.node.lifecycle.creationCompleted()&&this.node.scene().loadingController.loaded()&&(this.node.scene().missingExpressionReferencesController.checkForMissingReferences(this.node),this.node.scene().expressionsController.regenerateReferringExpressions(this.node)),this.node.scene().referencesController.notifyNameUpdated(this.node),this.node.emit(Br.NAME_UPDATED)}add_post_set_name_hook(e){this._on_set_name_hooks=this._on_set_name_hooks||[],this._on_set_name_hooks.push(e)}add_post_set_fullPath_hook(e){this._on_set_fullPath_hooks=this._on_set_fullPath_hooks||[],this._on_set_fullPath_hooks.push(e)}_postSetName(){if(this._on_set_name_hooks)for(let e of this._on_set_name_hooks)e()}runPostSetFullPathHooks(){if(this._on_set_fullPath_hooks)for(let e of this._on_set_fullPath_hooks)e()}};var K5=class{constructor(e,t){this.node=e;this._context=t;this._childrenByName=new Map;this._childrenByType=new Map;this._childrenAndGrandchildrenByContext=new Map}get selection(){return this._selection=this._selection||new W5(this.node)}dispose(){let e=this.children();for(let t of e)this.node.removeNode(t);this._selection=void 0}get context(){return this._context}set_output_node_find_method(e){this._output_node_find_method=e}output_node(){if(this._output_node_find_method)return this._output_node_find_method()}setChildName(e,t){let r;if(t=Lr.sanitizeName(t),(r=this._childrenByName.get(t))!=null)return e.name()===t&&r.graphNodeId()===e.graphNodeId()?void 0:(t=Lr.increment(t),this.setChildName(e,t));{let o=e.name();this._childrenByName.get(o)&&this._childrenByName.delete(o),this._childrenByName.set(t,e),e.nameController.updateNameFromParent(t),this._addToNodesByType(e),this.node.scene().nodesController.addToInstanciatedNode(e)}}_nextAvailableChildName(e){return e=Lr.sanitizeName(e),this._childrenByName.get(e)?this._nextAvailableChildName(Lr.increment(e)):e}node_context_signature(){return`${this.node.context()}/${this.node.type()}`}availableChildrenClasses(){return er.registeredNodes(this._context,this.node.type())}isValidChildType(e){return this.availableChildrenClasses()[e]!=null}createNode(e,t){if(typeof e=="string"){let r=this._findNodeClass(e);return this._createAndInitNode(r,t)}else return this._createAndInitNode(e,t)}_createAndInitNode(e,t){let r=t?.nodeName||Ap.baseName(e),o=this._nextAvailableChildName(r),s=new e(this.node.scene(),o,t);return s.initializeBaseAndNode(),this._addNode(s),s.lifecycle.setCreationCompleted(),s}_findNodeClass(e){let t=this.availableChildrenClasses()[e.toLowerCase()];if(t==null){let r=`child node type '${e}' not found for node '${this.node.path()}'. Available types are: ${Object.keys(this.availableChildrenClasses()).join(", ")}, ${this._context}, ${this.node.type()}`;throw console.error(r),r}return t}createOperationContainer(e,t,r){let o=er.registeredOperation(this._context,e);if(o==null){let s=`no operation found with context ${this._context}/${e}`;throw console.error(s),s}else{let s=new o(this.node.scene());return new J5(s,t,r?.paramsInitValueOverrides||{})}}_addNode(e){if(e.setParent(this.node),e.params.init(),e.parentController.onSetParent(),e.nameController.runPostSetFullPathHooks(),e.childrenAllowed()&&e.childrenController)for(let t of e.childrenController.children())t.nameController.runPostSetFullPathHooks();return this.node.emit(Br.CREATED,{child_node_json:e.toJSON()}),this.node.scene().lifecycleController.onAfterCreatedCallbackAllowed()&&e.lifecycle.runOnAfterCreatedCallbacks(),e.lifecycle.runOnAfterAddedCallbacks(),this.node.lifecycle.runOnChildAddCallbacks(e),e.require_webgl2()&&this.node.scene().webgl_controller.set_require_webgl2(),this.node.scene().missingExpressionReferencesController.checkForMissingReferences(e),e}removeNode(e){if(e.parent()!=this.node)return console.warn(`node ${e.name()} not under parent ${this.node.path()}`);{e.lifecycle.runOnBeforeDeleteCallbacks(),this.selection.contains(e)&&this.selection.remove([e]);let t=e.io.connections.firstInputConnection(),r=e.io.connections.inputConnections(),o=e.io.connections.outputConnections();if(r)for(let s of r)s&&s.disconnect({setInput:!0});if(o){for(let s of o)if(s&&(s.disconnect({setInput:!0}),t)){let i=t.node_src,l=s.output_index,a=s.node_dest,c=s.input_index;a.io.inputs.setInput(c,i,l)}}e.setParent(null),this._childrenByName.delete(e.name()),this._removeFromNodesByType(e),this.node.scene().nodesController.removeFromInstanciatedNode(e),e.setSuccessorsDirty(this.node),e.graphDisconnectSuccessors(),this.node.lifecycle.runOnChildRemoveCallbacks(e),e.lifecycle.runOnDeleteCallbacks(),e.dispose(),e.emit(Br.DELETED,{parent_id:this.node.graphNodeId()})}}_addToNodesByType(e){let t=e.graphNodeId(),r=e.type();yo.addToSetAtEntry(this._childrenByType,r,t),this._addToChildrenAndGrandchildrenByContext(e)}_removeFromNodesByType(e){let t=e.graphNodeId(),r=e.type();yo.removeFromSetAtEntry(this._childrenByType,r,t),this._removeFromChildrenAndGrandchildrenByContext(e)}_addToChildrenAndGrandchildrenByContext(e){let t=e.graphNodeId(),r=e.context();yo.addToSetAtEntry(this._childrenAndGrandchildrenByContext,r,t);let o=this.node.parent();o&&o.childrenAllowed()&&o.childrenController?._addToChildrenAndGrandchildrenByContext(e)}_removeFromChildrenAndGrandchildrenByContext(e){let t=e.graphNodeId(),r=e.context();yo.removeFromSetAtEntry(this._childrenAndGrandchildrenByContext,r,t);let o=this.node.parent();o&&o.childrenAllowed()&&o.childrenController?._removeFromChildrenAndGrandchildrenByContext(e)}nodesByType(e){let t=this._childrenByType.get(e);if(!t)return[];let r=this.node.scene().graph,o=[];for(let s of t){let i=r.nodeFromId(s);i&&o.push(i)}return o}childByName(e){return this._childrenByName.get(e)||null}hasChildrenAndGrandchildrenWithContext(e){return this._childrenAndGrandchildrenByContext.get(e)!=null}children(){let e=[];return this._childrenByName.forEach(t=>{e.push(t)}),e}childrenNames(){let e=[];return this._childrenByName.forEach((t,r)=>{e.push(r)}),e}traverseChildren(e){this._childrenByName.forEach(t=>{e(t),t.childrenController?.traverseChildren(e)})}};var Z5=class{constructor(e){this.node=e;this._creationCompleted=!1}dispose(){this._onChildAddCallbacks=void 0,this._onChildRemoveCallbacks=void 0,this._onAfterCreatedCallbacks=void 0,this._onAfterAddedCallbacks=void 0,this._onBeforeDeletedCallbacks=void 0,this._onAfterDeletedCallbacks=void 0}setCreationCompleted(){this._creationCompleted||(this._creationCompleted=!0)}creationCompleted(){return this.node.scene().loadingController.loaded()&&this._creationCompleted}onChildAdd(e){this._onChildAddCallbacks=this._onChildAddCallbacks||[],this._onChildAddCallbacks.push(e)}runOnChildAddCallbacks(e){this._runCallbacksWithChildNode(this._onChildAddCallbacks,e)}onChildRemove(e){this._onChildRemoveCallbacks=this._onChildRemoveCallbacks||[],this._onChildRemoveCallbacks.push(e)}runOnChildRemoveCallbacks(e){this._runCallbacksWithChildNode(this._onChildRemoveCallbacks,e)}onAfterCreated(e){this._onAfterCreatedCallbacks=this._onAfterCreatedCallbacks||[],this._onAfterCreatedCallbacks.push(e)}runOnAfterCreatedCallbacks(){this._runCallbacks(this._onAfterCreatedCallbacks)}onAfterAdded(e){this._onAfterAddedCallbacks=this._onAfterAddedCallbacks||[],this._onAfterAddedCallbacks.push(e)}runOnAfterAddedCallbacks(){this._runCallbacks(this._onAfterAddedCallbacks)}onBeforeDeleted(e){this._onBeforeDeletedCallbacks=this._onBeforeDeletedCallbacks||[],this._onBeforeDeletedCallbacks.push(e)}runOnBeforeDeleteCallbacks(){this._runCallbacks(this._onBeforeDeletedCallbacks)}onAfterDeleted(e){this._onAfterDeletedCallbacks=this._onAfterDeletedCallbacks||[],this._onAfterDeletedCallbacks.push(e)}runOnDeleteCallbacks(){this._runCallbacks(this._onAfterDeletedCallbacks)}_runCallbacks(e){if(!e)return;let t;for(t of e)t()}_runCallbacksWithChildNode(e,t){if(!e)return;let r;for(r of e)r(t)}};var or=(p=>(p.ANIM="anim",p.AUDIO="audio",p.COP="cop",p.EVENT="event",p.GL="gl",p.JS="js",p.MANAGER="manager",p.MAT="mat",p.OBJ="obj",p.POST="post",p.ROP="rop",p.SOP="sop",p))(or||{});var oh=(t=>(t.INPUT="subnetInput",t.OUTPUT="subnetOutput",t))(oh||{});var Kr=class{constructor(e){this._node=e}set_node(e){this._node=e}node(){return this._node}set_content(e){this._content=e,this._post_set_content()}has_content(){return this._content!=null}content(){return this._content}_post_set_content(){}coreContent(){return this._content}coreContentCloned(){return this._content}infos(){return[]}};var Q5=class extends Kr{set_content(e){super.set_content(e)}setTimelineBuilder(e){return this.set_content(e)}timelineBuilder(){return this.content()}coreContentCloned(){if(this._content)return this._content.clone()}};var e8=class extends Kr{setContent(e){super.set_content(e)}setAudioBuilder(e){return this.set_content(e)}audioBuilder(){return this.content()}coreContentCloned(){if(this._content)return this._content.clone()}};var t8=class extends Kr{set_content(e){super.set_content(e)}};var is=(i=>(i.OBJECT3D="Object3D",i.GROUP="Group",i.MESH="Mesh",i.POINTS="Points",i.LINE_SEGMENTS="LineSegments",i.LOD="LOD",i))(is||{});var ih=["Mesh","Points","LineSegments"],oGe=[{name:"Mesh",value:ih.indexOf("Mesh")},{name:"Points",value:ih.indexOf("Points")},{name:"LineSegments",value:ih.indexOf("LineSegments")}],JJ={MeshStandard:new Oi({color:16777215,side:eo,metalness:.5,roughness:.9}),Mesh:new Oi({color:16777215,side:eo,metalness:0,roughness:.9}),Points:new D0({color:16777215,size:.1,depthTest:!0}),LineSegments:new Wn({color:16777215,linewidth:1})};var y0=(t=>(t[t.NUMERIC=0]="NUMERIC",t[t.STRING=1]="STRING",t))(y0||{});var yc=(o=>(o[o.FLOAT=1]="FLOAT",o[o.VECTOR2=2]="VECTOR2",o[o.VECTOR3=3]="VECTOR3",o[o.VECTOR4=4]="VECTOR4",o))(yc||{});var VR={ATTRIB_CLASS:{VERTEX:0,OBJECT:1},OBJECT_TYPES:ih,CONSTRUCTOR_NAMES_BY_CONSTRUCTOR_NAME:{[Zo.name]:"Scene",[Tr.name]:"Group",[On.name]:"Object3D",[wr.name]:"Mesh",[Xo.name]:"Points",[$n.name]:"LineSegments",[il.name]:"Bone",[ol.name]:"SkinnedMesh"},CONSTRUCTORS_BY_NAME:{Mesh:wr,Points:Xo,LineSegments:$n},MATERIALS:JJ};var yi=(h=>(h.POINT_INDEX="ptnum",h.OBJECT_INDEX="objnum",h.COLOR="color",h.NORMAL="normal",h.POSITION="position",h.PSCALE="pscale",h.UP="up",h.UV="uv",h.SCALE="scale",h.TANGENT="tangent",h))(yi||{}),KJ={P:"position",N:"normal",Cd:"color"},Rn=class{static remapName(e){return KJ[e]||e}static arrayToIndexedArrays(e){let t={},r=0,o=[],s=[],i=0;for(;i<e.length;){let l=e[i],a=t[l];a!=null?o.push(a):(s.push(l),o.push(r),t[l]=r,r+=1),i++}return{indices:o,values:s}}static default_value(e){switch(e){case 1:return 0;case 2:return new re(0,0);case 3:return new F(0,0,0);default:throw`size ${e} not yet implemented`}}static copy(e,t,r=!0){let o=e?.array,s=t?.array;if(o&&s){let i=Math.min(o.length,s.length);for(let l=0;l<i;l++)s[l]=o[l];r&&(t.needsUpdate=!0)}}static attribSizeFromValue(e){if(ct.isString(e)||ct.isNumber(e))return yc.FLOAT;if(ct.isArray(e))return e.length;switch(e.constructor){case re:return yc.VECTOR2;case F:return yc.VECTOR3;case kt:return yc.VECTOR4}return 0}};var Mp=class{constructor(e){this._index=e}index(){return this._index}};var sh={POSITION:"position",NORMAL:"normal"};var ZJ={x:0,y:1,z:2,w:3,r:0,g:1,b:2},QJ=".",b0=class extends Mp{constructor(e,t){super(t);this._coreGeometry=e;this._geometry=this._coreGeometry.geometry()}applyMatrix4(e){this.position().applyMatrix4(e)}coreGeometry(){return this._coreGeometry}geometry(){return this._geometry=this._geometry||this._coreGeometry.geometry()}attribSize(e){return e=Rn.remapName(e),this._geometry.getAttribute(e).itemSize}hasAttrib(e){let t=Rn.remapName(e);return this._coreGeometry.hasAttrib(t)}attribValue(e,t){if(e===yi.POINT_INDEX)return this.index();{let r=null,o=null;e[e.length-2]===QJ&&(r=e[e.length-1],o=ZJ[r],e=e.substring(0,e.length-2));let s=Rn.remapName(e),i=this._geometry.getAttribute(s);if(i){let{array:l}=i;if(this._coreGeometry.isAttribIndexed(s))return this.indexedAttribValue(s);{let a=i.itemSize,c=this._index*a;if(o==null)switch(a){case 1:return l[c];case 2:return t=t||new re,t.fromArray(l,c),t;break;case 3:return t=t||new F,t.fromArray(l,c),t;break;case 4:return t=t||new kt,t.fromArray(l,c),t;break;default:throw`size not valid (${a})`}else switch(a){case 1:return l[c];default:return l[c+o]}}}else{let l=`attrib ${e} not found. availables are: ${Object.keys(this._geometry.attributes||{}).join(",")}`;throw console.warn(l),l}}}attribValueNumber(e){let t=Rn.remapName(e);return this._geometry.getAttribute(t).array[this._index]}attribValueVector2(e,t){let r=Rn.remapName(e),o=this._geometry.getAttribute(r);return t.fromArray(o.array,this._index*2),t}attribValueVector3(e,t){let r=Rn.remapName(e),o=this._geometry.getAttribute(r);return t.fromArray(o.array,this._index*3),t}attribValueVector4(e,t){let r=Rn.remapName(e),o=this._geometry.getAttribute(r);return t.fromArray(o.array,this._index*4),t}indexedAttribValue(e){let t=this.attribValueIndex(e);return this._coreGeometry.userDataAttrib(e)[t]}stringAttribValue(e){return this.indexedAttribValue(e)}attribValueIndex(e){return this._coreGeometry.isAttribIndexed(e)?this._geometry.getAttribute(e).array[this._index]:-1}isAttribIndexed(e){return this._coreGeometry.isAttribIndexed(e)}position(){return this._position||(this._position=this.getPosition(new F))}getPosition(e){let{array:t}=this._geometry.getAttribute(sh.POSITION);return e.fromArray(t,this._index*3)}setPosition(e){this.setAttribValueVector3(sh.POSITION,e)}normal(){return this._normal=this._normal||this.getNormal(new F)}getNormal(e){let{array:t}=this._geometry.getAttribute(sh.NORMAL);return e.fromArray(t,this._index*3)}setNormal(e){return this.setAttribValueVector3(sh.NORMAL,e)}setAttribValue(e,t){let r=this._geometry.getAttribute(e),o=r.array,s=r.itemSize;if(ct.isArray(t)){for(let i=0;i<s;i++)o[this._index*s+i]=t[i];return}switch(s){case 1:o[this._index]=t;break;case 2:let i=t,l=this._index*2;o[l+0]=i.x,o[l+1]=i.y;break;case 3:let a=t.r!=null,c=this._index*3;if(a){let p=t;o[c+0]=p.r,o[c+1]=p.g,o[c+2]=p.b}else{let p=t;o[c+0]=p.x,o[c+1]=p.y,o[c+2]=p.z}break;case 4:let h=t,g=this._index*4;o[g+0]=h.x,o[g+1]=h.y,o[g+2]=h.z,o[g+3]=h.w;break;default:throw console.warn(`Point.set_attrib_value does not yet allow attrib size ${s}`),`attrib size ${s} not implemented`}}setAttribValueFromNumber(e,t){let o=this._geometry.getAttribute(e).array;o[this._index]=t}setAttribValueFromVector2(e,t){let r=this._geometry.getAttribute(e);t.toArray(r.array,this._index*2)}setAttribValueFromVector3(e,t){let r=this._geometry.getAttribute(e);t.toArray(r.array,this._index*3)}setAttribValueFromVector4(e,t){let r=this._geometry.getAttribute(e);t.toArray(r.array,this._index*4)}setAttribValueVector3(e,t){if(t==null)return;if(e==null)throw"Point.set_attrib_value requires a name";let o=this._geometry.getAttribute(e).array,s=this._index*3;o[s]=t.x,o[s+1]=t.y,o[s+2]=t.z}setAttribIndex(e,t){let r=this._geometry.getAttribute(e).array;return r[this._index]=t}};var ah=function(n){return function(e){return Math.pow(e,n)}},lh=function(n){return function(e){return 1-Math.abs(Math.pow(e-1,n))}},r8=function(n){return function(e){return e<.5?ah(n)(e*2)/2:lh(n)(e*2-1)/2+.5}},ch={ease_i2:ah(2),ease_o2:lh(2),ease_io2:r8(2),ease_i3:ah(3),ease_o3:lh(3),ease_io3:r8(3),ease_i4:ah(4),ease_o4:lh(4),ease_io4:r8(4),ease_i_sin:function(n){return 1+Math.sin(Math.PI/2*n-Math.PI/2)},ease_o_sin:function(n){return Math.sin(Math.PI/2*n)},ease_io_sin:function(n){return(1+Math.sin(Math.PI*n-Math.PI/2))/2},ease_i_elastic:function(n){return n==0?0:(.04-.04/n)*Math.sin(25*n)+1},ease_o_elastic:function(n){return n==1?1:.04*n/--n*Math.sin(25*n)},ease_io_elastic:function(n){return n==.5?0:(n-=.5)<0?(.02+.01/n)*Math.sin(50*n):(.02-.01/n)*Math.sin(50*n)+1}};var zR=Math.PI/180,eK=12.9898,tK=78.233,rK=43758.5453,bi=class{static clamp(e,t,r){return e<t?t:e>r?r:e}static fit01(e,t,r){return this.fit(e,0,1,t,r)}static fit(e,t,r,o,s){let i=r-t,l=s-o;return(e-t)/i*l+o}static blend(e,t,r){return(1-r)*e+r*t}static degrees_to_radians(e){return e*zR}static radians_to_degrees(e){return e/zR}static deg2rad(e){return this.degrees_to_radians(e)}static rad2deg(e){return this.radians_to_degrees(e)}static rand(e){return ct.isNumber(e)?this.randFloat(e):this.randVec2(e)}static round(e,t){let r=e/t;return(e<0?Math.ceil(r):Math.floor(r))*t}static highest_even(e){return 2*Math.ceil(e*.5)}static randFloat(e,t=136574){return this._vec.x=e,this._vec.y=t,this.randVec2(this._vec)}static randVec2(e){let r=(e.x*eK+e.y*tK)%Math.PI;return this.fract(Math.sin(r)*rK)}static geodesic_distance(e,t){var r=6371e3,o=this.deg2rad(e.lat),s=this.deg2rad(t.lat),i=this.deg2rad(t.lat-e.lat),l=this.deg2rad(t.lng-e.lng),a=Math.sin(i/2)*Math.sin(i/2)+Math.cos(o)*Math.cos(s)*Math.sin(l/2)*Math.sin(l/2),c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)),h=r*c;return h}static expand_triangle(e,t){e.getMidpoint(this._triangle_mid),this._triangle_mid_to_corner.copy(e.a).sub(this._triangle_mid),this._triangle_mid_to_corner.normalize().multiplyScalar(t),e.a.add(this._triangle_mid_to_corner),this._triangle_mid_to_corner.copy(e.b).sub(this._triangle_mid),this._triangle_mid_to_corner.normalize().multiplyScalar(t),e.b.add(this._triangle_mid_to_corner),this._triangle_mid_to_corner.copy(e.c).sub(this._triangle_mid),this._triangle_mid_to_corner.normalize().multiplyScalar(t),e.c.add(this._triangle_mid_to_corner)}static nearestPower2(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.log(2)))}};bi.Easing=ch,bi.fract=e=>e-Math.floor(e),bi._vec={x:0,y:136574},bi._triangle_mid=new F,bi._triangle_mid_to_corner=new F;var n8=class{constructor(e,t){this._coreGeometry=e;this._index=t;this._geometry=this._coreGeometry.geometry()}index(){return this._index}points(){return this._points=this._points||this._get_points()}applyMatrix4(e){for(let t of this.points())t.applyMatrix4(e)}_get_points(){let e=this._geometry.index?.array||[],t=this._index*3;return[new b0(this._coreGeometry,e[t+0]),new b0(this._coreGeometry,e[t+1]),new b0(this._coreGeometry,e[t+2])]}positions(){return this._positions=this._positions||this._getPositions()}_getPositions(){let e=this.points();return[e[0].position(),e[1].position(),e[2].position()]}triangle(){return this._triangle=this._triangle||this._get_triangle()}_get_triangle(){let e=this.positions();return new I0(e[0],e[1],e[2])}deltas(){return this._deltas=this._deltas||this._getDeltas()}_getDeltas(){let e=this.positions();return[e[1].clone().sub(e[0]),e[2].clone().sub(e[0])]}area(){return this.triangle().getArea()}center(e){let t=this.positions();return e.x=(t[0].x+t[1].x+t[2].x)/3,e.y=(t[0].y+t[1].y+t[2].y)/3,e.z=(t[0].z+t[1].z+t[2].z)/3,e}randomPosition(e){let t=[bi.randFloat(e),bi.randFloat(e*6541)];return t[0]+t[1]>1&&(t[0]=1-t[0],t[1]=1-t[1]),this.positions()[0].clone().add(this.deltas()[0].clone().multiplyScalar(t[0])).add(this.deltas()[1].clone().multiplyScalar(t[1]))}attribValueAtPosition(e,t){let r=new F;this.triangle().getBarycoord(t,r);let o=r.toArray(),i=this._geometry.attributes[e].itemSize,l=this.points().map(g=>g.attribValue(e)),a,c,h=0;switch(i){case 1:{c=0;for(let g of l)c+=g*o[h],h++;a=c;break}default:{for(let g of l){let p=g.multiplyScalar(o[h]);c?c.add(p):c=p,h++}a=c}}return a}static interpolatedValue(e,t,r,o){let s=[t.a,t.b,t.c],l=e.getAttribute("position").array,a=s.map(m=>new F(l[m*3+0],l[m*3+1],l[m*3+2])),c=o.itemSize,h=o.array,g=[];switch(c){case 1:g=s.map(m=>h[m]);break;case 2:g=s.map(m=>new re(h[m*2+0],h[m*2+1]));break;case 3:g=s.map(m=>new F(h[m*3+0],h[m*3+1],h[m*3+2]));break}let p=s.map((m,v)=>r.distanceTo(a[v])),u=xr.sum([p[0]*p[1],p[0]*p[2],p[1]*p[2]]),d=[p[1]*p[2]/u,p[0]*p[2]/u,p[0]*p[1]/u],f;switch(c){case 1:f=xr.sum(s.map((m,v)=>d[v]*g[v]));break;default:var _=s.map((m,v)=>g[v].multiplyScalar(d[v]));f=null;for(let m of _)f?f.add(m):f=m}return f}};var Ea=class{from_points(e){e=this._filter_points(e);let t=new Gt,r=new No(t),o=e[0];if(o!=null){let s=o.geometry(),i=o.coreGeometry(),l={};for(let h=0;h<e.length;h++)l[e[h].index()]=h;let a=this._indices_from_points(l,s);a&&t.setIndex(a);let{attributes:c}=s;for(let h of Object.keys(c))if(i.userDataAttribs()[h]!=null){let u=xr.uniq(e.map(_=>_.indexedAttribValue(h))),d={};u.forEach((_,m)=>d[_]=m),r.userDataAttribs()[h]=u;let f=[];for(let _ of e){let m=d[_.indexedAttribValue(h)];f.push(m)}t.setAttribute(h,new _t(f,1))}else{let u=c[h].itemSize,d=new Array(e.length*u);switch(u){case 1:for(let _=0;_<e.length;_++)d[_]=e[_].attribValue(h);break;default:let f;for(let _=0;_<e.length;_++)f=e[_].attribValue(h),f.toArray(d,_*u);break}t.setAttribute(h,new _t(d,u))}}return t}};var o8=class extends Ea{_filter_points(e){return e}_indices_from_points(e,t){let r=t.index;if(r!=null){let o=r.array,s=[],i,l;for(let a=0;a<o.length;a++)i=o[a],l=e[i],l!=null&&s.push(l);return s}}};function HR(n,e=!1){let t=n[0].index!==null,r=new Set(Object.keys(n[0].attributes)),o=new Set(Object.keys(n[0].morphAttributes)),s={},i={},l=n[0].morphTargetsRelative,a=new Gt,c=0;for(let h=0;h<n.length;++h){let g=n[h],p=0;if(t!==(g.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let u in g.attributes){if(!r.has(u))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+'. All geometries must have compatible attributes; make sure "'+u+'" attribute exists among all geometries, or in none of them.'),null;s[u]===void 0&&(s[u]=[]),s[u].push(g.attributes[u]),p++}if(p!==r.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". Make sure all geometries have the same number of attributes."),null;if(l!==g.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let u in g.morphAttributes){if(!o.has(u))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+".  .morphAttributes must be consistent throughout all geometries."),null;i[u]===void 0&&(i[u]=[]),i[u].push(g.morphAttributes[u])}if(a.userData.mergedUserData=a.userData.mergedUserData||[],a.userData.mergedUserData.push(g.userData),e){let u;if(t)u=g.index.count;else if(g.attributes.position!==void 0)u=g.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". The geometry must have either an index or a position attribute"),null;a.addGroup(c,u,h),c+=u}}if(t){let h=0,g=[];for(let p=0;p<n.length;++p){let u=n[p].index;for(let d=0;d<u.count;++d)g.push(u.getX(d)+h);h+=n[p].attributes.position.count}a.setIndex(g)}for(let h in s){let g=jR(s[h]);if(!g)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+h+" attribute."),null;a.setAttribute(h,g)}for(let h in i){let g=i[h][0].length;if(g===0)break;a.morphAttributes=a.morphAttributes||{},a.morphAttributes[h]=[];for(let p=0;p<g;++p){let u=[];for(let f=0;f<i[h].length;++f)u.push(i[h][f][p]);let d=jR(u);if(!d)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+h+" morphAttribute."),null;a.morphAttributes[h].push(d)}}return a}function jR(n){let e,t,r,o=0;for(let l=0;l<n.length;++l){let a=n[l];if(a.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(e===void 0&&(e=a.array.constructor),e!==a.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(t===void 0&&(t=a.itemSize),t!==a.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(r===void 0&&(r=a.normalized),r!==a.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;o+=a.array.length}let s=new e(o),i=0;for(let l=0;l<n.length;++l)s.set(n[l].array,i),i+=n[l].array.length;return new lo(s,t,r)}var nK="position",i8=class{static createIndexIfNone(e){if(!e.index){let t=e.getAttribute(nK);if(t){let r=t.array;e.setIndex(xr.range(r.length/3))}}}};var uh=class{static merge(e){if(e.length===0)return;for(let l of e)i8.createIndexIfNone(l);let t=e.map(l=>new No(l)),r=t[0].indexedAttributeNames(),o={};for(let l of r){let a={},c=[];for(let g of t){let p=g.points();for(let u of p){c.push(u);let d=u.indexedAttribValue(l);a[d]!=null?a[d]:a[d]=Object.keys(a).length}}let h=Object.keys(a);for(let g of c){let p=g.indexedAttribValue(l),u=a[p];g.setAttribIndex(l,u)}o[l]=h}let s=HR(e),i=new No(s);return Object.keys(o).forEach(l=>{let a=o[l];i.setIndexedAttributeValues(l,a)}),s&&delete s.userData.mergedUserData,s}};var s8=class extends Ea{_filter_points(e){let t=e[0];if(t){let o=t.geometry().getIndex()?.array;if(o){let s={};for(let g of e)s[g.index()]=g;let i=[],l=o.length,a,c,h;for(let g=0;g<l;g+=3)a=s[o[g+0]],c=s[o[g+1]],h=s[o[g+2]],a&&c&&h&&(i.push(a),i.push(c),i.push(h));return i}}return[]}_indices_from_points(e,t){let r=t.index;if(r!=null){let o=r.array,s=[],i,l,a,c,h,g;for(let p=0;p<o.length;p+=3)i=o[p+0],l=o[p+1],a=o[p+2],c=e[i],h=e[l],g=e[a],c!=null&&h!=null&&g!=null&&(s.push(c),s.push(h),s.push(g));return s}}};var a8=class extends Ea{_filter_points(e){let t=e[0];if(t){let o=t.geometry().getIndex()?.array;if(o){let s={};for(let h of e)s[h.index()]=h;let i=[],l=o.length,a,c;for(let h=0;h<l;h+=2)a=s[o[h+0]],c=s[o[h+1]],a&&c&&(i.push(a),i.push(c));return i}}return[]}_indices_from_points(e,t){let r=t.index;if(r!=null){let o=r.array,s=[],i,l,a,c;for(let h=0;h<o.length;h+=2)i=o[h],l=o[h+1],a=e[i],c=e[l],a!=null&&c!=null&&(s.push(a),s.push(c));return s}}};var qR="isInstance",WR="indexed_attrib_values",bc=class{constructor(e){this._geometry=e}dispose(){}geometry(){return this._geometry}uuid(){return this._geometry.uuid}boundingBox(){return this._bounding_box=this._bounding_box||this._create_bounding_box()}_create_bounding_box(){if(this._geometry.computeBoundingBox(),this._geometry.boundingBox)return this._geometry.boundingBox}markAsInstance(){this._geometry.userData[qR]=!0}static markedAsInstance(e){return e.userData[qR]===!0}markedAsInstance(){return bc.markedAsInstance(this._geometry)}positionAttribName(){let e="position";return this.markedAsInstance()&&(e="instancePosition"),e}computeVertexNormals(){this._geometry.computeVertexNormals()}userDataAttribs(){return this._geometry.userData[WR]=this._geometry.userData[WR]||{}}indexedAttributeNames(){return Object.keys(this.userDataAttribs()||{})}userDataAttrib(e){return e=Rn.remapName(e),this.userDataAttribs()[e]}isAttribIndexed(e){return e=Rn.remapName(e),this.userDataAttrib(e)!=null}hasAttrib(e){return e===yi.POINT_INDEX?!0:(e=Rn.remapName(e),this._geometry.attributes[e]!=null)}markAttribAsNeedsUpdate(e){e=Rn.remapName(e);let t=this._geometry.attributes[e];t&&(t.needsUpdate=!0)}attribType(e){return this.isAttribIndexed(e)?y0.STRING:y0.NUMERIC}static attribNames(e){return Object.keys(e.attributes)}attribNames(){return bc.attribNames(this._geometry)}static attribNamesMatchingMask(e,t){let r=Lr.attribNames(t),o=[];for(let s of this.attribNames(e))for(let i of r)Lr.matchMask(s,i)&&o.push(s);return xr.uniq(o)}attribSizes(){let e={};for(let t of this.attribNames())e[t]=this._geometry.attributes[t].itemSize;return e}attribSize(e){let t;return e=Rn.remapName(e),(t=this._geometry.attributes[e])!=null?t.itemSize:e===yi.POINT_INDEX?1:0}setIndexedAttributeValues(e,t){this.userDataAttribs()[e]=t}setIndexedAttribute(e,t,r){this.setIndexedAttributeValues(e,t),this._geometry.setAttribute(e,new rl(r,1)),this._geometry.getAttribute(e).needsUpdate=!0}addNumericAttrib(e,t=1,r=0){let o=[],s=!1;if(ct.isNumber(r)){for(let i=0;i<this.pointsCount();i++)for(let l=0;l<t;l++)o.push(r);s=!0}else if(t>1)if(ct.isArray(r)){for(let i=0;i<this.pointsCount();i++)for(let l=0;l<t;l++)o.push(r[l]);s=!0}else{let i=r;if(t==2&&i.x!=null&&i.y!=null){for(let h=0;h<this.pointsCount();h++)o.push(i.x),o.push(i.y);s=!0}let l=r;if(t==3&&l.x!=null&&l.y!=null&&l.z!=null){for(let h=0;h<this.pointsCount();h++)o.push(l.x),o.push(l.y),o.push(l.z);s=!0}let a=r;if(t==3&&a.r!=null&&a.g!=null&&a.b!=null){for(let h=0;h<this.pointsCount();h++)o.push(a.r),o.push(a.g),o.push(a.b);s=!0}let c=r;if(t==4&&c.x!=null&&c.y!=null&&c.z!=null&&c.w!=null){for(let h=0;h<this.pointsCount();h++)o.push(c.x),o.push(c.y),o.push(c.z),o.push(c.w);s=!0}}if(s)this._geometry.setAttribute(e.trim(),new _t(o,t));else throw console.warn(r),`CoreGeometry.add_numeric_attrib error: no other default value allowed for now in add_numeric_attrib (default given: ${r})`}initPositionAttribute(e,t){let r=[];t==null&&(t=new F);for(let o=0;o<e;o++)r.push(t.x),r.push(t.y),r.push(t.z);return this._geometry.setAttribute("position",new _t(r,3))}addAttribute(e,t){switch(t.type()){case y0.STRING:return console.log("TODO: to implement");case y0.NUMERIC:return this.addNumericAttrib(e,t.size())}}renameAttrib(e,t){this.isAttribIndexed(e)&&(this.userDataAttribs()[t]=Jn.clone(this.userDataAttribs()[e]),delete this.userDataAttribs()[e]);let r=this._geometry.getAttribute(e);return this._geometry.setAttribute(t.trim(),new _t(r.array,r.itemSize)),this._geometry.deleteAttribute(e)}deleteAttribute(e){return this.isAttribIndexed(e)&&delete this.userDataAttribs()[e],this._geometry.deleteAttribute(e)}clone(){return bc.clone(this._geometry)}static clone(e){let t,r=e.clone();return(t=e.userData)!=null&&(r.userData=Jn.cloneDeep(t)),r}pointsCount(){return bc.pointsCount(this._geometry)}static pointsCount(e){let t,r=0,o=new this(e),s="position";if(o.markedAsInstance()&&(s="instancePosition"),(t=e.getAttribute(s))!=null){let i;(i=t.array)!=null&&(r=i.length/3)}return r}points(){return this.pointsFromGeometry()}pointsFromGeometry(){let e=[],t=this._geometry.getAttribute(this.positionAttribName());if(t!=null){let r=t.array.length/3;for(let o=0;o<r;o++){let s=new b0(this,o);e.push(s)}}return e}static geometryFromPoints(e,t){switch(t){case is.MESH:return this._mesh_builder.from_points(e);case is.POINTS:return this._points_builder.from_points(e);case is.LINE_SEGMENTS:return this._lines_segment_builder.from_points(e);case is.OBJECT3D:return null;case is.GROUP:return null;case is.LOD:return null}v0.unreachable(t)}static mergeGeometries(e){return uh.merge(e)}static merge_geometries(e){return uh.merge(e)}segments(){let e=this.geometry().index?.array||[];return xr.chunk(e,2)}faces(){return this.facesFromGeometry()}facesFromGeometry(){let t=(this.geometry().index?.array||[]).length/3;return xr.range(t).map(r=>new n8(this,r))}},No=bc;No._mesh_builder=new s8,No._points_builder=new o8,No._lines_segment_builder=new a8;var $R="POLY_render_hook",oK=(n,e,t,r,o,s)=>{},l8=class{static node(e,t){return e.node(t.name)}static clone(e){let t=e.clone(),r=e.uniforms;return r&&(t.uniforms=ll.clone(r)),t}static add_user_data_render_hook(e,t){e.userData[$R]=t}static apply_render_hook(e,t){if(t.userData){let r=t.userData[$R];if(r){e.onBeforeRender=(o,s,i,l,a,c)=>{r(o,s,i,l,a,c,e)};return}}e.onBeforeRender=oK}static applyCustomMaterials(e,t){let r=t;if(r.customMaterials)for(let o of Object.keys(r.customMaterials)){let s=o,i=r.customMaterials[s];i&&(e[s]=i,i.needsUpdate=!0)}}static assign_custom_uniforms(e,t,r){let o=e;if(o.customMaterials)for(let s of Object.keys(o.customMaterials)){let i=s,l=o.customMaterials[i];l&&(l.uniforms[t].value=r)}}static init_custom_material_uniforms(e,t,r){let o=e;if(o.customMaterials)for(let s of Object.keys(o.customMaterials)){let i=s,l=o.customMaterials[i];l&&(l.uniforms[t]=l.uniforms[t]||r)}}};var c8="name",x0="attributes",C0=class extends Mp{constructor(e,t){super(t);this._object=e;this._object.userData[x0]==null&&(this._object.userData[x0]={})}dispose(){}object(){return this._object}geometry(){return this._object.geometry}coreGeometry(){let e=this.geometry();return e?new No(e):null}points(){return this.coreGeometry()?.points()||[]}pointsFromGroup(e){if(e){let t=Lr.indices(e);if(t){let r=this.points();return xr.compact(t.map(o=>r[o]))}else return[]}else return this.points()}static isInGroup(e,t){let r=e.trim();if(r.length==0)return!0;let o=r.split("="),s=o[0];if(s[0]=="@"){let i=s.substr(1),l=o[1],a=this.attribValue(t,i);return l==a}return!1}computeVertexNormals(){this.coreGeometry()?.computeVertexNormals()}static _convert_array_to_vector(e){switch(e.length){case 1:return e[0];case 2:return new re(e[0],e[1]);case 3:return new F(e[0],e[1],e[2]);case 4:return new kt(e[0],e[1],e[2],e[3])}}static addAttribute(e,t,r){if(ct.isArray(r)&&!this._convert_array_to_vector(r)){let l="attribute_value invalid";throw console.error(l,r),new Error(l)}let o=r,s=e.userData;s[x0]=s[x0]||{},s[x0][t]=o}addAttribute(e,t){C0.addAttribute(this._object,e,t)}addNumericAttrib(e,t){this.addAttribute(e,t)}setAttribValue(e,t){this.addAttribute(e,t)}addNumericVertexAttrib(e,t,r){r==null&&(r=Rn.default_value(t)),this.coreGeometry()?.addNumericAttrib(e,t,r)}attributeNames(){return Object.keys(this._object.userData[x0])}attribNames(){return this.attributeNames()}hasAttrib(e){return this.attributeNames().includes(e)}renameAttrib(e,t){let r=this.attribValue(e);r!=null?(this.addAttribute(t,r),this.deleteAttribute(e)):console.warn(`attribute ${e} not found`)}deleteAttribute(e){delete this._object.userData[x0][e]}static attribValue(e,t,r=0,o){if(t===yi.OBJECT_INDEX)return r;if(e.userData&&e.userData[x0]){let s=e.userData[x0][t];if(s==null){if(t==c8)return e.name}else if(ct.isArray(s)&&o)return o.fromArray(s),o;return s}if(t==c8)return e.name}static stringAttribValue(e,t,r=0){let o=this.attribValue(e,t,r);if(o!=null)return ct.isString(o)?o:`${o}`}attribValue(e,t){return C0.attribValue(this._object,e,this._index,t)}stringAttribValue(e){return C0.stringAttribValue(this._object,e,this._index)}name(){return this.attribValue(c8)}humanType(){return VR.CONSTRUCTOR_NAMES_BY_CONSTRUCTOR_NAME[this._object.constructor.name]}attribTypes(){let e={};for(let t of this.attribNames()){let r=this.attribType(t);r!=null&&(e[t]=r)}return e}attribType(e){let t=this.attribValue(e);return ct.isString(t)?y0.STRING:y0.NUMERIC}attribSizes(){let e={};for(let t of this.attribNames()){let r=this.attribSize(t);r!=null&&(e[t]=r)}return e}attribSize(e){let t=this.attribValue(e);return t==null?null:Rn.attribSizeFromValue(t)}clone(){return C0.clone(this._object)}static clone(e){let t=e.clone();var r=new Map,o=new Map;return C0.parallelTraverse(e,t,function(s,i){r.set(i,s),o.set(s,i)}),t.traverse(function(s){let i=r.get(s),l=s;if(l.geometry&&i&&i.geometry){let g=i.geometry;l.geometry=No.clone(g);let p=l.geometry;p.userData&&(p.userData=Jn.cloneDeep(g.userData))}if(l.material){l8.applyCustomMaterials(s,l.material);let g=l.material;g.color==null&&(g.color=new Ke(1,1,1))}if(i){i.userData&&(s.userData=Jn.cloneDeep(i.userData));let g=i;g.animations&&(s.animations=g.animations.map(u=>u.clone()));let p=s;if(p.isSkinnedMesh){var a=p,c=i,h=c.skeleton.bones;a.skeleton=c.skeleton.clone(),a.bindMatrix.copy(c.bindMatrix);let u=h.map(function(d){return o.get(d)});a.skeleton.bones=u,a.bind(a.skeleton,a.bindMatrix)}}}),t}static parallelTraverse(e,t,r){r(e,t);for(var o=0;o<e.children.length;o++)this.parallelTraverse(e.children[o],t.children[o],r)}};var u8=class extends Kr{coreContentCloned(){if(this._content)return this._content.clone()}set_content(e){super.set_content(e)}firstObject(){if(this._content)return this._content.objects()[0]}firstCoreObject(){let e=this.firstObject();if(e)return new C0(e,0)}firstGeometry(){let e=this.firstObject();return e?e.geometry:null}objectsCount(){return this._content?this._content.objects().length:0}objectsVisibleCount(){let e=0;if(this._content){let t=this._content.objects();for(let r of t)r.visible&&e++}return e}objectsCountByType(){let e={},t=this._content;if(this._content&&t)for(let r of t.coreObjects()){let o=r.humanType();e[o]==null&&(e[o]=0),e[o]+=1}return e}objectsNamesByType(){let e={},t=this._content;if(this._content&&t)for(let r of t.coreObjects()){let o=r.humanType();e[o]=e[o]||[],e[o].push(r.name())}return e}pointAttributeNames(){let e=[],t=this.firstGeometry();return t&&(e=Object.keys(t.attributes)),e}pointAttributeSizesByName(){let e={},t=this.firstGeometry();return t&&Object.keys(t.attributes).forEach(r=>{let o=t.attributes[r];e[r]=o.itemSize}),e}objectAttributeSizesByName(){let e={},t=this.firstCoreObject();if(t){let r=t.attribNames();for(let o of r){let s=t.attribSize(o);s!=null&&(e[o]=s)}}return e}pointAttributeTypesByName(){let e={},t=this.firstGeometry();if(t){let r=new No(t);Object.keys(t.attributes).forEach(o=>{e[o]=r.attribType(o)})}return e}objectAttributeTypesByName(){let e={},t=this.firstCoreObject();if(t)for(let r of t.attribNames())e[r]=t.attribType(r);return e}objectAttributeNames(){let e=[],t=this.firstObject();return t&&(e=Object.keys(t.userData.attributes||{})),e}pointsCount(){return this._content?this._content.pointsCount():0}totalPointsCount(){return this._content?this._content.totalPointsCount():0}objectsData(){return this._content?this._content.objectsData():[]}boundingBox(e=!1){return this._content.boundingBox(e)}center(){return this._content.center()}size(){return this._content.size()}};var p8=class extends Kr{object(){return this._content}};var d8=class extends Kr{object(){return this._content}};var f8=class extends Kr{set_content(e){super.set_content(e)}};var m8=class extends Kr{set_content(e){super.set_content(e)}set_material(e){this._content!=null&&this._content.dispose(),this.set_content(e)}has_material(){return this.has_content()}material(){return this.content()}};var h8=class extends Kr{set_content(e){super.set_content(e)}set_object(e){return this.set_content(e)}has_object(){return this.has_content()}object(){return this.content()}};var _8=class extends Kr{set_content(e){super.set_content(e)}texture(){return this._content}coreContent(){return this._content}coreContentCloned(){let e=this._content?.clone();return e&&(e.needsUpdate=!0),e}object(){return this.texture()}infos(){if(this._content!=null)return[this._content]}resolution(){if(this._content){let e=this._content.image;if(e){if(e instanceof HTMLImageElement||e instanceof Image||e instanceof ImageData||e instanceof HTMLCanvasElement)return[e.width,e.height];if(e.data&&e.width!=null&&e.height!=null)return[e.width,e.height];let t=e;return[t.videoWidth,t.videoHeight]}}return[-1,-1]}};var g8=class extends Kr{set_content(e){super.set_content(e)}render_pass(){return this._content}object(e={}){return this.render_pass()}};var v8=class extends Kr{set_content(e){super.set_content(e)}renderer(){return this._content}};var YR={[or.ANIM]:Q5,[or.AUDIO]:e8,[or.COP]:_8,[or.EVENT]:t8,[or.GL]:p8,[or.JS]:d8,[or.MANAGER]:f8,[or.MAT]:m8,[or.OBJ]:h8,[or.POST]:g8,[or.ROP]:v8,[or.SOP]:u8};var y8=class{constructor(e){this.node=e;this._callbacks=[];this._callbacks_tmp=[];let t=YR[e.context()];this._container=new t(this.node)}container(){return this._container}containerUnlessBypassed(){if(this.node.flags?.bypass?.active()){let e=this.node.io.inputs.input(0);if(e)return e.containerController.containerUnlessBypassed()}else return this.container()}async compute(){if(this.node.flags?.bypass?.active()){let e=await this.requestInputContainer(0)||this._container;return this.node.cookController.endCook(),e}return this.node.isDirty()?new Promise((e,t)=>{if(this._callbacks.push(e),this.node.flags?.bypass?.active())throw"we should not be here";this.node.cookController.cookMain()}):this._container}async requestInputContainer(e){let t=this.node.io.inputs.input(e);return t?await t.compute():(this.node.states.error.set(`input ${e} required`),this.notifyRequesters(),null)}notifyRequesters(e){this._callbacks_tmp=this._callbacks.slice(),this._callbacks.splice(0,this._callbacks.length),e||(e=this.node.containerController.container());let t;for(;t=this._callbacks_tmp.pop();)t(e);this.node.scene().cookController.removeNode(this.node)}};var xc=er.performance.performanceManager(),b8=class{constructor(e){this.cookController=e;this._inputsStart=0;this._inputsTime=0;this._paramsStart=0;this._paramsTime=0;this._cookStart=0;this._cookTime=0;this._cooksCount=0;this._data={inputsTime:0,paramsTime:0,cookTime:0}}cooksCount(){return this._cooksCount}data(){return this._data.inputsTime=this._inputsTime,this._data.paramsTime=this._paramsTime,this._data.cookTime=this._cookTime,this._data}active(){return this.cookController.performanceRecordStarted()}recordInputsStart(){this.active()&&(this._inputsStart=xc.now())}recordInputsEnd(){this.active()&&(this._inputsTime=xc.now()-this._inputsStart)}recordParamsStart(){this.active()&&(this._paramsStart=xc.now())}recordParamsEnd(){this.active()&&(this._paramsTime=xc.now()-this._paramsStart)}recordCookStart(){this.active()&&(this._cookStart=xc.now())}recordCookEnd(){this.active()&&(this._cookTime=xc.now()-this._cookStart,this._cooksCount+=1)}};var x8=class{constructor(e){this.node=e;this._cooking=!1;this._performanceController=new b8(this);this._inputsEvaluationRequired=!0;this._corePerformance=this.node.scene().performance}performanceRecordStarted(){return this._corePerformance.started()}dispose(){this._clearHooks()}disallowInputsEvaluation(){this._inputsEvaluationRequired=!1}isCooking(){return this._cooking===!0}_startCookIfNoErrors(e){if(this.node.states.error.active())this.endCook();else try{this._performanceController.recordCookStart(),this.node.cook(e||[])}catch(t){this.node.states.error.set(`node internal error: '${t}'.`),er.warn(t),this.endCook()}}async cookMain(){if(this.isCooking())return;this._initCookingState(),this.node.states.error.clear(),this.node.scene().cookController.addNode(this.node);let e=this._inputsEvaluationRequired?await this._evaluateInputs():void 0;this.node.params.paramsEvalRequired()&&await this._evaluateParams(),this._startCookIfNoErrors(e)}async cookMainWithoutInputs(){if(this.node.scene().cookController.addNode(this.node),this.isCooking()){er.warn("cook_main_without_inputs already cooking",this.node.path());return}this._initCookingState(),this.node.states.error.clear(),this.node.params.paramsEvalRequired()&&await this._evaluateParams(),this._startCookIfNoErrors(void 0)}endCook(e){this._finalizeCookPerformance();let t=this.node.dirtyController.dirtyTimestamp();if(t==null||t===this._cookingDirtyTimestamp)this.node.removeDirtyState(),this._terminateCookProcess();else{if(this.node.flags?.bypass?.active())return;er.log("COOK AGAIN",t,this._cookingDirtyTimestamp,this.node.path()),this._cooking=!1,this.cookMain()}}_initCookingState(){this._cooking=!0,this._cookingDirtyTimestamp=this.node.dirtyController.dirtyTimestamp()}_terminateCookProcess(){this.isCooking()&&(this._cooking=!1,this.node.containerController.notifyRequesters(),this._run_on_cook_complete_hooks())}async _evaluateInputs(){this._performanceController.recordInputsStart();let e=this.node.io.inputs,t=this._inputsEvaluationRequired?e.isAnyInputDirty()?await e.evalRequiredInputs():e.containersWithoutEvaluation():[],r=e.inputs(),o=[],s;for(let i=0;i<r.length;i++)s=t[i],s&&(e.cloneRequired(i)?o[i]=s.coreContentCloned():o[i]=s.coreContent());return this._performanceController.recordInputsEnd(),o}async _evaluateParams(){this._performanceController.recordParamsStart(),await this.node.params.evalAll(),this._performanceController.recordParamsEnd()}cooksCount(){return this._performanceController.cooksCount()}cookTime(){return this._performanceController.data().cookTime}_finalizeCookPerformance(){!this._corePerformance.started()||(this._performanceController.recordCookEnd(),this._corePerformance.recordNodeCookData(this.node,this._performanceController.data()))}registerOnCookEnd(e,t){this._on_cook_complete_hook_names=this._on_cook_complete_hook_names||[],this._on_cook_complete_hooks=this._on_cook_complete_hooks||[],this._on_cook_complete_hook_names.push(e),this._on_cook_complete_hooks.push(t)}_clearHooks(){if(!(!this._on_cook_complete_hook_names||!this._on_cook_complete_hooks))for(let e of this._on_cook_complete_hook_names)this.deregisterOnCookEnd(e)}deregisterOnCookEnd(e){if(!this._on_cook_complete_hook_names||!this._on_cook_complete_hooks)return;let t=this._on_cook_complete_hook_names?.indexOf(e);this._on_cook_complete_hook_names.splice(t,1),this._on_cook_complete_hooks.splice(t,1),this._on_cook_complete_hook_names.length==0&&(this._on_cook_complete_hook_names=void 0),this._on_cook_complete_hooks.length==0&&(this._on_cook_complete_hooks=void 0)}_run_on_cook_complete_hooks(){if(this._on_cook_complete_hooks)for(let e of this._on_cook_complete_hooks)e()}onCookEndCallbackNames(){return this._on_cook_complete_hook_names}};var ph=class{constructor(e){this.node=e}dispose(){}toJSON(e=!1){let t={name:this.node.name(),type:this.node.type(),graph_node_id:this.node.graphNodeId(),is_dirty:this.node.isDirty(),ui_data_json:this.node.uiData.toJSON(),error_message:this.node.states.error.message(),children:this.childrenIds(),maxInputsCount:this.maxInputsCount(),inputs:this.inputIds(),input_connection_output_indices:this.inputConnectionOutputIndices(),named_input_connection_points:this.namedInputConnectionPoints(),named_output_connection_points:this.namedOutputConnectionPoints(),param_ids:this.to_json_params(e),override_cloned_state_allowed:this.node.io.inputs.overrideClonedStateAllowed(),inputs_clone_required_states:this.node.io.inputs.cloneRequiredStates(),flags:{display:this.node.flags?.display?.active(),bypass:this.node.flags?.bypass?.active(),optimize:this.node.flags?.optimize?.active()},selection:void 0};return this.node.childrenAllowed()&&this.node.childrenController&&(t.selection=this.node.childrenController.selection.toJSON()),t}childrenIds(){return this.node.children().map(e=>e.graphNodeId())}maxInputsCount(){return this.node.io.inputs.maxInputsCount()}inputIds(){return this.node.io.inputs.inputs().map(e=>e!=null?e.graphNodeId():void 0)}inputConnectionOutputIndices(){return this.node.io.connections.inputConnections()?.map(e=>e!=null?e.output_index:void 0)}namedInputConnectionPoints(){return this.node.io.inputs.namedInputConnectionPoints().map(e=>e.toJSON())}namedOutputConnectionPoints(){return this.node.io.outputs.namedOutputConnectionPoints().map(e=>e.toJSON())}to_json_params_from_names(e,t=!1){return e.map(r=>this.node.params.get(r).graphNodeId())}to_json_params(e=!1){return this.to_json_params_from_names(this.node.params.names,e)}};var Ge=(u=>(u.BOOLEAN="boolean",u.BUTTON="button",u.COLOR="color",u.FLOAT="float",u.FOLDER="folder",u.INTEGER="integer",u.PARAM_PATH="param_path",u.NODE_PATH="node_path",u.RAMP="ramp",u.STRING="string",u.VECTOR2="vector2",u.VECTOR3="vector3",u.VECTOR4="vector4",u))(Ge||{});var Zr=(i=>(i.VISIBLE_UPDATED="param_visible_updated",i.RAW_INPUT_UPDATED="raw_input_updated",i.VALUE_UPDATED="param_value_updated",i.EXPRESSION_UPDATED="param_expression_update",i.ERROR_UPDATED="param_error_updated",i.DELETED="param_deleted",i))(Zr||{});var dh="callback",C8="callbackString",iK="computeOnDirty",sK="cook",aK="fileBrowse",lK="type",cK="expression",uK="forEntities",pK="label",dK="level",fK="menu",mK="menuString",hK="entries",_K="multiline",gK="language",vK="nodeSelection",yK="context",bK="types",XR="dependentOnFoundNode",xK="range",CK="rangeLocked",TK="step",EK="spare",AK="texture",MK="env",JR="hidden",NK="field",T8="visibleIf",SK="conversion",PK="separatorBefore",OK="separatorAfter",wK="joinToPreviousParam",RK="editable";var fh=class{constructor(e){this._param=e;this._programatic_visible_state=!0;this._callbackAllowed=!1;this._updateVisibilityAndRemoveDirtyBound=this.updateVisibilityAndRemoveDirty.bind(this);this._ui_data_dependency_set=!1}dispose(){try{this._options[dh]=void 0,this._options[C8]=void 0}catch{}this._visibility_graph_node?.dispose()}set(e){this._default_options=e,this._options=Jn.cloneDeep(this._default_options),this.post_set_options()}copy(e){this._default_options=Jn.cloneDeep(e.default()),this._options=Jn.cloneDeep(e.current()),this.post_set_options()}setOption(e,t){if(this._options[e]=t,this._param.components)for(let r of this._param.components)r.options.setOption(e,t)}post_set_options(){this._handleComputeOnDirty()}param(){return this._param}node(){return this._param.node}default(){return this._default_options}current(){return this._options}hasOptionsOverridden(){return!Jn.isEqual(this._options,this._default_options)}overriddenOptions(){let e={},t=Object.keys(this._options);for(let r of t)if(!Jn.isEqual(this._options[r],this._default_options[r])){let o=Jn.cloneDeep(this._options[r]);Object.assign(e,{[r]:o})}return e}overriddenOptionNames(){return Object.keys(this.overriddenOptions())}computeOnDirty(){return this._options[iK]||!1}_handleComputeOnDirty(){this.computeOnDirty()&&(this._computeOnDirty_callback_added||(this.param().addPostDirtyHook("computeOnDirty",this._computeParam.bind(this)),this._computeOnDirty_callback_added=!0))}async _computeParam(){await this.param().compute()}hasCallback(){return this._options[dh]!=null||this._options[C8]!=null}allowCallback(){this._callbackAllowed=!0}executeCallback(){if(!this._callbackAllowed||!this.node())return;let e=this.getCallback();if(!e||!this.node().scene().loadingController.loaded())return;let t=this.param().parentParam();t?t.options.executeCallback():e(this.node(),this.param())}getCallback(){if(this.hasCallback())return this._options[dh]=this._options[dh]||this.createCallbackFromString()}createCallbackFromString(){let e=this._options[C8];if(e){let t=new Function("node","scene","window","location",e);return()=>{t(this.node(),this.node().scene(),null,null)}}}colorConversion(){return this._options[SK]}makesNodeDirtyWhenDirty(){if(this.param().parentParam()!=null)return!1;let e=this._options[sK];return e??!0}fileBrowseOption(){return this._options[aK]}fileBrowseAllowed(){return this.fileBrowseOption()!=null}fileBrowseType(){let e=this.fileBrowseOption();return e?e[lK]:null}separatorBefore(){return this._options[PK]}separatorAfter(){return this._options[OK]}joinToPreviousParam(){return this._options[wK]}editable(){let e=this._options[RK];return e??!0}isExpressionForEntities(){let e=this._options[cK];return e&&e[uK]||!1}level(){return this._options[dK]||0}hasMenu(){return this.menuOptions()!=null||this.menuStringOptions()!=null}menuOptions(){return this._options[fK]}menuStringOptions(){return this._options[mK]}menuEntries(){let e=this.menuOptions()||this.menuStringOptions();return e?e[hK]:[]}isMultiline(){return this._options[_K]===!0}language(){return this._options[gK]}isCode(){return this.language()!=null}nodeSelectionOptions(){return this._options[vK]}nodeSelectionContext(){let e=this.nodeSelectionOptions();if(e)return e[yK]}nodeSelectionTypes(){let e=this.nodeSelectionOptions();if(e)return e[bK]}dependentOnFoundNode(){return XR in this._options?this._options[XR]:!0}isSelectingParam(){return this.param().type()==Ge.PARAM_PATH}range(){return this._options[xK]||[0,1]}step(){return this._options[TK]}rangeLocked(){return this._options[CK]||[!1,!1]}ensureInRange(e){let t=this.range();return e>=t[0]&&e<=t[1]?e:e<t[0]?this.rangeLocked()[0]===!0?t[0]:e:this.rangeLocked()[1]===!0?t[1]:e}isSpare(){return this._options[EK]||!1}textureOptions(){return this._options[AK]}textureAsEnv(){let e=this.textureOptions();return e!=null?e[MK]===!0:!1}isHidden(){return this._options[JR]===!0||this._programatic_visible_state===!1}isVisible(){return!this.isHidden()}setVisibleState(e){this._options[JR]=!e,this.param().emit(Zr.VISIBLE_UPDATED)}label(){return this._options[pK]}isLabelHidden(){let e=this.param().type();return e===Ge.BUTTON||e===Ge.BOOLEAN&&this.isFieldHidden()}isFieldHidden(){return this._options[NK]===!1}uiDataDependsOnOtherParams(){return T8 in this._options}visibilityPredecessors(){let e=this._options[T8];if(!e)return[];let t=[];ct.isArray(e)?t=xr.uniq(e.map(o=>Object.keys(o)).flat()):t=Object.keys(e);let r=this.param().node;return xr.compact(t.map(o=>{let s=r.params.get(o);if(s)return s;console.error(`param ${o} not found as visibility condition for ${this.param().name()} in node ${this.param().node.type()}`)}))}setUiDataDependency(){if(this._ui_data_dependency_set)return;this._ui_data_dependency_set=!0;let e=this.visibilityPredecessors();if(e.length>0){this._visibility_graph_node=new Un(this.param().scene(),"param_visibility");for(let t of e)this._visibility_graph_node.addGraphInput(t);this._visibility_graph_node.addPostDirtyHook("_update_visibility_and_remove_dirty",this._updateVisibilityAndRemoveDirtyBound)}}updateVisibilityAndRemoveDirty(){this.updateVisibility(),this.param().removeDirtyState()}async updateVisibility(){let e=this._options[T8];if(e){let t=this.visibilityPredecessors(),r=t.map(o=>{if(o.isDirty())return o.compute()});if(this._programatic_visible_state=!1,await Promise.all(r),ct.isArray(e))for(let o of e)t.filter(i=>i.value==o[i.name()]).length==t.length&&(this._programatic_visible_state=!0);else{let o=t.filter(s=>s.value==e[s.name()]);this._programatic_visible_state=o.length==t.length}this.param().emit(Zr.VISIBLE_UPDATED)}}};var mh=class{constructor(e){this.param=e;this._blockedEmit=!1;this._blockedParentEmit=!1;this._countByEventName=new Map}emitAllowed(){return this._blockedEmit===!0||this.param.scene().loadingController.isLoading()?!1:this.param.scene().dispatchController.emitAllowed()}blockEmit(){if(this._blockedEmit=!0,this.param.isMultiple()&&this.param.components)for(let e of this.param.components)e.emitController.blockEmit();return!0}unblockEmit(){if(this._blockedEmit=!1,this.param.isMultiple()&&this.param.components)for(let e of this.param.components)e.emitController.unblockEmit();return!0}blockParentEmit(){return this._blockedParentEmit=!0,!0}unblockParentEmit(){return this._blockedParentEmit=!1,!0}incrementCount(e){let t=(this._countByEventName.get(e)||0)+1;this._countByEventName.set(e,t)}eventsCount(e){return this._countByEventName.get(e)||0}emit(e){if(this.emitAllowed()){this.param.emit(e);let t=this.param.parentParam();t!=null&&this._blockedParentEmit!==!0&&t.emit(e)}}};var E8=class{constructor(e){this.param=e}toJSON(){let e={name:this.param.name(),type:this.param.type(),raw_input:this.rawInput(),value:this.value(),value_pre_conversion:this.value_pre_conversion(),expression:this.expression(),graph_node_id:this.param.graphNodeId(),error_message:this.error_message(),is_visible:this.is_visible(),components:void 0};return this.param.isMultiple()&&this.param.components&&(e.components=this.param.components.map(t=>t.graphNodeId())),e}rawInput(){return this.param.rawInputSerialized()}value(){return this.param.valueSerialized()}value_pre_conversion(){return this.param.valuePreConversionSerialized()}expression(){return this.param.hasExpression()?this.param.expressionController?.expression():void 0}error_message(){return this.param.states.error.message()}is_visible(){return this.param.options.isVisible()}};var A8=class{constructor(e){this.param=e}active(){let e=this.param.scene().timeController.graphNode.graphNodeId();return this.param.graphPredecessorIds().includes(e)}};var M8=class{constructor(e){this.param=e}set(e){this._message!=e&&(this._message=e,this._message&&er.warn(this.param.path(),this._message),this.param.emitController.emit(Zr.ERROR_UPDATED))}message(){return this._message}clear(){this.set(void 0)}active(){return this._message!=null}};var N8=class{constructor(e){this.param=e;this.timeDependent=new A8(this.param);this.error=new M8(this.param)}};var Np=class extends Un{constructor(e,t,r){super(e.scene(),"MethodDependency");this.param=e;this.path_argument=t;this.decomposed_path=r;this._update_from_name_change_bound=this._update_from_name_change.bind(this);e.expressionController?.registerMethodDependency(this),this.addPostDirtyHook("_update_from_name_change",this._update_from_name_change_bound)}_update_from_name_change(e){if(e&&this.decomposed_path){let t=e;this.decomposed_path.update_from_name_change(t);let r=this.decomposed_path.to_path(),o=this.jsep_node;o&&(o.value=`${o.value}`.replace(`${this.path_argument}`,r),o.raw=o.raw.replace(`${this.path_argument}`,r)),this.param.expressionController&&this.param.expressionController.updateFromMethodDependencyNameChange()}}reset(){this.graphDisconnectPredecessors()}listen_for_name_changes(){if(this.jsep_node&&this.decomposed_path){for(let e of this.decomposed_path.named_nodes())if(e){let t=e;t.nameController&&this.addGraphInput(t.nameController.graph_node)}}}set_jsep_node(e){this.jsep_node=e}set_resolved_graph_node(e){this.resolved_graph_node=e}set_unresolved_path(e){this.unresolved_path=e}static create(e,t,r,o){let s=ct.isNumber(t),i=new Np(e,t,o);if(r)i.set_resolved_graph_node(r);else if(!s){let l=t;i.set_unresolved_path(l)}return i}};var LK=[],so=class extends Un{constructor(e,t){super(e,"BaseParam");this._options=new fh(this);this._emit_controller=new mh(this);this._isComputing=!1;this._node=t,this._initializeParam()}get options(){return this._options=this._options||new fh(this)}get emitController(){return this._emit_controller=this._emit_controller||new mh(this)}get expressionController(){return this._expression_controller}get serializer(){return this._serializer=this._serializer||new E8(this)}get states(){return this._states=this._states||new N8(this)}dispose(){let e=this.graphPredecessors();for(let r of e)r instanceof Np&&r.dispose();let t=this.graphSuccessors();for(let r of t)if(r instanceof so){let o=r.rawInputSerialized();r.set(r.defaultValue()),r.set(o)}else r.setDirty();this.scene().missingExpressionReferencesController.deregisterParam(this),this._expression_controller?.dispose(),super.dispose(),this._options?.dispose()}_initializeParam(){}static type(){return Ge.FLOAT}type(){return this.constructor.type()}isNumeric(){return!1}setName(e){super.setName(e)}get value(){return this._value}copyValue(e){e.type()==this.type()?this._copyValue(e):console.warn(`cannot copy value from ${e.type()} to ${this.type()}`)}_copyValue(e){throw"abstract method param._copy_value"}valuePreConversionSerialized(){}convert(e){return null}static areRawInputEqual(e,t){return!1}isRawInputEqual(e){return this.constructor.areRawInputEqual(this._raw_input,e)}static areValuesEqual(e,t){return!1}isValueEqual(e){return this.constructor.areValuesEqual(this.value,e)}_cloneRawInput(e){return e}set(e){this._raw_input=this._cloneRawInput(this._prefilterInvalidRawInput(e)),this.emitController.emit(Zr.RAW_INPUT_UPDATED),this.processRawInput()}_prefilterInvalidRawInput(e){return e}defaultValue(){return this._default_value}isDefault(){return this._raw_input==this._default_value}rawInput(){return this._raw_input}processRawInput(){}async compute(){if(this.scene().loadingController.isLoading()&&er.warn(`param attempt to compute ${this.path()} while scene is loading`),this.isDirty()){if(this._isComputing)return new Promise((e,t)=>{this._computeResolves=this._computeResolves||[],this._computeResolves.push(e)});if(this._isComputing=!0,await this.processComputation(),this._isComputing=!1,this._computeResolves){let e=[...this._computeResolves];this._computeResolves=[];for(let t of e)t()}}}async processComputation(){}setInitValue(e){this._default_value=this._cloneRawInput(this._prefilterInvalidRawInput(e))}_setupNodeDependencies(e){if(e?(this.options.allowCallback(),this.parentParam()||(this.options.makesNodeDirtyWhenDirty()?e.params.params_node?.addGraphInput(this,!1):this.dirtyController.addPostDirtyHook("run callback",async()=>{await this.compute(),this.options.executeCallback()}))):this._node&&this._node.params.params_node?.removeGraphInput(this),this.components)for(let t of this.components)t._setupNodeDependencies(e)}get node(){return this._node}parent(){return this.node}set_parent_param(e){e.addGraphInput(this,!1),this._parent_param=e}parentParam(){return this._parent_param}has_parent_param(){return this._parent_param!=null}path(){return this.node?.path()+"/"+this.name()}pathRelativeTo(e){let t=Ar.relativePath(e,this.node);return t.length>0?`${t}${Ar.SEPARATOR}${this.name()}`:this.name()}emit(e){this.emitController.emitAllowed()&&(this.emitController.incrementCount(e),this.scene().dispatchController.dispatch(this,e))}get components(){return this._components}componentNames(){return LK}isMultiple(){return this.componentNames().length>0}initComponents(){}hasExpression(){return this.expressionController!=null&&this.expressionController.active()}toJSON(){return this.serializer.toJSON()}};var Sp=Zi($9());Sp.default.addUnaryOp("@");var IK=10;Sp.default.addBinaryOp("**",IK);var DK="Identifier",BK="Literal",kK="CallExpression",FK="`",ss=class{constructor(){}parse_expression(e){try{this.reset(),this.node=(0,Sp.default)(e)}catch(t){let r=`could not parse the expression '${e}' (error: ${t})`;this.error_message=r}}parse_expression_for_string_param(e){try{this.reset();let t=ss.string_value_elements(e),r=[];for(let o=0;o<t.length;o++){let s=t[o],i;if(o%2==1)i=(0,Sp.default)(s);else{let l=s.replace(/\'/g,"\\'");i={type:BK,value:`'${l}'`,raw:`'${l}'`}}r.push(i)}this.node={type:kK,arguments:r,callee:{type:DK,name:"strConcat"}}}catch(t){let r=`could not parse the expression '${e}' (error: ${t})`;this.error_message=r}}static string_value_elements(e){return e!=null?ct.isString(e)?e.split(FK):[]:[]}reset(){this.node=void 0,this.error_message=void 0}};var S8=class{static if(e){let t=e[0],r=e[1],o=e[2];return`(${t}) ? (${r}) : (${o})`}};var P8="$",Pp=class{constructor(e){this.param=e;this._set_error_from_error_bound=this._set_error_from_error.bind(this)}clear_error(){this._error_message=void 0}set_error(e){this._error_message=this._error_message||e}_set_error_from_error(e){ct.isString(e)?this._error_message=e:this._error_message=e.message}is_errored(){return this._error_message!=null}error_message(){return this._error_message}reset(){this._error_message=void 0}traverse_node(e){let t=`traverse_${e.type}`;if(this[t])return this[t](e);this.set_error(`expression unknown node type: ${e.type}`)}traverse_BinaryExpression(e){return`${this.traverse_node(e.left)} ${e.operator} ${this.traverse_node(e.right)}`}traverse_LogicalExpression(e){return`${this.traverse_node(e.left)} ${e.operator} ${this.traverse_node(e.right)}`}traverse_MemberExpression(e){return`${this.traverse_node(e.object)}.${this.traverse_node(e.property)}`}traverse_ConditionalExpression(e){return`(${this.traverse_node(e.test)}) ? (${this.traverse_node(e.consequent)}) : (${this.traverse_node(e.alternate)})`}traverse_Compound(e){let t=e.body,r=[];for(let o=0;o<t.length;o++){let s=t[o];s.type=="Identifier"?s.name[0]==P8?r.push("`${"+this.traverse_node(s)+"}`"):r.push(`'${s.name}'`):r.push("`${"+this.traverse_node(s)+"}`")}return r.join(" + ")}traverse_Literal(e){return`${e.raw}`}};var KR="coreGeometry",xi=class{constructor(){}reset(){this._attributeNames&&this._attributeNames.clear()}assignAttributesLines(){if(this._attributeNames){let e=[];for(let t of this._attributeNames)e.push(xi.assignAttributeLine(t));return e.join(`;
`)}else return""}assignArraysLines(){if(this._attributeNames){let e=[];if(this._attributeNames.size>0){let t=`const ${KR} = entities[0].coreGeometry();`;e.push(t)}for(let t of this._attributeNames)e.push(xi.assignItemSizeLine(t)),e.push(xi.assignArrayLine(t));return e.join(`;
`)}else return""}attributePresenceCheckLine(){if(this._attributeNames){let e=[];for(let t of this._attributeNames){let r=xi._varAttribute(t);e.push(r)}if(e.length>0)return e.join(" && ")}return"true"}add(e){this._attributeNames=this._attributeNames||new Set,this._attributeNames.add(e)}static assignAttributeLine(e){return`const ${this._varAttribute(e)} = getEntitiesAttribute(entities,'${e}')`}static assignItemSizeLine(e){let t=this._varAttribute(e);return`const ${this._varAttribSize(e)} = ${t}.itemSize`}static assignArrayLine(e){let t=this._varAttribute(e),r=this._varArray(e),o=`${KR}.isAttribIndexed('${e}')`,s=`entities.map(e=>e.indexedAttribValue('${e}'))`,i=`${t}.array`;return`const ${r} = ${o} ? ${s} : ${i}`}static _varAttribute(e){return`attrib_${e}`}static _varAttribSize(e){return`attrib_size_${e}`}static _varArray(e){return`array_${e}`}varAttributeSize(e){return xi._varAttribSize(e)}varArray(e){return xi._varArray(e)}};var GK=["abs","acos","acosh","asin","asinh","atan","atan2","atanh","ceil","cos","cosh","exp","expm1","floor","log","log1p","log2","log10","max","min","pow","round","sign","sin","sinh","sqrt","tan","tanh"],UK=["cbrt","hypot","log10","trunc"],ZR={math_random:"random"},VK=["fit","fit01","fract","deg2rad","rad2deg","rand","clamp"],zK=Object.keys(ch),HK=["precision"],jK=["E","LN2","LN10","LOG10E","LOG2E","PI","SQRT1_2","SQRT2"],Aa={};GK.forEach(n=>{Aa[n]=`Math.${n}`});UK.forEach(n=>{Aa[n]=`Math.${n}`});Object.keys(ZR).forEach(n=>{let e=ZR[n];Aa[n]=`Math.${e}`});VK.forEach(n=>{Aa[n]=`Core.Math.${n}`});zK.forEach(n=>{Aa[n]=`Core.Math.Easing.${n}`});HK.forEach(n=>{Aa[n]=`Core.String.${n}`});var qK={if:S8.if},QR={};jK.forEach(n=>{QR[n]=`Math.${n}`});var Cc="'",eL=", ",WK="@",$K={x:0,y:1,z:2,w:3,r:0,g:1,b:2},YK={Math:bi,String:Lr},O8=class extends Pp{constructor(e){super(e);this.param=e;this._attribute_requirements_controller=new xi;this.methods=[];this.method_index=-1;this.methodDependencies=[];this.immutableDependencies=[]}parse_tree(e){if(this.reset(),e.error_message==null){try{if(this._attribute_requirements_controller=new xi,e.node){let t=this.traverse_node(e.node);t&&!this.is_errored()&&(this.function_main_string=t)}else console.warn("no parsed_tree.node")}catch(t){console.warn(`error in expression for param ${this.param.path()}`),console.warn(t)}if(this.function_main_string)try{let t=this._functionBody();this.function=new Function("CorePoint","Core","param","methods","_set_error_from_error",`
					try {
						${t}
					} catch(e) {
						_set_error_from_error(e)
						return null;
					}`)}catch(t){console.warn(t),this.set_error("cannot generate function")}else this.set_error("cannot generate function body")}else this.set_error("cannot parse expression")}reset(){super.reset(),this.function_main_string=void 0,this.methods=[],this.method_index=-1,this.function=void 0,this.methodDependencies=[],this.immutableDependencies=[]}_functionBody(){return this.param.options.isExpressionForEntities()?`
			const entities = param.expressionController.entities();
			function getEntitiesAttribute(entities, attribName){
				const firstEntity = entities[0];
				if(firstEntity instanceof CorePoint){
					return firstEntity.geometry().attributes[attribName];
				} else {
					return entities.map(e=>e.attribValue(attribName));
				}
			}
			function getCorePointAttribValue(entity, attribName, array, attributeSize, propertyOffset){
				return array[entity.index()*attributeSize+propertyOffset];
			}
			function getCoreObjectAttribValue(entity, attribName, array, attributeSize, propertyOffset){
				return entity.attribValue(attribName)
			}
			if(entities){
				return new Promise( async (resolve, reject)=>{
					let entity;
					const entityCallback = param.expressionController.entityCallback();
					// assign_attributes_lines
					${this._attribute_requirements_controller.assignAttributesLines()}
					// check if attributes are present
					if( ${this._attribute_requirements_controller.attributePresenceCheckLine()} ){
						// assign function
						const getEntityAttribValue = (entities[0] instanceof CorePoint) ? getCorePointAttribValue : getCoreObjectAttribValue;
						// assign_arrays_lines
						${this._attribute_requirements_controller.assignArraysLines()}
						for(let index=0; index < entities.length; index++){
							entity = entities[index];
							result = ${this.function_main_string};
							entityCallback(entity, result);
						}
						resolve()
					} else {
						const error = new Error('attribute not found')
						_set_error_from_error(error)
						reject(error)
					}
				})
			}
			return []`:`
			return new Promise( async (resolve, reject)=>{
				try {
					const value = ${this.function_main_string}
					resolve(value)
				} catch(e) {
					_set_error_from_error(e)
					reject()
				}
			})
			`}evalAllowed(){return this.function!=null}evalFunction(){if(this.function)return this.clear_error(),this.function(b0,YK,this.param,this.methods,this._set_error_from_error_bound)}traverse_CallExpression(e){let t=e.arguments.map(s=>this.traverse_node(s)),o=e.callee.name;if(o){let s=qK[o];if(s)return s(t);let i=`${t.join(eL)}`,l=Aa[o];if(l)return`${l}(${i})`;let a=er.expressionsRegister;if(a.getMethod(o)){let h=e.arguments[0],g=`return ${t[0]}`,p,u;try{p=new Function(g),u=p()}catch{}return this._createMethodAndDependencies(o,u,h),`(await methods[${this.method_index}].processArguments([${i}]))`}else{let h=a.availableMethods().join(", "),g=`method not found (${o}), available methods are: ${h}`;er.warn(g)}}this.set_error(`unknown method: ${o}`)}traverse_BinaryExpression(e){return`(${this.traverse_node(e.left)} ${e.operator} ${this.traverse_node(e.right)})`}traverse_LogicalExpression(e){return`(${this.traverse_node(e.left)} ${e.operator} ${this.traverse_node(e.right)})`}traverse_MemberExpression(e){return`${this.traverse_node(e.object)}.${this.traverse_node(e.property)}`}traverse_UnaryExpression(e){if(e.operator===WK){let t=e.argument,r,o;switch(t.type){case"Identifier":{r=t.name;break}case"MemberExpression":{let s=t,i=s.object,l=s.property;r=i.name,o=l.name;break}}if(r){if(r=Rn.remapName(r),r==yi.POINT_INDEX||r==yi.OBJECT_INDEX)return"((entity != null) ? entity.index() : 0)";{let s=this._attribute_requirements_controller.varAttributeSize(r),i=this._attribute_requirements_controller.varArray(r);this._attribute_requirements_controller.add(r);let l=o?$K[o]:0;return l==null&&(l=0),`getEntityAttribValue(entity, '${r}', ${i}, ${s}, ${l})`}}else return console.warn("attribute not found"),""}else return`${e.operator}${this.traverse_node(e.argument)}`}traverse_Literal(e){return`${e.raw}`}traverse_Identifier(e){if(e.name[0]==P8){let r=e.name.substr(1),o=QR[r];if(o)return o;let s=`traverse_Identifier_${r}`;if(this[s])return this[s]();this.set_error(`identifier unknown: ${e.name}`)}else return e.name}traverse_Identifier_F(){return this.immutableDependencies.push(this.param.scene().timeController.graphNode),"param.scene().timeController.frame()"}traverse_Identifier_T(){return this.immutableDependencies.push(this.param.scene().timeController.graphNode),"param.scene().timeController.time()"}traverse_Identifier_OS(){return`${Cc}${this.param.node.name()}${Cc}`}traverse_Identifier_CH(){return`${Cc}${this.param.name()}${Cc}`}traverse_Identifier_CEX(){return this._method_centroid("x")}traverse_Identifier_CEY(){return this._method_centroid("y")}traverse_Identifier_CEZ(){return this._method_centroid("z")}_method_centroid(e){let r=[0,`${Cc}${e}${Cc}`].join(eL);return this._createMethodAndDependencies("centroid",0),`(await methods[${this.method_index}].processArguments([${r}]))`}_createMethodAndDependencies(e,t,r){let o=er.expressionsRegister,s=o.getMethod(e);if(!s){let l=o.availableMethods(),a=`method not found (${e}), available methods are: ${l.join(", ")}`;this.set_error(a),er.warn(a);return}let i=new s(this.param);if(this.method_index+=1,this.methods[this.method_index]=i,i.requireDependency()&&t!=null){let l=i.findDependency(t);l?(r&&l.set_jsep_node(r),this.methodDependencies.push(l)):r&&ct.isString(t)&&this.param.scene().missingExpressionReferencesController.register(this.param,t)}}};var XK=", ",w8=class extends Pp{constructor(e){super(e);this.param=e}parse_tree(e){if(e.error_message==null&&e.node)try{return this.traverse_node(e.node)}catch{this.set_error("could not traverse tree")}else this.set_error("cannot parse tree")}traverse_CallExpression(e){let r=`${e.arguments.map(s=>this.traverse_node(s)).join(XK)}`;return`${e.callee.name}(${r})`}traverse_UnaryExpression(e){return`${e.operator}${this.traverse_node(e.argument)}`}traverse_Identifier(e){return`${e.name}`}};var R8=class{constructor(e){this.param=e;this._cyclicGraphDetected=!1;this.methodDependencies=[]}set_error(e){this.error_message=this.error_message||e}reset(){this.param.graphDisconnectPredecessors(),this.methodDependencies.forEach(e=>{e.reset()}),this.methodDependencies=[]}update(e){this._cyclicGraphDetected=!1,this._connectImmutableDependencies(e),this.methodDependencies=e.methodDependencies,this._handleMethodDependencies(),this._listenForNameChanges()}_connectImmutableDependencies(e){e.immutableDependencies.forEach(t=>{if(this._cyclicGraphDetected==!1&&this.param.addGraphInput(t)==!1){this._cyclicGraphDetected=!0,this.set_error("cannot create expression, infinite graph detected"),this.reset();return}})}_handleMethodDependencies(){this.methodDependencies.forEach(e=>{this._cyclicGraphDetected==!1&&this._handleMethodDependency(e)})}_handleMethodDependency(e){let t=e.resolved_graph_node;if(t&&!this.param.addGraphInput(t)){this._cyclicGraphDetected=!0,this.set_error("cannot create expression, infinite graph detected"),this.reset();return}}_listenForNameChanges(){this.methodDependencies.forEach(e=>{e.listen_for_name_changes()})}};var L8=class{constructor(e){this.param=e;this.parse_completed=!1;this.parse_started=!1;this.parsed_tree=new ss;this._functionGenerator=new O8(this.param),this.dependencies_controller=new R8(this.param)}parseExpression(e){if(this.parse_started)throw new Error(`parse in progress for param ${this.param.path()}`);this.parse_started=!0,this.parse_completed=!1,this.parsed_tree=this.parsed_tree||new ss,this.reset(),this.param.type()==Ge.STRING?this.parsed_tree.parse_expression_for_string_param(e):this.parsed_tree.parse_expression(e),this._functionGenerator.parse_tree(this.parsed_tree),this._functionGenerator.error_message()==null&&(this.dependencies_controller.update(this._functionGenerator),this.dependencies_controller.error_message?this.param.states.error.set(this.dependencies_controller.error_message):(this.parse_completed=!0,this.parse_started=!1))}async computeFunction(){if(this._computeAllowed())try{return await this._functionGenerator.evalFunction()}catch{}}reset(){this.parse_completed=!1,this.parse_started=!1,this.dependencies_controller.reset(),this._functionGenerator.reset()}is_errored(){return this._functionGenerator.is_errored()}error_message(){return this._functionGenerator.error_message()}_computeAllowed(){return this._functionGenerator.evalAllowed()}updateFromMethodDependencyNameChange(){this.expression_string_generator=this.expression_string_generator||new w8(this.param);let e=this.expression_string_generator.parse_tree(this.parsed_tree);e?this.param.set(e):console.warn("failed to regenerate expression")}};var Op=class{constructor(e){this.param=e}dispose(){this.param.scene().expressionsController.deregisterParam(this.param),this._resetMethodDependencies()}_resetMethodDependencies(){this._method_dependencies_by_graph_node_id?.forEach(e=>{e.dispose()}),this._method_dependencies_by_graph_node_id?.clear()}registerMethodDependency(e){this._method_dependencies_by_graph_node_id=this._method_dependencies_by_graph_node_id||new Map,this._method_dependencies_by_graph_node_id.set(e.graphNodeId(),e)}active(){return this._expression!=null}expression(){return this._expression}is_errored(){return this._manager?this._manager.is_errored():!1}error_message(){return this._manager?this._manager.error_message():null}requires_entities(){return this.param.options.isExpressionForEntities()}set_expression(e,t=!0){this.param.scene().missingExpressionReferencesController.deregisterParam(this.param),this.param.scene().expressionsController.deregisterParam(this.param),this._expression!=e&&(this._resetMethodDependencies(),this._expression=e,this._expression?(this._manager=this._manager||new L8(this.param),this._manager.parseExpression(this._expression)):this._manager?.reset(),t&&this.param.setDirty())}updateFromMethodDependencyNameChange(){this._manager&&this.active()&&this._manager.updateFromMethodDependencyNameChange()}computeExpression(){if(this._manager&&this.active())return this._manager.computeFunction()}async computeExpressionForEntities(e,t){this._setEntities(e,t),await this.computeExpression(),this._manager?.error_message()&&this.param.node.states.error.set(`expression evalution error: ${this._manager?.error_message()}`),this._resetEntities()}computeExpressionForPoints(e,t){return this.computeExpressionForEntities(e,t)}computeExpressionForObjects(e,t){return this.computeExpressionForEntities(e,t)}entities(){return this._entities}entityCallback(){return this._entityCallback}_setEntities(e,t){this._entities=e,this._entityCallback=t}_resetEntities(){this._entities=void 0,this._entityCallback=void 0}};var Ma=class extends so{isNumeric(){return!0}isDefault(){return this._raw_input==this._default_value}_prefilterInvalidRawInput(e){return ct.isArray(e)?e[0]:e}processRawInput(){this.states.error.clear();let e=this.convert(this._raw_input);e!=null?(this._expression_controller&&(this._expression_controller.set_expression(void 0,!1),this.emitController.emit(Zr.EXPRESSION_UPDATED)),e!=this._value&&(this._update_value(e),this.setSuccessorsDirty(this))):ct.isString(this._raw_input)?(this._expression_controller=this._expression_controller||new Op(this),this._raw_input!=this._expression_controller.expression()&&(this._expression_controller.set_expression(this._raw_input),this.emitController.emit(Zr.EXPRESSION_UPDATED))):this.states.error.set(`param input is invalid (${this.path()})`)}async processComputation(){if(this.expressionController?.active()&&!this.expressionController.requires_entities()){let e=await this.expressionController.computeExpression();if(this.expressionController.is_errored())this.states.error.set(`expression error: "${this.expressionController.expression()}" (${this.expressionController.error_message()})`);else{let t=this.convert(e);t!=null?(this.states.error.active()&&this.states.error.clear(),this._update_value(t)):this.states.error.set(`expression returns an invalid type (${e}) (${this.expressionController.expression()})`)}}}_update_value(e){this._value=e;let t=this.parentParam();t&&t.set_value_from_components(),this.options.executeCallback(),this.emitController.emit(Zr.VALUE_UPDATED),this.removeDirtyState()}};var I8=class extends Ma{static type(){return Ge.BOOLEAN}defaultValueSerialized(){return ct.isString(this._default_value)?this._default_value:this.convert(this._default_value)||!1}rawInputSerialized(){return this._raw_input}valueSerialized(){return this.value}_copyValue(e){this.set(e.value)}static areRawInputEqual(e,t){return e==t}static areValuesEqual(e,t){return e==t}convert(e){if(ct.isBoolean(e))return e;if(ct.isNumber(e))return e>=1;if(ct.isString(e)){if(Lr.isBoolean(e))return Lr.toBoolean(e);if(Lr.isNumber(e))return parseFloat(e)>=1}return null}};var D8=class extends so{static type(){return Ge.BUTTON}defaultValueSerialized(){return this._default_value}rawInputSerialized(){return this._raw_input}valueSerialized(){return this.value}_copyValue(e){}static areRawInputEqual(e,t){return!0}static areValuesEqual(e,t){return!0}async pressButton(){(this.node.isDirty()||this.node.cookController.isCooking())&&await this.node.compute(),this.options.executeCallback()}};var Na=class extends Ma{static type(){return Ge.FLOAT}defaultValueSerialized(){return this._default_value}rawInputSerialized(){return this._raw_input}valueSerialized(){return this.value}_copyValue(e){this.set(e.valueSerialized())}_prefilterInvalidRawInput(e){return ct.isArray(e)?e[0]:ct.isString(e)&&Lr.isNumber(e)?parseFloat(e):e}static areRawInputEqual(e,t){return e==t}static areValuesEqual(e,t){return e==t}static convert(e){if(ct.isNumber(e))return e;if(ct.isBoolean(e))return e?1:0;if(Lr.isNumber(e)){let t=parseFloat(e);if(ct.isNumber(t))return t}return null}convert(e){let t=Na.convert(e);return t&&this.options.ensureInRange(t)}};var T0=class extends so{constructor(){super(...arguments);this._components_contructor=Na}get components(){return this._components}isNumeric(){return!0}isDefault(){for(let e of this.components)if(!e.isDefault())return!1;return!0}rawInput(){return this._components.map(e=>e.rawInput())}rawInputSerialized(){return this._components.map(e=>e.rawInputSerialized())}_copyValue(e){for(let t=0;t<this.components.length;t++){let r=this.components[t],o=e.components[t];r.copyValue(o)}}initComponents(){if(this._components!=null)return;let e=0;this._components=new Array(this.componentNames().length);for(let t of this.componentNames()){let r=new this._components_contructor(this.scene(),this._node),o;ct.isArray(this._default_value)?o=this._default_value[e]:o=this._default_value[t],r.options.copy(this.options),r.setInitValue(o),r.setName(`${this.name()}${t}`),r.set_parent_param(this),this._components[e]=r,e++}}async processComputation(){await this.compute_components(),this.set_value_from_components()}set_value_from_components(){}hasExpression(){for(let e of this.components)if(e.expressionController?.active())return!0;return!1}async compute_components(){let e=this.components,t=[];for(let r of e)r.isDirty()&&t.push(r.compute());await Promise.all(t),this.removeDirtyState()}_prefilterInvalidRawInput(e){if(ct.isArray(e))return e;{let t=e;return this.componentNames().map(()=>t)}}processRawInput(){let e=this.scene().cooker;e.block();let t=this.components;for(let s of t)s.emitController.blockParentEmit();let r=this._raw_input,o=0;if(ct.isArray(r))for(let s=0;s<t.length;s++){let i=r[s];i==null&&(i=o),t[s].set(i),o=i}else for(let s=0;s<t.length;s++){let i=this.componentNames()[s],l=r[i];l==null&&(l=o),t[s].set(l),o=l}e.unblock();for(let s=0;s<t.length;s++)t[s].emitController.unblockParentEmit();this.emitController.emit(Zr.VALUE_UPDATED)}};var Sa=(s=>(s.NONE="no conversion",s.GAMMA_TO_LINEAR="gamma -> linear",s.LINEAR_TO_GAMMA="linear -> gamma",s.SRGB_TO_LINEAR="sRGB -> linear",s.LINEAR_TO_SRGB="linear -> sRGB",s))(Sa||{});var JK=["r","g","b"],B8=class extends T0{constructor(){super(...arguments);this._value=new Ke;this._value_pre_conversion=new Ke;this._value_serialized_dirty=!1;this._value_serialized=[0,0,0];this._value_pre_conversion_serialized=[0,0,0];this._copied_value=[0,0,0]}static type(){return Ge.COLOR}componentNames(){return JK}defaultValueSerialized(){return ct.isArray(this._default_value)?this._default_value:this._default_value.toArray()}valueSerialized(){return this._update_value_serialized_if_required(),this._value_serialized}valuePreConversionSerialized(){return this._update_value_serialized_if_required(),this._value_pre_conversion_serialized}_copyValue(e){e.value.toArray(this._copied_value),this.set(this._copied_value)}_cloneRawInput(e){if(e instanceof Ke)return e.clone();{let t=[e[0],e[1],e[2]];return t[0]==null&&(t[0]=t[0]||0),t[1]==null&&(t[1]=t[1]||t[0]),t[2]==null&&(t[2]=t[2]||t[1]),t}}static areRawInputEqual(e,t){return e instanceof Ke?t instanceof Ke?e.equals(t):e.r==t[0]&&e.g==t[1]&&e.b==t[2]:t instanceof Ke?e[0]==t.r&&e[1]==t.g&&e[2]==t.b:e[0]==t[0]&&e[1]==t[1]&&e[2]==t[2]}static areValuesEqual(e,t){return e.equals(t)}initComponents(){super.initComponents(),this.r=this.components[0],this.g=this.components[1],this.b=this.components[2],this._value_serialized_dirty=!0}_update_value_serialized_if_required(){!this._value_serialized_dirty||(this._value_serialized[0]=this._value.r,this._value_serialized[1]=this._value.g,this._value_serialized[2]=this._value.b,this._value_pre_conversion_serialized[0]=this._value_pre_conversion.r,this._value_pre_conversion_serialized[1]=this._value_pre_conversion.g,this._value_pre_conversion_serialized[2]=this._value_pre_conversion.b)}valuePreConversion(){return this._value_pre_conversion}set_value_from_components(){this._value_pre_conversion.r=this.r.value,this._value_pre_conversion.g=this.g.value,this._value_pre_conversion.b=this.b.value,this._value.copy(this._value_pre_conversion);let e=this.options.colorConversion();if(e!=null&&e!=Sa.NONE){switch(e){case Sa.GAMMA_TO_LINEAR:{this._value.convertGammaToLinear();return}case Sa.LINEAR_TO_GAMMA:{this._value.convertLinearToGamma();return}case Sa.SRGB_TO_LINEAR:{this._value.convertSRGBToLinear();return}case Sa.LINEAR_TO_SRGB:{this._value.convertLinearToSRGB();return}}v0.unreachable(e)}this._value_serialized_dirty=!0}};var k8=class extends so{static type(){return Ge.FOLDER}defaultValueSerialized(){return this._default_value}rawInputSerialized(){return this._raw_input}valueSerialized(){return this.value}_copyValue(e){}static areRawInputEqual(e,t){return!0}static areValuesEqual(e,t){return!0}};var wp=class extends Ma{static type(){return Ge.INTEGER}defaultValueSerialized(){return this._default_value}rawInputSerialized(){return this._raw_input}valueSerialized(){return this.value}_copyValue(e){this.set(e.valueSerialized())}_prefilterInvalidRawInput(e){return ct.isArray(e)?e[0]:ct.isString(e)&&Lr.isNumber(e)?parseInt(e):e}static areRawInputEqual(e,t){return e==t}static areValuesEqual(e,t){return e==t}static convert(e){if(ct.isNumber(e))return Math.round(e);if(ct.isBoolean(e))return e?1:0;if(Lr.isNumber(e)){let t=parseInt(e);if(ct.isNumber(t))return t}return null}convert(e){let t=wp.convert(e);return t&&this.options.ensureInRange(t)}};var F8=class{constructor(){this._index=-1;this._path_elements=[];this._named_nodes=[];this._graph_node_ids=[];this._node_element_by_graph_node_id=new Map}reset(){this._index=-1,this._path_elements=[],this._named_nodes=[],this._graph_node_ids=[],this._node_element_by_graph_node_id.clear()}add_node(e,t){this._index+=1,e==t.name()&&(this._named_nodes[this._index]=t),this._graph_node_ids[this._index]=t.graphNodeId(),this._node_element_by_graph_node_id.set(t.graphNodeId(),e)}add_path_element(e){this._index+=1,this._path_elements[this._index]=e}named_graph_nodes(){return this._named_nodes}named_nodes(){let e=[];for(let t of this._named_nodes)if(t){let r=t;r.nameController&&e.push(r)}return e}update_from_name_change(e){this._named_nodes.map(r=>r?.graphNodeId()).includes(e.graphNodeId())&&this._node_element_by_graph_node_id.set(e.graphNodeId(),e.name())}to_path(){let e=new Array(this._index);for(let o=0;o<=this._index;o++){let s=this._named_nodes[o];if(s){let i=this._node_element_by_graph_node_id.get(s.graphNodeId());i&&(e[o]=i)}else{let i=this._path_elements[o];i&&(e[o]=i)}}let t=e.join(Ar.SEPARATOR),r=t[0];return r&&(Ar.NON_LETTER_PREFIXES.includes(r)||(t=`${Ar.SEPARATOR}${t}`)),t}};var Rp=class extends so{constructor(){super(...arguments);this.decomposed_path=new F8}_handleReferences(e,t){this.scene().referencesController.setNamedNodesFromParam(this),e?this.scene().referencesController.setReferenceFromParam(this,e):this.scene().missingExpressionReferencesController.register(this,t)}};var G8=class extends Rp{static type(){return Ge.PARAM_PATH}_initializeParam(){this._value=new Tp}defaultValueSerialized(){return this._default_value}rawInputSerialized(){return`${this._raw_input}`}valueSerialized(){return`${this.value}`}_copyValue(e){this.set(e.valueSerialized())}static areRawInputEqual(e,t){return e==t}static areValuesEqual(e,t){return e==t}isDefault(){return this._raw_input==this._default_value}setParam(e){this.set(e.path())}processRawInput(){this._value.path()!=this._raw_input&&(this._value.set_path(this._raw_input),this.findTarget(),this.setDirty(),this.emitController.emit(Zr.VALUE_UPDATED))}async processComputation(){this.findTarget()}findTarget(){if(!this.node)return;let e=this._raw_input,t=null,r=e!=null&&e!=="";this.scene().referencesController.resetReferenceFromParam(this),this.decomposed_path.reset(),r&&(t=Ar.findParam(this.node,e,this.decomposed_path));let o=this._value.param(),s=t;if(s&&s.graphNodeId()==this.graphNodeId()){this.states.error.set("param cannot refer to itself");return}if(this._handleReferences(t,e),o?.graphNodeId()!==s?.graphNodeId()){let i=this.options.dependentOnFoundNode(),l=this._value.param();l&&i&&this.removeGraphInput(l),t?this._assign_found_node(t):this._value.set_param(null),this.options.executeCallback()}this.removeDirtyState()}_assign_found_node(e){let t=this.options.dependentOnFoundNode();this._value.set_param(e),t&&this.addGraphInput(e)}notifyPathRebuildRequired(e){this.decomposed_path.update_from_name_change(e);let t=this.decomposed_path.to_path();this.set(t)}notifyTargetParamOwnerParamsUpdated(e){this.setDirty()}};var hh=class extends Rp{static type(){return Ge.NODE_PATH}_initializeParam(){this._value=new Ca}defaultValueSerialized(){return this._default_value}rawInputSerialized(){return`${this._raw_input}`}valueSerialized(){return`${this.value}`}_copyValue(e){this.set(e.valueSerialized())}static areRawInputEqual(e,t){return e==t}static areValuesEqual(e,t){return e==t}isDefault(){return this._raw_input==this._default_value}setNode(e,t){if(t?.relative==!0){let r=Ar.relativePath(this.node,e);this.set(r)}else this.set(e.path())}processRawInput(){this._value.path()!=this._raw_input&&(this._value.set_path(this._raw_input),this._findTarget(),this.setDirty(),this.emitController.emit(Zr.VALUE_UPDATED))}async processComputation(){this._findTarget()}_findTarget(){if(!this.node)return;let e=this._raw_input,t=null,r=e!=null&&e!=="";this.scene().referencesController.resetReferenceFromParam(this),this.decomposed_path.reset(),r&&(t=Ar.findNode(this.node,e,this.decomposed_path));let o=this._value.node(),s=t;if(s&&s.graphNodeId()==this.node.graphNodeId()){this.states.error.set("param cannot refer to its own node");return}if(this._handleReferences(t,e),o?.graphNodeId()!==s?.graphNodeId()){let i=this.options.dependentOnFoundNode(),l=this._value.node();l&&i&&this.removeGraphInput(l),t?this._assign_found_node(t):this._value.set_node(null),this.options.executeCallback()}r&&!t&&this.scene().loadingController.loaded()&&r&&this.states.error.set(`no node found at path '${e}'`),this.removeDirtyState()}_assign_found_node(e){let t=this.options.dependentOnFoundNode();this._isNodeExpectedContext(e)?this._is_node_expected_type(e)?(this.states.error.clear(),this._value.set_node(e),t&&this.addGraphInput(e)):this.states.error.set(`node type is ${e.type()} but the params expects one of ${(this._expected_node_types()||[]).join(", ")}`):this.states.error.set(`node context is ${e.context()} but the params expects a ${this._expectedContext()}`)}_expectedContext(){return this.options.nodeSelectionContext()}_isNodeExpectedContext(e){let t=this._expectedContext();if(t==null)return!0;let r=e.parent()?.childrenController?.context;return t==r}_expected_node_types(){return this.options.nodeSelectionTypes()}_is_node_expected_type(e){let t=this._expected_node_types();return t==null?!0:t?.includes(e.type())}notifyPathRebuildRequired(e){this.decomposed_path.update_from_name_change(e);let t=this.decomposed_path.to_path();this.set(t)}notifyTargetParamOwnerParamsUpdated(e){this.setDirty()}};var qi=class{constructor(e=0,t=0){this._position=e;this._value=t}toJSON(){return{position:this._position,value:this._value}}position(){return this._position}value(){return this._value}copy(e){this._position=e.position(),this._value=e.value()}clone(){let e=new qi;return e.copy(this),e}isEqual(e){return this._position==e.position()&&this._value==e.value()}isEqualJSON(e){return this._position==e.position&&this._value==e.value}fromJSON(e){this._position=e.position,this._value=e.value}static areEqualJSON(e,t){return e.position==t.position&&e.value==t.value}static fromJSON(e){return new qi(e.position,e.value)}},U8=(e=>(e.CUBIC="cubic",e))(U8||{});var Kn=class{constructor(e="cubic",t=[]){this._interpolation=e;this._points=t;this._uuid=el()}uuid(){return this._uuid}interpolation(){return this._interpolation}points(){return this._points}static fromJSON(e){let t=[];for(let o of e.points)t.push(qi.fromJSON(o));let r=e.interpolation;return(r==null||r=="")&&(r="cubic"),new Kn(r,t)}toJSON(){return{interpolation:this._interpolation,points:this._points.map(e=>e.toJSON())}}clone(){let e=new Kn;return e.copy(this),e}copy(e){this._interpolation=e.interpolation();let t=0;this._points.length>e.points().length&&this._points.splice(0,e.points().length);for(let r of e.points()){let o=this._points[t];o?o.copy(r):this._points.push(r.clone()),t+=1}}isEqual(e){if(this._interpolation!=e.interpolation())return!1;let t=e.points();if(this._points.length!=t.length)return!1;let r=0;for(let o of this._points){let s=t[r];if(!o.isEqual(s))return!1;r+=1}return!0}isEqualJSON(e){if(this._interpolation!=e.interpolation||this._points.length!=e.points.length)return!1;let t=0;for(let r of this._points){let o=e.points[t];if(!r.isEqualJSON(o))return!1;t+=1}return!0}static are_json_equal(e,t){if(e.interpolation!=t.interpolation||e.points.length!=t.points.length)return!1;let r=0;for(let o of e.points){let s=t.points[r];if(!qi.areEqualJSON(o,s))return!1;r+=1}return!0}from_json(e){this._interpolation=e.interpolation;let t=0;for(let r of e.points){let o=this._points[t];o?o.fromJSON(r):this._points.push(qi.fromJSON(r)),t+=1}}};var V8=1024,tL=1,rL=V8*tL,Tc=255,_h=class extends so{constructor(){super(...arguments);this._texture_data=new Uint8Array(3*rL);this._ramp_texture=new Do(this._texture_data,V8,tL,qo)}static type(){return Ge.RAMP}defaultValueSerialized(){return this._default_value instanceof Kn?this._default_value.toJSON():this._default_value}_cloneRawInput(e){return e instanceof Kn?e.clone():Kn.fromJSON(e).toJSON()}rawInputSerialized(){return this._raw_input instanceof Kn?this._raw_input.toJSON():Kn.fromJSON(this._raw_input).toJSON()}valueSerialized(){return this.value.toJSON()}_copyValue(e){this.set(e.valueSerialized())}static areRawInputEqual(e,t){return e instanceof Kn?t instanceof Kn?e.isEqual(t):e.isEqualJSON(t):t instanceof Kn?t.isEqualJSON(e):Kn.are_json_equal(e,t)}static areValuesEqual(e,t){return e.isEqual(t)}isDefault(){return this._default_value instanceof Kn?this.value.isEqual(this._default_value):this.value.isEqualJSON(this._default_value)}processRawInput(){this._raw_input instanceof Kn?this._value?this._value.copy(this._raw_input):this._value=this._raw_input:this._value?this._value.from_json(this._raw_input):this._value=Kn.fromJSON(this._raw_input),this._resetRampInterpolant(),this._updateRampTexture(),this.options.executeCallback(),this.emitController.emit(Zr.VALUE_UPDATED),this.setSuccessorsDirty(this)}hasExpression(){return!1}_resetRampInterpolant(){this._ramp_interpolant=void 0}rampTexture(){return this._ramp_texture}_updateRampTexture(){this._updateRampTextureData(),this.rampTexture().needsUpdate=!0}_updateRampTextureData(){let e=0,t=0,r=0;for(var o=0;o<rL;o++)e=o*3,t=o/V8,r=this.valueAtPosition(t),r<=0?(this._texture_data[e+0]=(_o(r,-1,0)+1)*Tc,this._texture_data[e+1]=0,this._texture_data[e+2]=0):r<=1?(this._texture_data[e+0]=Tc,this._texture_data[e+1]=_o(r,0,1)*Tc,this._texture_data[e+2]=0):(this._texture_data[e+0]=Tc,this._texture_data[e+1]=Tc,this._texture_data[e+2]=(_o(r,1,2)-1)*Tc)}static createInterpolant(e,t){let r=1,o=new Float32Array(r);return new Rd(e,t,r,o)}interpolant(){return this._ramp_interpolant=this._ramp_interpolant||this._createInterpolant()}_createInterpolant(){let e=this.value.points(),t=xr.sortBy(e,i=>i.position()),r=new Float32Array(t.length),o=new Float32Array(t.length),s=0;for(let i of t)r[s]=i.position(),o[s]=i.value(),s++;return _h.createInterpolant(r,o)}valueAtPosition(e){return this.interpolant().evaluate(e)[0]}},E0=_h;E0.DEFAULT_VALUE=new Kn(U8.CUBIC,[new qi(0,0),new qi(1,1)]),E0.DEFAULT_VALUE_JSON=_h.DEFAULT_VALUE.toJSON();var z8=class extends so{static type(){return Ge.STRING}defaultValueSerialized(){return this._default_value}_cloneRawInput(e){return`${e}`}rawInputSerialized(){return`${this._raw_input}`}valueSerialized(){return`${this.value}`}_copyValue(e){this.set(e.value)}static areRawInputEqual(e,t){return e==t}static areValuesEqual(e,t){return e==t}isDefault(){return this._raw_input==this._default_value}convert(e){return ct.isString(e)?e:`${e}`}rawInput(){return this._raw_input}processRawInput(){this.states.error.clear(),this._value_elements(this._raw_input).length>=3?(this._expression_controller=this._expression_controller||new Op(this),this._raw_input!=this._expression_controller.expression()&&(this._expression_controller.set_expression(this._raw_input),this.setDirty(),this.emitController.emit(Zr.EXPRESSION_UPDATED))):this._raw_input!=this._value&&(this._value=this._raw_input,this.removeDirtyState(),this.setSuccessorsDirty(this),this.emitController.emit(Zr.VALUE_UPDATED),this.options.executeCallback(),this._expression_controller&&(this._expression_controller.set_expression(void 0,!1),this.emitController.emit(Zr.EXPRESSION_UPDATED)))}async processComputation(){if(this.expressionController?.active()&&!this.expressionController.requires_entities()){let e=await this.expressionController.computeExpression();if(this.expressionController.is_errored())this.states.error.set(`expression error: ${this.expressionController.error_message()}`);else{let t=this.convert(e);t!=null?(this._value=t,this.emitController.emit(Zr.VALUE_UPDATED),this.options.executeCallback()):this.states.error.set(`expression returns an invalid type (${e})`),this.removeDirtyState()}}}_value_elements(e){return ss.string_value_elements(e)}};var KK=["x","y"],H8=class extends T0{constructor(){super(...arguments);this._value=new re;this._copied_value=[0,0]}static type(){return Ge.VECTOR2}componentNames(){return KK}defaultValueSerialized(){return ct.isArray(this._default_value)?this._default_value:this._default_value.toArray()}valueSerialized(){return this.value.toArray()}_copyValue(e){e.value.toArray(this._copied_value),this.set(this._copied_value)}_cloneRawInput(e){if(e instanceof re)return e.clone();{let t=[e[0],e[1]];return t[0]==null&&(t[0]=t[0]||0),t[1]==null&&(t[1]=t[1]||t[0]),t}}static areRawInputEqual(e,t){return e instanceof re?t instanceof re?e.equals(t):e.x==t[0]&&e.y==t[1]:t instanceof re?e[0]==t.x&&e[1]==t.y:e[0]==t[0]&&e[1]==t[1]}static areValuesEqual(e,t){return e.equals(t)}initComponents(){super.initComponents(),this.x=this.components[0],this.y=this.components[1]}set_value_from_components(){this._value.x=this.x.value,this._value.y=this.y.value}};var ZK=["x","y","z"],j8=class extends T0{constructor(){super(...arguments);this._value=new F;this._copied_value=[0,0,0]}static type(){return Ge.VECTOR3}componentNames(){return ZK}defaultValueSerialized(){return ct.isArray(this._default_value)?this._default_value:this._default_value.toArray()}valueSerialized(){return this.value.toArray()}_copyValue(e){e.value.toArray(this._copied_value),this.set(this._copied_value)}_cloneRawInput(e){if(e instanceof F)return e.clone();{let t=[e[0],e[1],e[2]];return t[0]==null&&(t[0]=t[0]||0),t[1]==null&&(t[1]=t[1]||t[0]),t[2]==null&&(t[2]=t[2]||t[1]),t}}static areRawInputEqual(e,t){return e instanceof F?t instanceof F?e.equals(t):e.x==t[0]&&e.y==t[1]&&e.z==t[2]:t instanceof F?e[0]==t.x&&e[1]==t.y&&e[2]==t.z:e[0]==t[0]&&e[1]==t[1]&&e[2]==t[2]}static areValuesEqual(e,t){return e.equals(t)}initComponents(){super.initComponents(),this.x=this.components[0],this.y=this.components[1],this.z=this.components[2]}set_value_from_components(){this._value.x=this.x.value,this._value.y=this.y.value,this._value.z=this.z.value}};var QK=["x","y","z","w"],q8=class extends T0{constructor(){super(...arguments);this._value=new kt;this._copied_value=[0,0,0,0]}static type(){return Ge.VECTOR4}componentNames(){return QK}defaultValueSerialized(){return ct.isArray(this._default_value)?this._default_value:this._default_value.toArray()}valueSerialized(){return this.value.toArray()}_copyValue(e){e.value.toArray(this._copied_value),this.set(this._copied_value)}_cloneRawInput(e){if(e instanceof kt)return e.clone();{let t=[e[0],e[1],e[2],e[3]];return t[0]==null&&(t[0]=t[0]||0),t[1]==null&&(t[1]=t[1]||t[0]),t[2]==null&&(t[2]=t[2]||t[1]),t[3]==null&&(t[3]=t[3]||t[2]),t}}static areRawInputEqual(e,t){return e instanceof kt?t instanceof kt?e.equals(t):e.x==t[0]&&e.y==t[1]&&e.z==t[2]&&e.w==t[3]:t instanceof kt?e[0]==t.x&&e[1]==t.y&&e[2]==t.z&&e[3]==t.w:e[0]==t[0]&&e[1]==t[1]&&e[2]==t[2]&&e[3]==t[3]}static areValuesEqual(e,t){return e.equals(t)}initComponents(){super.initComponents(),this.x=this.components[0],this.y=this.components[1],this.z=this.components[2],this.w=this.components[3]}set_value_from_components(){this._value.x=this.x.value,this._value.y=this.y.value,this._value.z=this.z.value,this._value.w=this.w.value}};var nL={[Ge.BOOLEAN]:I8,[Ge.BUTTON]:D8,[Ge.COLOR]:B8,[Ge.FLOAT]:Na,[Ge.FOLDER]:k8,[Ge.INTEGER]:wp,[Ge.PARAM_PATH]:G8,[Ge.NODE_PATH]:hh,[Ge.RAMP]:E0,[Ge.STRING]:z8,[Ge.VECTOR2]:H8,[Ge.VECTOR3]:j8,[Ge.VECTOR4]:q8};var eZ="params",W8=class{constructor(e){this.node=e;this._param_create_mode=!1;this._params_created=!1;this._params_by_name={};this._params_list=[];this._param_names=[];this._non_spare_params=[];this._spare_params=[];this._non_spare_param_names=[];this._spare_param_names=[];this._params_added_since_last_params_eval=!1;this._promises=[]}dispose(){this._params_node&&this._params_node.dispose();for(let e of this.all)e.dispose();this._post_create_params_hook_names=void 0,this._post_create_params_hooks=void 0,this._on_scene_load_hooks=void 0,this._on_scene_load_hook_names=void 0}initDependencyNode(){this._params_node||(this._params_node=new Un(this.node.scene(),eZ),this.node.addGraphInput(this._params_node,!1))}init(){this.initDependencyNode(),this._param_create_mode=!0,this._initFromParamsConfig(),this.node.createParams(),this._postCreateParams()}_postCreateParams(){this._updateCaches(),this._initParamAccessors(),this._param_create_mode=!1,this._params_created=!0,this._runPostCreateParamsHooks()}postCreateSpareParams(){this._updateCaches(),this._initParamAccessors(),this.node.scene().referencesController.notifyParamsUpdated(this.node),this.node.emit(Br.PARAMS_UPDATED)}updateParams(e){let t=!1,r=!1;if(e.namesToDelete)for(let o of e.namesToDelete)this.has(o)&&(this._deleteParam(o),r=!0);if(e.toAdd)for(let o of e.toAdd){let s=this.addParam(o.type,o.name,o.init_value,o.options);s&&(o.raw_input!=null&&s.set(o.raw_input),t=!0)}(r||t)&&this.postCreateSpareParams()}_initFromParamsConfig(){let e=this.node.paramsConfig,t=!1;if(e)for(let r of Object.keys(e)){let o=e[r],s,i=this.node.createOptions?.paramsInitValueOverrides;i&&(s=i[r],t=!0),this.addParam(o.type,r,o.init_value,o.options,s)}t&&this.node.setDirty(),this.node.createOptions&&(this.node.createOptions.paramsInitValueOverrides=void 0)}_initParamAccessors(){let e=Object.getOwnPropertyNames(this.node.pv);this._removeUnneededAccessors(e),e=Object.getOwnPropertyNames(this.node.pv);for(let t of this.all){let r=t.options.isSpare();(!e.includes(t.name())||r)&&(Object.defineProperty(this.node.pv,t.name(),{get:()=>t.value,configurable:r}),Object.defineProperty(this.node.p,t.name(),{get:()=>t,configurable:r}))}}_removeUnneededAccessors(e){let t=this._param_names,r=[];for(let o of e)t.includes(o)||r.push(o);for(let o of r)Object.defineProperty(this.node.pv,o,{get:()=>{},configurable:!0}),Object.defineProperty(this.node.p,o,{get:()=>{},configurable:!0})}get params_node(){return this._params_node}get all(){return this._params_list}get non_spare(){return this._non_spare_params}get spare(){return this._spare_params}get names(){return this._param_names}get non_spare_names(){return this._non_spare_param_names}get spare_names(){return this._spare_param_names}set_with_type(e,t,r){let o=this.paramWithType(e,r);o?o.set(t):er.warn(`param ${e} not found with type ${r}`)}set_float(e,t){this.set_with_type(e,t,Ge.FLOAT)}set_vector3(e,t){this.set_with_type(e,t,Ge.VECTOR3)}has_param(e){return this._params_by_name[e]!=null}has(e){return this.has_param(e)}get(e){return this.param(e)}paramWithType(e,t){let r=this.param(e);if(r&&r.type()==t)return r}getFloat(e){return this.paramWithType(e,Ge.FLOAT)}value(e){return this.param(e)?.value}valueWithType(e,t){return this.paramWithType(e,t)?.value}boolean(e){return this.valueWithType(e,Ge.BOOLEAN)}float(e){return this.valueWithType(e,Ge.FLOAT)}integer(e){return this.valueWithType(e,Ge.INTEGER)}string(e){return this.valueWithType(e,Ge.STRING)}vector2(e){return this.valueWithType(e,Ge.VECTOR2)}vector3(e){return this.valueWithType(e,Ge.VECTOR3)}color(e){return this.valueWithType(e,Ge.COLOR)}param(e){let t=this._params_by_name[e];return t??(er.warn(`tried to access param '${e}' in node ${this.node.path()}, but existing params are: ${this.names} on node ${this.node.path()}`),null)}_deleteParam(e){let t=this._params_by_name[e];if(t){if(this._params_node&&this._params_node.removeGraphInput(this._params_by_name[e]),t._setupNodeDependencies(null),delete this._params_by_name[e],t.isMultiple()&&t.components)for(let r of t.components){let o=r.name();delete this._params_by_name[o]}}else throw new Error(`param '${e}' does not exist on node ${this.node.path()}`)}addParam(e,t,r,o={},s){let i=o.spare||!1;this._param_create_mode===!1&&!i&&er.warn(`node ${this.node.path()} (${this.node.type()}) param '${t}' cannot be created outside of create_params`),this.node.scene()==null&&er.warn(`node ${this.node.path()} (${this.node.type()}) has no scene assigned`);let l=nL[e];if(l!=null){let a=this._params_by_name[t];a&&(i?a.type()!=e&&this._deleteParam(a.name()):er.warn(`a param named ${t} already exists`,this.node));let c=new l(this.node.scene(),this.node);if(c.options.set(o),c.setName(t),c.setInitValue(r),c.initComponents(),s==null)c.set(r);else if(c.options.isExpressionForEntities()&&c.set(r),s.raw_input!=null)c.set(s.raw_input);else if(s.simple_data!=null)c.set(s.simple_data);else if(s.complex_data!=null){let h=s.complex_data.raw_input;h?c.set(h):c.set(r);let g=s.complex_data.overriden_options;if(g!=null){let p=Object.keys(g);for(let u of p)c.options.setOption(u,g[u])}}if(c._setupNodeDependencies(this.node),this._params_by_name[c.name()]=c,c.isMultiple()&&c.components)for(let h of c.components)this._params_by_name[h.name()]=h;return this._params_added_since_last_params_eval=!0,c}}_updateCaches(){this._params_list=Object.values(this._params_by_name),this._param_names=Object.keys(this._params_by_name),this._non_spare_params=Object.values(this._params_by_name).filter(e=>!e.options.isSpare()),this._spare_params=Object.values(this._params_by_name).filter(e=>e.options.isSpare()),this._non_spare_param_names=Object.values(this._params_by_name).filter(e=>!e.options.isSpare()).map(e=>e.name()),this._spare_param_names=Object.values(this._params_by_name).filter(e=>e.options.isSpare()).map(e=>e.name())}async _evalParam(e){e.isDirty()&&(await e.compute(),e.states.error.active()&&this.node.states.error.set(`param '${e.name()}' error: ${e.states.error.message()}`))}async evalParams(e){let t=0;for(let o of e)o.isDirty()&&(t+=1);this._promises.length=t;let r=0;for(let o of e)o.isDirty()&&(this._promises[r]=this._evalParam(o),r+=1);await Promise.all(this._promises),this.node.states.error.active()&&this.node._setContainer(null)}paramsEvalRequired(){return this._params_node!=null&&(this._params_node.isDirty()||this._params_added_since_last_params_eval)}async evalAll(){this.paramsEvalRequired()&&(await this.evalParams(this._params_list),this._params_node?.removeDirtyState(),this._params_added_since_last_params_eval=!1)}onParamsCreated(e,t){if(this._params_created)t();else{if(this._post_create_params_hook_names&&this._post_create_params_hook_names.includes(e)){er.error(`hook name ${e} already exists`);return}this._post_create_params_hook_names=this._post_create_params_hook_names||[],this._post_create_params_hook_names.push(e),this._post_create_params_hooks=this._post_create_params_hooks||[],this._post_create_params_hooks.push(t)}}addOnSceneLoadHook(e,t){this._on_scene_load_hook_names=this._on_scene_load_hook_names||[],this._on_scene_load_hooks=this._on_scene_load_hooks||[],this._on_scene_load_hook_names.includes(e)?er.warn(`hook with name ${e} already exists`,this.node):(this._on_scene_load_hook_names.push(e),this._on_scene_load_hooks.push(t))}_runPostCreateParamsHooks(){if(this._post_create_params_hooks)for(let e of this._post_create_params_hooks)e()}runOnSceneLoadHooks(){if(this._on_scene_load_hooks)for(let e of this._on_scene_load_hooks)e()}};var $8=class{constructor(){}};var Y8=class{constructor(e,t,r=0,o=0){this._node_src=e;this._node_dest=t;this._output_index=r;this._input_index=o;if(this._output_index==null)throw"bad output index";if(this._input_index==null)throw"bad input index";this._id=Y8._next_id++,this._node_src.io.connections&&this._node_dest.io.connections&&(this._node_src.io.connections.addOutputConnection(this),this._node_dest.io.connections.addInputConnection(this))}get id(){return this._id}get node_src(){return this._node_src}get node_dest(){return this._node_dest}get output_index(){return this._output_index}get input_index(){return this._input_index}src_connection_point(){let e=this._node_src,t=this._output_index;return e.io.outputs.namedOutputConnectionPoints()[t]}dest_connection_point(){let e=this._node_dest,t=this._input_index;return e.io.inputs.namedInputConnectionPoints()[t]}disconnect(e={}){this._node_src.io.connections&&this._node_dest.io.connections&&(this._node_src.io.connections.removeOutputConnection(this),this._node_dest.io.connections.removeInputConnection(this)),e.setInput===!0&&this._node_dest.io.inputs.setInput(this._input_index,null)}},gh=Y8;gh._next_id=0;var X8=class{constructor(e){this.inputs_controller=e;this._cloneRequiredStates=[];this._overridden=!1;this.node=e.node}initInputsClonedState(e){ct.isArray(e)?this._clonedStates=e:this._clonedState=e,this._updateCloneRequiredState()}overrideClonedStateAllowed(){if(this._clonedStates){for(let e of this._clonedStates)if(e==Uo.FROM_NODE)return!0}return this._clonedState?this._clonedState==Uo.FROM_NODE:!1}cloneRequiredState(e){return this._cloneRequiredStates[e]}cloneRequiredStates(){return this._cloneRequiredStates}_getCloneRequiredState(e){let t=this._clonedStates;if(t){let r=t[e];if(r!=null)return this._cloneRequiredFromState(r)}return this._clonedState?this._cloneRequiredFromState(this._clonedState):!0}_cloneRequiredFromState(e){switch(e){case Uo.ALWAYS:return!0;case Uo.NEVER:return!1;case Uo.FROM_NODE:return!this._overridden}return v0.unreachable(e)}overrideClonedState(e){this._overridden=e,this._updateCloneRequiredState(),this.node.emit(Br.OVERRIDE_CLONABLE_STATE_UPDATE),this.node.setDirty()}overriden(){return this._overridden}_updateCloneRequiredState(){if(this._clonedStates){let e=[];for(let t=0;t<this._clonedStates.length;t++)e[t]=this._getCloneRequiredState(t);this._cloneRequiredStates=e}else if(this._clonedState){let e=this.inputs_controller.maxInputsCount(),t=[];for(let r=0;r<e;r++)t[r]=this._getCloneRequiredState(r);this._cloneRequiredStates=t}}};var J8=0,K8=class{constructor(e){this.node=e;this._graphNodeInputs=[];this._inputs=[];this._has_named_inputs=!1;this._minInputsCount=0;this._maxInputsCount=J8;this._maxInputsCountOnInput=J8;this._depends_on_inputs=!0}dispose(){this._graphNode&&this._graphNode.dispose();for(let e of this._graphNodeInputs)e&&e.dispose();this._on_update_hooks=void 0,this._on_update_hook_names=void 0}set_depends_on_inputs(e){this._depends_on_inputs=e}setMinCount(e){this._minInputsCount=e}minCount(){return this._minInputsCount}setMaxCount(e){this._maxInputsCount==J8&&(this._maxInputsCountOnInput=e),this._maxInputsCount=e,this._initGraphNodeInputs()}namedInputConnectionPointsByName(e){if(this._named_input_connection_points){for(let t of this._named_input_connection_points)if(t&&t.name()==e)return t}}setNamedInputConnectionPoints(e){this._has_named_inputs=!0;let t=this.node.io.connections.inputConnections();if(t)for(let r of t)r&&r.input_index>=e.length&&r.disconnect({setInput:!0});this._named_input_connection_points=e,this.setMinCount(0),this.setMaxCount(e.length),this._initGraphNodeInputs(),this.node.emit(Br.NAMED_INPUTS_UPDATED)}hasNamedInputs(){return this._has_named_inputs}namedInputConnectionPoints(){return this._named_input_connection_points||[]}_initGraphNodeInputs(){for(let e=0;e<this._maxInputsCount;e++)this._graphNodeInputs[e]=this._graphNodeInputs[e]||this._createGraphNodeInput(e)}_createGraphNodeInput(e){let t=new Un(this.node.scene(),`input_${e}`);return this._graphNode||(this._graphNode=new Un(this.node.scene(),"inputs"),this.node.addGraphInput(this._graphNode,!1)),this._graphNode.addGraphInput(t,!1),t}maxInputsCount(){return this._maxInputsCount||0}maxInputsCountOverriden(){return this._maxInputsCount!=this._maxInputsCountOnInput}inputGraphNode(e){return this._graphNodeInputs[e]}setCount(e,t){t==null&&(t=e),this.setMinCount(e),this.setMaxCount(t),this._initConnectionControllerInputs()}_initConnectionControllerInputs(){this.node.io.connections.initInputs()}isAnyInputDirty(){return this._graphNode?.isDirty()||!1}containersWithoutEvaluation(){let e=[];for(let t=0;t<this._inputs.length;t++){let r=this._inputs[t],o;r&&(o=r.containerController.containerUnlessBypassed()),e.push(o)}return e}_existingInputIndices(){let e=[];if(this._maxInputsCount>0)for(let t=0;t<this._inputs.length;t++)this._inputs[t]&&e.push(t);return e}async evalRequiredInputs(){let e=[];if(this._maxInputsCount>0){let t=this._existingInputIndices();if(t.length<this._minInputsCount)this.node.states.error.set("inputs are missing");else if(t.length>0){let r=[],o;for(let s=0;s<this._inputs.length;s++)o=this._inputs[s],o&&r.push(this.evalRequiredInput(s));e=await Promise.all(r),this._graphNode?.removeDirtyState()}}return e}async evalRequiredInput(e){let t,r=this.input(e);if(r&&(t=await r.compute(),this._graphNodeInputs[e].removeDirtyState()),!(t&&t.coreContent())){let o=this.input(e);if(o){let s=o.states.error.message();s&&this.node.states.error.set(`input ${e} is invalid (error: ${s})`)}}return t}get_named_input_index(e){if(this._named_input_connection_points){for(let t=0;t<this._named_input_connection_points.length;t++)if(this._named_input_connection_points[t]?.name()==e)return t}return-1}get_input_index(e){if(ct.isString(e)){if(this.hasNamedInputs())return this.get_named_input_index(e);throw new Error(`node ${this.node.path()} has no named inputs`)}else return e}setInput(e,t,r=0){let o=this.get_input_index(e)||0;if(o<0){let h=`invalid input (${e}) for node ${this.node.path()}`;throw console.warn(h),new Error(h)}let s=0;if(t&&t.io.outputs.hasNamedOutputs()&&(s=t.io.outputs.getOutputIndex(r),s==null||s<0)){let g=t.io.outputs.namedOutputConnectionPoints().map(p=>p.name());console.warn(`node ${t.path()} does not have an output named ${r}. inputs are: ${g.join(", ")}`);return}let i=this._graphNodeInputs[o];if(i==null){let h=`graph_input_node not found at index ${o}`;throw console.warn(h),new Error(h)}if(t&&this.node.parent()!=t.parent())return;let l=this._inputs[o],a=null,c;this.node.io.connections&&(c=this.node.io.connections.inputConnection(o)),c&&(a=c.output_index),(t!==l||s!=a)&&(l!=null&&this._depends_on_inputs&&i.removeGraphInput(l),t!=null?i.addGraphInput(t)?(this._depends_on_inputs||i.removeGraphInput(t),c&&c.disconnect({setInput:!1}),this._inputs[o]=t,new gh(t,this.node,s,o)):console.warn(`cannot connect ${t.path()} to ${this.node.path()}`):(this._inputs[o]=null,c&&c.disconnect({setInput:!1})),this._run_on_set_input_hooks(),i.setSuccessorsDirty(),this.node.emit(Br.INPUTS_UPDATED))}remove_input(e){let t=this.inputs(),r;for(let o=0;o<t.length;o++)r=t[o],r!=null&&e!=null&&r.graphNodeId()===e.graphNodeId()&&this.setInput(o,null)}input(e){return this._inputs[e]}named_input(e){if(this.hasNamedInputs()){let t=this.get_input_index(e);return this._inputs[t]}else return null}named_input_connection_point(e){if(this.hasNamedInputs()&&this._named_input_connection_points){let t=this.get_input_index(e);return this._named_input_connection_points[t]}}has_named_input(e){return this.get_named_input_index(e)>=0}hasInput(e){return this._inputs[e]!=null}inputs(){return this._inputs}initInputsClonedState(e){this._clonedStatesController||(this._clonedStatesController=new X8(this),this._clonedStatesController.initInputsClonedState(e))}overrideClonedStateAllowed(){return this._clonedStatesController?.overrideClonedStateAllowed()||!1}overrideClonedState(e){this._clonedStatesController?.overrideClonedState(e)}clonedStateOverriden(){return this._clonedStatesController?.overriden()||!1}cloneRequired(e){let t=this._clonedStatesController?.cloneRequiredState(e);return t??!0}cloneRequiredStates(){let e=this._clonedStatesController?.cloneRequiredStates();return e??!0}add_on_set_input_hook(e,t){this._on_update_hooks=this._on_update_hooks||[],this._on_update_hook_names=this._on_update_hook_names||[],this._on_update_hook_names.includes(e)?console.warn(`hook with name ${e} already exists`,this.node):(this._on_update_hooks.push(t),this._on_update_hook_names.push(e))}_run_on_set_input_hooks(){if(this._on_update_hooks)for(let e of this._on_update_hooks)e()}};var Z8=class{constructor(e){this.node=e;this._has_outputs=!1;this._has_named_outputs=!1}dispose(){this._named_output_connection_points&&this._named_output_connection_points.splice(0,this._named_output_connection_points.length)}setHasOneOutput(){this._has_outputs=!0}setHasNoOutput(){this._has_outputs=!1}hasOutputs(){return this._has_outputs}hasNamedOutputs(){return this._has_named_outputs}hasNamedOutput(e){return this.getNamedOutputIndex(e)>=0}namedOutputConnectionPoints(){return this._named_output_connection_points||[]}namedOutputConnection(e){if(this._named_output_connection_points)return this._named_output_connection_points[e]}getNamedOutputIndex(e){if(this._named_output_connection_points){for(let t=0;t<this._named_output_connection_points.length;t++)if(this._named_output_connection_points[t]?.name()==e)return t}return-1}getOutputIndex(e){return e!=null?ct.isString(e)?this.hasNamedOutputs()?this.getNamedOutputIndex(e):(console.warn(`node ${this.node.path()} has no named outputs`),-1):e:-1}namedOutputConnectionPointsByName(e){if(this._named_output_connection_points){for(let t of this._named_output_connection_points)if(t?.name()==e)return t}}setNamedOutputConnectionPoints(e,t=!0){this._has_named_outputs=!0;let r=this.node.io.connections.outputConnections();if(r)for(let o of r)o&&o.output_index>=e.length&&o.disconnect({setInput:!0});this._named_output_connection_points=e,t&&this.node.scene()&&this.node.setDirty(this.node),this.node.emit(Br.NAMED_OUTPUTS_UPDATED)}used_output_names(){let e=this.node.io.connections;if(e){let r=e.outputConnections().map(i=>i?i.output_index:null);r=xr.uniq(r);let o=[];r.forEach(i=>{ct.isNumber(i)&&o.push(i)});let s=[];for(let i of o){let l=this.namedOutputConnectionPoints()[i]?.name();l&&s.push(l)}return s}else return[]}};var Q8=class{constructor(e){this._node=e;this._output_connections=new Map}initInputs(){let e=this._node.io.inputs.maxInputsCount();for(this._input_connections=this._input_connections||new Array(e);this._input_connections.length<e;)this._input_connections.push(void 0)}dispose(){this._input_connections&&this._input_connections.splice(0,this._input_connections.length),this._output_connections&&this._output_connections.clear()}addInputConnection(e){this._input_connections?this._input_connections[e.input_index]=e:console.warn("input connections array not initialized")}removeInputConnection(e){if(this._input_connections)if(e.input_index<this._input_connections.length){this._input_connections[e.input_index]=void 0;let t=!0;for(let r=e.input_index;r<this._input_connections.length;r++)this._input_connections[r]&&(t=!1);t&&(this._input_connections=this._input_connections.slice(0,e.input_index))}else console.warn(`attempt to remove an input connection at index ${e.input_index}`);else console.warn("input connections array not initialized")}inputConnection(e){if(this._input_connections)return this._input_connections[e]}firstInputConnection(){return this._input_connections?xr.compact(this._input_connections)[0]:null}inputConnections(){return this._input_connections}existingInputConnections(){let e=this._input_connections;if(e)for(;e.length>1&&e[e.length-1]===void 0;)e.pop();return e}addOutputConnection(e){let t=e.output_index,r=e.id,o=this._output_connections.get(t);o||(o=new Map,this._output_connections.set(t,o)),o.set(r,e)}removeOutputConnection(e){let t=e.output_index,r=e.id,o=this._output_connections.get(t);o&&o.delete(r)}outputConnections(){let e=[];return this._output_connections.forEach((t,r)=>{t.forEach((o,s)=>{o&&e.push(o)})}),e}};var e6=class{constructor(e){this._node=e}set_in(e){this._in=e}set_out(e){this._out=e}clear(){this._in=void 0,this._out=void 0}in(){return this._in}out(){return this._out}};var Pa=class{constructor(e,t,r){this._name=e;this._type=t;this._init_value=r}get init_value(){return this._init_value}name(){return this._name}type(){return this._type}are_types_matched(e,t){return!0}toJSON(){return this._json=this._json||this._create_json()}_create_json(){return{name:this._name,type:this._type}}};var t6=(a=>(a.BOOL="bool",a.INT="int",a.FLOAT="float",a.VEC2="vec2",a.VEC3="vec3",a.VEC4="vec4",a.SAMPLER_2D="sampler2D",a.SSS_MODEL="SSSModel",a))(t6||{});var tZ={bool:Ge.BOOLEAN,int:Ge.INTEGER,float:Ge.FLOAT,vec2:Ge.VECTOR2,vec3:Ge.VECTOR3,vec4:Ge.VECTOR4,sampler2D:Ge.RAMP,SSSModel:Ge.STRING},oL={[Ge.BOOLEAN]:"bool",[Ge.COLOR]:"vec3",[Ge.INTEGER]:"int",[Ge.FLOAT]:"float",[Ge.FOLDER]:void 0,[Ge.VECTOR2]:"vec2",[Ge.VECTOR3]:"vec3",[Ge.VECTOR4]:"vec4",[Ge.BUTTON]:void 0,[Ge.PARAM_PATH]:void 0,[Ge.NODE_PATH]:void 0,[Ge.RAMP]:void 0,[Ge.STRING]:void 0},rZ={bool:!1,int:0,float:0,vec2:[0,0],vec3:[0,0,0],vec4:[0,0,0,0],sampler2D:E0.DEFAULT_VALUE_JSON,SSSModel:"SSSModel()"};var r6=class extends Pa{constructor(e,t,r){super(e,t);this._name=e;this._type=t;this._init_value=r;this._init_value=this._init_value||rZ[this._type]}type(){return this._type}are_types_matched(e,t){return e==t}get param_type(){return tZ[this._type]}get init_value(){return this._init_value}toJSON(){return this._json=this._json||this._create_json()}_create_json(){return{name:this._name,type:this._type}}};var n6=(i=>(i.BOOL="bool",i.INT="int",i.FLOAT="float",i.VEC2="vec2",i.VEC3="vec3",i.VEC4="vec4",i))(n6||{});var nZ={bool:Ge.BOOLEAN,int:Ge.INTEGER,float:Ge.FLOAT,vec2:Ge.VECTOR2,vec3:Ge.VECTOR3,vec4:Ge.VECTOR4},iL={[Ge.BOOLEAN]:"bool",[Ge.COLOR]:"vec3",[Ge.INTEGER]:"int",[Ge.FLOAT]:"float",[Ge.FOLDER]:void 0,[Ge.VECTOR2]:"vec2",[Ge.VECTOR3]:"vec3",[Ge.VECTOR4]:"vec4",[Ge.BUTTON]:void 0,[Ge.PARAM_PATH]:void 0,[Ge.NODE_PATH]:void 0,[Ge.RAMP]:void 0,[Ge.STRING]:void 0},oZ={bool:!1,int:0,float:0,vec2:[0,0],vec3:[0,0,0],vec4:[0,0,0,0]};var o6=class extends Pa{constructor(e,t){super(e,t);this._type=t;this._init_value=oZ[this._type]}type(){return this._type}are_types_matched(e,t){return e==t}get param_type(){return nZ[this._type]}get init_value(){return this._init_value}toJSON(){return this._json=this._json||this._create_json()}_create_json(){return{name:this._name,type:this._type}}};var bo=(s=>(s.BASE="base",s.DRAG="drag",s.KEYBOARD="keyboard",s.MOUSE="mouse",s.POINTER="pointer",s))(bo||{}),xo=class extends Pa{constructor(e,t,r){super(e,t);this._name=e;this._type=t;this._event_listener=r}type(){return this._type}get param_type(){return Ge.FLOAT}are_types_matched(e,t){return t=="base"?!0:e==t}get event_listener(){return this._event_listener}toJSON(){return this._json=this._json||this._create_json()}_create_json(){return{name:this._name,type:this._type}}};var sL={[or.ANIM]:void 0,[or.AUDIO]:void 0,[or.COP]:void 0,[or.EVENT]:bo.BASE,[or.GL]:t6.FLOAT,[or.JS]:n6.FLOAT,[or.MANAGER]:void 0,[or.MAT]:void 0,[or.OBJ]:void 0,[or.POST]:void 0,[or.ROP]:void 0,[or.SOP]:void 0};function vh(n,e,t){switch(n){case or.EVENT:return new xo(e,t);case or.GL:return new r6(e,t);case or.JS:return new o6(e,t);default:return}}function aL(n){switch(n){case or.EVENT:return;case or.GL:return oL;case or.JS:return iL;default:return}}var i6=class{constructor(e,t){this.node=e;this._context=t;this._raw_input_serialized_by_param_name=new Map;this._default_value_serialized_by_param_name=new Map;this._initialized=!1}initializeNode(){if(this._initialized){console.warn("already initialized",this.node);return}this._initialized=!0,this.node.params.onParamsCreated("create_inputs_from_params",this.create_inputs_from_params.bind(this))}initialized(){return this._initialized}create_inputs_from_params(){let e=aL(this._context);if(!e)return;let t=[];for(let r of this.node.params.names){let o=!0;if(this._inputless_param_names&&this._inputless_param_names.length>0&&this._inputless_param_names.includes(r)&&(o=!1),o&&this.node.params.has(r)){let s=this.node.params.get(r);if(s&&!s.parentParam()){let i=e[s.type()];if(i){let l=vh(this._context,s.name(),i);l&&t.push(l)}}}}this.node.io.inputs.setNamedInputConnectionPoints(t)}set_inputless_param_names(e){return this._inputless_param_names=e}createSpareParameters(){if(this.node.scene().loadingController.isLoading())return;let e=this.node.params.spare_names,t={};for(let r of e)if(this.node.params.has(r)){let o=this.node.params.get(r);o&&(this._raw_input_serialized_by_param_name.set(r,o.rawInputSerialized()),this._default_value_serialized_by_param_name.set(r,o.defaultValueSerialized()),t.namesToDelete=t.namesToDelete||[],t.namesToDelete.push(r))}for(let r of this.node.io.inputs.namedInputConnectionPoints())if(r){let o=r.name(),s=r.param_type,i=r.init_value,l=this._default_value_serialized_by_param_name.get(o),a=this.node.paramDefaultValue(o);if(a!=null?i=a:l!=null?i=l:i=r.init_value,ct.isArray(r.init_value))if(ct.isNumber(i)){let c=new Array(r.init_value.length);c.fill(i),i=c}else ct.isArray(i)&&i.length==r.init_value.length&&l!=null&&(i=r.init_value);i!=null&&(t.toAdd=t.toAdd||[],t.toAdd.push({name:o,type:s,init_value:Jn.clone(i),raw_input:Jn.clone(i),options:{spare:!0}}))}this.node.params.updateParams(t);for(let r of this.node.params.spare)if(!r.parentParam()){let o=this._raw_input_serialized_by_param_name.get(r.name());o&&r.set(o)}}};var s6=class{constructor(e,t){this.node=e;this._context=t;this._create_spare_params_from_inputs=!0;this._functions_overridden=!1;this._input_name_function=e=>`in${e}`;this._output_name_function=e=>e==0?"val":`val${e}`;this._expected_input_types_function=()=>{let e=this.first_input_connection_type()||this.default_connection_type();return[e,e]};this._expected_output_types_function=()=>[this._expected_input_types_function()[0]];this._update_signature_if_required_bound=this.update_signature_if_required.bind(this);this._initialized=!1;this._spare_params_controller=new i6(this.node,this._context)}default_connection_type(){return sL[this._context]}create_connection_point(e,t){return vh(this._context,e,t)}functions_overridden(){return this._functions_overridden}initialized(){return this._initialized}set_create_spare_params_from_inputs(e){this._create_spare_params_from_inputs=e}set_input_name_function(e){this._initialize_if_required(),this._input_name_function=e}set_output_name_function(e){this._initialize_if_required(),this._output_name_function=e}set_expected_input_types_function(e){this._initialize_if_required(),this._functions_overridden=!0,this._expected_input_types_function=e}set_expected_output_types_function(e){this._initialize_if_required(),this._functions_overridden=!0,this._expected_output_types_function=e}input_name(e){return this._wrapped_input_name_function(e)}output_name(e){return this._wrapped_output_name_function(e)}initializeNode(){if(this._initialized){console.warn("already initialized",this.node);return}this._initialized=!0,this.node.io.inputs.add_on_set_input_hook("_update_signature_if_required",this._update_signature_if_required_bound),this.node.params.addOnSceneLoadHook("_update_signature_if_required",this._update_signature_if_required_bound),this.node.params.onParamsCreated("_update_signature_if_required_bound",this._update_signature_if_required_bound),this.node.addPostDirtyHook("_update_signature_if_required",this._update_signature_if_required_bound),this._spare_params_controller.initialized()||this._spare_params_controller.initializeNode()}_initialize_if_required(){this._initialized||this.initializeNode()}get spare_params(){return this._spare_params_controller}update_signature_if_required(e){(!this.node.lifecycle.creationCompleted()||!this._connections_match_inputs())&&(this.update_connection_types(),this.node.removeDirtyState(),this.node.scene().loadingController.isLoading()||this.make_successors_update_signatures())}make_successors_update_signatures(){let e=this.node.graphAllSuccessors();if(this.node.childrenAllowed()){let t=this.node.nodesByType(oh.INPUT),r=this.node.nodesByType(oh.OUTPUT);for(let o of t)e.push(o);for(let o of r)e.push(o)}for(let t of e){let r=t;r.io&&r.io.has_connection_points_controller&&r.io.connection_points.initialized()&&r.io.connection_points.update_signature_if_required(this.node)}}update_connection_types(){let e=!1,t=this._wrapped_expected_input_types_function(),r=this._wrapped_expected_output_types_function(),o=[];for(let i=0;i<t.length;i++){let l=t[i],a=this.create_connection_point(this._wrapped_input_name_function(i),l);o.push(a)}let s=[];for(let i=0;i<r.length;i++){let l=r[i],a=this.create_connection_point(this._wrapped_output_name_function(i),l);s.push(a)}this.node.io.inputs.setNamedInputConnectionPoints(o),this.node.io.outputs.setNamedOutputConnectionPoints(s,e),this._create_spare_params_from_inputs&&this._spare_params_controller.createSpareParameters()}_connections_match_inputs(){let e=this.node.io.inputs.namedInputConnectionPoints().map(s=>s?.type()),t=this.node.io.outputs.namedOutputConnectionPoints().map(s=>s?.type()),r=this._wrapped_expected_input_types_function(),o=this._wrapped_expected_output_types_function();if(r.length!=e.length||o.length!=t.length)return!1;for(let s=0;s<e.length;s++)if(e[s]!=r[s])return!1;for(let s=0;s<t.length;s++)if(t[s]!=o[s])return!1;return!0}_wrapped_expected_input_types_function(){if(this.node.scene().loadingController.isLoading()){let e=this.node.io.saved_connection_points_data.in();if(e)return e.map(t=>t.type)}return this._expected_input_types_function()}_wrapped_expected_output_types_function(){if(this.node.scene().loadingController.isLoading()){let e=this.node.io.saved_connection_points_data.out();if(e)return e.map(t=>t.type)}return this._expected_output_types_function()}_wrapped_input_name_function(e){if(this.node.scene().loadingController.isLoading()){let t=this.node.io.saved_connection_points_data.in();if(t)return t[e].name}return this._input_name_function(e)}_wrapped_output_name_function(e){if(this.node.scene().loadingController.isLoading()){let t=this.node.io.saved_connection_points_data.out();if(t)return t[e].name}return this._output_name_function(e)}first_input_connection_type(){return this.input_connection_type(0)}input_connection_type(e){let t=this.node.io.connections.inputConnections();if(t){let r=t[e];if(r)return r.src_connection_point().type()}}};var a6=class{constructor(e){this.node=e;this._connections=new Q8(this.node)}dispose(){this.inputs.dispose(),this.outputs.dispose(),this.connections.dispose()}get connections(){return this._connections}get inputs(){return this._inputs=this._inputs||new K8(this.node)}hasInputs(){return this._inputs!=null}get outputs(){return this._outputs=this._outputs||new Z8(this.node)}has_outputs(){return this._outputs!=null}get connection_points(){return this._connection_points=this._connection_points||new s6(this.node,this.node.context())}get has_connection_points_controller(){return this._connection_points!=null}get saved_connection_points_data(){return this._saved_connection_points_data=this._saved_connection_points_data||new e6(this.node)}clear_saved_connection_points_data(){this._saved_connection_points_data&&(this._saved_connection_points_data.clear(),this._saved_connection_points_data=void 0)}};var l6=class{constructor(){}};var yh=class extends Un{constructor(e,t="BaseNode",r){super(e,t);this.createOptions=r;this.containerController=new y8(this);this.pv=new $8;this.p=new l6;this._initialized=!1}copy_param_values(e){let t=this.params.non_spare;for(let r of t){let o=e.params.get(r.name());o&&r.copyValue(o)}}get parentController(){return this._parent_controller=this._parent_controller||new q5(this)}static displayedInputNames(){return[]}childrenControllerContext(){return this._childrenControllerContext}_create_childrenController(){if(this._childrenControllerContext)return new K5(this,this._childrenControllerContext)}get childrenController(){return this._childrenController=this._childrenController||this._create_childrenController()}childrenAllowed(){return this._childrenControllerContext!=null}get uiData(){return this._uiData=this._uiData||new k5(this)}get states(){return this._states=this._states||new j5(this)}get lifecycle(){return this._lifecycle=this._lifecycle||new Z5(this)}get serializer(){return this._serializer=this._serializer||new ph(this)}get cookController(){return this._cookController=this._cookController||new x8(this)}get io(){return this._io=this._io||new a6(this)}get nameController(){return this._nameController=this._nameController||new Ap(this)}setName(e){this.nameController.setName(e)}_setCoreName(e){this._name=e}get params(){return this._paramsController=this._paramsController||new W8(this)}initializeBaseAndNode(){this._initialized?console.warn("node already initialized"):(this._initialized=!0,this.displayNodeController?.initializeNode(),this.initializeBaseNode(),this.initializeNode(),this.polyNodeController&&this.polyNodeController.initializeNode())}initializeBaseNode(){}initializeNode(){}static type(){throw"type to be overriden"}type(){return this.constructor.type()}static context(){throw console.error("node has no node_context",this),"context requires override"}context(){return this.constructor.context()}static require_webgl2(){return!1}require_webgl2(){return this.constructor.require_webgl2()}setParent(e){this.parentController.setParent(e)}parent(){return this.parentController.parent()}firstAncestorWithContext(e){return this.parentController.firstAncestorWithContext(e)}root(){return this._scene.root()}path(e){return this.parentController.path(e)}createParams(){}addParam(e,t,r,o){return this._paramsController?.addParam(e,t,r,o)}paramDefaultValue(e){return null}cook(e){return null}onCookEnd(e,t){this.cookController.registerOnCookEnd(e,t)}async compute(){return this.isDirty()||this.flags?.bypass?.active()?await this.containerController.compute():this.containerController.container()}_setContainer(e,t=null){this.containerController.container().set_content(e),e!=null&&(e.name||(e.name=this.path()),e.node||(e.node=this)),this.cookController.endCook(t)}createNode(e,t){return this.childrenController?.createNode(e,t)}createOperationContainer(e,t,r){return this.childrenController?.createOperationContainer(e,t,r)}removeNode(e){this.childrenController?.removeNode(e)}dispose(){super.dispose(),this.setParent(null),this._nameController&&(this._nameController.dispose(),this._nameController=void 0),this._io&&(this._io.dispose(),this._io=void 0),this._lifecycle&&(this._lifecycle.dispose(),this._lifecycle=void 0),this.displayNodeController&&this.displayNodeController.dispose(),this._childrenController&&(this._childrenController.dispose(),this._childrenController=void 0),this._paramsController&&(this._paramsController.dispose(),this._paramsController=void 0),this._cookController&&(this._cookController.dispose(),this._cookController=void 0),this._serializer&&(this._serializer.dispose(),this._serializer=void 0),this._uiData&&(this._uiData.dispose(),this._uiData=void 0)}children(){return this.childrenController?.children()||[]}node(e){return this.parentController?.findNode(e)||null}nodeSibling(e){let t=this.parent();if(t){let r=t.childrenController?.childByName(e);if(r)return r}return null}nodesByType(e){return this.childrenController?.nodesByType(e)||[]}setInput(e,t,r=0){this.io.inputs.setInput(e,t,r)}emit(e,t=null){this.scene().dispatchController.dispatch(this,e,t)}toJSON(e=!1){return this.serializer.toJSON(e)}async requiredModules(){}usedAssembler(){}integrationData(){}};var So=class{constructor(e,t,r){this.type=e;this.init_value=t;this.options=r}},dt=class{static BUTTON(e,t){return new So(Ge.BUTTON,e,t)}static BOOLEAN(e,t){return new So(Ge.BOOLEAN,e,t)}static COLOR(e,t){return e instanceof Ke&&(e=e.toArray()),new So(Ge.COLOR,e,t)}static FLOAT(e,t){return new So(Ge.FLOAT,e,t)}static FOLDER(e=null,t){return new So(Ge.FOLDER,e,t)}static INTEGER(e,t){return new So(Ge.INTEGER,e,t)}static RAMP(e=E0.DEFAULT_VALUE,t){return new So(Ge.RAMP,e,t)}static STRING(e="",t){return new So(Ge.STRING,e,t)}static VECTOR2(e,t){return e instanceof re&&(e=e.toArray()),new So(Ge.VECTOR2,e,t)}static VECTOR3(e,t){return e instanceof F&&(e=e.toArray()),new So(Ge.VECTOR3,e,t)}static VECTOR4(e,t){return e instanceof kt&&(e=e.toArray()),new So(Ge.VECTOR4,e,t)}static NODE_PATH(e,t){return new So(Ge.NODE_PATH,e,t)}static PARAM_PATH(e,t){return new So(Ge.PARAM_PATH,e,t)}},Zn=class{};var lL={computeOnDirty:!1,callback:n=>{c6.update(n)}};function cL(n){return class extends n{constructor(){super(...arguments);this.displayAudioIcon=dt.BOOLEAN(0,{...lL});this.audioIconColor=dt.COLOR([0,0,0],{...lL,visibleIf:{displayAudioIcon:1}})}}}var c6=class{constructor(e){this.node=e;this._callbacksByName=new Map}async toggleSound(){this.audioListeners().forEach(e=>{e.toggleSound()}),this.update(),this._runOnToggleSoundCallbacks()}soundOn(){let e=this.audioListeners()[0];return e&&Er(e.pv.soundOn)||!1}update(){this._updateViewers()}audioListeners(){return this.node.nodesByType("audioListener")}_updateViewers(){this.node.scene().viewersRegister.traverseViewers(e=>{e.audioController().update()})}static update(e){e.audioController.update()}onToggleSound(e,t){if(this._callbacksByName.get(e)){console.warn(`callback already registered ith name '${e}'`);return}this._callbacksByName.set(e,t)}_runOnToggleSoundCallbacks(){let e=this.soundOn();this._callbacksByName.forEach(t=>{t(e)})}};var iZ={computeOnDirty:!1,callback:n=>{u6.update(n)}};function uL(n){return class extends n{constructor(){super(...arguments);this.autoUpdate=dt.BOOLEAN(1,iZ)}}}var u6=class{constructor(e){this.node=e}async update(){let e=this.node.object,t=this.node.pv;Er(t.autoUpdate)!=e.autoUpdate&&(e.autoUpdate=Er(t.autoUpdate))}static async update(e){e.sceneAutoUpdateController.update()}};var Ec=["none","color","texture"],p6={computeOnDirty:!1,callback:n=>{d6.update(n)}};function pL(n){return class extends n{constructor(){super(...arguments);this.backgroundMode=dt.INTEGER(Ec.indexOf("none"),{menu:{entries:Ec.map((t,r)=>({name:t,value:r}))},...p6});this.bgColor=dt.COLOR([0,0,0],{visibleIf:{backgroundMode:Ec.indexOf("color")},...p6});this.bgTexture=dt.NODE_PATH("",{visibleIf:{backgroundMode:Ec.indexOf("texture")},nodeSelection:{context:or.COP},dependentOnFoundNode:!1,...p6})}}}var d6=class{constructor(e){this.node=e}update(){let e=this.node.object,t=this.node.pv;if(t.backgroundMode==Ec.indexOf("none"))e.background=null;else if(t.backgroundMode==Ec.indexOf("color"))e.background=t.bgColor;else{let r=t.bgTexture.nodeWithContext(or.COP);r?r.compute().then(o=>{e.background=o.texture()}):this.node.states.error.set("bgTexture node not found")}}static update(e){e.sceneBackgroundController.update()}};var dL={computeOnDirty:!1,callback:n=>{f6.update(n)}};function fL(n){return class extends n{constructor(){super(...arguments);this.useEnvironment=dt.BOOLEAN(0,dL);this.environment=dt.NODE_PATH("",{visibleIf:{useEnvironment:1},nodeSelection:{context:or.COP},dependentOnFoundNode:!1,...dL})}}}var f6=class{constructor(e){this.node=e}async update(){let e=this.node.object,t=this.node.pv;if(Er(t.useEnvironment)){let r=t.environment.nodeWithContext(or.COP);r?r.compute().then(o=>{e.environment=o.texture()}):this.node.states.error.set("bgTexture node not found")}else e.environment=null}static async update(e){e.sceneEnvController.update()}};var Ac={computeOnDirty:!1,callback:n=>{h6.update(n)}};var Mc=["linear","exponential"];function m6(n){return class extends n{constructor(){super(...arguments);this.useFog=dt.BOOLEAN(0,Ac);this.fogType=dt.INTEGER(Mc.indexOf("exponential"),{visibleIf:{useFog:1},menu:{entries:Mc.map((t,r)=>({name:t,value:r}))},...Ac});this.fogColor=dt.COLOR([1,1,1],{visibleIf:{useFog:1},...Ac});this.fogNear=dt.FLOAT(1,{range:[0,100],rangeLocked:[!0,!1],visibleIf:{useFog:1,fogType:Mc.indexOf("linear")},...Ac});this.fogFar=dt.FLOAT(100,{range:[0,100],rangeLocked:[!0,!1],visibleIf:{useFog:1,fogType:Mc.indexOf("linear")},...Ac});this.fogDensity=dt.FLOAT(25e-5,{visibleIf:{useFog:1,fogType:Mc.indexOf("exponential")},...Ac})}}}var sZ=class extends m6(Zn){},h6=class{constructor(e){this.node=e}async update(){let e=this.node.object,t=this.node.pv;if(Er(t.useFog))if(t.fogType==Mc.indexOf("linear")){let r=this.fog2(t);e.fog=r,r.color=t.fogColor,r.near=t.fogNear,r.far=t.fogFar}else{let r=this.fogExp2(t);e.fog=this.fogExp2(t),r.color=t.fogColor,r.density=t.fogDensity}else e.fog&&(e.fog=null)}fog2(e){return this._fog=this._fog||new Di(16777215,e.fogNear,e.fogFar)}fogExp2(e){return this._fogExp2=this._fogExp2||new Bi(16777215,e.fogDensity)}static async update(e){e.sceneFogController.update()}};function mL(n){return class extends n{constructor(){super(...arguments);this.nodesMask=dt.STRING("*/file* */image* */envMap*",{cook:!1});this.printNodes=dt.BUTTON(null,{cook:!1,callback:t=>{_6.PARAM_CALLBACK_printResolve(t)}})}}}var _6=class{constructor(e){this.node=e}static async PARAM_CALLBACK_printResolve(e){let t=await e.loadProgress.resolvedNodes();console.log(t);let r=t.map(o=>o.path()).sort();console.log(r)}async resolvedNodes(){let e=this.node.p.nodesMask;e.isDirty()&&await e.compute();let t=e.value;return this.node.scene().nodesController.nodesFromMask(t||"")}};var hL={computeOnDirty:!1,callback:n=>{g6.update(n)}};function _L(n){return class extends n{constructor(){super(...arguments);this.useOverrideMaterial=dt.BOOLEAN(0,hL);this.overrideMaterial=dt.NODE_PATH("",{visibleIf:{useOverrideMaterial:1},nodeSelection:{context:or.MAT},dependentOnFoundNode:!1,...hL})}}}var g6=class{constructor(e){this.node=e}async update(){let e=this.node.object,t=this.node.pv;if(Er(t.useOverrideMaterial)){let r=t.overrideMaterial.nodeWithContext(or.MAT);if(r){let o=await r.compute();e.overrideMaterial=o.material()}else e.overrideMaterial=null,this.node.states.error.set("overrideMaterial node not found")}else e.overrideMaterial=null}static async update(e){e.sceneMaterialOverrideController.update()}};var gL=class extends mL(cL(_L(fL(m6(pL(uL(Zn))))))){},f$e=new gL;var v6=["auxclick","click","contextmenu","dblclick","mousedown","mouseenter","mouseleave","mousemove","mouseover","mouseout","mouseup","pointerlockchange","pointerlockerror","select","wheel"];var y6=class extends yh{constructor(){super(...arguments);this._cook_without_inputs_bound=this._cook_without_inputs.bind(this)}static context(){return or.EVENT}initializeBaseNode(){this.uiData.setLayoutHorizontal(),this.addPostDirtyHook("cook_without_inputs_on_dirty",this._cook_without_inputs_bound),this.io.inputs.set_depends_on_inputs(!1),this.io.connections.initInputs(),this.io.connection_points.spare_params.initializeNode()}_cook_without_inputs(){this.cookController.cookMainWithoutInputs()}cook(){this.cookController.endCook()}processEventViaConnectionPoint(e,t){t.event_listener?t.event_listener(e):this.processEvent(e)}processEvent(e){}async dispatchEventToOutput(e,t){this.run_on_dispatch_hook(e,t);let r=this.io.outputs.getOutputIndex(e);if(r>=0){let s=this.io.connections.outputConnections().filter(l=>l.output_index==r),i;for(let l of s){i=l.node_dest;let a=i.io.inputs.namedInputConnectionPoints()[l.input_index];i.processEventViaConnectionPoint(t,a)}}else console.warn(`requested output '${e}' does not exist on node '${this.path()}'`)}onDispatch(e,t){this._on_dispatch_hooks_by_output_name=this._on_dispatch_hooks_by_output_name||new Map,yo.pushOnArrayAtEntry(this._on_dispatch_hooks_by_output_name,e,t)}run_on_dispatch_hook(e,t){if(this._on_dispatch_hooks_by_output_name){let r=this._on_dispatch_hooks_by_output_name.get(e);if(r)for(let o of r)o(t)}}};var bh=["keydown","keypress","keyup"];var Ci=(t=>(t.CANVAS="canvas",t.DOCUMENT="document",t))(Ci||{}),Qn=["canvas","document"];var Kt={visibleIf:{active:1},callback:n=>{vL.PARAM_CALLBACK_updateRegister(n)}},Po=class extends y6{constructor(){super(...arguments);this._activeEventDatas=[]}initializeBaseNode(){super.initializeBaseNode();let e=()=>{this.scene().eventsDispatcher.registerEventNode(this)},t=()=>{this.scene().eventsDispatcher.unregisterEventNode(this)};this.lifecycle.onAfterAdded(e),this.lifecycle.onBeforeDeleted(t),this.params.onParamsCreated("update_register",()=>{this._updateRegister()})}processEvent(e){!this.pv.active||!e.event||this.dispatchEventToOutput(e.event.type,e)}static PARAM_CALLBACK_updateRegister(e){e._updateRegister()}_updateRegister(){this._updateActiveEventDatas(),this.scene().eventsDispatcher.updateViewerEventListeners(this)}_updateActiveEventDatas(){this._activeEventDatas=[],this.pv.active&&this.acceptedEventTypes().forEach(t=>{let r=this.params.get(t);r&&r.value&&this._activeEventDatas.push({type:t,emitter:Qn[this.pv.element]})})}activeEventDatas(){return this._activeEventDatas}};var vL=class extends Po{acceptedEventTypes(){return new Set}};var yL=class extends Zn{constructor(){super(...arguments);this.active=dt.BOOLEAN(!0,{callback:e=>{b6.PARAM_CALLBACK_updateRegister(e)},separatorAfter:!0});this.element=dt.INTEGER(Qn.indexOf(Ci.CANVAS),{menu:{entries:Qn.map((e,t)=>({name:e,value:t}))},separatorAfter:!0});this.auxclick=dt.BOOLEAN(0,Kt);this.click=dt.BOOLEAN(0,Kt);this.contextmenu=dt.BOOLEAN(0,Kt);this.dblclick=dt.BOOLEAN(0,Kt);this.mousedown=dt.BOOLEAN(1,Kt);this.mouseenter=dt.BOOLEAN(0,Kt);this.mouseleave=dt.BOOLEAN(0,Kt);this.mousemove=dt.BOOLEAN(1,Kt);this.mouseover=dt.BOOLEAN(0,Kt);this.mouseout=dt.BOOLEAN(0,Kt);this.mouseup=dt.BOOLEAN(1,Kt);this.pointerlockchange=dt.BOOLEAN(0,Kt);this.pointerlockerror=dt.BOOLEAN(0,Kt);this.select=dt.BOOLEAN(0,Kt);this.wheel=dt.BOOLEAN(0,Kt);this.ctrlKey=dt.BOOLEAN(0,{...Kt,separatorBefore:!0});this.altKey=dt.BOOLEAN(0,Kt);this.shiftKey=dt.BOOLEAN(0,Kt);this.metaKey=dt.BOOLEAN(0,Kt)}},aZ=new yL,b6=class extends Po{constructor(){super(...arguments);this.paramsConfig=aZ}static type(){return"mouse"}acceptedEventTypes(){return new Set(v6.map(e=>`${e}`))}initializeNode(){this.io.outputs.setNamedOutputConnectionPoints(v6.map(e=>new xo(e,bo.MOUSE)))}processEvent(e){if(!this.pv.active||!e.event)return;let t=e.event;t.ctrlKey==Er(this.pv.ctrlKey)&&t.shiftKey==Er(this.pv.shiftKey)&&t.altKey==Er(this.pv.altKey)&&t.metaKey==Er(this.pv.metaKey)&&this.dispatchEventToOutput(e.event.type,e)}};var x6=["pointerdown","pointermove","pointerup"];var bL=class extends Zn{constructor(){super(...arguments);this.active=dt.BOOLEAN(!0,{callback:e=>{C6.PARAM_CALLBACK_updateRegister(e)},separatorAfter:!0});this.element=dt.INTEGER(Qn.indexOf(Ci.CANVAS),{menu:{entries:Qn.map((e,t)=>({name:e,value:t}))},separatorAfter:!0});this.pointerdown=dt.BOOLEAN(1,Kt);this.pointermove=dt.BOOLEAN(0,Kt);this.pointerup=dt.BOOLEAN(0,Kt);this.ctrlKey=dt.BOOLEAN(0,{...Kt,separatorBefore:!0});this.altKey=dt.BOOLEAN(0,Kt);this.shiftKey=dt.BOOLEAN(0,Kt);this.metaKey=dt.BOOLEAN(0,Kt)}},lZ=new bL,C6=class extends Po{constructor(){super(...arguments);this.paramsConfig=lZ}static type(){return"pointer"}acceptedEventTypes(){return new Set(x6.map(e=>`${e}`))}initializeNode(){this.io.outputs.setNamedOutputConnectionPoints(x6.map(e=>new xo(e,bo.POINTER)))}processEvent(e){if(!this.pv.active||!e.event)return;let t=e.event;t.ctrlKey==Er(this.pv.ctrlKey)&&t.shiftKey==Er(this.pv.shiftKey)&&t.altKey==Er(this.pv.altKey)&&t.metaKey==Er(this.pv.metaKey)&&this.dispatchEventToOutput(e.event.type,e)}};var xL=class extends Zn{constructor(){super(...arguments);this.active=dt.BOOLEAN(!0,{callback:(e,t)=>{T6.PARAM_CALLBACK_updateRegister(e)},separatorAfter:!0});this.element=dt.INTEGER(Qn.indexOf(Ci.CANVAS),{menu:{entries:Qn.map((e,t)=>({name:e,value:t}))},separatorAfter:!0,...Kt});this.keydown=dt.BOOLEAN(1,Kt);this.keypress=dt.BOOLEAN(0,Kt);this.keyup=dt.BOOLEAN(0,Kt);this.keyCodes=dt.STRING("Digit1 KeyE ArrowDown",Kt);this.ctrlKey=dt.BOOLEAN(0,Kt);this.altKey=dt.BOOLEAN(0,Kt);this.shiftKey=dt.BOOLEAN(0,Kt);this.metaKey=dt.BOOLEAN(0,Kt)}},cZ=new xL,T6=class extends Po{constructor(){super(...arguments);this.paramsConfig=cZ}static type(){return"keyboard"}acceptedEventTypes(){return new Set(bh.map(e=>`${e}`))}initializeNode(){this.io.outputs.setNamedOutputConnectionPoints(bh.map(e=>new xo(e,bo.KEYBOARD)))}setElement(e){this.p.element.set(Qn.indexOf(e))}processEvent(e){if(!this.pv.active||!e.event)return;let t=e.event;t.ctrlKey==Er(this.pv.ctrlKey)&&t.shiftKey==Er(this.pv.shiftKey)&&t.altKey==Er(this.pv.altKey)&&t.metaKey==Er(this.pv.metaKey)&&(!Lr.matchMask(t.code,this.pv.keyCodes)||this.dispatchEventToOutput(e.event.type,e))}};var E6=["resize"];var CL=class extends Zn{constructor(){super(...arguments);this.active=dt.BOOLEAN(!0,{callback:e=>{A6.PARAM_CALLBACK_updateRegister(e)},separatorAfter:!0});this.element=dt.INTEGER(0,{hidden:!0});this.resize=dt.BOOLEAN(1,Kt)}},uZ=new CL,A6=class extends Po{constructor(){super(...arguments);this.paramsConfig=uZ}static type(){return"window"}acceptedEventTypes(){return new Set(E6.map(e=>`${e}`))}initializeNode(){this.io.outputs.setNamedOutputConnectionPoints(E6.map(e=>new xo(e,bo.POINTER)))}processEvent(e){!this.pv.active||!e.event||this.dispatchEventToOutput(e.event.type,e)}};var M6=["dragover"];var N6=["touchstart","touchmove","touchend"];var TL=class extends Zn{constructor(){super(...arguments);this.active=dt.BOOLEAN(!0,{callback:e=>{S6.PARAM_CALLBACK_updateRegister(e)},separatorAfter:!0});this.element=dt.INTEGER(Qn.indexOf(Ci.CANVAS),{menu:{entries:Qn.map((e,t)=>({name:e,value:t}))},separatorAfter:!0});this.dragover=dt.BOOLEAN(1,Kt);this.ctrlKey=dt.BOOLEAN(0,{...Kt,separatorBefore:!0});this.altKey=dt.BOOLEAN(0,Kt);this.shiftKey=dt.BOOLEAN(0,Kt);this.metaKey=dt.BOOLEAN(0,Kt)}},pZ=new TL,S6=class extends Po{constructor(){super(...arguments);this.paramsConfig=pZ}static type(){return"drag"}acceptedEventTypes(){return new Set(M6.map(e=>`${e}`))}initializeNode(){this.io.outputs.setNamedOutputConnectionPoints(M6.map(e=>new xo(e,bo.DRAG)))}processEvent(e){if(!this.pv.active||!e.event)return;let t=e.event;t.ctrlKey==Er(this.pv.ctrlKey)&&t.shiftKey==Er(this.pv.shiftKey)&&t.altKey==Er(this.pv.altKey)&&t.metaKey==Er(this.pv.metaKey)&&this.dispatchEventToOutput(e.event.type,e)}};var EL=class extends Zn{constructor(){super(...arguments);this.active=dt.BOOLEAN(!0,{callback:e=>{P6.PARAM_CALLBACK_updateRegister(e)},separatorAfter:!0});this.element=dt.INTEGER(Qn.indexOf(Ci.CANVAS),{menu:{entries:Qn.map((e,t)=>({name:e,value:t}))},separatorAfter:!0});this.touchstart=dt.BOOLEAN(1,Kt);this.touchmove=dt.BOOLEAN(0,Kt);this.touchend=dt.BOOLEAN(0,Kt)}},dZ=new EL,P6=class extends Po{constructor(){super(...arguments);this.paramsConfig=dZ}static type(){return"touch"}acceptedEventTypes(){return new Set(N6.map(e=>`${e}`))}initializeNode(){this.io.outputs.setNamedOutputConnectionPoints(N6.map(e=>new xo(e,bo.DRAG)))}processEvent(e){!this.pv.active||!e.event||this.dispatchEventToOutput(e.event.type,e)}};var as=(o=>(o.MAX_FRAME_UPDATED="scene_maxFrameUpdated",o.REALTIME_STATUS_UPDATED="scene_realtime_status_updated",o.FRAME_UPDATED="scene_frame_updated",o.PLAY_STATE_UPDATED="scene_play_state_updated",o))(as||{});var AL=60,Nc=class{constructor(e){this.scene=e;this._frame=0;this._time=0;this._realtimeState=!0;this._maxFrame=600;this._maxFrameLocked=!1;this._playing=!1;this._delta=0;this._onBeforeTickCallbacks=[];this._onAfterTickCallbacks=[];this._graphNode=new Un(e,"timeController")}get graphNode(){return this._graphNode}frame(){return this._frame}time(){return this._time}maxFrame(){return this._maxFrame}maxFrameLocked(){return this._maxFrameLocked}realtimeState(){return this._realtimeState}setMaxFrame(e){this._maxFrame=Math.floor(e),this.scene.dispatchController.dispatch(this._graphNode,as.MAX_FRAME_UPDATED)}setMaxFrameLocked(e){this._maxFrameLocked=e,this.scene.dispatchController.dispatch(this._graphNode,as.MAX_FRAME_UPDATED)}setRealtimeState(e){this._realtimeState=e,this.scene.dispatchController.dispatch(this._graphNode,as.REALTIME_STATUS_UPDATED)}setTime(e,t=!0){if(e==this._time)return;this._time=e,this.scene.cooker.block();let r=this._delta;for(let o of this._onBeforeTickCallbacks)o(r);if(t){let o=Math.floor(this._time*AL),s=this._ensureFrameWithinBounds(o);o!=s?this.setFrame(s,!0):this._frame=o}this.scene.dispatchController.dispatch(this._graphNode,as.FRAME_UPDATED),this.scene.uniformsController.updateTimeDependentUniformOwners(),this.graphNode.setSuccessorsDirty(),this.scene.cooker.unblock();for(let o of this._onAfterTickCallbacks)o(r)}setFrame(e,t=!0){e!=this._frame&&(e=this._ensureFrameWithinBounds(e),e!=this._frame&&(this._frame=e,t&&this.setTime(this._frame/AL,!1)))}setFrameToStart(){this.setFrame(Nc.START_FRAME,!0)}incrementTimeIfPlaying(e){this._playing&&(this.scene.root().areChildrenCooking()||this.incrementTime(e))}incrementTime(e){if(this._realtimeState){this._delta=e;let t=this._time+this._delta;this.setTime(t,!1),this.setFrame(this._frame+1,!1)}else this.setFrame(this.frame()+1)}_ensureFrameWithinBounds(e){if(this._playing){if(this._maxFrameLocked&&e>this._maxFrame)return Nc.START_FRAME}else{if(this._maxFrameLocked&&e>this._maxFrame)return this._maxFrame;if(e<Nc.START_FRAME)return Nc.START_FRAME}return e}playing(){return this._playing===!0}pause(){this._playing!=!1&&(this._playing=!1,this.scene.dispatchController.dispatch(this._graphNode,as.PLAY_STATE_UPDATED),this.scene.eventsDispatcher.sceneEventsController.dispatch(kR))}play(){this._playing!=!0&&(this._playing=!0,this.scene.dispatchController.dispatch(this._graphNode,as.PLAY_STATE_UPDATED),this.scene.eventsDispatcher.sceneEventsController.dispatch(BR))}togglePlayPause(){this.playing()?this.pause():this.play()}registerOnBeforeTick(e,t){this._registerCallback(e,t,this.registeredBeforeTickCallbacks())}unRegisterOnBeforeTick(e){this._unregisterCallback(e,this._onBeforeTickCallbacksMap)}registeredBeforeTickCallbacks(){return this._onBeforeTickCallbacksMap=this._onBeforeTickCallbacksMap||new Map}registerOnAfterTick(e,t){this._registerCallback(e,t,this.registeredAfterTickCallbacks())}unRegisterOnAfterTick(e){this._unregisterCallback(e,this._onAfterTickCallbacksMap)}registeredAfterTickCallbacks(){return this._onAfterTickCallbacksMap=this._onAfterTickCallbacksMap||new Map}_registerCallback(e,t,r){if(r.has(e)){console.warn(`callback ${e} already registered`);return}r.set(e,t),this._updateCallbacks()}_unregisterCallback(e,t){!t||(t.delete(e),this._updateCallbacks())}_updateCallbacks(){this._onBeforeTickCallbacks=[],this._onBeforeTickCallbacksMap?.forEach(e=>{this._onBeforeTickCallbacks.push(e)}),this._onAfterTickCallbacks=[],this._onAfterTickCallbacksMap?.forEach(e=>{this._onAfterTickCallbacks.push(e)})}},O6=Nc;O6.START_FRAME=0;var EJe=async function(n){let{domElement:e,sceneData:t,onProgress:r}=n;if(n.runRegister!=null?n.runRegister:!0){for(let a of y5.nodes)Fe.registerNode(a);for(let a of y5.operations)Fe.registerOperation(a);$3.run(Fe),ZO(Fe)}Fe.libs.setRoot("/three/js/libs");let s="default",{scene:i,viewer:l}=await Wl.loadSceneData({domElement:e,sceneName:s,configureScene:QO,sceneData:t,onProgress:r,assetsRoot:""});return{scene:i,viewer:l}};export{Fe as Poly,EJe as loadSceneFromSceneData_default};
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*!
@fileoverview gl-matrix - High performance matrix and vector operations
@author Brandon Jones
@author Colin MacKenzie IV
@version 2.7.0

Copyright (c) 2015-2018, Brandon Jones, Colin MacKenzie IV.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

*/
